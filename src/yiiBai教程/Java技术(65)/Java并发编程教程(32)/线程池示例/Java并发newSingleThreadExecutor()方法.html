<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java并发newSingleThreadExecutor()方法</h1><div style="width:100%;float:left;" class="article-content">   
 <p>可以通过调用<code>Executors</code>类的<code>static newSingleThreadExecutor()</code>方法获得单个线程池。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-java">ExecutorService executor = Executors.newSingleThreadExecutor();
</code></pre> 
 <p><code>newSingleThreadExecutor()</code>方法创建一次执行单个任务的执行程序。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>以下<code>TestThread</code>程序显示了基于线程的环境中<code>newSingleThreadExecutor()</code>方法的使用。</p> 
 <pre><code class="lang-java">import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

public class TestThread {

   public static void main(final String[] arguments) throws InterruptedException {

      ExecutorService executor = Executors.newSingleThreadExecutor();

      try {
         executor.submit(new Task());
         System.out.println("Shutdown executor");
         executor.shutdown();
         executor.awaitTermination(5, TimeUnit.SECONDS);
      }
      catch (InterruptedException e) {
         System.err.println("tasks interrupted");
      }
      finally {
         if (!executor.isTerminated()) {
            System.err.println("cancel non-finished tasks");
         }
         executor.shutdownNow();
         System.out.println("shutdown finished");
      }
   }

   static class Task implements Runnable {
      public void run() {
         try {
            Long duration = (long) (Math.random() * 20);
            System.out.println("Running Task!");
            TimeUnit.SECONDS.sleep(duration);
         } 
         catch (InterruptedException e) {
            e.printStackTrace();
         }
      }
   }       
}
</code></pre> 
 <p>这将产生以下结果 - </p>   
 <pre><code class="lang-java">Shutdown executor
Running Task!
shutdown finished
cancel non-finished tasks
java.lang.InterruptedException: sleep interrupted
    at java.lang.Thread.sleep(Native Method)
    at java.lang.Thread.sleep(Thread.java:302)
    at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:328)
    at TestThread$Task.run(TestThread.java:39)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
    at java.lang.Thread.run(Thread.java:662)
</code></pre>
 <br>      
</div></body></html>