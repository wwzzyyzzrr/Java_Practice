<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring Boot应用程序开发入门</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本节中，我们来在Java中开发一个简单的“<code>Hello World！</code>” Web应用程序，突出一些<strong>Spring Boot</strong>的主要特性。在这里将使用<a target="_blank" href="http://www.yiibai.com/maven/" title="Maven">Maven</a>来构建这个项目，因为大多数IDE支持它。</p> 
 <p>在开始之前，打开一个终端，检查是否安装了<a target="_blank" href="http://www.yiibai.com/java/" title="Java">Java</a>和Maven的有效版本。</p> 
 <pre><code class="lang-shell">C:\Users\Administrator&gt;java -version
java version "1.8.0_65"
Java(TM) SE Runtime Environment (build 1.8.0_65-b17)
Java HotSpot(TM) 64-Bit Server VM (build 25.65-b01, mixed mode)

C:\Users\Administrator&gt;mvn -v
Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-11T00:41:47+08:00)
Maven home: D:\worksp\yiibai.com\apache-maven-3.3.9
Java version: 1.8.0_65, vendor: Oracle Corporation
Java home: D:\Program Files\Java\jdk1.8.0_65\jre
Default locale: zh_CN, platform encoding: GBK
OS name: "windows 10", version: "10.0", arch: "amd64", family: "dos"
</code></pre> 
 <p>此示例需要在其自己的文件夹中创建。后续说明假定您已创建了一个合适的文件夹，并且它是“当前目录”。</p> 
 <blockquote> 
  <p>提示，如果还没有安装 Maven ，请参考安装教程 - <a target="_blank" href="http://www.yiibai.com/maven/maven_environment_setup.html">http://www.yiibai.com/maven/maven_environment_setup.html</a></p> 
 </blockquote> 
 <h2 id="h2--pom-"><a name="创建POM文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建POM文件</h2>
 <p>我们需要从创建一个<code>Maven pom.xml</code>文件开始。<code>pom.xml</code>是将用于构建项目的配置，在这个示例中，把它放在 <code>D:\spring-boot\pom.xml</code> 。打开您喜欢的文本编辑器并添加以下内容：</p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;myproject&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.4.3.RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;!-- Additional lines to be added here... --&gt;

&lt;/project&gt;
</code></pre> 
 <p>它给出了一个工作构建，可以通过运行<code>mvn package</code>(可以忽略“<strong>jar will be empty - no content was marked for inclusion!</strong>”现在警告)测试它。</p> 
 <p>执行结果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/04/614090133_95912.png" alt=""></p> 
 <blockquote> 
  <p>此时，可以将项目导入到IDE中(最新的Java IDE包括对Maven的内置支持)。为了简单起见，这里将继续为此示例使用纯文本编辑器。</p> 
 </blockquote> 
 <h2 id="h2-u6DFBu52A0u7C7Bu8DEFu5F84u4F9Du8D56u9879"><a name="添加类路径依赖项" class="reference-link"></a><span class="header-link octicon octicon-link"></span>添加类路径依赖项</h2>
 <p><strong>Spring Boot</strong>提供了一些“启动器”，使得容易添加 <strong>jar</strong> 到你的类路径。在我们的示例应用程序已经在POM的父部分中使用了<code>spring-boot-starter-parent</code>。<code>spring-boot-starter-parent</code>是一个特殊的启动器，提供了有用的 <strong>Maven</strong> 默认值。 它还提供了一个依赖关系管理部分，以便您可以省略“<code>blessed</code>”依赖关系的 <code>version</code> 标签。</p> 
 <p>其他“<strong>Starters</strong>”只是提供了在开发特定类型的应用程序时可能需要的依赖关系。由于我们正在开发一个web应用程序，将添加一个<code>spring-boot-starter-web</code>依赖关系。</p> 
 <pre><code class="lang-java">$ mvn dependency:tree

[INFO] com.example:myproject:jar:0.0.1-SNAPSHOT
</code></pre> 
 <p>执行结果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/04/614090133_95912.png" alt=""></p> 
 <p><code>mvn dependency:tree</code>命令打印项目依赖关系的树表示。可以看到<code>spring-boot-starter-parent</code>本身不提供依赖关系。现在编辑 <code>pom.xml</code> 文件，并在<code>parent</code>部分的下面添加<code>spring-boot-starter-web</code>依赖关系：</p> 
 <pre><code class="lang-xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre> 
 <p>完整的 <code>pom.xml</code> 文件代码如下所示 - </p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;myproject&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.4.3.RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;!-- Additional lines to be added here... --&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;
</code></pre> 
 <p>如果再次运行<code>mvn dependency:tree</code>命令，将看到现在还有许多其他依赖项，包括<code>Tomcat Web</code>服务器和<code>Spring Boot</code>本身。</p> 
 <h2 id="h2-u7F16u5199u4EE3u7801"><a name="编写代码" class="reference-link"></a><span class="header-link octicon octicon-link"></span>编写代码</h2>
 <p>要完成上面的应用程序示例，我们需要创建一个单一的Java文件。Maven将默认从<code>src/main/java</code>编译源代码，所以需要创建该文件夹结构，然后添加一个名为<code>src/main/java/Example.java</code>的文件，完整的文件路径是 <code>D:/spring-boot/src/main/java/Example.java</code>，代码如下所示：</p> 
 <pre><code class="lang-java">import org.springframework.boot.*;
import org.springframework.boot.autoconfigure.*;
import org.springframework.stereotype.*;
import org.springframework.web.bind.annotation.*;

@RestController
@EnableAutoConfiguration
public class Example {

    @RequestMapping("/")
    String home() {
        return "Hello World!"; // Copyright: w w w . y i I b A i.c O m 
    }

    public static void main(String[] args) throws Exception {
        SpringApplication.run(Example.class, args);
    }

}
</code></pre> 
 <p>虽然这里没有太多的代码，但背后有很多事情正在发生。让我们看看代码的重要部分。</p> 
 <h3 id="h3--restcontroller-requestmapping-"><a name="@RestController 和 @RequestMapping注解" class="reference-link"></a><span class="header-link octicon octicon-link"></span><a target="_blank" href="https://github.com/RestController" title="@RestController" class="at-link">@RestController</a> 和 <a target="_blank" href="https://github.com/RequestMapping" title="@RequestMapping" class="at-link">@RequestMapping</a>注解</h3>
 <p><code>Example</code>类的第一个注解是<code><a target="_blank" href="https://github.com/RestController" title="@RestController" class="at-link">@RestController</a></code>。这称为构造型注释，它为阅读代码的人提供了提示，对于Spring，该类扮演了一个特定的角色。在这种情况下，这个类是一个web <code><a target="_blank" href="https://github.com/Controller" title="@Controller" class="at-link">@Controller</a></code>，因此Spring会在处理传入的Web请求时考虑它。</p> 
 <p><code><a target="_blank" href="https://github.com/RequestMapping" title="@RequestMapping" class="at-link">@RequestMapping</a></code>注解提供了“路由”信息。它告诉Spring任何带有路径“<code>/</code>”的HTTP请求应该映射到<code>home</code>方法。<code><a target="_blank" href="https://github.com/RestController" title="@RestController" class="at-link">@RestController</a></code>注解告诉Spring将生成的字符串直接返回给调用者。</p> 
 <blockquote> 
  <p><code><a target="_blank" href="https://github.com/RestController" title="@RestController" class="at-link">@RestController</a></code>和<code><a target="_blank" href="https://github.com/RequestMapping" title="@RequestMapping" class="at-link">@RequestMapping</a></code>注解是Spring MVC注释(它们不是<strong>Spring Boot</strong>特有的)。有关更多详细信息，请参阅Spring参考文档中的<a target="_blank" href="http://docs.spring.io/spring/docs/4.3.5.RELEASE/spring-framework-reference/htmlsingle#mvc" title="MVC部分">MVC部分</a>。</p> 
 </blockquote> 
 <h3 id="h3--enableautoconfiguration-"><a name="@EnableAutoConfiguration注解" class="reference-link"></a><span class="header-link octicon octicon-link"></span><a target="_blank" href="https://github.com/EnableAutoConfiguration" title="@EnableAutoConfiguration" class="at-link">@EnableAutoConfiguration</a>注解</h3>
 <p>第二个类级别注解是<code><a target="_blank" href="https://github.com/EnableAutoConfiguration" title="@EnableAutoConfiguration" class="at-link">@EnableAutoConfiguration</a></code>。这个注解告诉<code>Spring Boot</code>“猜测”将如何配置Spring，它是基于添加的<code>jar</code>依赖。 由于<code>spring-boot-starter-web</code>添加了<code>Tomcat</code>和<a target="_blank" href="http://www.yiibai.com/spring_mvc/" title="Spring MVC">Spring MVC</a>，因此自动配置将假设正在开发一个Web应用程序并相应地设置Spring。</p> 
 <blockquote> 
  <p>启动器和自动配置(Starters &amp; Auto-Configuration)<br>自动配置旨在与“Starters”配合使用，但这两个概念不直接绑定。可以自由选择和选择起始者以外的<code>jar</code>依赖，<strong>Spring Boot</strong>仍将尽力自动配置应用程序。</p> 
 </blockquote> 
 <h3 id="h3--main-"><a name="“main”方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>“main”方法</h3>
 <p>应用程序的最后一部分是主(main)方法。 这只是一个遵循Java约定的应用程序入口点的标准方法。<code>main</code>方法通过调用<code>run</code>来委托Spring Boot <code>SpringApplication</code>类。<code>SpringApplication</code>将引导应用程序，启动Spring，从而启动自动配置<strong>Tomcat Web</strong>服务器。需要传递<code>Example.class</code>作为<code>run</code>方法的参数来告诉<code>SpringApplication</code>，这是主要的Spring组件。<code>args</code>数组也被传递以暴露任何命令行参数。</p> 
 <h3 id="h3-u8FD0u884Cu793Au4F8B"><a name="运行示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>运行示例</h3>
 <p>现在，我们的应用程序应该可以正常运行工作了。由于 POM 中使用了<code>spring-boot-starter-parent</code>，有一个有用的 <code>run</code> 目标，用它来启动应用程序。输入 <code>mvn spring-boot:run</code> 从根项目目录启动应用程序：</p>   
 <pre><code class="lang-shell">$ mvn spring-boot:run

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
::Spring Boot:: (v1.4.3.RELEASE)
....... . . .
....... . . . (log output here)
....... . . .
........ Started Example in 2.222 seconds (JVM running for 6.514)
</code></pre> 
 <p>如果打开Web浏览器访问 <a target="_blank" href="http://localhost:8080">http://localhost:8080</a> ， 应该会看到以下输出：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/04/980100108_43893.png" alt=""></p> 
 <p>要正常退出应用程序，请按<code>ctrl-c</code>。</p> 
 <h2 id="h2--jar"><a name="创建可执行jar" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建可执行jar</h2>
 <p>现在，我们来完成一个例子，创建一个完全自包含的可执行<code>jar</code>文件，可以在生产中运行。可执行<code>jar</code>(有时称为“fat jar”)是包含编译的类以及需要运行的所有<code>jar</code>依赖性的代码存档。</p> 
 <blockquote> 
  <p>可执行jar和Java<br>Java不提供任何标准方法来加载嵌套的<code>jar</code>文件(即包含在<code>jar</code>中的<code>jar</code>文件)。如果想要分发一个自包含的应用程序，这可能是有问题的。<br>为了解决这个问题，许多开发人员使用“uber” jar。 一个uber jar简单地将所有类，从所有<code>jar</code>到一个单一的归档。这种方法的问题是，很难看到实际上在应用程序中使用哪些库。如果在多个<code>jar</code>中使用相同的文件名(但是具有不同的内容)，它也可能是有问题的。<br><strong>Spring Boot</strong>采用不同的方法，并允许直接嵌套JAR。<br>要创建可执行的<code>jar</code>，需要将<code>spring-boot-maven-plugin</code>添加到<code>pom.xml</code>文件中。 在<code>dependencies</code>部分下面插入以下行：</p> 
 </blockquote> 
 <pre><code class="lang-xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre> 
 <p>现在，<code>pom.xml</code>文件的完整内容如下 - </p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;myproject&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.4.3.RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;!-- Additional lines to be added here... --&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;

&lt;/project&gt;
</code></pre> 
 <p><code>POM</code> 中 <code>spring-boot-starter-parent</code> 包括<code>&lt;executions&gt;</code>配置以绑定 <code>repackage</code> 目标。如果不使用父<code>POM</code>，则需要自己声明此配置。有关详细信息，请参阅<a target="_blank" href="http://docs.spring.io/spring-boot/docs/1.4.3.RELEASE/maven-plugin/usage.html" title="插件文档">插件文档</a>。</p> 
 <p>保存<code>pom.xml</code>文件并从命令行运行命令 <code>mvn package</code>：</p> 
 <pre><code class="lang-shell">$ mvn package

[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building myproject 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] .... ..
[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ myproject ---
[INFO] Building jar: /Users/developer/example/spring-boot-example/target/myproject-0.0.1-SNAPSHOT.jar
[INFO]
[INFO] --- spring-boot-maven-plugin:1.4.3.RELEASE:repackage (default) @ myproject ---
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
</code></pre> 
 <p>在 <code>target</code> 目录中，应该看到一个<code>myproject-0.0.1-SNAPSHOT.jar</code>文件。文件大小应为<code>10 Mb</code>左右。如果想看里面内容，可以使用<code>jar tvf</code>：</p> 
 <pre><code class="lang-shell">$ jar tvf target/myproject-0.0.1-SNAPSHOT.jar
</code></pre> 
 <p>应该在<code>target</code>目录中看到一个名为<code>myproject-0.0.1-SNAPSHOT.jar.original</code>的文件。这是Maven在<strong>Spring Boot</strong>重新打包之前创建的原始<code>jar</code>文件。<br>要运行该应用程序，请使用<code>java -jar</code>命令：</p> 
 <pre><code class="lang-shell">$ java -jar target/myproject-0.0.1-SNAPSHOT.jar

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
::Spring Boot:: (v1.4.3.RELEASE)
....... . . .
....... . . . (log output here)
....... . . .
........ Started Example in 2.536 seconds (JVM running for 2.864)
</code></pre> 
 <p>如果打开Web浏览器访问 <a target="_blank" href="http://localhost:8080">http://localhost:8080</a> ， 应该会看到以下输出：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/04/980100108_43893.png" alt=""></p> 
 <p>和之前一样，要正常退出应用程序，同时按住<code>ctrl+c</code>。</p> 
 <p>到此，第一个 Spring Boot应用程序的开发就结束了。接下来再学习其它方面的知识内容。</p>
 <br>      
</div></body></html>