<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">log4j HTMLLayout</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 如果想生成一个HTML格式的文件，日志信息，那么可以使用 org.apache.log4j.HTMLLayout 格式化日志信息。</p> 
 <p> HTMLLayout类扩展抽象org.apache.log4j.Layout类，并覆盖其基类的 format()方法来提供HTML样式格式。</p> 
 <p> 这提供了以下信息显示：</p> 
 <ul> 
  <li> <p> 生成特定的日志事件之前，从应用程序的开始所经过的时间</p> </li> 
  <li> <p> 调用该记录请求的线程的名称</p> </li> 
  <li> <p> 与此记录请求相关联的级别</p> </li> 
  <li> <p> 日志记录器(Logger)和记录消息的名称</p> </li> 
  <li> <p> 可选程序文件的位置信息，并从其中记录被调用的行号</p> </li> 
 </ul> 
 <p> HTMLLayout是一个非常简单的布局对象，它提供以下方法：</p> 
 <table class="src" style="margin: 8px 0px; padding: 0px;  border-color: rgb(214, 214, 214); width: 560px; border-collapse: collapse; vertical-align: top; color: rgb(0, 0, 0);  background-color: rgb(247, 247, 247);"> 
  <tbody style="margin: 0px; padding: 0px;"> 
   <tr style="margin: 0px; padding: 0px;"> 
    <th style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214); width: 23px; background-color: rgb(238, 238, 238);"> S.N.</th> 
    <th style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214); background-color: rgb(238, 238, 238);"> 方法 &amp; 描述</th> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 1</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> <b style="margin: 0px; padding: 0px;">setContentType(String)</b><br style="margin: 0px; padding: 0px;"> 设置 text/html 为&nbsp;HTML内容的内容类型。默认为 text/html</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 2</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> <b style="margin: 0px; padding: 0px;">setLocationInfo(String)</b><br style="margin: 0px; padding: 0px;"> 设置位置信息记录事件。默认为 false</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 3</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> <b style="margin: 0px; padding: 0px;">setTitle(String)</b><br style="margin: 0px; padding: 0px;"> 设置为HTML文件的标题。默认值是Log4j的日志信息</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2> HTMLLayout 例子：</h2> 
 <p> 以下是对HTMLLayout一个简单的配置文件：</p> 
 <pre class="prettyprint" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
# Define the root logger with appender file
log = /usr/home/log4j
log4j.rootLogger = DEBUG, FILE

# Define the file appender
log4j.appender.FILE=org.apache.log4j.FileAppender
log4j.appender.FILE.File=${log}/htmlLayout.html

# Define the layout for file appender
log4j.appender.FILE.layout=org.apache.log4j.HTMLLayout
log4j.appender.FILE.layout.Title=HTML Layout Example
log4j.appender.FILE.layout.LocationInfo=true</pre> 
 <p> 现在考虑下面的Java例子用于产生日志信息：</p> 
 <pre class="prettyprint" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
import org.apache.log4j.Logger;

import java.io.*;
import java.sql.SQLException;
import java.util.*;

public class log4jExample{
  /* Get actual class name to be printed on */
  static Logger log = Logger.getLogger(
                      log4jExample.class.getName());

  public static void main(String[] args)
                throws IOException,SQLException{
   
     log.debug("Hello this is an debug message");
     log.info("Hello this is an info message");
  }
}</pre> 
 <p style="margin: 0.8em 0px 1em; padding: 0px; text-align: justify; color: rgb(0, 0, 0); "> 编译并运行上述程序，它会在 /usr/home/log4j 目录创建 htmlLayout.html 文件，该文件将有如下的日志信息：</p> 
 <hr style="border: 0px; color: rgb(214, 214, 214); height: 1px; width: 561px;  background-color: rgb(214, 214, 214);"> 
 <span style="color: rgb(0, 0, 0); ">Log session start time Mon Mar 22 13:30:24 AST 2014</span>
 <br style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); "> 
 <br style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); "> 
 <table border="1" bordercolor="#224466" cellpadding="4" cellspacing="0" style="margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-size: x-small; arial, " width="100%"> 
  <tbody style="margin: 0px; padding: 0px;"> 
   <tr style="margin: 0px; padding: 0px;"> 
    <th style="margin: 0px; padding: 0px; color: rgb(255, 255, 255); background: rgb(51, 102, 153);"> Time</th> 
    <th style="margin: 0px; padding: 0px; color: rgb(255, 255, 255); background: rgb(51, 102, 153);"> Thread</th> 
    <th style="margin: 0px; padding: 0px; color: rgb(255, 255, 255); background: rgb(51, 102, 153);"> Level</th> 
    <th style="margin: 0px; padding: 0px; color: rgb(255, 255, 255); background: rgb(51, 102, 153);"> Category</th> 
    <th style="margin: 0px; padding: 0px; color: rgb(255, 255, 255); background: rgb(51, 102, 153);"> File:Line</th> 
    <th style="margin: 0px; padding: 0px; color: rgb(255, 255, 255); background: rgb(51, 102, 153);"> Message</th> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 0px;"> 0</td> 
    <td style="margin: 0px; padding: 0px;" title="main thread"> main</td> 
    <td style="margin: 0px; padding: 0px;" title="Level"> <font color="#339933">DEBUG</font></td> 
    <td style="margin: 0px; padding: 0px;" title="log4jExample category"> log4jExample</td> 
    <td style="margin: 0px; padding: 0px;"> log4jExample.java:15</td> 
    <td style="margin: 0px; padding: 0px;" title="Message"> Hello this is an debug message</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 0px;"> 6</td> 
    <td style="margin: 0px; padding: 0px;" title="main thread"> main</td> 
    <td style="margin: 0px; padding: 0px;" title="Level"> INFO</td> 
    <td style="margin: 0px; padding: 0px;" title="log4jExample category"> log4jExample</td> 
    <td style="margin: 0px; padding: 0px;"> log4jExample.java:16</td> 
    <td style="margin: 0px; padding: 0px;" title="Message"> Hello this is an info message</td> 
   </tr> 
  </tbody> 
 </table> 
 <p> 可以使用一个Web浏览器打开htmlLayout.html 文件。同样重要的是要注意，页脚&lt;/ HTML&gt;和&lt;/ body&gt;标记是完全缺失。</p> 
 <p> 一个具有HTML格式的日志文件的一大优势是，它可以被发布为网页可以远程查看。</p> 
 <br>      
</div></body></html>