<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring4 MVC+Hibernate4+MySQL+Maven使用注解集成实例</h1><div style="width:100%;float:left;" class="article-content">   
 <div>
   在本教程中，我们将使用基于注解的配置集成Spring和Hibernate。&nbsp;我们将开发包含表单要求用户输入一个简单的CRUD为导向Web应用程序，使用Hibernate保存输入的数据到&nbsp;MySQL&nbsp;数据库，从数据库和更新检索记录或删除它们在事务中，全部采用注解配置。 
 </div> 
 <div> 
  <div>
    使用以下技术： 
  </div> 
  <ul> 
   <li> Spring 4.0.6.RELEASE </li> 
   <li> Hibernate Core 4.3.6.Final </li> 
   <li> validation-api 1.1.0.Final </li> 
   <li> hibernate-validator 5.1.3.Final </li> 
   <li> MySQL Server 5.6 </li> 
   <li> Maven 3 </li> 
   <li> JDK 1.7 </li> 
   <li> Tomcat 8.0.21 </li> 
   <li> Eclipse JUNO Service Release 2 </li> 
   <li> TestNG 6.9.4 </li> 
   <li> Mockito 1.10.19 </li> 
   <li> DBUnit 2.2 </li> 
   <li> H2 Database 1.4.187 </li> 
  </ul> 
  <p> 现在，让我们开始 </p> 
  <h4> 
   <div>
     第1步：创建目录结构 
   </div> </h4> 
  <div>
    以下是最终的项目结构： 
  </div> 
  <p> <img src="/uploads/tutorial/20160116/1-160116091Z1924.png" alt=""> </p> 
  <div>
    现在让我们来添加上每个细节上述结构中提到的内容。 
  </div> 
  <h4> 
   <div>
     第2步：更新 pom.xml，包括所需的依赖关系 
   </div> </h4> 
  <pre>&lt;?xml version="1.0"?&gt;
&lt;project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
	xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;

	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
	&lt;groupId&gt;com.yiibai.springmvc&lt;/groupId&gt;
	&lt;artifactId&gt;SpringHibernateExample&lt;/artifactId&gt;
	&lt;packaging&gt;war&lt;/packaging&gt;
	&lt;version&gt;1.0.0&lt;/version&gt;
	&lt;name&gt;SpringHibernateExample&lt;/name&gt;

	&lt;properties&gt;
		&lt;springframework.version&gt;4.0.6.RELEASE&lt;/springframework.version&gt;
		&lt;hibernate.version&gt;4.3.6.Final&lt;/hibernate.version&gt;
		&lt;mysql.connector.version&gt;5.1.31&lt;/mysql.connector.version&gt;
		&lt;joda-time.version&gt;2.3&lt;/joda-time.version&gt;
		&lt;testng.version&gt;6.9.4&lt;/testng.version&gt;
		&lt;mockito.version&gt;1.10.19&lt;/mockito.version&gt;
		&lt;h2.version&gt;1.4.187&lt;/h2.version&gt;
		&lt;dbunit.version&gt;2.2&lt;/dbunit.version&gt;
	&lt;/properties&gt;

	&lt;dependencies&gt;
		&lt;!-- Spring --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-core&lt;/artifactId&gt;
			&lt;version&gt;${springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-web&lt;/artifactId&gt;
			&lt;version&gt;${springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
			&lt;version&gt;${springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
			&lt;version&gt;${springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
			&lt;version&gt;${springframework.version}&lt;/version&gt;
		&lt;/dependency&gt;

		&lt;!-- Hibernate --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.hibernate&lt;/groupId&gt;
			&lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;
			&lt;version&gt;${hibernate.version}&lt;/version&gt;
		&lt;/dependency&gt;

		&lt;!-- jsr303 validation --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;javax.validation&lt;/groupId&gt;
			&lt;artifactId&gt;validation-api&lt;/artifactId&gt;
			&lt;version&gt;1.1.0.Final&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.hibernate&lt;/groupId&gt;
			&lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
			&lt;version&gt;5.1.3.Final&lt;/version&gt;
		&lt;/dependency&gt;

		&lt;!-- MySQL --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;mysql&lt;/groupId&gt;
			&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
			&lt;version&gt;${mysql.connector.version}&lt;/version&gt;
		&lt;/dependency&gt;

      	&lt;!-- Joda-Time --&gt;		
		&lt;dependency&gt;
  			&lt;groupId&gt;joda-time&lt;/groupId&gt;
  			&lt;artifactId&gt;joda-time&lt;/artifactId&gt;
  			&lt;version&gt;${joda-time.version}&lt;/version&gt;
  		&lt;/dependency&gt;
		
		&lt;!-- To map JodaTime with database type --&gt;  		
  		&lt;dependency&gt;
    		&lt;groupId&gt;org.jadira.usertype&lt;/groupId&gt;
    		&lt;artifactId&gt;usertype.core&lt;/artifactId&gt;
    		&lt;version&gt;3.0.0.CR1&lt;/version&gt;
		&lt;/dependency&gt;

		&lt;!-- Servlet+JSP+JSTL --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;javax.servlet&lt;/groupId&gt;
			&lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
			&lt;version&gt;3.1.0&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
			&lt;artifactId&gt;javax.servlet.jsp-api&lt;/artifactId&gt;
			&lt;version&gt;2.3.1&lt;/version&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
		    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
		    &lt;artifactId&gt;jstl&lt;/artifactId&gt;
		    &lt;version&gt;1.2&lt;/version&gt;
		&lt;/dependency&gt;
		
		
		&lt;!-- Testing dependencies --&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.springframework&lt;/groupId&gt;
			&lt;artifactId&gt;spring-test&lt;/artifactId&gt;
			&lt;version&gt;${springframework.version}&lt;/version&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.testng&lt;/groupId&gt;
			&lt;artifactId&gt;testng&lt;/artifactId&gt;
			&lt;version&gt;${testng.version}&lt;/version&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.mockito&lt;/groupId&gt;
			&lt;artifactId&gt;mockito-all&lt;/artifactId&gt;
			&lt;version&gt;${mockito.version}&lt;/version&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;com.h2database&lt;/groupId&gt;
			&lt;artifactId&gt;h2&lt;/artifactId&gt;
			&lt;version&gt;${h2.version}&lt;/version&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;dbunit&lt;/groupId&gt;
			&lt;artifactId&gt;dbunit&lt;/artifactId&gt;
			&lt;version&gt;${dbunit.version}&lt;/version&gt;
			&lt;scope&gt;test&lt;/scope&gt;
		&lt;/dependency&gt;
		
	&lt;/dependencies&gt;

	&lt;build&gt;
		&lt;pluginManagement&gt;
			&lt;plugins&gt;
				&lt;plugin&gt;
					&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
					&lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
					&lt;version&gt;2.4&lt;/version&gt;
					&lt;configuration&gt;
						&lt;warSourceDirectory&gt;src/main/webapp&lt;/warSourceDirectory&gt;
						&lt;warName&gt;SpringHibernateExample&lt;/warName&gt;
						&lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;
					&lt;/configuration&gt;
				&lt;/plugin&gt;
			&lt;/plugins&gt;
		&lt;/pluginManagement&gt;
		&lt;finalName&gt;SpringHibernateExample&lt;/finalName&gt;
	&lt;/build&gt;
&lt;/project&gt;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">首先要注意这里是&nbsp;maven-war-plugin&nbsp;插件声明。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">由于我们使用的是全注解的配置，所以不包函 web.xml 文件在项目中，</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">所以我们需要配置这个插件以避免 Maven 构建 war 包失败。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">因为在这个例子中，我们将用一个表单来接受来自用户的输入，</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">我们也需要验证用户的输入。在这里</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">我们将选择JSR303验证，所以我们包括验证，API 代表了规范，</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">hibernate-validator它代表本规范的实现。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">hibernate-validator&nbsp;还提供了一些它自己的注解(@Email，@NotEmpty等)不属于规范的一部分。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">伴随着这一点，我们也包括&nbsp;JSP/Servlet/Jstl&nbsp;依赖关系，也将需要为使用的 servlet&nbsp;API和JSTL视图在代码中。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">在一般情况下，容器可能已经包含了这些库，从而在 pom.xml 中“提供”了我们可以设置的范围。</span> </p> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     步骤3：配置Hibernate 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.configuration.HibernateConfiguration </p> 
  <pre>package com.yiibai.springmvc.configuration;

import java.util.Properties;

import javax.sql.DataSource;

import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.core.env.Environment;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.hibernate4.HibernateTransactionManager;
import org.springframework.orm.hibernate4.LocalSessionFactoryBean;
import org.springframework.transaction.annotation.EnableTransactionManagement;

@Configuration
@EnableTransactionManagement
@ComponentScan({ "com.yiibai.springmvc.configuration" })
@PropertySource(value = { "classpath:application.properties" })
public class HibernateConfiguration {

    @Autowired
    private Environment environment;

    @Bean
    public LocalSessionFactoryBean sessionFactory() {
        LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
        sessionFactory.setDataSource(dataSource());
        sessionFactory.setPackagesToScan(new String[] { "com.yiibai.springmvc.model" });
        sessionFactory.setHibernateProperties(hibernateProperties());
        return sessionFactory;
     }
	
    @Bean
    public DataSource dataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(environment.getRequiredProperty("jdbc.driverClassName"));
        dataSource.setUrl(environment.getRequiredProperty("jdbc.url"));
        dataSource.setUsername(environment.getRequiredProperty("jdbc.username"));
        dataSource.setPassword(environment.getRequiredProperty("jdbc.password"));
        return dataSource;
    }
    
    private Properties hibernateProperties() {
        Properties properties = new Properties();
        properties.put("hibernate.dialect", environment.getRequiredProperty("hibernate.dialect"));
        properties.put("hibernate.show_sql", environment.getRequiredProperty("hibernate.show_sql"));
        properties.put("hibernate.format_sql", environment.getRequiredProperty("hibernate.format_sql"));
        return properties;        
    }
    
	@Bean
    @Autowired
    public HibernateTransactionManager transactionManager(SessionFactory s) {
       HibernateTransactionManager txManager = new HibernateTransactionManager();
       txManager.setSessionFactory(s);
       return txManager;
    }
}&nbsp;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">@Configuration表示该类包含注解为&nbsp;@Bean生产Bean管理是由Spring容器的一个或多个bean的方法。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">在我们的例子中，这个类代表hibernate配置。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> @ComponentScan&nbsp;相当于&nbsp;context:component-scan base-package="..."&nbsp;在xml文件中配置,&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">提供Spring在哪里寻找管理&nbsp;beans/classes。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> @EnableTransactionManagement&nbsp;相当于&nbsp;Spring’s tx:* XML 命名空间,&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">使Spring注解驱动事务管理能力。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> @PropertySource&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">用于声明一组属性(在属性中定义的应用程序类路径文件)在Spring运行时</span><span style="line-height:1.5;">&nbsp;</span>Environment<span style="line-height:1.5;">,&nbsp;</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">提供了灵活性，可以在不同的应用环境的不同值。</span> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    下面是这篇文章中使用的属性文件。 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> /src/main/resources/application.properties </p> 
  <pre>jdbc.driverClassName = com.mysql.jdbc.Driver
jdbc.url = jdbc:mysql://localhost:3306/yiibai
jdbc.username = root
jdbc.password = passwd123
hibernate.dialect = org.hibernate.dialect.MySQLDialect
hibernate.show_sql = true
hibernate.format_sql = true</pre> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第4步：配置Spring&nbsp;MVC 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.configuration.AppConfig </p> 
  <pre>package com.yiibai.springmvc.configuration;

import org.springframework.context.MessageSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.ResourceBundleMessageSource;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.view.InternalResourceViewResolver;
import org.springframework.web.servlet.view.JstlView;

@Configuration
@EnableWebMvc
@ComponentScan(basePackages = "com.yiibai.springmvc")
public class AppConfig {
	
	@Bean
	public ViewResolver viewResolver() {
		InternalResourceViewResolver viewResolver = new InternalResourceViewResolver();
		viewResolver.setViewClass(JstlView.class);
		viewResolver.setPrefix("/WEB-INF/views/");
		viewResolver.setSuffix(".jsp");
		return viewResolver;
	}
	
	@Bean
	public MessageSource messageSource() {
	    ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource();
	    messageSource.setBasename("messages");
	    return messageSource;
	}
}</pre> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    同样，@Configuration标志着这一类配置类如上所述与器件扫描是指包位置找到相关的Bean类。 
  </div> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    @EnableWebMvc相当于mvc:annotation-driven&nbsp;在XML文件中。 
  </div> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    ViewResolver方法配置一个ViewResolver来找出真正的视图。 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">在这篇文章中，我们提交表单并验证用户输入(通过JSR303注解)。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">在校验失败后，默认的错误消息会显示。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">要通过自己的自定义覆盖默认的[国际化]从外部消息包的消息[.properties文件]，</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">我们需要配置一个ResourceBundleMessageSource。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">messageSource方法有同样的目的。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">请注意，以basename方法提供的参数(消息)。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">Spring将搜索应用程序类路径中一个名为 messages.properties 的文件。让我们添加的文件：</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> /src/main/resources/messages.properties </p> 
  <pre>Size.employee.name=Name must be between {2} and {1} characters long
NotNull.employee.joiningDate=Joining Date can not be blank
NotNull.employee.salary=Salary can not be blank
Digits.employee.salary=Only numeric data with max 8 digits and with max 2 precision is allowed
NotEmpty.employee.ssn=SSN can not be blank
typeMismatch=Invalid format
non.unique.ssn=SSN {0} already exist. Please fill in different value.</pre> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    请注意，上述消息按照特定的模式： 
  </div> 
  <pre>{ValidationAnnotationClass}.{modelObject}.{fieldName}&nbsp;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">此外，根据具体注解(如@Size)，你也可以用传递参数给这些消息<span style="font-size:15px;">{0},{1},..{i}</span>索引。</span> </p> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     步骤5：配置初始化器类 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.configuration.AppInitializer </p> 
  <pre>package com.yiibai.springmvc.configuration;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.ServletRegistration;

import org.springframework.web.WebApplicationInitializer;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;
import org.springframework.web.servlet.DispatcherServlet;

public class AppInitializer implements WebApplicationInitializer {

	public void onStartup(ServletContext container) throws ServletException {

		AnnotationConfigWebApplicationContext ctx = new AnnotationConfigWebApplicationContext();
		ctx.register(AppConfig.class);
		ctx.setServletContext(container);

		ServletRegistration.Dynamic servlet = container.addServlet(
				"dispatcher", new DispatcherServlet(ctx));

		servlet.setLoadOnStartup(1);
		servlet.addMapping("/");
	}

}&nbsp;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">上面的内容类似于web.xml，因为我们使用的是前端控制器&nbsp;DispatcherServlet&nbsp;的内容，</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">分配映射(URL模式的XML)，而不是提供给Spring配置文件<span style="font-size:15px;">(spring-servlet.xml)</span>的路径，在这里我们正在注册的配置类。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">更新：请注意，上面的类可以写成更加简洁[最佳方法]，通过扩展</span>&nbsp;AbstractAnnotationConfigDispatcherServletInitializer&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">基类，如下所示：</span> </p> 
  <pre>package com.yiibai.springmvc.configuration;

import org.springframework.web.servlet.support.AbstractAnnotationConfigDispatcherServletInitializer;

public class AppInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {

	@Override
	protected Class&lt;?&gt;[] getRootConfigClasses() {
		return new Class[] { AppConfig.class };
	}
 
	@Override
	protected Class&lt;?&gt;[] getServletConfigClasses() {
		return null;
	}
 
	@Override
	protected String[] getServletMappings() {
		return new String[] { "/" };
	}

}</pre> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第6步：添加控制器来处理请求 
   </div> </h4> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    添加控制器这将有助于处理&nbsp;GET和POST请求。 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.controller.AppController </p> 
  <pre>package com.yiibai.springmvc.controller;

import java.util.List;
import java.util.Locale;

import javax.validation.Valid;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.validation.BindingResult;
import org.springframework.validation.FieldError;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

import com.yiibai.springmvc.model.Employee;
import com.yiibai.springmvc.service.EmployeeService;

@Controller
@RequestMapping("/")
public class AppController {

	@Autowired
	EmployeeService service;
	
	@Autowired
	MessageSource messageSource;

	/*
	 * This method will list all existing employees.
	 */
	@RequestMapping(value = { "/", "/list" }, method = RequestMethod.GET)
	public String listEmployees(ModelMap model) {

		List&lt;Employee&gt; employees = service.findAllEmployees();
		model.addAttribute("employees", employees);
		return "allemployees";
	}

	/*
	 * This method will provide the medium to add a new employee.
	 */
	@RequestMapping(value = { "/new" }, method = RequestMethod.GET)
	public String newEmployee(ModelMap model) {
		Employee employee = new Employee();
		model.addAttribute("employee", employee);
		model.addAttribute("edit", false);
		return "registration";
	}

	/*
	 * This method will be called on form submission, handling POST request for
	 * saving employee in database. It also validates the user input
	 */
	@RequestMapping(value = { "/new" }, method = RequestMethod.POST)
	public String saveEmployee(@Valid Employee employee, BindingResult result,
			ModelMap model) {

		if (result.hasErrors()) {
			return "registration";
		}

		/*
		 * Preferred way to achieve uniqueness of field [ssn] should be implementing custom @Unique annotation 
		 * and applying it on field [ssn] of Model class [Employee].
		 * 
		 * Below mentioned peace of code [if block] is to demonstrate that you can fill custom errors outside the validation
		 * framework as well while still using internationalized messages.
		 * 
		 */
		if(!service.isEmployeeSsnUnique(employee.getId(), employee.getSsn())){
			FieldError ssnError =new FieldError("employee","ssn",messageSource.getMessage("non.unique.ssn", new String[]{employee.getSsn()}, Locale.getDefault()));
		    result.addError(ssnError);
			return "registration";
		}
		
		service.saveEmployee(employee);

		model.addAttribute("success", "Employee " + employee.getName() + " registered successfully");
		return "success";
	}


	/*
	 * This method will provide the medium to update an existing employee.
	 */
	@RequestMapping(value = { "/edit-{ssn}-employee" }, method = RequestMethod.GET)
	public String editEmployee(@PathVariable String ssn, ModelMap model) {
		Employee employee = service.findEmployeeBySsn(ssn);
		model.addAttribute("employee", employee);
		model.addAttribute("edit", true);
		return "registration";
	}
	
	/*
	 * This method will be called on form submission, handling POST request for
	 * updating employee in database. It also validates the user input
	 */
	@RequestMapping(value = { "/edit-{ssn}-employee" }, method = RequestMethod.POST)
	public String updateEmployee(@Valid Employee employee, BindingResult result,
			ModelMap model, @PathVariable String ssn) {

		if (result.hasErrors()) {
			return "registration";
		}

		if(!service.isEmployeeSsnUnique(employee.getId(), employee.getSsn())){
			FieldError ssnError =new FieldError("employee","ssn",messageSource.getMessage("non.unique.ssn", new String[]{employee.getSsn()}, Locale.getDefault()));
		    result.addError(ssnError);
			return "registration";
		}

		service.updateEmployee(employee);

		model.addAttribute("success", "Employee " + employee.getName()	+ " updated successfully");
		return "success";
	}

	
	/*
	 * This method will delete an employee by it's SSN value.
	 */
	@RequestMapping(value = { "/delete-{ssn}-employee" }, method = RequestMethod.GET)
	public String deleteEmployee(@PathVariable String ssn) {
		service.deleteEmployeeBySsn(ssn);
		return "redirect:/list";
	}

}&nbsp;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">这是一个非常直接的基于Spring的控制器。&nbsp;@Controller表明这个类是一个控制器在处理与模式映射@RequestMapping请求。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">这里用“/”，它被作为默认的控制器。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">listEmployees方法标注了@&nbsp;RequestMethod.GET，</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">同时处理默认的网址&nbsp;“/”&nbsp;和&nbsp;‘/list’。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">它充当处理应用初始页面，显示现有雇员的列表。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">newEmployee方法处理新员工注册页面的GET请求，</span>&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">表示通过模型 Employee 对象支持页面。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">方法&nbsp;saveEmployee&nbsp;被注解为@&nbsp;RequestMethod.POST，并且将处理新员工登记表单提交&nbsp;POST 请求&nbsp;(‘/new’)。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">注间这个方法的参数和它们的顺序。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">@Valid要求Spring来验证相关的对象(Employee)。</span>&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">BindingResult包含此验证，并可能在此验证过程中发生任何错误的结果。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">请注意，BindingResult必须出现在验证对象，否则Spring将无法验证并且抛出一个异常。</span><span style="line-height:1.5;">&nbsp;</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">如果验证失败，自定义错误信息(因为我们已经配置在步骤4)中显示。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">我们还包括代码检查SSN唯一性，因为它声明要在数据库中具有唯一必。保存</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">/更新员工之前要检查，如果SSN是否独一无二。如果没有，我们生成验证错误和重定向到注册页面。</span><span style="line-height:1.5;">&nbsp;</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">这个代码展示出一种方式来填充在自定义错误校验框架之外，同时仍使用国际化的信息。</span> </p> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第7步：添加DAO层 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.dao.AbstractDao </p> 
  <pre>package com.yiibai.springmvc.dao;

import java.io.Serializable;

import java.lang.reflect.ParameterizedType;

import org.hibernate.Criteria;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.springframework.beans.factory.annotation.Autowired;

public abstract class AbstractDao&lt;PK extends Serializable, T&gt; {
	
	private final Class&lt;T&gt; persistentClass;
	
	@SuppressWarnings("unchecked")
	public AbstractDao(){
		this.persistentClass =(Class&lt;T&gt;) ((ParameterizedType) this.getClass().getGenericSuperclass()).getActualTypeArguments()[1];
	}
	
	@Autowired
	private SessionFactory sessionFactory;

	protected Session getSession(){
		return sessionFactory.getCurrentSession();
	}

	@SuppressWarnings("unchecked")
	public T getByKey(PK key) {
		return (T) getSession().get(persistentClass, key);
	}

	public void persist(T entity) {
		getSession().persist(entity);
	}

	public void delete(T entity) {
		getSession().delete(entity);
	}
	
	protected Criteria createEntityCriteria(){
		return getSession().createCriteria(persistentClass);
	}

}&nbsp;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">这个通用类是所有的DAO实现类的基类。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">它提供包装方法也是常见的hibernate&nbsp;操作。</span> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    注意上面，我们已经在前面第3步创建了SessionFactory，在这里将自动装配。 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.dao.EmployeeDao </p>   
  <pre>package com.yiibai.springmvc.dao;

import java.util.List;

import com.yiibai.springmvc.model.Employee;

public interface EmployeeDao {

	Employee findById(int id);

	void saveEmployee(Employee employee);
	
	void deleteEmployeeBySsn(String ssn);
	
	List&lt;Employee&gt; findAllEmployees();

	Employee findEmployeeBySsn(String ssn);

}</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.dao.EmployeeDaoImpl </p> 
  <pre>package com.yiibai.springmvc.dao;

import java.util.List;

import org.hibernate.Criteria;
import org.hibernate.Query;
import org.hibernate.criterion.Restrictions;
import org.springframework.stereotype.Repository;

import com.yiibai.springmvc.model.Employee;

@Repository("employeeDao")
public class EmployeeDaoImpl extends AbstractDao&lt;Integer, Employee&gt; implements EmployeeDao {

	public Employee findById(int id) {
		return getByKey(id);
	}

	public void saveEmployee(Employee employee) {
		persist(employee);
	}

	public void deleteEmployeeBySsn(String ssn) {
		Query query = getSession().createSQLQuery("delete from Employee where ssn = :ssn");
		query.setString("ssn", ssn);
		query.executeUpdate();
	}

	@SuppressWarnings("unchecked")
	public List&lt;Employee&gt; findAllEmployees() {
		Criteria criteria = createEntityCriteria();
		return (List&lt;Employee&gt;) criteria.list();
	}

	public Employee findEmployeeBySsn(String ssn) {
		Criteria criteria = createEntityCriteria();
		criteria.add(Restrictions.eq("ssn", ssn));
		return (Employee) criteria.uniqueResult();
	}
}</pre> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第8步：添加服务层 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.service.EmployeeService </p> 
  <pre>package com.yiibai.springmvc.service;

import java.util.List;

import com.yiibai.springmvc.model.Employee;

public interface EmployeeService {

	Employee findById(int id);
	
	void saveEmployee(Employee employee);
	
	void updateEmployee(Employee employee);
	
	void deleteEmployeeBySsn(String ssn);

	List&lt;Employee&gt; findAllEmployees(); 
	
	Employee findEmployeeBySsn(String ssn);

	boolean isEmployeeSsnUnique(Integer id, String ssn);
	
}</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.service.EmployeeServiceImpl </p> 
  <pre>package com.yiibai.springmvc.service;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.yiibai.springmvc.dao.EmployeeDao;
import com.yiibai.springmvc.model.Employee;

@Service("employeeService")
@Transactional
public class EmployeeServiceImpl implements EmployeeService {

	@Autowired
	private EmployeeDao dao;
	
	public Employee findById(int id) {
		return dao.findById(id);
	}

	public void saveEmployee(Employee employee) {
		dao.saveEmployee(employee);
	}

	/*
	 * Since the method is running with Transaction, No need to call hibernate update explicitly.
	 * Just fetch the entity from db and update it with proper values within transaction.
	 * It will be updated in db once transaction ends. 
	 */
	public void updateEmployee(Employee employee) {
		Employee entity = dao.findById(employee.getId());
		if(entity!=null){
			entity.setName(employee.getName());
			entity.setJoiningDate(employee.getJoiningDate());
			entity.setSalary(employee.getSalary());
			entity.setSsn(employee.getSsn());
		}
	}

	public void deleteEmployeeBySsn(String ssn) {
		dao.deleteEmployeeBySsn(ssn);
	}
	
	public List&lt;Employee&gt; findAllEmployees() {
		return dao.findAllEmployees();
	}

	public Employee findEmployeeBySsn(String ssn) {
		return dao.findEmployeeBySsn(ssn);
	}

	public boolean isEmployeeSsnUnique(Integer id, String ssn) {
		Employee employee = findEmployeeBySsn(ssn);
		return ( employee == null || ((id != null) &amp;&amp; (employee.getId() == id)));
	}
	
}&nbsp;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">上面最有趣的部分是 @Transactional 它开始在每个方法启动一个事务，并提交其上的每个方法退出(或回滚，如果方法失败，会发生是一个错误)。</span>&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">注意，因为该事务是在方法范围，和内部的方法，我们将使用DAO，DAO方法将在同一事务内执行。</span> </p> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第9步：创建域实体类(POJO) 
   </div> </h4> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    让我们创建实际的员工实体数据表。 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> com.yiibai.springmvc.model.Employee </p> 
  <pre>package com.yiibai.springmvc.model;

import java.math.BigDecimal;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.validation.constraints.Digits;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

import org.hibernate.annotations.Type;
import org.hibernate.validator.constraints.NotEmpty;
import org.joda.time.LocalDate;
import org.springframework.format.annotation.DateTimeFormat;

@Entity
@Table(name="EMPLOYEE")
public class Employee {

	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private int id;

	@Size(min=3, max=50)
	@Column(name = "NAME", nullable = false)
	private String name;

	@NotNull
	@DateTimeFormat(pattern="dd/MM/yyyy") 
	@Column(name = "JOINING_DATE", nullable = false)
	@Type(type="org.jadira.usertype.dateandtime.joda.PersistentLocalDate")
	private LocalDate joiningDate;

	@NotNull
	@Digits(integer=8, fraction=2)
	@Column(name = "SALARY", nullable = false)
	private BigDecimal salary;
	
	@NotEmpty
	@Column(name = "SSN", unique=true, nullable = false)
	private String ssn;

	public int getId() {
		return id;
	}

	public void setId(int id) {
		this.id = id;
	}

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public LocalDate getJoiningDate() {
		return joiningDate;
	}

	public void setJoiningDate(LocalDate joiningDate) {
		this.joiningDate = joiningDate;
	}

	public BigDecimal getSalary() {
		return salary;
	}

	public void setSalary(BigDecimal salary) {
		this.salary = salary;
	}

	public String getSsn() {
		return ssn;
	}

	public void setSsn(String ssn) {
		this.ssn = ssn;
	}

	@Override
	public int hashCode() {
		final int prime = 31;
		int result = 1;
		result = prime * result + id;
		result = prime * result + ((ssn == null) ? 0 : ssn.hashCode());
		return result;
	}

	@Override
	public boolean equals(Object obj) {
		if (this == obj)
			return true;
		if (obj == null)
			return false;
		if (!(obj instanceof Employee))
			return false;
		Employee other = (Employee) obj;
		if (id != other.id)
			return false;
		if (ssn == null) {
			if (other.ssn != null)
				return false;
		} else if (!ssn.equals(other.ssn))
			return false;
		return true;
	}

	@Override
	public String toString() {
		return "Employee [id=" + id + ", name=" + name + ", joiningDate="
				+ joiningDate + ", salary=" + salary + ", ssn=" + ssn + "]";
	}
	
}</pre> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    这是注明使用JPA注解@Entity，@Table，@Column 使用 hibernate的具体注释@Type，我们正在使用提供数据库中的数据类型和LocalDate之间的映射标准的实体类。 
  </div> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    @DateTimeFormat是一个&nbsp;Spring&nbsp;的具体注解声明，字段应该使用一个给定格式格式化日期时间。 
  </div> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第10步：添加视图/JSP 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> WEB-INF/views/allemployees.jsp&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">[主页包含所有现有员工列表]</span> </p> 
  <pre>&lt;%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="uft-8"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
	&lt;title&gt;University Enrollments&lt;/title&gt;

	&lt;style&gt;
		tr:first-child{
			font-weight: bold;
			background-color: #C6C9C4;
		}
	&lt;/style&gt;

&lt;/head&gt;


&lt;body&gt;
	&lt;h2&gt;List of Employees&lt;/h2&gt;	
	&lt;table&gt;
		&lt;tr&gt;
			&lt;td&gt;NAME&lt;/td&gt;&lt;td&gt;Joining Date&lt;/td&gt;&lt;td&gt;Salary&lt;/td&gt;&lt;td&gt;SSN&lt;/td&gt;&lt;td&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;c:forEach items="${employees}" var="employee"&gt;
			&lt;tr&gt;
			&lt;td&gt;${employee.name}&lt;/td&gt;
			&lt;td&gt;${employee.joiningDate}&lt;/td&gt;
			&lt;td&gt;${employee.salary}&lt;/td&gt;
			&lt;td&gt;&lt;a href="&lt;c:url value='/edit-${employee.ssn}-employee' /&gt;"&gt;${employee.ssn}&lt;/a&gt;&lt;/td&gt;
			&lt;td&gt;&lt;a href="&lt;c:url value='/delete-${employee.ssn}-employee' /&gt;"&gt;delete&lt;/a&gt;&lt;/td&gt;
			&lt;/tr&gt;
		&lt;/c:forEach&gt;
	&lt;/table&gt;
	&lt;br/&gt;
	&lt;a href="&lt;c:url value='/new' /&gt;"&gt;Add New Employee&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> WEB-INF/views/registration.jsp&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">[注册页面用来创建和保存在数据库中的新员工]</span> </p> 
  <pre>&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%&gt;
&lt;%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;

&lt;html&gt;

&lt;head&gt;
	&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
	&lt;title&gt;Employee Registration Form&lt;/title&gt;

&lt;style&gt;

	.error {
		color: #ff0000;
	}
&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

	&lt;h2&gt;Registration Form&lt;/h2&gt;
 
	&lt;form:form method="POST" modelAttribute="employee"&gt;
		&lt;form:input type="hidden" path="id" id="id"/&gt;
		&lt;table&gt;
			&lt;tr&gt;
				&lt;td&gt;&lt;label for="name"&gt;Name: &lt;/label&gt; &lt;/td&gt;
				&lt;td&gt;&lt;form:input path="name" id="name"/&gt;&lt;/td&gt;
				&lt;td&gt;&lt;form:errors path="name" cssClass="error"/&gt;&lt;/td&gt;
		    &lt;/tr&gt;
	    
			&lt;tr&gt;
				&lt;td&gt;&lt;label for="joiningDate"&gt;Joining Date: &lt;/label&gt; &lt;/td&gt;
				&lt;td&gt;&lt;form:input path="joiningDate" id="joiningDate"/&gt;&lt;/td&gt;
				&lt;td&gt;&lt;form:errors path="joiningDate" cssClass="error"/&gt;&lt;/td&gt;
		    &lt;/tr&gt;
	
			&lt;tr&gt;
				&lt;td&gt;&lt;label for="salary"&gt;Salary: &lt;/label&gt; &lt;/td&gt;
				&lt;td&gt;&lt;form:input path="salary" id="salary"/&gt;&lt;/td&gt;
				&lt;td&gt;&lt;form:errors path="salary" cssClass="error"/&gt;&lt;/td&gt;
		    &lt;/tr&gt;
	
			&lt;tr&gt;
				&lt;td&gt;&lt;label for="ssn"&gt;SSN: &lt;/label&gt; &lt;/td&gt;
				&lt;td&gt;&lt;form:input path="ssn" id="ssn"/&gt;&lt;/td&gt;
				&lt;td&gt;&lt;form:errors path="ssn" cssClass="error"/&gt;&lt;/td&gt;
		    &lt;/tr&gt;
	
			&lt;tr&gt;
				&lt;td colspan="3"&gt;
					&lt;c:choose&gt;
						&lt;c:when test="${edit}"&gt;
							&lt;input type="submit" value="Update"/&gt;
						&lt;/c:when&gt;
						&lt;c:otherwise&gt;
							&lt;input type="submit" value="Register"/&gt;
						&lt;/c:otherwise&gt;
					&lt;/c:choose&gt;
				&lt;/td&gt;
			&lt;/tr&gt;
		&lt;/table&gt;
	&lt;/form:form&gt;
	&lt;br/&gt;
	&lt;br/&gt;
	Go back to &lt;a href="&lt;c:url value='/list' /&gt;"&gt;List of All Employees&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;</pre> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> WEB-INF/views/success.jsp&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">[包括成功页面新员工创建一个确认，并链接回员工列表]</span> </p> 
  <pre>&lt;%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="utf-8"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;title&gt;Registration Confirmation Page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	message : ${success}
	&lt;br/&gt;
	&lt;br/&gt;
	Go back to &lt;a href="&lt;c:url value='/list' /&gt;"&gt;List of All Employees&lt;/a&gt;
	
&lt;/body&gt;

&lt;/html&gt;</pre> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第11步：在数据库创建模式 
   </div> </h4> 
  <pre>CREATE TABLE EMPLOYEE(
	id INT NOT NULL auto_increment, 
	name VARCHAR(50) NOT NULL,
	joining_date DATE NOT NULL,
	salary DOUBLE NOT NULL,
	ssn VARCHAR(30) NOT NULL UNIQUE,
	PRIMARY KEY (id)
);</pre> 
  <h4 style="color:#404040;font-size:18px;background-color:#FFFFFF;"> 
   <div style="background-color:inherit;">
     第12步：构建，部署和运行应用程序 
   </div> </h4> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">现在构建(参考提到的前面Eclipse教程)或通过Maven的命令行</span>(&nbsp;mvn clean install).&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">部署War到Servlet3.0容器。</span> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">打开浏览器，浏览：</span>&nbsp;<a target="_blank" href="http://localhost:8080/SpringHibernateExample/">http://localhost:8080/SpringHibernateExample/</a> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-160116091940640.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    现在，点击“Add&nbsp;New&nbsp;Employee”，并点击注册按钮但不填写任何信息： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-1601160919561c.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    现在填写详细信息 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-16011609213NV.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    点击注册(Register)，应该得到类似的东西： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-160116092203H6.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    点击列表，进入列表： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-16011609221R55.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    现在添加几个记录和以前一样： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-16011609223E01.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    现在点击第二记录的删除链接，它应该被删除了，如下图： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-160116092259591.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    现在点击SSN链接(这是一个更新)，第二要记录要更新： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-1601160923152Y.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    现在，编辑一些字段，此外SSN值更改为现有的记录中的值： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-160116092331M1.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    尝试更新，你应该得到验证错误的SSN： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-160116092351509.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    修正了错误，通过改变SSN以唯一值更新，然后查看记录的完整列表，看到更新有了变化(这里修改SSN为：123456)： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-16011609240I35.png" alt=""> </p> 
  <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;">
    最后，查看数据库在这时是： 
  </div> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> <img src="/uploads/tutorial/20160116/1-1601160924233B.png" alt=""> </p> 
  <p style="color:#404040;font-size:15px;background-color:#FFFFFF;"> 到这里，整个教程完成，包教不包会！ </p> 
 </div> 
 <div>
   下载代码：
  <a target="_blank" href="http://pan.baidu.com/s/1i4b87Gh">http://pan.baidu.com/s/1i4b87Gh</a> 
 </div>
 <br>      
</div></body></html>