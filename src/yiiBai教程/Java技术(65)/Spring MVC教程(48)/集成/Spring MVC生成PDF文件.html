<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring MVC生成PDF文件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>以下示例演示如何使用Spring Web MVC框架生成PDF格式的文件。首先使用Eclipse IDE，并按照以下步骤使用<strong>Spring Web Framework</strong>开发基于动态表单的Web应用程序：</p> 
 <ol> 
  <li>创建一个名称为 <strong>GeneratePdf</strong> 的动态WEB项目。</li>
  <li>在 <code>com.yiibai.springmvc</code> 包下创建三个Java类：<code>UserPDFView</code> 和 <code>PDFController</code>。</li>
  <li>从<a target="_blank" href="http://www.yiibai.com/maven/" title="maven">maven</a>存储库页面下载Apache iText库：<a target="_blank" href="http://mvnrepository.com/artifact/com.lowagie/itext/2.1.7" title="Apache iText">Apache iText</a>。 把它放在<code>CLASSPATH</code>中。</li>
  <li>最后一步是创建所有源和配置文件的内容并运行应用程序，详细如下所述。</li>
 </ol> 
 <p>完整的项目文件目录结构如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/2201/880170142_88052.png" alt=""></p> 
 <p><strong>PDFController.java</strong> 的代码如下所示 -</p> 
 <pre><code class="lang-java">package com.yiibai.springmvc;
import java.util.HashMap;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.AbstractController;

public class PDFController extends AbstractController {

   @Override
   protected ModelAndView handleRequestInternal(HttpServletRequest request,
      HttpServletResponse response) throws Exception {
      //user data
      Map&lt;String,String&gt; userData = new HashMap&lt;String,String&gt;();
      userData.put("100", "Xiao.Lu");
      userData.put("102", "User 102");
      userData.put("301", "User 301");
      userData.put("400", "User 400");
      return new ModelAndView("UserSummary","userData",userData);
   }
}
</code></pre> 
 <p><strong>UserPDFView.java</strong> 的代码如下所示 -</p> 
 <pre><code class="lang-java">package com.yiibai.springmvc;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.web.servlet.view.document.AbstractPdfView;

import com.lowagie.text.Document;
import com.lowagie.text.Table;
import com.lowagie.text.pdf.PdfWriter;

public class UserPDFView extends AbstractPdfView {

   protected void buildPdfDocument(Map&lt;String, Object&gt; model, Document document,
      PdfWriter pdfWriter, HttpServletRequest request, HttpServletResponse response)
      throws Exception {
      Map&lt;String,String&gt; userData = (Map&lt;String,String&gt;) model.get("userData");

      Table table = new Table(2);
      table.addCell("No.");
      table.addCell("User Name");

      for (Map.Entry&lt;String, String&gt; entry : userData.entrySet()) {
         table.addCell(entry.getKey());
         table.addCell(entry.getValue());
      }
      document.add(table);
   }
}
</code></pre> 
 <p><strong>GeneratePdf-servlet.xml</strong> 配置如下所示 - </p> 
 <pre><code class="lang-xml">&lt;beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:context="http://www.springframework.org/schema/context"   
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:mvc="http://www.springframework.org/schema/mvc"
   xsi:schemaLocation="
   http://www.springframework.org/schema/beans     
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context 
   http://www.springframework.org/schema/context/spring-context-3.0.xsd
   http://www.springframework.org/schema/mvc
   http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd"&gt;
   &lt;bean
      class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping" /&gt;

   &lt;bean class="com.yiibai.springmvc.PDFController" /&gt;

   &lt;bean class="org.springframework.web.servlet.view.XmlViewResolver"&gt;
      &lt;property name="location"&gt;
         &lt;value&gt;/WEB-INF/views.xml&lt;/value&gt;
      &lt;/property&gt;
   &lt;/bean&gt;
&lt;/beans&gt;
</code></pre> 
 <p><strong>views.xml</strong> 文件中的配置如下所示 - </p>   
 <pre><code class="lang-xml">&lt;beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="
   http://www.springframework.org/schema/beans     
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context 
   http://www.springframework.org/schema/context/spring-context-3.0.xsd"&gt;

   &lt;bean id="UserSummary" class="com.yiibai.springmvc.UserPDFView"&gt;&lt;/bean&gt;
&lt;/beans&gt;
</code></pre> 
 <p>在上面的代码中，创建了一个<code>PDFController</code>和<code>UserPDFView</code>类。<code>iText</code>库是用来处理PDF文件格式，并将数据转换为<code>PDF</code>文档。</p> 
 <p>完成创建源和配置文件后，发布应用程序到Tomcat服务器。</p> 
 <p>现在启动Tomcat服务器，当访问URL =&gt; <a target="_blank" href="http://localhost:8080/GeneratePdf/pdf">http://localhost:8080/GeneratePdf/pdf</a> ， 如果<strong>Spring Web</strong>应用程序没有问题，应该看到以下结果：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/2201/417170151_48366.png" alt=""></p>
 <br>      
</div></body></html>