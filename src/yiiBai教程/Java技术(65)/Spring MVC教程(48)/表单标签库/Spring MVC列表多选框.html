<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring MVC列表多选框</h1><div style="width:100%;float:left;" class="article-content">   
 <p>以下示例显示如何在使用<strong>Spring Web MVC</strong>框架的表单中使用列表框(Listbox)。首先使用Eclipse IDE来创建一个WEB工程，实现一个让用户可选择自己所善长的技术(多选)的功能。并按照以下步骤使用<strong>Spring Web Framework</strong>开发基于动态表单的Web应用程序：</p> 
 <ol> 
  <li>创建一个名称为 <strong>Listbox</strong> 的动态WEB项目。</li>
  <li>在 <code>com.yiibai.springmvc</code> 包下创建两个Java类<code>User</code>，<code>UserController</code>。</li>
  <li>在<code>jsp</code>子文件夹下创建两个视图文件：<code>user.jsp</code>，<code>userlist.jsp</code>。</li>
  <li>最后一步是创建所有源和配置文件的内容并运行应用程序，详细如下所述。</li>
 </ol> 
 <p>完整的项目文件目录结构如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/1901/316160144_42682.png" alt=""></p> 
 <p><strong>User.java</strong> 的代码如下所示 -</p> 
 <pre><code class="lang-java">package com.yiibai.springmvc;
public class User {

       private String username;
       private String password;
       private String address;
       private boolean receivePaper;
       private String [] favoriteFrameworks;   
       private String gender;
       private String favoriteNumber;
       private String country;
       private String [] skills;

       public String getUsername() {
          return username;
       }
       public void setUsername(String username) {
          this.username = username;
       }

       public String getPassword() {
          return password;
       }
       public void setPassword(String password) {
          this.password = password;
       }
       public String getAddress() {
          return address;
       }
       public void setAddress(String address) {
          this.address = address;
       }
       public boolean isReceivePaper() {
          return receivePaper;
       }
       public void setReceivePaper(boolean receivePaper) {
          this.receivePaper = receivePaper;
       }
       public String[] getFavoriteFrameworks() {
          return favoriteFrameworks;
       }
       public void setFavoriteFrameworks(String[] favoriteFrameworks) {
          this.favoriteFrameworks = favoriteFrameworks;
       }
       public String getGender() {
          return gender;
       }
       public void setGender(String gender) {
          this.gender = gender;
       }
       public String getFavoriteNumber() {
          return favoriteNumber;
       }
       public void setFavoriteNumber(String favoriteNumber) {
          this.favoriteNumber = favoriteNumber;
       }
       public String getCountry() {
          return country;
       }
       public void setCountry(String country) {
          this.country = country;
       }
       public String[] getSkills() {
          return skills;
       }
       public void setSkills(String[] skills) {
          this.skills = skills;
       }
    }
</code></pre> 
 <p><strong>UserController.java</strong> 的代码如下所示 -</p> 
 <pre><code class="lang-java">package com.yiibai.springmvc;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.ui.ModelMap;

@Controller
public class UserController {

   @RequestMapping(value = "/user", method = RequestMethod.GET)
   public ModelAndView user() {
      User user = new User();      
      user.setFavoriteFrameworks((new String []{"Spring MVC","Struts 2"}));
      user.setGender("M");
      ModelAndView modelAndView = new ModelAndView("user", "command", user);
      return modelAndView;
   }

   @RequestMapping(value = "/addUser", method = RequestMethod.POST)
   public String addUser(@ModelAttribute("SpringWeb")User user, 
      ModelMap model) {
      model.addAttribute("username", user.getUsername());
      model.addAttribute("password", user.getPassword());
      model.addAttribute("address", user.getAddress());
      model.addAttribute("receivePaper", user.isReceivePaper());
      model.addAttribute("favoriteFrameworks", user.getFavoriteFrameworks());
      model.addAttribute("gender", user.getGender());
      model.addAttribute("favoriteNumber", user.getFavoriteNumber());
      model.addAttribute("country", user.getCountry());
      model.addAttribute("skills", user.getSkills());
      return "userlist";
   }

   @ModelAttribute("webFrameworkList")
   public List&lt;String&gt; getWebFrameworkList()
   {
      List&lt;String&gt; webFrameworkList = new ArrayList&lt;String&gt;();
      webFrameworkList.add("Spring MVC");
      webFrameworkList.add("Struts 1");
      webFrameworkList.add("Struts 2");
      webFrameworkList.add("Apache Hadoop");
      return webFrameworkList;
   }

   @ModelAttribute("numbersList")
   public List&lt;String&gt; getNumbersList()
   {
      List&lt;String&gt; numbersList = new ArrayList&lt;String&gt;();
      numbersList.add("1");
      numbersList.add("2");
      numbersList.add("3");
      numbersList.add("4");
      return numbersList;
   }

   @ModelAttribute("countryList")
   public Map&lt;String, String&gt; getCountryList()
   {
      Map&lt;String, String&gt; countryList = new HashMap&lt;String, String&gt;();
      countryList.put("US", "United States");
      countryList.put("CH", "China");
      countryList.put("SG", "Singapore");
      countryList.put("MY", "Malaysia");
      return countryList;
   }

   @ModelAttribute("skillsList")
   public Map&lt;String, String&gt; getSkillsList()
   {
      Map&lt;String, String&gt; skillList = new HashMap&lt;String, String&gt;();
      skillList.put("Hibernate", "Hibernate");
      skillList.put("Spring", "Spring");
      skillList.put("Apache Hadoop", "Apache Hadoop");
      skillList.put("Struts", "Struts");
      return skillList;
   }
}
</code></pre> 
 <p>这里的第一个服务方法<code>user()</code>，我们已经在<code>ModelAndView</code>对象中传递了一个名称为“<code>command</code>”的空<code>User</code>对象，因为如果在JSP文件中使用<code>&lt;form:form&gt;</code>标签，<strong>spring</strong>框架需要一个名称为“<code>command</code>”的对象。 所以当调用<code>user()</code>方法时，它返回<code>user.jsp</code>视图。</p> 
 <p>第二个服务方法<code>addUser()</code>将根据URL =&gt; <code>Listbox/addUser</code> 上的POST方法请求时调用。根据提交的信息准备模型对象。 最后从服务方法返回“<code>userlist</code>”视图，这将呈现<code>userlist.jsp</code>视图。</p> 
 <p><strong>user.jsp</strong> 的代码如下所示 -</p> 
 <pre><code class="lang-html">&lt;%@ page contentType="text/html; charset=UTF-8"%&gt;

&lt;%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Spring MVC表单处理(列表框)&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h2&gt;用户信息&lt;/h2&gt;
    &lt;form:form method="POST" action="/Listbox/addUser"&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="username"&gt;用户名：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:input path="username" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="password"&gt;密码：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:password path="password" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="address"&gt;地址：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:textarea path="address" rows="5" cols="30" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="receivePaper"&gt;是否订阅：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:checkbox path="receivePaper" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="favoriteFrameworks"&gt;喜欢的框架/技术：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:checkboxes items="${webFrameworkList}"
                        path="favoriteFrameworks" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="gender"&gt;性别：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:radiobutton path="gender" value="M" label="男" /&gt; &lt;form:radiobutton
                        path="gender" value="F" label="女" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="favoriteNumber"&gt;喜欢的数字：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:radiobuttons path="favoriteNumber"
                        items="${numbersList}" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;form:label path="country"&gt;所在国家：&lt;/form:label&gt;&lt;/td&gt;
                &lt;td&gt;&lt;form:select path="country"&gt;
                        &lt;form:option value="NONE" label="请选择..." /&gt;
                        &lt;form:options items="${countryList}" /&gt;
                    &lt;/form:select&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
            &lt;td&gt;&lt;form:label path="skills"&gt;技术：&lt;/form:label&gt;&lt;/td&gt;
            &lt;td&gt;&lt;form:select path="skills" items="${skillsList}"
                    multiple="true" /&gt;&lt;/td&gt;
        &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td colspan="2"&gt;&lt;input type="submit" value="提交" /&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/form:form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>这里使用<code>&lt;form:select /&gt;</code> 及其属性 <code>multiple=true</code>标签来呈现HTML列表多选框。 例如 - </p>   
 <pre><code class="lang-html">&lt;form:select path="skills" items="${skillsList}" multiple="true" /&gt;
</code></pre> 
 <p>它将呈现以下HTML内容。</p> 
 <pre><code class="lang-html">&lt;select id="skills" name="skills" multiple="multiple"&gt;
   &lt;option value="Struts"&gt;Struts&lt;/option&gt;
   &lt;option value="Hibernate"&gt;Hibernate&lt;/option&gt;
   &lt;option value="Apache Wicket"&gt;Apache Hadoop&lt;/option&gt;
   &lt;option value="Spring"&gt;Spring&lt;/option&gt;
&lt;/select&gt;
&lt;input type="hidden" name="_skills" value="1"/&gt;
</code></pre> 
 <p><strong>userlist.jsp</strong> 的代码如下所示 -</p> 
 <pre><code class="lang-html">&lt;%@ page contentType="text/html; charset=UTF-8"%&gt;
&lt;%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Spring MVC表单处理(列表框)&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h2&gt;提交用户信息 -&lt;/h2&gt;
    &lt;table&gt;
        &lt;tr&gt;
            &lt;td&gt;用户名：&lt;/td&gt;
            &lt;td&gt;${username}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;密码：&lt;/td&gt;
            &lt;td&gt;${password}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;地址：&lt;/td&gt;
            &lt;td&gt;${address}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;是否订阅：&lt;/td&gt;
            &lt;td&gt;${receivePaper}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;喜欢的技术/框架：&lt;/td&gt;
            &lt;td&gt;
                &lt;%
                    String[] favoriteFrameworks = (String[]) request.getAttribute("favoriteFrameworks");
                    for (String framework : favoriteFrameworks) {
                        out.println(framework);
                    }
                %&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;性别：&lt;/td&gt;
            &lt;td&gt;${(gender=="M"? "男" : "女")}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;喜欢的数字：&lt;/td&gt;
            &lt;td&gt;${favoriteNumber}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;国家：&lt;/td&gt;
            &lt;td&gt;${country}&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
                &lt;td&gt;技术：&lt;/td&gt;
                &lt;td&gt;
                    &lt;%
                        String[] skills = (String[]) request.getAttribute("skills");
                            for (String skill : skills) {
                                out.println(skill);
                            }
                    %&gt;
                &lt;/td&gt;
            &lt;/tr&gt;

    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>完成创建源和配置文件后，发布应用程序到Tomcat服务器。</p> 
 <p>现在启动Tomcat服务器，现在尝试访问URL =&gt; <a target="_blank" href="http://localhost:8080/Listbox/user">http://localhost:8080/Listbox/user</a> ，如果<strong>Spring Web</strong>应用程序没有问题，应该看到以下结果：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/1901/383160134_53888.png" alt=""></p> 
 <p>提交所需信息后，点击提交按钮提交表单。 如果<strong>Spring Web</strong>应用程序没有问题，应该看到以下结果：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201701/1901/234160135_36211.png" alt=""></p>
 <br>      
</div></body></html>