<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java NIO通道之间的数据传输</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在Java NIO中，可以非常频繁地将数据从一个通道传输到另一个通道。批量传输文件数据是非常普遍的，因为几个优化方法已经添加到<code>FileChannel</code>类中，使其更有效率。</p> 
 <p>通道之间的数据传输在<code>FileChannel</code>类中的两种方法是：</p> 
 <ul> 
  <li><code>FileChannel.transferTo()</code>方法</li>
  <li><code>FileChannel.transferFrom()</code>方法</li>
 </ul> 
 <p><strong>FileChannel.transferTo()方法</strong></p> 
 <p><code>transferTo()</code>方法用来从<code>FileChannel</code>到其他通道的数据传输。</p> 
 <p>下面来看一下<code>transferTo()</code>方法的例子：</p> 
 <pre><code class="lang-java">public abstract class Channel extends AbstractChannel  
{    
   public abstract long transferTo (long position, long count, WritableByteChannel target);  
}
</code></pre> 
 <p><strong>FileChannel.transferFrom()方法</strong></p> 
 <p><code>transferFrom()</code>方法允许从源通道到<code>FileChannel</code>的数据传输。</p> 
 <p>下面来看看<code>transferFrom()</code>方法的例子：</p> 
 <pre><code class="lang-java">public abstract class Channel extends AbstractChannel  
{    
    public abstract long transferFrom (ReadableByteChannel src, long position, long count);  
}
</code></pre> 
 <p><strong>基本通道到通道数据传输示例</strong></p> 
 <p>下面来看看从<code>4</code>个不同文件读取文件内容的简单示例，并将它们的组合输出写入第五个文件：</p> 
 <pre><code class="lang-java">package com.yiibai;

import java.io.File;
import java.io.FileOutputStream;
import java.io.FileInputStream;
import java.nio.channels.WritableByteChannel;
import java.nio.channels.FileChannel;

public class TransferDemo {
    public static void main(String[] argv) throws Exception {
        String relativelyPath = System.getProperty("user.dir");
        // Path of Input files
        String[] iF = new String[] { relativelyPath + "/input1.txt", relativelyPath + "/input2.txt",
                relativelyPath + "/input3.txt", relativelyPath + "/input4.txt" };
        // Path of Output file and contents will be written in this file
        String oF = relativelyPath + "/combine_output.txt";
        // Acquired the channel for output file
        FileOutputStream output = new FileOutputStream(new File(oF));
        WritableByteChannel targetChannel = output.getChannel();
        for (int j = 0; j &lt; iF.length; j++) {
            // Get the channel for input files
            FileInputStream input = new FileInputStream(iF[j]);
            FileChannel inputChannel = input.getChannel();

            // The data is tranfer from input channel to output channel
            inputChannel.transferTo(0, inputChannel.size(), targetChannel);

            // close an input channel
            inputChannel.close();
            input.close();
        }
        // close the target channel
        targetChannel.close();
        output.close();
        System.out.println("All jobs done...");
    }
}
</code></pre> 
 <p>在上述程序中，将<code>4</code>个不同的文件(即<code>input1.txt</code>，<code>input2.txt</code>，<code>input3.txt</code>和<code>input4.txt</code>)的内容读取并将其组合的输出写入第五个文件，即：<code>combine_output.txt</code>文件的中。<code>combine_output.txt</code>文件的内容如下 - </p>   
 <pre><code class="lang-shell">this is content from input1.txt
this is content from input2.txt
this is content from input3.txt
this is content from input4.txt
</code></pre>
 <br>      
</div></body></html>