<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java NIO ServerSocketChannel</h1><div style="width:100%;float:left;" class="article-content">   
 <p>Java NIO <code>ServerSocketChannel</code>还可以用来将通道与TCP(传输控制协议)网络套接字连接起来。它相当于网络编程中使用的Java网络套接字。<code>ServerSocketChannel</code>类位于<code>java.nio.channels</code>包中。</p> 
 <p>下面我们来看看<code>ServerSocketChannel</code>的例子：</p> 
 <pre><code class="lang-java">ServerSocketChannel ssc = ServerSocketChannel.open();  
ssc.socket().bind(new InetSocketAddress(8085));  
while(true){  
    SocketChannel socketChannel = ssc.accept();  
}
</code></pre> 
 <p><strong>关闭ServerSocketChannel</strong></p> 
 <p>通过调用<code>ServerSocketChannel.close()</code>方法执行所有操作后，可以关闭<code>ServerSocketChannel</code>。</p> 
 <p>下面是关闭<code>ServerSocketChannel</code>的语法是：</p> 
 <pre><code class="lang-java">ServerSocketChannel.close();
</code></pre> 
 <p><strong>打开ServerSocketChannel</strong></p> 
 <p>要打开<code>ServerSocketChannel</code>，可通过调用<code>ServerSocketChannel.open()</code>方法打开一个<code>ServerSocketChannel</code>。</p> 
 <p>用于打开<code>ServerSocketChannel</code>的语法是：</p> 
 <pre><code class="lang-java">ServerSocketChannel sc = ServerSocketChannel.open();  
sc.connect(new InetSocketAddress("localhost", 9099));
</code></pre> 
 <p><strong>监听连接</strong></p> 
 <p>监听客户商连接，可通过调用<code>ServerSocketChannel.accept()</code>方法完成。<code>accept()</code>方法用于返回带有传入连接的<code>SocketChannel</code>。</p> 
 <p>下面是监听连接的例子：</p> 
 <pre><code class="lang-java">while(true){  
    SocketChannel sc = serverSocketChannel.accept();  
}
</code></pre> 
 <p>在<code>while</code>循环中调用<code>accept()</code>方法，因为这里要监听所有传入的连接。</p> 
 <p><strong>从ServerSocketChannel读取数据</strong></p> 
 <p>要从<code>ServerSocketChannel</code>读取数据，可调用<code>read()</code>方法之一。</p> 
 <p>下面是从<code>ServerSocketChannel</code>读取数据的例子：</p>   
 <pre><code class="lang-java">ByteBuffer bb = ByteBuffer.allocate(84);  
int bytesRead = ServerSocketChannel.read(bb);
</code></pre> 
 <p>首先分配缓冲区。从<code>ServerSocketChannel</code>读取的数据存储在缓冲区中。</p> 
 <p>其次，调用<code>ServerSocketChannel.read()</code>方法，并将数据从<code>ServerSocketChannel</code>读入缓冲区。<code>read()</code>方法的整数值返回写入缓冲区的字节数。</p> 
 <p><strong>将数据写入ServerSocketChannel</strong></p> 
 <p>要将数据写入<code>ServerSocketChannel</code>，可使用<code>ServerSocketChannel.write()</code>方法，它将缓冲区(<code>buffer</code>)作为参数。</p> 
 <p>下面是将数据写入<code>ServerSocketChannel</code>的例子：</p> 
 <pre><code class="lang-java">String newData = "The new String is writing in a file ..." + System.currentTimeMillis();  
ByteBuffer bb= ByteBuffer.allocate(48);  
bb.clear();  
bb.put(newData.getBytes());  
bb.flip();  
while(bb.hasRemaining()) {  
    ServerSocketChannel.write(bb);  
}
</code></pre> 
 <p><code>ServerSocketChannel.write()</code>方法在<code>while</code>循环中使用，因为<code>write()</code>方法写入<code>ServerSocketChannel</code>的字节数目是未知的，因此需要重复使用<code>write()</code>方法，直到<code>Buffer</code>不再有可用的字节。</p>
 <br>      
</div></body></html>