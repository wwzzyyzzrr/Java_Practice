<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java NIO SocketChannel</h1><div style="width:100%;float:left;" class="article-content">   
 <p>Java NIO <code>SocketChannel</code>用于将通道与TCP(传输控制协议)网络套接字连接。它相当于网络编程中使用的Java网络套接字(<code>Socket</code>)。</p> 
 <p>Java NIO中有两种可用于创建<code>SocketChannel</code>的方法：</p> 
 <ul> 
  <li>当传入连接到达<code>ServerSocketChannel</code>时，可以创建它。</li>
  <li>打开一个<code>SocketChannel</code>，并在网络上与服务器连接。</li>
 </ul> 
 <p>我们来看看使用选择器的SocketChannel客户端 - 服务器通信的框图：</p> 
 <p><strong>打开套接字通道 - SocketChannel</strong></p> 
 <p>可以通过调用<code>SocketChannel.Open()</code>方法打开一个<code>SocketChannel</code>。</p> 
 <p>打开套接字通道(<code>SocketChannel</code>)的语法是：</p> 
 <pre><code class="lang-java">SocketChannel sc = SocketChannel.open();  
sc.connect(new InetSocketAddress("localhost", 9099));
</code></pre> 
 <p><strong>关闭套接字通道 - SocketChannel</strong></p> 
 <p>通过调用<code>SocketChannel.close()</code>方法执行所有操作后，可以关闭<code>SocketChannel</code>。</p> 
 <p>关闭套接字通道(<code>SocketChannel</code>)的语法是：</p> 
 <pre><code class="lang-java">SocketChannel.close();
</code></pre> 
 <p><strong>从SocketChannel读取</strong></p> 
 <p>要从<code>SocketChannel</code>读取数据，调用<code>read()</code>方法之一。</p> 
 <p>下面来看如何从<code>SocketChannel</code>读取数据的例子：</p> 
 <pre><code class="lang-java">ByteBuffer bb = ByteBuffer.allocate(84);  
int bytesRead = SocketChannel.read(bb);
</code></pre> 
 <p>首先分配缓冲区。 从<code>SocketChannel</code>读取的数据存储在缓冲区中。</p> 
 <p>其次，调用<code>SocketChannel.read()</code>方法，并将数据从<code>SocketChannel</code>读入缓冲区。 <code>read()</code>方法返回写入缓冲区字节数的整数值。</p> 
 <p><strong>写入套接字通道-SocketChannel</strong></p> 
 <p>要将数据写入<code>SocketChannel</code>，可使用<code>SocketChannel.write()</code>方法并将缓冲(<code>buffer</code>)作为参数。</p> 
 <p>下面来看看一下将数据写入<code>SocketChannel</code>的例子：</p>   
 <pre><code class="lang-java">String newData = "The new String is writing in a file ..." + System.currentTimeMillis();  
ByteBuffer bb= ByteBuffer.allocate(48);  
bb.clear();  
bb.put(newData.getBytes());  
bb.flip();  
while(bb.hasRemaining()) {  
    SocketChannel.write(bb);  
}
</code></pre> 
 <p><code>SocketChannel.write()</code>方法在<code>while</code>循环中使用，因为<code>write()</code>方法写入<code>SocketChannel</code>的字节数目是未知的，因此需要重复使用<code>write()</code>方法，直到<code>Buffer</code>没有可用的字节写入。</p>
 <br>      
</div></body></html>