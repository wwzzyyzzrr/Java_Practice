<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">使用“mvn site-deploy”部署站点（WebDAV例子）</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 这里有一个指南，向您展示如何使用“mvn site:deploy”来自动部署生成的文档站点到服务器，这里通过WebDAV机制说明。 </p> 
 <p> P.S 在这篇文章中，我们使用的是Apache服务器2.x的WebDAV功能。 </p> 
 <h2> 1. 启用 WebDAV </h2> 
 <p> 请参见本指南，了解&nbsp;<a target="_blank" href="http://www.yiibai.com/article/enable-webdav-in-apache-server-2-2-x-windows.html">如何启用WebDAV访问Apache 2.x服务器</a>。 </p> 
 <h2> 2. 配置在何处部署 </h2> 
 <p> 在 pom.xml 中，配置在 “distributionManagement” 标签部署你的网站。 </p> 
 <pre>&lt;distributionManagement&gt;
    &lt;site&gt;
      &lt;id&gt;yiibaiserver&lt;/id&gt;
      &lt;url&gt;dav:http://127.0.0.1/sites/&lt;/url&gt;
    &lt;/site&gt;
&lt;/distributionManagement&gt;</pre> 
 <div style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#E6E6FC;"> 
  <strong>注</strong>
  <br> “dav”前缀是HTTP协议之前添加的，这意味着通过WebDAV机制部署您的网站。或者，可以用“scp”取代它，如果您的服务器支持“scp”访问。 
 </div> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> 告诉Maven来使用“wagon-webdav-jackrabbit”扩展部署。 </p> 
 <pre>&lt;build&gt;
	&lt;extensions&gt;
		&lt;extension&gt;
			&lt;groupId&gt;org.apache.maven.wagon&lt;/groupId&gt;
			&lt;artifactId&gt;wagon-webdav-jackrabbit&lt;/artifactId&gt;
			&lt;version&gt;1.0-beta-7&lt;/version&gt;
		&lt;/extension&gt;
	&lt;/extensions&gt;
&lt;/build&gt;</pre> 
 <div style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#F7F7DA;"> 
  <strong>wagon-webdav</strong>
  <br> 一些人说可以使用“wagon-webdav”，但这不是我试了不能正常工作，所以这里用“wagon-webdav-jackrabbit”代替。
  <br> 
  <pre>&lt;extension&gt;
            &lt;groupId&gt;org.apache.maven.wagon&lt;/groupId&gt;
            &lt;artifactId&gt;wagon-webdav&lt;/artifactId&gt;
            &lt;version&gt;1.0-beta-2&lt;/version&gt;
&lt;/extension&gt;</pre> 
 </div> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <em>&nbsp;pom.xml 整个文件内容：</em> </p> 
 <pre>&lt;project xmlns="http://maven.apache.org/POM/4.0.0" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
  http://maven.apache.org/maven-v4_0_0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.yiibai.core&lt;/groupId&gt;
  &lt;artifactId&gt;yiibai-core&lt;/artifactId&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;
  &lt;version&gt;1&lt;/version&gt;
  &lt;name&gt;yiibai-core&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
  &lt;build&gt;
	&lt;extensions&gt;
		&lt;extension&gt;
			&lt;groupId&gt;org.apache.maven.wagon&lt;/groupId&gt;
			&lt;artifactId&gt;wagon-webdav-jackrabbit&lt;/artifactId&gt;
			&lt;version&gt;1.0-beta-7&lt;/version&gt;
		&lt;/extension&gt;
	&lt;/extensions&gt;
  &lt;/build&gt;
  &lt;distributionManagement&gt;
    &lt;site&gt;
      &lt;id&gt;yiibaiserver&lt;/id&gt;
      &lt;url&gt;dav:http://127.0.0.1/sites/&lt;/url&gt;
    &lt;/site&gt;
  &lt;/distributionManagement&gt;
&lt;/project&gt;</pre> 
 <h2 style="color:#333333;font-family:'Helvetica Neue', Helvetica,  font-size:24px;font-weight:500;background-color:#FFFFFF;"> 3. 配置WebDAV身份验证 </h2> 
 <p style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;"> <span style="background-color:inherit;">通常情况下，WebDAV是需要认证的访问。所以需要把相关的认证细节(用户名和密码)</span>%MAVEN_PATH%/conf/settings.xml<span style="background-color:inherit;">.</span> </p> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <em>File : settings.xml</em> </p> 
 <pre>&lt;servers&gt;
	&lt;server&gt;
		&lt;id&gt;yiibaiserver&lt;/id&gt;
		&lt;username&gt;admin&lt;/username&gt;
		&lt;password&gt;123456&lt;/password&gt;
	&lt;/server&gt;
&lt;/servers&gt;</pre> 
 <div style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#E6E6FC;"> 
  <strong>&nbsp;“yiibaiserver” 是什么 ?</strong>
  <br> 在Maven的“的settings.xml”文件服务器ID将在“的pom.xml”文件被网站引用。 
 </div> 
 <h2 style="color:#333333;font-family:'Helvetica Neue', Helvetica,  font-size:24px;font-weight:500;background-color:#FFFFFF;"> 4. mvn site:deploy </h2> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> “mvn site:deploy” 命令执行： </p> 
 <pre class="prettyprint">C:\worksp\yiibai-core&gt;mvn site:deploy
... ...
Transfer finished. 11622 bytes copied in 0.021 seconds
十一月 03, 2015 9:00:07 下午 org.apache.commons.httpclient.auth.AuthChallengePro
cessor selectAuthScheme
信息: digest authentication scheme selected
Uploading: .//project-info.html to http://127.0.0.1/sites/

##十一月 03, 2015 9:00:07 下午 org.apache.commons.httpclient.auth.AuthChallengeP
rocessor selectAuthScheme
信息: digest authentication scheme selected
##http://127.0.0.1/sites//./project-info.html - Status code: 201

Transfer finished. 11170 bytes copied in 0.035 seconds
十一月 03, 2015 9:00:07 下午 org.apache.commons.httpclient.auth.AuthChallengePro
cessor selectAuthScheme
信息: digest authentication scheme selected
Uploading: .//project-summary.html to http://127.0.0.1/sites/

##十一月 03, 2015 9:00:07 下午 org.apache.commons.httpclient.auth.AuthChallengeP
rocessor selectAuthScheme
信息: digest authentication scheme selected
##http://127.0.0.1/sites//./project-summary.html - Status code: 201

Transfer finished. 10190 bytes copied in 0.021 seconds
http://127.0.0.1/sites/ - Session: Disconnecting
http://127.0.0.1/sites/ - Session: Disconnected
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 28.737 s
[INFO] Finished at: 2015-11-03T21:00:07+08:00
[INFO] Final Memory: 14M/156M
[INFO] ------------------------------------------------------------------------</pre> 
 <p> 所有站点文件夹和文件，在项目文件夹- “target/site”会被自动部署到服务器。 </p> 
 <h2> 5. 输出 </h2> 
 <p> 在本例中，可以通过这个网址访问该部署的站点：<a target="_blank" href="http://127.0.0.1/sites/">http://127.0.0.1/sites/</a>，见下图： </p> 
 <p> <img src="/uploads/tutorial/20151103/1-151103210434Y7.png" alt=""> </p> 
 <div> 
  <img title="auto-deploy-site-maven" src="file://D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/6ae34c60015d4114a7e379ff2f02d3ca/y-site-maven.png" alt="auto deploy site with Maven" width="640" height="374" style="height:auto;"> 
 </div> 
 <p> 完成. </p> 
 <h2> 参考 </h2> 
 <ol> 
  <li> <a target="_blank" href="http://maven.apache.org/plugins/maven-site-plugin/usage.html">http://maven.apache.org/plugins/maven-site-plugin/usage.html</a> </li> 
  <li> <a target="_blank" href="http://mojo.codehaus.org/wagon-maven-plugin/usage.html">http://mojo.codehaus.org/wagon-maven-plugin/usage.html</a> </li> 
  <li> <a target="_blank" href="http://maven.apache.org/plugins/maven-site-plugin/deploy-mojo.html">http://maven.apache.org/plugins/maven-site-plugin/deploy-mojo.html</a> </li> 
  <li> <a target="_blank" href="http://maven.40175.n5.nabble.com/site-deploy-using-DAV-with-digest-auth-td125042.html">http://maven.40175.n5.nabble.com/site-deploy-using-DAV-with-digest-auth-td125042.html</a> </li> 
  <li> <a target="_blank" href="http://www.sonatype.com/books/maven-book/reference/site-generation-sect-deploy-site.html">http://www.sonatype.com/books/maven-book/reference/site-generation-sect-deploy-site.html</a> </li> 
 </ol>
 <br>      
</div></body></html>