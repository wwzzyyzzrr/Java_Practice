<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JPA继承-连接策略</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在连接策略中，为每个实体类生成一个单独的表。 每个表的属性都与主键连接。 它消除了字段字重复的可能性。</p> 
 <p>以下语法表示连接的策略: -</p> 
 <pre><code class="lang-java">@Inheritance(strategy=InheritanceType.JOINED)
</code></pre> 
 <h2 id="h2-u8FDEu63A5u7B56u7565u793Au4F8B"><a name="连接策略示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>连接策略示例</h2>
 <p>在这个例子中，我们将员工分为活跃员工和退休员工。</p> 
 <p>因此，子类<code>ActiveEmployees</code>和<code>RetiredEmployees</code>继承父类<code>Employee</code>的<code>e_id</code>和<code>e_name</code>字段。</p> 
 <p>现在，按照以下步骤创建JPA项目 - </p> 
 <p><strong>第1步:</strong> 在<code>com.yiibai.jpa.inheritence</code>包下创建一个根实体类<code>Employee.java</code>并指定所有必需的属性和注释。</p> 
 <p>文件:<em>Employee.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.inheritence;

import java.io.Serializable;

import javax.persistence.*;

@Entity
@Table(name = "employee_details")
@Inheritance(strategy=InheritanceType.JOINED) 
public class Employee implements Serializable {

    @Id
    private int e_id;
    private String e_name;

    public Employee(int e_id, String e_name) {
        super();
        this.e_id = e_id;
        this.e_name = e_name;
    }

    public Employee() {
        super();

    }

    public int getE_id() {
        return e_id;
    }

    public void setE_id(int e_id) {
        this.e_id = e_id;
    }

    public String getE_name() {
        return e_name;
    }

    public void setE_name(String e_name) {
        this.e_name = e_name;
    }

}
</code></pre> 
 <p><strong>第2步:</strong> 在<code>com.yiibai.jpa.inheritence</code>包下创建实体类<code>ActiveEmployee.java</code>(它是<code>Employee</code>类的子类)。</p> 
 <p>文件:<em>ActiveEmployee.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.inheritence;

import javax.persistence.*;

@Entity
public class ActiveEmployee extends Employee {

    private int e_salary;
    private int e_experience;

    public ActiveEmployee(int e_id, String e_name, int e_salary, int e_experience) {
        super(e_id, e_name);
        this.e_salary = e_salary;
        this.e_experience = e_experience;
    }

    public ActiveEmployee() {
        super();

    }

    public int getE_salary() {
        return e_salary;
    }

    public void setE_salary(int e_salary) {
        this.e_salary = e_salary;
    }

    public int getE_experience() {
        return e_experience;
    }

    public void setE_experience(int e_experience) {
        this.e_experience = e_experience;
    }

}
</code></pre> 
 <p><strong>第3步:</strong> 在<code>com.yiibai.jpa.inheritence</code>包下创建另一个实体类<code>RetiredEmployee.java</code>(它是<code>Employee.java</code>的子类)。</p> 
 <p>文件:<em>RetiredEmployee.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.inheritence;

import javax.persistence.*;

@Entity
public class RetiredEmployee extends Employee {

    private int e_pension;

    public RetiredEmployee(int e_id, String e_name, int e_pension) {
        super(e_id, e_name);
        this.e_pension = e_pension;
    }

    public RetiredEmployee() {
        super();

    }

    public int getE_pension() {
        return e_pension;
    }

    public void setE_pension(int e_pension) {
        this.e_pension = e_pension;
    }

}
</code></pre> 
 <p><strong>第4步:</strong> 将实体类和其他数据库配置映射到<code>Persistence.xml</code>文件中。<br><code>persistence.xml</code>中</p> 
 <p>文件:<em>persistence.xml</em> - </p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.1"
    xmlns="http://xmlns.jcp.org/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"&gt;
    &lt;persistence-unit name="Employee_details"&gt;
        &lt;class&gt;com.yiibai.jpa.inheritence.ActiveEmployee&lt;/class&gt;
        &lt;class&gt;com.yiibai.jpa.inheritence.RetiredEmployee&lt;/class&gt;
        &lt;class&gt;com.yiibai.jpa.inheritence.Employee&lt;/class&gt;
        &lt;properties&gt;
            &lt;property name="javax.persistence.jdbc.driver"
                value="com.mysql.jdbc.Driver" /&gt;
            &lt;property name="javax.persistence.jdbc.url"
                value="jdbc:mysql://localhost:3306/testdb?serverTimezone=UTC&amp;characterEncoding=utf8" /&gt;
            &lt;property name="javax.persistence.jdbc.user" value="root" /&gt;
            &lt;property name="javax.persistence.jdbc.password"
                value="123456" /&gt;
            &lt;property name="eclipselink.logging.level" value="SEVERE" /&gt;
            &lt;property name="eclipselink.ddl-generation"
                value="create-or-extend-tables" /&gt;
        &lt;/properties&gt;
    &lt;/persistence-unit&gt;

&lt;/persistence&gt;
</code></pre> 
 <p><strong>第5步:</strong>在<code>com.yiibai.jpa.persistence</code>包下创建持久性类<code>EmployeePersistence.java</code>。 这个类用于初始化一个对象并保存它。</p> 
 <p>文件: <em>EmployeePersistence.java</em> - </p>   
 <pre><code class="lang-java">package com.yiibai.jpa.persistence;

import javax.persistence.*;
import com.yiibai.jpa.inheritence.*;

public class EmployeePersistence {

    public static void main(String[] args) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("Employee_details");
        EntityManager em = emf.createEntityManager();

        em.getTransaction().begin();

        ActiveEmployee ae1 = new ActiveEmployee(101, "李小云", 10000, 5);
        ActiveEmployee ae2 = new ActiveEmployee(102, "张峰", 12000, 7);

        RetiredEmployee re1 = new RetiredEmployee(103, "王四哥", 5000);
        RetiredEmployee re2 = new RetiredEmployee(104, "叶问顶", 4000);

        em.persist(ae1);
        em.persist(ae2);

        em.persist(re1);
        em.persist(re2);

        em.getTransaction().commit();

        em.close();
        emf.close();

    }
}
</code></pre> 
 <p>执行程序后，在MySQL数据库中运行<code>select * from employee_details</code>查询，将会得到以下输出结果 -</p> 
 <pre><code class="lang-shell">mysql&gt; select * from employee_details;
+------+-----------------+--------+
| E_ID | DTYPE           | E_NAME |
+------+-----------------+--------+
|  101 | ActiveEmployee  | 李小云 |
|  102 | ActiveEmployee  | 张峰   |
|  104 | RetiredEmployee | 叶问顶 |
|  103 | RetiredEmployee | 王四哥 |
+------+-----------------+--------+
4 rows in set
</code></pre> 
 <p>查询<code>activeemployee</code>表，执行 <code>Select * from activeemployee</code> - </p> 
 <pre><code class="lang-sql">mysql&gt; Select * from activeemployee;
+------+--------------+----------+
| E_ID | E_EXPERIENCE | E_SALARY |
+------+--------------+----------+
|  101 |            5 |    10000 |
|  102 |            7 |    12000 |
+------+--------------+----------+
2 rows in set
</code></pre> 
 <p>查询<code>retired_employee</code>表，执行 <code>Select * from retired_employee</code> - </p> 
 <pre><code class="lang-sql">mysql&gt; Select * from retiredemployee;
+------+-----------+
| E_ID | E_PENSION |
+------+-----------+
|  104 |      4000 |
|  103 |      5000 |
+------+-----------+
2 rows in set
</code></pre>
 <br>      
</div></body></html>