<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JPA标准WHERE子句</h1><div style="width:100%;float:left;" class="article-content">   
 <p>WHERE子句用于对数据库应用条件并基于该条件获取数据。 在Criteria API中，AbstractQuery接口的<code>where(</code>)方法用于设置查询条件。</p> 
 <h2 id="h2--where-"><a name="标准WHERE示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>标准WHERE示例</h2>
 <p>在这里，我们将在<code>student</code>表上执行多个<code>WHERE</code>操作。假设该表包含以下记录 -</p> 
 <pre><code class="lang-sql">DROP TABLE IF EXISTS `student`;
CREATE TABLE `student` (
  `S_ID` int(11) NOT NULL,
  `S_NAME` varchar(255) DEFAULT NULL,
  `S_AGE` int(11) DEFAULT NULL,
  PRIMARY KEY (`S_ID`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of student
-- ----------------------------
INSERT INTO `student` VALUES ('101', 'Gaurav', '24');
INSERT INTO `student` VALUES ('102', 'Rahul', '22');
INSERT INTO `student` VALUES ('103', 'Chris', '20');
INSERT INTO `student` VALUES ('104', 'Ronit', '26');
INSERT INTO `student` VALUES ('105', 'Roy', '21');
</code></pre> 
 <p>现在，请按照以下步骤执行操作: - </p> 
 <p><strong>第1步:</strong> 创建一个实体类。在<code>com.yiibai.jpa</code>包下创建了<code>StudentEntity.java</code>类文件。 该类包含三个属性:<code>s_id</code>，<code>s_name</code>，<code>s_age</code>以及所有必需的注解。</p> 
 <p>文件:<em>StudentEntity.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa;

import javax.persistence.*;

@Entity
@Table(name = "student")
public class StudentEntity {

    @Id
    private int s_id;
    private String s_name;
    private int s_age;

    public StudentEntity(int s_id, String s_name, int s_age) {
        super();
        this.s_id = s_id;
        this.s_name = s_name;
        this.s_age = s_age;
    }

    public StudentEntity() {
        super();
    }

    public int getS_id() {
        return s_id;
    }

    public void setS_id(int s_id) {
        this.s_id = s_id;
    }

    public String getS_name() {
        return s_name;
    }

    public void setS_name(String s_name) {
        this.s_name = s_name;
    }

    public int getS_age() {
        return s_age;
    }

    public void setS_age(int s_age) {
        this.s_age = s_age;
    }

}
</code></pre> 
 <p><strong>第2步:</strong> 将实体类和其他数据库配置映射到 <em>persistence.xml</em> 文件中。</p> 
 <p>文件:<em>Persistence.xml</em> - </p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.1"
    xmlns="http://xmlns.jcp.org/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"&gt;
    &lt;persistence-unit name="Student_details"&gt;
        &lt;class&gt;com.yiibai.jpa.StudentEntity&lt;/class&gt;  
        &lt;properties&gt;
            &lt;property name="javax.persistence.jdbc.driver"
                value="com.mysql.jdbc.Driver" /&gt;
            &lt;property name="javax.persistence.jdbc.url"
                value="jdbc:mysql://localhost:3306/testdb?serverTimezone=UTC" /&gt;
            &lt;property name="javax.persistence.jdbc.user" value="root" /&gt;
            &lt;property name="javax.persistence.jdbc.password"
                value="123456" /&gt;
            &lt;property name="eclipselink.logging.level" value="SEVERE" /&gt;
            &lt;property name="eclipselink.ddl-generation"
                value="create-or-extend-tables" /&gt;
        &lt;/properties&gt;
    &lt;/persistence-unit&gt;

&lt;/persistence&gt;
</code></pre> 
 <p>这里，我们创建了基本实体类并将配置映射到<em>persistence.xml</em> 文件中，可以通过以下方式执行不同类型的<code>SELECT</code>排序操作 -</p> 
 <h3 id="h3-1-jpql-"><a name="1. JPQL大于和小于条件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. JPQL大于和小于条件</h3>
 <p>在这里，我们将通过一个简单的示例演示如何从数据库指定大于和小于条件查询获取符合条件的数据。</p> 
 <p>文件:<em>Comparison.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.jpql;

import com.yiibai.jpa.StudentEntity;
import javax.persistence.*;
import javax.persistence.criteria.*;

import java.util.*;

public class Comparison {

    public static void main(String args[]) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("Student_details");
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();

        CriteriaBuilder cb = em.getCriteriaBuilder();

        AbstractQuery&lt;StudentEntity&gt; cq1 = cb.createQuery(StudentEntity.class);
        AbstractQuery&lt;StudentEntity&gt; cq2 = cb.createQuery(StudentEntity.class);

        Root&lt;StudentEntity&gt; stud1 = cq1.from(StudentEntity.class);

        cq1.where(cb.greaterThan(stud1.get("s_age"), 22));

        CriteriaQuery&lt;StudentEntity&gt; select1 = ((CriteriaQuery&lt;StudentEntity&gt;) cq1).select(stud1);
        TypedQuery&lt;StudentEntity&gt; tq1 = em.createQuery(select1);
        List&lt;StudentEntity&gt; list1 = tq1.getResultList();

        System.out.println("Students having age greater than 22");

        System.out.print("s_id");
        System.out.print("\t s_name");
        System.out.println("\t s_age");

        for (StudentEntity s : list1) {
            System.out.print(s.getS_id());
            System.out.print("\t" + s.getS_name());
            System.out.println("\t" + s.getS_age());
        }

        Root&lt;StudentEntity&gt; stud2 = cq2.from(StudentEntity.class);

        cq2.where(cb.lessThan(stud2.get("s_age"), 22));

        CriteriaQuery&lt;StudentEntity&gt; select2 = ((CriteriaQuery&lt;StudentEntity&gt;) cq2).select(stud2);
        TypedQuery&lt;StudentEntity&gt; tq2 = em.createQuery(select2);
        List&lt;StudentEntity&gt; list2 = tq2.getResultList();

        System.out.println("Students having age Less than 22");

        System.out.print("s_id");
        System.out.print("\t s_name");
        System.out.println("\t s_age");

        for (StudentEntity s : list2) {
            System.out.print(s.getS_id());
            System.out.print("\t" + s.getS_name());
            System.out.println("\t" + s.getS_age());
        }

        em.getTransaction().commit();
        em.close();
        emf.close();
    }
}
</code></pre> 
 <p>执行上面代码，得到以下输出结果 - </p> 
 <pre><code class="lang-shell">Students having age greater than 22
s_id     s_name     s_age
101    Gaurav    24
104    Ronit    26
Students having age Less than 22
s_id     s_name     s_age
103    Chris    20
105    Roy    21
</code></pre> 
 <h3 id="h3-2-jpql-between-"><a name="2. JPQL Between条件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. JPQL Between条件</h3>
 <p>在这里，我们将通过一个简单的示例演示如何从数据库指定Between条件查询获取符合条件的数据。</p> 
 <p>文件:<strong>Between.java</strong> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.jpql;

import com.yiibai.jpa.StudentEntity;
import javax.persistence.*;
import javax.persistence.criteria.*;

import java.util.*;

public class Between {

    public static void main(String args[]) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("Student_details");
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();

        CriteriaBuilder cb = em.getCriteriaBuilder();

        AbstractQuery&lt;StudentEntity&gt; cq = cb.createQuery(StudentEntity.class);

        Root&lt;StudentEntity&gt; stud = cq.from(StudentEntity.class);

        cq.where(cb.between(stud.get("s_age"), 22, 26));
        CriteriaQuery&lt;StudentEntity&gt; select = ((CriteriaQuery&lt;StudentEntity&gt;) cq).select(stud);
        TypedQuery&lt;StudentEntity&gt; tq = em.createQuery(select);
        List&lt;StudentEntity&gt; list = tq.getResultList();

        System.out.println("Students having age between 22 and 26");

        System.out.print("s_id");
        System.out.print("\t s_name");
        System.out.println("\t s_age");

        for (StudentEntity s : list) {
            System.out.print(s.getS_id());
            System.out.print("\t" + s.getS_name());
            System.out.println("\t" + s.getS_age());
        }

        em.getTransaction().commit();
        em.close();
        emf.close();
    }
}
</code></pre> 
 <p>执行上面代码，得到以下输出结果 - </p>   
 <pre><code class="lang-shell">Students having age between 22 and 26
s_id     s_name     s_age
101    Gaurav    24
102    Rahul    22
104    Ronit    26
</code></pre> 
 <h3 id="h3-3-jpql-like-"><a name="3. JPQL Like条件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3. JPQL Like条件</h3>
 <p>在这里，我们将通过一个简单的示例演示如何从数据库指定Like条件查询获取符合条件的数据。</p> 
 <p>文件:<strong>Like.java</strong> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.jpql;

import com.yiibai.jpa.StudentEntity;
import javax.persistence.*;
import javax.persistence.criteria.*;

import java.util.*;

public class Like {

    public static void main(String args[]) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("Student_details");
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();

        CriteriaBuilder cb = em.getCriteriaBuilder();

        AbstractQuery&lt;StudentEntity&gt; cq = cb.createQuery(StudentEntity.class);

        Root&lt;StudentEntity&gt; stud = cq.from(StudentEntity.class);

        cq.where(cb.like(stud.get("s_name"), "R%"));
        CriteriaQuery&lt;StudentEntity&gt; select = ((CriteriaQuery&lt;StudentEntity&gt;) cq).select(stud);
        TypedQuery&lt;StudentEntity&gt; tq = em.createQuery(select);
        List&lt;StudentEntity&gt; list = tq.getResultList();

        System.out.println("Students name starting with R");

        System.out.print("s_id");
        System.out.print("\t s_name");
        System.out.println("\t s_age");

        for (StudentEntity s : list) {
            System.out.print(s.getS_id());
            System.out.print("\t" + s.getS_name());
            System.out.println("\t" + s.getS_age());
        }
        em.getTransaction().commit();
        em.close();
        emf.close();
    }
}
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">Students name starting with R
s_id     s_name     s_age
102    Rahul    22
104    Ronit    26
105    Roy    21
</code></pre> 
 <h3 id="h3-4-jpql-in-"><a name="4. JPQL In条件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>4. JPQL In条件</h3>
 <p>在这里，我们将通过一个简单的示例演示如何从数据库指定In条件查询获取符合条件的数据。</p> 
 <p>文件:<strong>Like.java</strong> - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.jpql;

import com.yiibai.jpa.StudentEntity;
import javax.persistence.*;
import javax.persistence.criteria.*;

import java.util.*;

public class In {

    public static void main(String args[]) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("Student_details");
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();

        CriteriaBuilder cb = em.getCriteriaBuilder();

        AbstractQuery&lt;StudentEntity&gt; cq = cb.createQuery(StudentEntity.class);

        Root&lt;StudentEntity&gt; stud = cq.from(StudentEntity.class);

        cq.where(cb.in(stud.get("s_age")).value(22).value(24));
        CriteriaQuery&lt;StudentEntity&gt; select = ((CriteriaQuery&lt;StudentEntity&gt;) cq).select(stud);
        TypedQuery&lt;StudentEntity&gt; tq = em.createQuery(select);
        List&lt;StudentEntity&gt; list = tq.getResultList();

        System.out.println("Students having age 22 and 24");

        System.out.print("s_id");
        System.out.print("\t s_name");
        System.out.println("\t s_age");

        for (StudentEntity s : list) {
            System.out.print(s.getS_id());
            System.out.print("\t" + s.getS_name());
            System.out.println("\t" + s.getS_age());
        }

        em.getTransaction().commit();
        em.close();
        emf.close();
    }
}
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">Students having age 22 and 24
s_id     s_name     s_age
101    Gaurav    24
102    Rahul    22
</code></pre>
 <br>      
</div></body></html>