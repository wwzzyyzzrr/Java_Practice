<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JPA插入实体</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在JPA中，我们可以通过实体轻松地将数据插入到数据库中。 <code>EntityManager</code>提供<code>persist()</code>方法来插入数据记录。</p> 
 <h2 id="h2-jpa-"><a name="JPA实体插入示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>JPA实体插入示例</h2>
 <p>在这里，我们将演示如何使用实现插入学生的记录。</p> 
 <p>创建一个JPA项目，其项目目录结构如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201806/0806/143120641_38714.png" alt=""></p> 
 <p>这个例子包含以下步骤 -</p> 
 <p><strong>第1步:</strong> 在<code>com.yiibai.jpa.student</code>包下创建一个名为StudentEntity.java的实体类，这个类包含以下几个属性:<code>s_id</code>，<code>s_name</code> 和 <code>s_age</code>。</p> 
 <p>文件:<em>StudentEntity.java</em> 的代码如下 - </p> 
 <pre><code class="lang-java">package com.yiibai.jpa.student;

import javax.persistence.*;

@Entity
@Table(name = "student")
public class StudentEntity {

    @Id
    private int s_id;
    private String s_name;
    private int s_age;

    public StudentEntity(int s_id, String s_name, int s_age) {
        super();
        this.s_id = s_id;
        this.s_name = s_name;
        this.s_age = s_age;
    }

    public StudentEntity() {
        super();
    }

    public int getS_id() {
        return s_id;
    }

    public void setS_id(int s_id) {
        this.s_id = s_id;
    }

    public String getS_name() {
        return s_name;
    }

    public void setS_name(String s_name) {
        this.s_name = s_name;
    }

    public int getS_age() {
        return s_age;
    }

    public void setS_age(int s_age) {
        this.s_age = s_age;
    }

}
</code></pre> 
 <p><strong>第2步:</strong> 现在，将实体类和其他数据库配置映射到<code>persistence.xml</code>文件中。</p> 
 <p>文件:<em>persistence.xml</em> 的内容如下 -</p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.1"
    xmlns="http://xmlns.jcp.org/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"&gt;
    &lt;persistence-unit name="Student_details"&gt;
        &lt;class&gt;com.yiibai.jpa.student.StudentEntity&lt;/class&gt;
        &lt;properties&gt;
            &lt;property name="javax.persistence.jdbc.driver"
                value="com.mysql.jdbc.Driver" /&gt;
            &lt;property name="javax.persistence.jdbc.url"
                value="jdbc:mysql://localhost:3306/testdb?serverTimezone=UTC" /&gt;
            &lt;property name="javax.persistence.jdbc.user" value="root" /&gt;
            &lt;property name="javax.persistence.jdbc.password" value="123456" /&gt;
            &lt;property name="eclipselink.logging.level" value="SEVERE" /&gt;
            &lt;property name="eclipselink.ddl-generation"
                value="create-or-extend-tables" /&gt;
        &lt;/properties&gt;
    &lt;/persistence-unit&gt;

&lt;/persistence&gt;
</code></pre> 
 <p><strong>第3步:</strong> 在<code>com.yiibai.jpa.persist</code>包下创建一个名为<code>PersistStudent.java</code>的持久化类，以便将实体对象与数据保持一致。</p> 
 <p>文件:<em>PersistStudent.java</em> 的代码如下 - </p>   
 <pre><code class="lang-java">package com.yiibai.jpa.student;

import javax.persistence.*;

public class PersistStudent {

    public static void main(String args[]) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("Student_details");
        EntityManager em = emf.createEntityManager();

        em.getTransaction().begin();

        StudentEntity s1 = new StudentEntity();
        s1.setS_id(1001);
        s1.setS_name("Maxsu");
        s1.setS_age(26);

        StudentEntity s2 = new StudentEntity();
        s2.setS_id(1102);
        s2.setS_name("Yiibai");
        s2.setS_age(23);

        StudentEntity s3 = new StudentEntity();
        s3.setS_id(1003);
        s3.setS_name("James");
        s3.setS_age(28);

        em.persist(s1);
        em.persist(s2);
        em.persist(s3);

        em.getTransaction().commit();

        em.close();
        emf.close();

        System.out.println("All job done.");

    }
}
</code></pre> 
 <p>执行上面程序后，<code>student</code>表在MySQL工作台下生成。此表包含学生的详细信息。要获取数据，请在MySQL控制台执行<code>select * from student</code>查询。得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201806/0806/560120640_87404.png" alt=""></p>
 <br>      
</div></body></html>