<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java组合实体模式</h1><div style="width:100%;float:left;" class="article-content">   
 <p>组合实体模式用于EJB持久化机制。 组合实体是表示对象图的EJB实体bean。 当组合实体更新时，内部依赖对象bean将自动更新为由EJB实体bean管理。 以下是组合实体Bean的参与者。</p> 
 <ul> 
  <li><strong>组合实体</strong> - 它是主要的实体bean。 它可以是粗粒度的或可以包含用于持久性目的的粗粒度对象。</li>
  <li><strong>粗粒对象</strong> - 此对象包含依赖对象。 它有自己的生命周期，并且管理依赖对象的生命周期。</li>
  <li><strong>依赖对象</strong> - 依赖对象是一个对象，这取决于它的持久性生命周期粗粒对象。</li>
  <li><strong>策略</strong> - 策略表示如何实现复组合实体。</li>
 </ul> 
 <h2 id="h2-u5B9Eu73B0u5B9Eu4F8B"><a name="实现实例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实现实例</h2>
 <p>在这个实现的示例中，将创建<code>CompositeEntity</code>对象作为<code>CompositeEntity</code>。 <code>CoarseGrainedObject</code>是一个包含依赖对象的类。 <code>CompositeEntityPatternDemo</code>是一个演示类，它使用<code>Client</code>类来演示使用组合实体模式。</p> 
 <p>组合实体模式示例的结构如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201612/09/546121214_69248.jpg" alt=""></p> 
 <h3 id="h3--1-"><a name="第1步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第1步</h3>
 <p>创建一个领情对象，其代码如下 -<br><em>DependentObject1.java</em></p> 
 <pre><code class="lang-java">public class DependentObject1 {

   private String data;

   public void setData(String data){
      this.data = data; 
   } 

   public String getData(){
      return data;
   }
}
</code></pre> 
 <p><em>DependentObject2.java</em></p> 
 <pre><code class="lang-java">public class DependentObject2 {

   private String data;

   public void setData(String data){
      this.data = data; 
   } 

   public String getData(){
      return data;
   }
}
</code></pre> 
 <h3 id="h3--2-"><a name="第2步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第2步</h3>
 <p>创建粗粒度类对象，其代码如下 -<br><em>CoarseGrainedObject.java</em></p> 
 <pre><code class="lang-java">public class CoarseGrainedObject {
   DependentObject1 do1 = new DependentObject1();
   DependentObject2 do2 = new DependentObject2();

   public void setData(String data1, String data2){
      do1.setData(data1);
      do2.setData(data2);
   }

   public String[] getData(){
      return new String[] {do1.getData(),do2.getData()};
   }
}
</code></pre> 
 <h3 id="h3--3-"><a name="第3步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第3步</h3>
 <p>创建组合实体，其代码如下 -<br><em>CompositeEntity.java</em></p>   
 <pre><code class="lang-java">public class CompositeEntity {
   private CoarseGrainedObject cgo = new CoarseGrainedObject();

   public void setData(String data1, String data2){
      cgo.setData(data1, data2);
   }

   public String[] getData(){
      return cgo.getData();
   }
}
</code></pre> 
 <h3 id="h3--4-"><a name="第4步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第4步</h3>
 <p>创建<code>Client</code>类以使用组合实体，其代码如下 -<br><em>Client.java</em></p> 
 <pre><code class="lang-java">public class Client {
   private CompositeEntity compositeEntity = new CompositeEntity();

   public void printData(){

      for (int i = 0; i &lt; compositeEntity.getData().length; i++) {
         System.out.println("Data: " + compositeEntity.getData()[i]);
      }
   }

   public void setData(String data1, String data2){
      compositeEntity.setData(data1, data2);
   }
}
</code></pre> 
 <h3 id="h3--5-"><a name="第5步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第5步</h3>
 <p>使用客户端来演示组合实体设计模式的使用。<br><em>CompositeEntityPatternDemo.java</em></p> 
 <pre><code class="lang-java">public class CompositeEntityPatternDemo {
   public static void main(String[] args) {

       Client client = new Client();
       client.setData("Test", "Data");
       client.printData();
       client.setData("Second Test", "Data1");
       client.printData();
   }
}
</code></pre> 
 <h3 id="h3--6-"><a name="第6步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第6步</h3>
 <p>验证输出，执行上面的代码得到以下结果 -</p> 
 <pre><code class="lang-java">Data: Test
Data: Data
Data: Second Test
Data: Data1
</code></pre>
 <br>      
</div></body></html>