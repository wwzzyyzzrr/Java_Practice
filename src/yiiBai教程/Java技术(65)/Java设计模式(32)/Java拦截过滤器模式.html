<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java拦截过滤器模式</h1><div style="width:100%;float:left;" class="article-content">   
 <p>当我们想要对应用程序的请求或响应进行一些预处理/后处理时，使用截取过滤器设计模式。 在将请求传递到实际目标应用程序之前，在请求上定义和应用过滤器。 过滤器可以进行请求的认证/授权/日志记录或跟踪，然后将请求传递给相应的处理程序。 以下是这种类型的设计模式的实体。</p> 
 <ul> 
  <li><strong>过滤器</strong> - 在请求处理程序执行请求之前或之后执行某些任务的过滤器。</li>
  <li><strong>过滤器链</strong> - 过滤器链携带多个过滤器，并帮助在目标上以定义的顺序执行它们。</li>
  <li><strong>目标</strong> - 目标对象是请求处理程序。</li>
  <li><strong>过滤器管理器</strong> - 过滤器管理器管理过滤器和过滤器链。</li>
  <li><strong>客户端</strong> - 客户端是向目标（<em>Target</em>）对象发送请求的对象。</li>
 </ul> 
 <h2 id="h2-u5B9Eu73B0u793Au4F8B"><a name="实现示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实现示例</h2>
 <p>在这个实现示例中，将创建一个<code>FilterChain</code>，<code>FilterManager</code>，<code>Target</code>，<code>Client</code>作为表示实体的各种对象。<code>AuthenticationFilter</code>和<code>DebugFilter</code>表示具体的过滤器。</p> 
 <p><code>InterceptingFilterDemo</code>是一个演示类，将使用客户端来演示拦截过滤器设计模式。</p> 
 <p>拦截过滤器模式示例的结构如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201612/09/569141238_33914.jpg" alt=""></p> 
 <h3 id="h3--1-"><a name="第1步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第1步</h3>
 <p>创建一个名为 <code>Filter</code> 的接口，其代码如下 - </p> 
 <p><em>Filter.java</em></p> 
 <pre><code class="lang-java">public interface Filter {
   public void execute(String request);
}
</code></pre> 
 <h3 id="h3--2-"><a name="第2步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第2步</h3>
 <p>创建具体过滤器，其代码如下 -<br><em>AuthenticationFilter.java</em></p> 
 <pre><code class="lang-java">public class AuthenticationFilter implements Filter {
   public void execute(String request){
      System.out.println("Authenticating request: " + request);
   }
}
</code></pre> 
 <p><em>DebugFilter.java</em></p> 
 <pre><code class="lang-java">public class DebugFilter implements Filter {
   public void execute(String request){
      System.out.println("request log: " + request);
   }
}
</code></pre> 
 <h3 id="h3--3-"><a name="第3步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第3步</h3>
 <p>创建目标（Target）类，其代码如下 -<br><em>Target.java</em></p> 
 <pre><code class="lang-java">public class Target {
   public void execute(String request){
      System.out.println("Executing request: " + request);
   }
}
</code></pre> 
 <h3 id="h3--4-"><a name="第4步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第4步</h3>
 <p>创建过滤器链，其代码如下 -<br><em>FilterChain.java</em></p> 
 <pre><code class="lang-java">import java.util.ArrayList;
import java.util.List;

public class FilterChain {
   private List&lt;Filter&gt; filters = new ArrayList&lt;Filter&gt;();
   private Target target;

   public void addFilter(Filter filter){
      filters.add(filter);
   }

   public void execute(String request){
      for (Filter filter : filters) {
         filter.execute(request);
      }
      target.execute(request);
   }

   public void setTarget(Target target){
      this.target = target;
   }
}
</code></pre> 
 <h3 id="h3--5-"><a name="第5步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第5步</h3>
 <p>创建筛选管理器，其代码如下 - </p> 
 <p><em>FilterManager.java</em></p>   
 <pre><code class="lang-java">public class FilterManager {
   FilterChain filterChain;

   public FilterManager(Target target){
      filterChain = new FilterChain();
      filterChain.setTarget(target);
   }
   public void setFilter(Filter filter){
      filterChain.addFilter(filter);
   }

   public void filterRequest(String request){
      filterChain.execute(request);
   }
}
</code></pre> 
 <h3 id="h3--6-"><a name="第6步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第6步</h3>
 <p>创建客户端，其代码如下 - </p> 
 <p><em>Client.java</em></p> 
 <pre><code class="lang-java">public class Client {
   FilterManager filterManager;

   public void setFilterManager(FilterManager filterManager){
      this.filterManager = filterManager;
   }

   public void sendRequest(String request){
      filterManager.filterRequest(request);
   }
}
</code></pre> 
 <h3 id="h3--7-"><a name="第7步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第7步</h3>
 <p>使用客户端来演示拦截过滤器设计模式。<br><em>InterceptingFilterDemo.java</em></p> 
 <pre><code class="lang-java">public class InterceptingFilterDemo {
   public static void main(String[] args) {
      FilterManager filterManager = new FilterManager(new Target());
      filterManager.setFilter(new AuthenticationFilter());
      filterManager.setFilter(new DebugFilter());

      Client client = new Client();
      client.setFilterManager(filterManager);
      client.sendRequest("HOME");
   }
}
</code></pre> 
 <h3 id="h3--8-"><a name="第8步" class="reference-link"></a><span class="header-link octicon octicon-link"></span>第8步</h3>
 <p>验证输出，执行上面的代码得到以下结果 -</p> 
 <pre><code class="lang-java">Authenticating request: HOME
request log: HOME
Executing request: HOME
</code></pre>
 <br>      
</div></body></html>