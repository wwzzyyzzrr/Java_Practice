<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Gradle测试</h1><div style="width:100%;float:left;" class="article-content">   
 <p>测试任务自动检测和执行测试源集合中的所有单元测试。它还会在测试执行完成后生成报告。 <a target="_blank" href="http://www.yiibai.com/junit/" title="JUnit">JUnit</a>和<a target="_blank" href="http://www.yiibai.com/testng/" title="TestNG">TestNG</a>都是支持的API。</p> 
 <p>测试任务提供了一个<code>Test.set Debug（）</code>方法，可以将其设置为启动<code>JVM</code>等待调试器。在继续执行之前，它将调试器发布值设置为<code>5005</code>。</p> 
 <h2 id="h2-u6D4Bu8BD5u68C0u6D4B"><a name="测试检测" class="reference-link"></a><span class="header-link octicon octicon-link"></span>测试检测</h2>
 <p>测试任务通过检查编译的测试类来检测哪些类是测试类。 默认情况下，它扫描所有<code>.class</code>文件。不过也可以设置自定义包含/排除，只有那些类才会被扫描。根据所使用的测试框架（<code>JUnit</code> / <code>TestNG</code>），测试类检测使用不同的标准。</p> 
 <p>如果不想使用测试类检测，可以通过将<code>scanForTestClasses</code>设置为<code>false</code>来禁用它。</p> 
 <h2 id="h2-u6D4Bu8BD5u5206u7EC4"><a name="测试分组" class="reference-link"></a><span class="header-link octicon octicon-link"></span>测试分组</h2>
 <p><code>JUnit</code>和<code>TestNG</code>允许复杂的测试方法分组。对于分组，<code>JUnit</code>有测试类和方法。<code>JUnit 4.8</code>引入了类别的概念。测试任务允许指定要包括或排除的<code>JUnit</code>类别。</p> 
 <p>可以使用<code>build.gradle</code>文件中的以下代码段对测试方法进行分组。如下代码所示 - </p> 
 <pre><code class="lang-sql">test {
   useJUnit {
      includeCategories 'org.gradle.junit.CategoryA'
      excludeCategories 'org.gradle.junit.CategoryB'
   }
}
</code></pre> 
 <h2 id="h2-u5305u62ECu548Cu6392u9664u6307u5B9Au6D4Bu8BD5"><a name="包括和排除指定测试" class="reference-link"></a><span class="header-link octicon octicon-link"></span>包括和排除指定测试</h2>
 <p><code>Test</code>类有一个<code>include</code>和<code>exclude</code>方法。这些方法可以用于指定哪些测试应该运行。<br>只运行包含的测试 -</p> 
 <pre><code class="lang-groovy">test {
   include '**my.package.name/*'
}
</code></pre> 
 <p>跳过排除的测试 -</p>   
 <pre><code class="lang-groovy">test {
   exclude '**my.package.name/*'
}
</code></pre> 
 <p>以下代码中所示的<code>build.gradle</code>示例文件显示了不同的配置选项。</p> 
 <pre><code class="lang-groovy">apply plugin: 'java' // adds 'test' task

test {
   // enable TestNG support (default is JUnit)
   useTestNG()

   // set a system property for the test JVM(s)
   systemProperty 'some.prop', 'value'

   // explicitly include or exclude tests
   include 'org/foo/**'
   exclude 'org/boo/**'

   // show standard out and standard error of the test JVM(s) on the console
   testLogging.showStandardStreams = true

   // set heap size for the test JVM(s)
   minHeapSize = "64m"
   maxHeapSize = "512m"

   // set JVM arguments for the test JVM(s)
   jvmArgs '-XX:MaxPermSize=256m'

   // listen to events in the test execution lifecycle
   beforeTest { 
      descriptor → logger.lifecycle("Running test: " + descriptor)
   }

   // listen to standard out and standard error of the test JVM(s)
   onOutput { 
      descriptor, event → logger.lifecycle
         ("Test: " + descriptor + " produced standard out/err: " 
         + event.message )
   }
}
</code></pre> 
 <p>可以使用以下命令语法来执行一些测试任务。</p> 
 <pre><code class="lang-groovy">gradle &lt;someTestTask&gt; --debug-jvm
</code></pre>
 <br>      
</div></body></html>