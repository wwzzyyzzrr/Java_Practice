<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">创建Gradle Java Web应用程序并在Tomcat上运行</h1><div style="width:100%;float:left;" class="article-content">   
 <h2 id="h2-1-gradle-"><a name="1- 创建Gradle工程" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1- 创建Gradle工程</h2>
 <p>打开 <strong>Eclipse</strong> ，在菜单中找到 <strong>File</strong> -&gt; <strong>New</strong> -&gt; <strong>Other…</strong>，在打开界面中选择 <code>Gradle Project</code>，如下图中所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/340091044_79152.png" alt=""></p> 
 <p>点击下一步（<strong>Next</strong>），如下图中所示，并继续点击下一步（<strong>Next</strong>） - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/867091046_34700.png" alt=""></p> 
 <p>在新打开的界面中输入项目代码的名称，这里我们创建一个名称为 <code>GradleWebApp</code> 如下图所示-</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/376091052_80783.png" alt=""></p> 
 <p>在新打开界面中，选择 <code>Gradle</code> 的安装目录，如下图中所示，并继续点击下一步（<strong>Next</strong>）-</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/355091054_32850.png" alt=""></p> 
 <p>构建完成后，点击完成（<strong>Finish</strong>）即可，界面提示如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/694091057_54952.png" alt=""></p> 
 <p>项目创建完成后，它的一个初始结构如下图中所示：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/202091059_21246.png" alt=""></p> 
 <h2 id="h2-2-gradle"><a name="2- 配置Gradle" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2- 配置Gradle</h2>
 <p>这是<code>Eclipse</code>所创建的<code>build.gradle</code>文件的默认内容，这里我们删除所有注释：</p> 
 <pre><code class="lang-groovy">apply plugin: 'java'

repositories {
   jcenter()
}

dependencies {

   compile 'org.slf4j:slf4j-api:1.7.21'

   testCompile 'junit:junit:4.12'

}
</code></pre> 
 <p>接下来需要将应用程序的配置添加“WEB应用程序”。并且可以让这个项目可直接在 <code>Eclipse+Tomcat</code> 插件上运行。修改<code>build.gradle</code>文件的添加一些代码内容，如下所示 - </p> 
 <pre><code class="lang-groovy">apply plugin: 'java'
apply plugin: 'war' 
apply plugin: 'com.bmuschko.tomcat'

repositories {
    jcenter()
}

dependencies {   

    testCompile 'junit:junit:4.12' 

    providedCompile "javax.servlet:javax.servlet-api:3.1.0"      

}


dependencies {
    def tomcatVersion = '7.0.59'

    tomcat "org.apache.tomcat.embed:tomcat-embed-core:${tomcatVersion}",
           "org.apache.tomcat.embed:tomcat-embed-logging-juli:${tomcatVersion}",
           "org.apache.tomcat.embed:tomcat-embed-jasper:${tomcatVersion}"
}


buildscript {

    repositories {
        jcenter()
    }

    dependencies {
        classpath 'com.bmuschko:gradle-tomcat-plugin:2.2.2'
    }
}
</code></pre> 
 <p>注意，每次<code>build.gradle</code>内容有发生变化时，需要使用<code>Gradle</code>工具来更新项目。如下图中所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/900101004_45617.png" alt=""></p> 
 <h2 id="h2-3-"><a name="3-编辑应用程序结构" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3-编辑应用程序结构</h2>
 <p>In “src/main” folder, you need to create 2 sub folders are “resources” and “webapp”. </p> 
 <p>在”<code>src/main</code>“文件夹中，需要创建<code>2</code>个子文件夹，分别为“<code>resources</code>”和“<code>webapp</code>”。</p> 
 <ul> 
  <li><code>src/main/java</code>: 此文件夹中存放 <code>java</code> 源文件代码。</li>
  <li><code>src/main/resources</code>: 此文件夹中可以存放属性文件和其他资源。</li>
  <li><code>src/main/webapp</code>: 此文件夹包含<code>jsp</code>和其他<code>Web</code>应用程序内容。</li>
 </ul> 
 <p>创建完成后，目录结构如下图中所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/127101010_36226.png" alt=""></p> 
 <h2 id="h2-u9879u76EEu4EE3u7801"><a name="项目代码" class="reference-link"></a><span class="header-link octicon octicon-link"></span>项目代码</h2>
 <p>创建一个简单的类，叫作 <code>Greeting.java</code> 在 <code>gradlewebapp.bean</code> 包下，其项目结构和代码如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/717101014_65456.png" alt=""></p> 
 <p><code>Greeting.java</code> 文件的源代码如下所示 - </p> 
 <pre><code class="lang-java">package com.yiibai.gradlewebapp.bean;

public class Greeting {

    public String getHello()  {
        return "Hello Gradle Web Application";
    }
}
</code></pre> 
 <p>接下来，我们还要创建一个简单的<code>JSP</code>页面，在 <code>webapp</code> 目录下创建一个 <code>hello.jsp</code> 文件，如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/488101018_25613.png" alt=""></p> 
 <p><code>hello.jsp</code> 文件的代码如下所示 -</p> 
 <pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;

&lt;meta charset="UTF-8"&gt;

&lt;title&gt;Hello Gradle Web App&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;jsp:useBean id="greeting" class="com.yiibai.gradlewebapp.bean.Greeting"/&gt;

&lt;h3&gt;${greeting.hello}&lt;/h3&gt;



&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <h2 id="h2-5-gradle-"><a name="5- Gradle构建" class="reference-link"></a><span class="header-link octicon octicon-link"></span>5- Gradle构建</h2>
 <p>在 <code>Eclipse</code> 菜单中 <code>Window</code> -&gt; <code>Show View</code> -&gt; <code>Other...</code> -&gt; <code>Gradle</code> -&gt; <code>Gradle Tasks</code> 打开“Gradle任务”视图。如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/956101023_69535.png" alt=""></p> 
 <p>Right-click on “build” and select “Run Gradle Tasks”.</p> 
 <p>右键单击“<code>build</code>”并选择“<code>Run Gradle Tasks</code>”，如下图中所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/251101026_85755.png" alt=""></p> 
 <p>查看 <code>Gradle Executions</code> 选项卡，应该看到执行的任务的列表。</p> 
 <p>注意，如果出现类似错误：<code>Gradle Could not find tools.jar. Please check that ...</code>，则在右键单击“<code>build</code>” 选择“<code>Create Gradle Run Configurate...</code>”(第二个选项)并对应JDK安装的目录，重新构建编译即可，如下图中所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/819101050_20240.png" alt=""></p> 
 <p>构建成功，输出结果如下所示 - </p>   
 <pre><code class="lang-groovy">Working Directory: D:/worksp/GradleWebApp
Gradle User Home: D:/worksp/gradle/Downloads
Gradle Distribution: Local installation at D:/worksp/yiibai.com/gradle-3.1
Gradle Version: 3.1
Java Home: D:/Program Files/Java/jdk1.8.0_65
JVM Arguments: None
Program Arguments: None
Gradle Tasks: build

:compileJava
:processResources UP-TO-DATE
:classes
:war
:assemble
:compileTestJava
:processTestResources UP-TO-DATE
:testClasses
:test
:check
:build

BUILD SUCCESSFUL

Total time: 8.521 secs
</code></pre> 
 <h2 id="h2-6-"><a name="6-配置以运行应用程序" class="reference-link"></a><span class="header-link octicon octicon-link"></span>6-配置以运行应用程序</h2>
 <p>在项目名称上点击右键，在弹出的菜单选项中选择 <code>Run As</code> -&gt; <code>Run Configurations...</code> 在弹出的界面中选择 “New”，如下图中所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/381111003_76676.png" alt=""></p> 
 <p>输入以下几个内容：</p> 
 <ul> 
  <li><strong>Name</strong>: Run GradleWebApp</li>
  <li><strong>Gradle Tasks</strong>: tomcatRun</li>
  <li><strong>Working Directory</strong>: ${workspace_loc:/GradleWebApp}</li>
 </ul> 
 <p>如有必要，还需要指定 <code>Gradle</code>和<code>JDK的</code>安装的目录，最终的结果如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/944111006_22562.png" alt=""></p> 
 <p>如果是第一次运行，可能还要下载一些应用程序，所以需要等待一段时间…找点咖啡之类的东西喝先。<br>运行成功后，应该可以看到类似下面的输出结果 - </p> 
 <pre><code class="lang-groovy">Working Directory: D:/worksp/GradleWebApp
Gradle User Home: D:/worksp/gradle/Downloads
Gradle Distribution: Local installation at D:/worksp/yiibai.com/gradle-3.1
Gradle Version: 3.1
Java Home: D:/Program Files/Java/jdk1.8.0_65
JVM Arguments: None
Program Arguments: None
Gradle Tasks: tomcatRun

:compileJava UP-TO-DATE
:processResources UP-TO-DATE
:classes UP-TO-DATE
:tomcatRun
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-core/7.0.59/tomcat-embed-core-7.0.59.pom
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-logging-juli/7.0.59/tomcat-embed-logging-juli-7.0.59.pom
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-jasper/7.0.59/tomcat-embed-jasper-7.0.59.pom
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-el/7.0.59/tomcat-embed-el-7.0.59.pom
Download https://jcenter.bintray.com/org/eclipse/jdt/core/compiler/ecj/4.4/ecj-4.4.pom
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-core/7.0.59/tomcat-embed-core-7.0.59.jar
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-logging-juli/7.0.59/tomcat-embed-logging-juli-7.0.59.jar
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-jasper/7.0.59/tomcat-embed-jasper-7.0.59.jar
Download https://jcenter.bintray.com/org/apache/tomcat/embed/tomcat-embed-el/7.0.59/tomcat-embed-el-7.0.59.jar
Download https://jcenter.bintray.com/org/eclipse/jdt/core/compiler/ecj/4.4/ecj-4.4.jar
Started Tomcat Server
The Server is running at http://localhost:8080/GradleWebApp
</code></pre> 
 <p>打开浏览器，输入URL：<a target="_blank" href="http://localhost:8080/GradleWebApp/hello.jsp">http://localhost:8080/GradleWebApp/hello.jsp</a> ，得到以下显示结果。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201610/28/496111021_93443.png" alt=""></p> 
 <blockquote> 
  <p>注意：您还可以使用<a target="_blank" href="https://github.com/bmuschko/gradle-tomcat-plugin" title="Gradle Tomcat插件">Gradle Tomcat插件</a>来创建其他任务：</p> 
 </blockquote> 
 <table> 
  <thead> 
   <tr> 
    <th>任务名称</th> 
    <th>类型</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>tomcatRun</td> 
    <td>TomcatRun</td> 
    <td>启动Tomcat实例并部署浏览Web应用程序</td> 
   </tr> 
   <tr> 
    <td>tomcatRunWar</td> 
    <td>TomcatRunWar</td> 
    <td>启动Tomcat实例并将WAR部署它</td> 
   </tr> 
   <tr> 
    <td>tomcatStop</td> 
    <td>TomcatStop</td> 
    <td>停止Tomcat实例</td> 
   </tr> 
   <tr> 
    <td>tomcatJasper</td> 
    <td>tomcatJasper</td> 
    <td>运行JSP编译器，并使用Jasper将JSP页面转换为Java源代码</td> 
   </tr> 
  </tbody> 
 </table>
 <br>      
</div></body></html>