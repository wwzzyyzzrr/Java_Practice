<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PDFBox提取图像</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在前一章中，我们已经看到了如何合并多个PDF文档。 在本章中，我们将了解如何从PDF文档的页面提取图像。</p> 
 <h2 id="h2--pdf-"><a name="从PDF文档生成图像" class="reference-link"></a><span class="header-link octicon octicon-link"></span>从PDF文档生成图像</h2>
 <p>PDFBox库提供了一个名称为<code>PDFRenderer</code>的类，它将PDF文档呈现为AWT BufferedImage。</p> 
 <p>以下是从PDF文档生成图像的步骤。</p> 
 <p><strong>第1步:加载现有的PDF文档</strong></p> 
 <p>使用<code>PDDocument</code>类的静态方法<code>load()</code>加载现有的PDF文档。 此方法接受一个文件对象作为参数，因为这是一个静态方法，可以使用类名称调用它，如下所示。</p> 
 <pre><code class="lang-java">File file = new File("path of the document") 
PDDocument document = PDDocument.load(file);
</code></pre> 
 <p><strong>第2步:实例化PDFRenderer类</strong></p> 
 <p><code>PDFRenderer</code>类将PDF文档呈现到AWT BufferedImage中。 因此，需要实例化这个类，如下所示。 这个类的构造函数接受一个文档对象; 传递上一步创建的文档对象，如下所示。</p> 
 <pre><code class="lang-java">PDFRenderer renderer = new PDFRenderer(document);
</code></pre> 
 <p><strong>第3步:从PDF文档渲染图像</strong></p> 
 <p>可以使用<code>Renderer</code>类的<code>renderImage()</code>方法在特定页面中呈现图像，以将此方法用于传递要渲染图像的页面的索引。</p> 
 <pre><code class="lang-java">BufferedImage image = renderer.renderImage(0);
</code></pre> 
 <p><strong>第4步:将图像写入文件</strong></p> 
 <p>可以使用<code>write()</code>方法将上一步中呈现的图像写入文件。 对于这种方法，需要传递三个参数 -</p> 
 <ul> 
  <li>渲染的图像对象。</li>
  <li>代表图像类型的字符串(<code>jpg</code>或<code>png</code>)。</li>
  <li>需要保存提取的图像的文件对象。</li>
 </ul> 
 <pre><code class="lang-java">ImageIO.write(image, "JPEG", new File("D:/PdfBoxExamples/myimage.jpg"));
</code></pre> 
 <p><strong>第5步:关闭文档</strong></p> 
 <p>最后，使用<code>PDDocument</code>类的<code>close()</code>方法关闭文档，如下所示。</p> 
 <pre><code class="lang-java">document.close();
</code></pre> 
 <p><strong>示例</strong></p> 
 <p>假设，在目录:<code>F:\worksp\pdfbox</code>中有一个PDF文档 - <code>mypdf.pdf</code>，并且在其第一页中包含一个图像，如下所示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201803/1103/760110311_14054.png" alt=""></p> 
 <p>本示例演示如何将上述PDF文档转换为图像文件。 在这里，将检索PDF文档第一页中的图像并将其保存为<code>myimage.jpg</code>。 将此代码保存为<code>PdfToImage.java</code> - </p>   
 <pre><code class="lang-java">package com.yiibai;

import java.awt.image.BufferedImage;
import java.io.File;

import javax.imageio.ImageIO;
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.rendering.PDFRenderer;
public class PdfToImage {

   public static void main(String args[]) throws Exception {

      //Loading an existing PDF document
      File file = new File("F:/worksp/pdfbox/mypdf.pdf");
      PDDocument document = PDDocument.load(file);

      //Instantiating the PDFRenderer class
      PDFRenderer renderer = new PDFRenderer(document);

      //Rendering an image from the PDF document
      BufferedImage image = renderer.renderImage(0);

      //Writing the image to a file
      ImageIO.write(image, "JPEG", new File("F:/worksp/pdfbox/myimage.jpg"));

      System.out.println("Image created");

      //Closing the document
      document.close();

   }
}
</code></pre> 
 <p>执行时，上述程序将检索给定PDF文档中的图像，并显示以下消息。</p> 
 <pre><code class="lang-shell">Image created
</code></pre> 
 <p>如果打开<em>F:/worksp/pdfbox/</em>，可以观察到图像文件:<code>myimage.jpg</code>，打开后如下所示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201803/1103/342110315_82370.png" alt=""></p>
 <br>      
</div></body></html>