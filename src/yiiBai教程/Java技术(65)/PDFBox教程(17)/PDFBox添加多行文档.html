<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PDFBox添加多行文档</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在前一章中提供的示例中，学习了如何在PDF中向页面添加文本，但通过此程序，只能添加适合单行的文本。 如果您尝试添加更多内容，则不会显示超出行间距的所有文字。</p> 
 <p>例如，如果传递以下字符串在上一章中执行上述程序，则只会显示其中的一部分。</p> 
 <pre><code class="lang-java">String text = "This is an example of adding text to a page in the pdf document. we can
   add as many lines as we want like this using the showText() method of the 
   ContentStream class";
</code></pre> 
 <p>用上面提到的字符串替换上一章中例子的字符串文本并执行它。 执行后，将得到类似以下输出。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201803/1003/339110336_57417.jpg" alt=""></p> 
 <p>如果仔细观察输出，可以看到只显示了一部分字符串。</p> 
 <p>要将多行添加到PDF，需要使用<code>setLeading()</code>方法设置前导，并在每行完成后使用<code>newline()</code>方法切换到新行。</p> 
 <p>以下是创建空白文档并将多行文本内容添加到页面的步骤。</p> 
 <p><strong>第1步:加载现有文档</strong></p> 
 <p>使用<code>PDDocument</code>类的<code>load()</code>方法加载现有文档。 因此，请实例化此类并加载所需的文档，如下所示。</p> 
 <pre><code class="lang-java">File file = new File("Path of the document"); 
PDDocument doc = PDDocument.load(file);
</code></pre> 
 <p><strong>第2步:获取所需的页面</strong></p> 
 <p>使用<code>getPage()</code>方法获取文档中的所需页面。 通过将索引传递给此方法来检索所需页面的对象，如下所示。</p> 
 <pre><code class="lang-java">PDPage page = doc.getPage(1);
</code></pre> 
 <p><strong>第3步:准备内容流</strong></p> 
 <p>使用<code>PDPageContentStream</code>类的对象来插入各种数据元素。 因此，需要将文档对象和页面对象传递给此类的构造函数，通过传递在前面的步骤中创建的这两个对象来实例化此类，如下所示。</p> 
 <pre><code class="lang-java">PDPageContentStream contentStream = new PDPageContentStream(doc, page);
</code></pre> 
 <p><strong>第4步:开始文本</strong></p> 
 <p>在PDF文档中插入文本时，可以使用<code>PDPageContentStream</code>类的<code>beginText()</code>和<code>endText()</code>方法指定文本的开始点和结束点，如下所示。</p> 
 <pre><code class="lang-java">contentStream.beginText(); 
......
code to add text content 
......
contentStream.endText();
</code></pre> 
 <p>因此，使用<code>beginText()</code>方法开始文本，如下所示。</p> 
 <pre><code class="lang-java">contentStream.beginText();
</code></pre> 
 <p><strong>第5步:设置文本的位置</strong></p> 
 <p>使用<code>newLineAtOffset()</code>方法，可以在页面中设置内容流的位置。</p> 
 <pre><code class="lang-java">//Setting the position for the line 
contentStream.newLineAtOffset(25, 700);
</code></pre> 
 <p><strong>第6步:设置字体</strong></p> 
 <p>使用<code>PDPageContentStream</code>类的<code>setFont()</code>方法将文本的字体设置为所需的样式，如下所示，需要传递该字体的类型和大小。</p> 
 <pre><code class="lang-java">contentStream.setFont( font_type, font_size );
</code></pre> 
 <p><strong>第7步:设置文本引导</strong></p> 
 <p>可以使用<code>setLeading()</code>方法设置文本引导，如下所示。</p> 
 <pre><code class="lang-java">contentStream.setLeading(14.5f);
</code></pre> 
 <p><strong>第8步:使用newline()插入多个字符串</strong></p> 
 <p>使用<code>PDPageContentStream</code>类的<code>ShowText()</code>方法插入多个字符串，方法是使用<code>newline()</code>方法将每个字符串分开，如下所示。</p> 
 <pre><code class="lang-java">contentStream. ShowText(text1); 
contentStream.newLine(); 
contentStream. ShowText(text2);
</code></pre> 
 <p><strong>第9步:结束文本</strong></p> 
 <p>插入文本后，需要使用<code>PDPageContentStream类</code>的<code>endText()</code>方法结束文本，如下所示。</p> 
 <pre><code class="lang-java">contentStream.endText();
</code></pre> 
 <p><strong>第10步:关闭PDPageContentStream</strong></p> 
 <p>使用<code>close()</code>方法关闭<code>PDPageContentStream</code>对象，如下所示。</p> 
 <pre><code class="lang-java">contentstream.close();
</code></pre> 
 <p><strong>第11步:保存文档</strong></p> 
 <p>添加所需内容后，使用<code>PDDocument</code>类的<code>save()</code>方法保存PDF文档，如以下代码块中所示。</p>   
 <pre><code class="lang-java">doc.save("Path");
</code></pre> 
 <p><strong>第12步:关闭文件</strong></p> 
 <p>最后，使用<code>PDDocument</code>类的<code>close()</code>方法关闭文档，如下所示。</p> 
 <pre><code class="lang-java">doc.close();
</code></pre> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>本示例演示如何使用PDFBox在PDF中添加多行。 此程序保存在名称为<code>AddMultipleLines.java</code>的文件中。</p> 
 <pre><code class="lang-java">package com.yiibai;

import java.io.File;
import java.io.IOException;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.pdmodel.PDPage;
import org.apache.pdfbox.pdmodel.PDPageContentStream;
import org.apache.pdfbox.pdmodel.font.PDFont;
import org.apache.pdfbox.pdmodel.font.PDType0Font;
import org.apache.pdfbox.pdmodel.font.PDType1Font;

public class AddMultipleLines {
   public static void main(String args[]) throws IOException {

      //Loading an existing document
      File file = new File("F:/worksp/pdfbox/my_doc.pdf");
      PDDocument doc = PDDocument.load(file);

      //Creating a PDF Document
      PDPage page = doc.getPage(1); 
      PDFont font = PDType0Font.load(doc, new File("c:/windows/fonts/times.ttf"));

      PDPageContentStream contentStream = new PDPageContentStream(doc, page); 

      //Begin the Content stream 
      contentStream.beginText(); 

      //Setting the font to the Content stream
      contentStream.setFont( PDType1Font.TIMES_ROMAN, 16 );
      System.out.println(" getName =&gt; "+font.getName());
     // contentStream.setFont( font, 16 );

      //Setting the leading
      contentStream.setLeading(14.5f);

      //Setting the position for the line
      contentStream.newLineAtOffset(25, 725);

      String text1 = "This is an example of adding text to a page in the pdf document. we can add as many lines";
      String text2 = "as we want like this using the ShowText()  method of the ContentStream class";
      //Adding text in the form of string
      contentStream.showText(text1);
      contentStream.newLine();
      contentStream.newLine();
      contentStream.showText(text2);
      contentStream.newLine();
      //Ending the content stream
      contentStream.endText();

      System.out.println("Content added");

      //Closing the content stream
      contentStream.close();

      //Saving the document
      doc.save(new File("F:/worksp/pdfbox/new-mul-doc.pdf"));

      //Closing the document
      doc.close();
   }
}
</code></pre> 
 <p>执行上面示例代码后，在指定路径中打开PDF文档:<em>new-mul-doc.pdf</em>，则可以观察到给定内容以多行添加到文档中，如下所示。<br><img src="http://www.yiibai.com/uploads/images/201803/1003/660120323_54594.png" alt=""></p>
 <br>      
</div></body></html>