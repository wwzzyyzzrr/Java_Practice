<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PDFBox合并多个PDF文档</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在前一章中，我们已经看到如何将给定的PDF文档分成多个文档。 现在让我们学习如何将多个PDF文档合并为一个文档。</p> 
 <h2 id="h2--pdf-"><a name="合并多个PDF文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>合并多个PDF文档</h2>
 <p>使用<code>PDFMergerUtility</code>类的类将多个PDF文档合并到单个PDF文档中，该类提供了将两个或多个PDF文档合并到单个PDF文档中的方法。</p> 
 <p>以下是合并多个PDF文档的步骤。</p> 
 <p><strong>第1步:加载现有的PDF文档</strong></p> 
 <p>使用<code>PDDocument</code>类的静态方法<code>load()</code>加载现有的PDF文档。 此方法接受一个文件对象作为参数，因为这是一个静态方法，可以使用类名称调用它，如下所示。</p> 
 <pre><code class="lang-java">File file = new File("path of the document") 
PDDocument document = PDDocument.load(file);
</code></pre> 
 <p><strong>第2步:实例化PDFMergerUtility类</strong></p> 
 <p>如下所示实例化合并实用程序类。</p> 
 <pre><code class="lang-java">PDFMergerUtility PDFmerger = new PDFMergerUtility();
</code></pre> 
 <p><strong>第3步:设置目标文件</strong></p> 
 <p>使用<code>setDestinationFileName()</code>方法设置目标文件，如下所示。</p> 
 <pre><code class="lang-java">PDFmerger.setDestinationFileName("D:/PdfBoxExamples/docs/merged.pdf");
</code></pre> 
 <p><strong>第4步:设置源文件</strong></p> 
 <p>使用<code>addSource()</code>方法设置源文件，如下所示。</p> 
 <pre><code class="lang-java">PDFmerger.addSource(file1);
</code></pre> 
 <p><strong>第5步:合并文档</strong></p> 
 <p>使用<code>PDFmerger</code>类的<code>mergeDocuments()</code>方法合并文档，如下所示。</p> 
 <pre><code class="lang-java">PDFmerger.mergeDocuments();
</code></pre> 
 <p><strong>第6步:关闭文档</strong></p> 
 <p>最后使用<code>PDDocument</code>类的<code>close()</code>方法关闭文档，如下所示。</p> 
 <pre><code class="lang-java">document.close();
</code></pre> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>假设，在目录:<code>F:\worksp\pdfbox</code>中有两个PDF文档 - <code>sample1.pdf</code>和<code>sample2.pdf</code>，如下所示。</p> 
 <p>第一个PDF文件(<code>sample1.pdf</code>):<br><img src="http://www.yiibai.com/uploads/images/201803/1103/826100312_21110.png" alt=""></p> 
 <p>第二个PDF文件(<code>sample2.pdf</code>):<br><img src="http://www.yiibai.com/uploads/images/201803/1103/670100312_47290.png" alt=""></p> 
 <p>本示例演示如何合并上述PDF文档。 在这里，我们将把<code>sample1.pdf</code>和<code>sample2.pdf</code>这两个PDF文档合并到一个PDF文档 - <code>merged.pdf</code>中。 将此代码保存在名称为<code>MergePDFs.java</code>的文件中。</p>   
 <pre><code class="lang-java">package com.yiibai;

import org.apache.pdfbox.multipdf.PDFMergerUtility;
import org.apache.pdfbox.pdmodel.PDDocument;

import java.io.File; 
import java.io.IOException;

public class MergePDFs {
   public static void main(String[] args) throws IOException {

      //Loading an existing PDF document
      File file1 = new File("F:/worksp/pdfbox/sample1.pdf");
      PDDocument doc1 = PDDocument.load(file1);

      File file2 = new File("F:/worksp/pdfbox/sample2.pdf");
      PDDocument doc2 = PDDocument.load(file2);

      //Instantiating PDFMergerUtility class
      PDFMergerUtility PDFmerger = new PDFMergerUtility();

      //Setting the destination file
      PDFmerger.setDestinationFileName("F:/worksp/pdfbox/merged.pdf");

      //adding the source files
      PDFmerger.addSource(file1);
      PDFmerger.addSource(file2);

      //Merging the two documents
      PDFmerger.mergeDocuments();


      System.out.println("Documents merged");
      //Closing the documents
      doc1.close();
      doc2.close();
   }

}
</code></pre> 
 <p>执行时，上述程序会显示以下消息 - </p> 
 <pre><code class="lang-shell">Documents merged
</code></pre> 
 <p>打开新合成的文档(<code>merged.pdf</code>)，如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201803/1103/127110302_81031.png" alt=""></p>
 <br>      
</div></body></html>