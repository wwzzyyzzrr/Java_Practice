<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PDFBox添加文档</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在前一章中，我们讨论了如何将页面添加到PDF文档。 在本章中，我们将讨论如何将文本添加到现有的PDF文档。</p> 
 <h2 id="h2--pdf-"><a name="将文本添加到现有的PDF文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>将文本添加到现有的PDF文档</h2>
 <p>可以使用PDFBox库将内容添加到文档，它提供一个名称为<code>PDPageContentStream</code>的类，其中包含在<code>PDFDocument</code>的页面中插入文本，图像和其他类型内容所需的方法。</p> 
 <p>以下是创建空白文档并将内容添加到其中的页面的步骤。</p> 
 <p><strong>第1步:加载现有文档</strong></p> 
 <p>使用<code>PDDocument</code>类的<code>load()</code>方法加载现有文档。 因此，请实例化此类并加载所需的文档，如下所示。</p> 
 <pre><code class="lang-java">File file = new File("Path_of_the_document"); 
PDDocument doc = document.load(file);
</code></pre> 
 <p><strong>第2步:获取所需的页面</strong></p> 
 <p>使用<code>getPage()</code>方法获取文档中的所需页面。 通过将索引传递给此方法来检索所需页面的对象，如下所示。</p> 
 <pre><code class="lang-java">PDPage page = doc.getPage(1);
</code></pre> 
 <p><strong>第3步:准备内容流</strong></p> 
 <p>使用<code>PDPageContentStream</code>类的对象插入各种数据元素。 因此，需要将文档对象和页面对象传递给此类的构造函数，通过传递在前面的步骤中创建的这两个对象来实例化此类，如下所示。</p> 
 <pre><code class="lang-java">PDPageContentStream contentStream = new PDPageContentStream(doc, page);
</code></pre> 
 <p><strong>第4步:开始文本</strong></p> 
 <p>在PDF文档中插入文本时，可以使用<code>PDPageContentStream</code>类的<code>beginText()</code>和<code>endText()</code>方法指定文本的开始点和结束点，如下所示。</p> 
 <pre><code class="lang-java">contentStream.beginText(); 
// 其它代码 .....
code to add text content 
// 其它代码 .....
contentStream.endText();
</code></pre> 
 <p>因此，使用<code>beginText()</code>方法开始文本，如下所示。</p> 
 <pre><code class="lang-java">contentStream.beginText();
</code></pre> 
 <p><strong>第5步:设置文本的位置</strong></p> 
 <p>使用<code>newLineAtOffset()</code>方法，可以在页面中设置内容流的位置。</p> 
 <pre><code class="lang-java">//Setting the position for the line 
contentStream.newLineAtOffset(25, 700);
</code></pre> 
 <p><strong>第6步:设置字体</strong></p> 
 <p>可以使用<code>PDPageContentStream</code>类的<code>setFont()</code>方法将文本的字体设置为所需的样式，如下所示。 要使用此方法，需要传递字体的类型和大小。</p> 
 <pre><code class="lang-java">contentStream.setFont( font_type, font_size );
</code></pre> 
 <p><strong>第7步:插入文本</strong></p> 
 <p>使用<code>PDPageContentStream</code>类的<code>ShowText()</code>方法将文本插入到页面中，如下所示。 该方法以字符串的形式接受所需的文本。</p> 
 <pre><code class="lang-java">contentStream.showText(text);
</code></pre> 
 <p><strong>第8步:结束文本</strong></p> 
 <p>插入文本后，需要使用<code>PDPageContentStream</code>类的<code>endText()</code>方法结束文本，如下所示。</p> 
 <pre><code class="lang-java">contentStream.endText();
</code></pre> 
 <p><strong>第9步:关闭PDPageContentStream</strong></p> 
 <p>使用<code>PDPageContentStream</code>类的<code>close()</code>方法关闭对象，如下所示。</p> 
 <pre><code class="lang-java">contentstream.close();
</code></pre> 
 <p><strong>第10步:保存文档</strong></p> 
 <p>添加所需内容后，使用<code>PDDocument</code>类的<code>save()</code>方法保存PDF文档，如以下代码块中所示。</p> 
 <pre><code class="lang-java">doc.save("Path");
</code></pre> 
 <p><strong>步骤11:关闭文件</strong></p> 
 <p>最后，使用<code>PDDocument</code>类的<code>close()</code>方法关闭文档，如下所示。</p>   
 <pre><code class="lang-java">doc.close();
</code></pre> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>本示例演示如何将内容添加到文档中的页面。 在这里将创建一个Java程序来加载保存在<code>F:\worksp\pdfbox</code>目录中的<code>my_doc.pdf</code>的PDF文档，并为其添加一些文本。 将此代码保存在<em>AddingContent.java</em> 的文件中。</p> 
 <pre><code class="lang-java">package com.yiibai;

import java.io.File; 
import java.io.IOException;

import org.apache.pdfbox.pdmodel.PDDocument; 
import org.apache.pdfbox.pdmodel.PDPage; 
import org.apache.pdfbox.pdmodel.PDPageContentStream; 
import org.apache.pdfbox.pdmodel.font.PDType1Font;

public class AddingContent {
   public static void main (String args[]) throws IOException {

      //Loading an existing document
      File file = new File("F:\\worksp\\pdfbox\\my_doc.pdf");
      PDDocument document = PDDocument.load(file);

      //Retrieving the pages of the document 
      PDPage page = document.getPage(0);
      PDPageContentStream contentStream = new PDPageContentStream(document, page);

      //Begin the Content stream 
      contentStream.beginText(); 
      // contentStream.set
      //Setting the font to the Content stream  
      contentStream.setFont(PDType1Font.HELVETICA_BOLD, 14);

      //Setting the position for the line 
      contentStream.newLineAtOffset(25, 500);

      String text = "This is the sample document and we are adding content to it. - By yiibai.com";

      //Adding text in the form of string 
      contentStream.showText(text);    

      //Ending the content stream
      contentStream.endText();

      System.out.println("Content added");

      //Closing the content stream
      contentStream.close();

      //Saving the document
      document.save(new File("F:\\worksp\\pdfbox\\new-doc-text.pdf"));

      //Closing the document
      document.close();
   }
}
</code></pre> 
 <p>执行上面示例代码后，在指定路径中找到并打开PDF文档:<code>new-doc-text.pdf</code>，则可以观察到给定内容已添加到文档中，如下所示。<br><img src="http://www.yiibai.com/uploads/images/201803/1003/774110332_91049.png" alt=""></p>
 <br>      
</div></body></html>