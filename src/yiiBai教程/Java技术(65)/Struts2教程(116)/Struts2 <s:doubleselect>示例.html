<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Struts2 &lt;s:doubleselect&gt;示例</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 在Struts2，&lt;s:doubleselect&gt;标签用于创建两个HTML下拉框，第一个下拉列表中选择后，第二个下拉列表将根据第一个选择发生相应的变化。一个非常典型的例子是“国家”，“国家”下拉选项，不同的“状态”列表是根据所选择的“国家”。 </p> 
 <p> 这里创建一个Web工程：strut2sdoubleselect，来演示在多个复选框如何设置的默认值，整个项目的结构如下图所示： </p> 
 <p> <img src="/uploads/tutorial/20151115/1-15111516323B49.png" alt=""> </p> 
 <p> &nbsp;&lt;s:doubleselect&gt; 标签示例 </p> 
 <pre>&lt;s:doubleselect label="Fruits (OGNL) " 
name="fruit1" list="{'fruit','meat'}" 
doubleName="fruit2" 
doubleList="top == 'fruit' ? {'apple', 'orange','banana'} : {'chicken', 'pig'}" /&gt;</pre> 
 <p> 产生下面的HTML代码... </p> 
 <pre>&lt;tr&gt; 
&lt;td class="tdLabel"&gt;
  &lt;label for="resultAction_fruit1" class="label"&gt;
     Fruits (OGNL) :
  &lt;/label&gt;
&lt;/td&gt; 
&lt;td&gt; 
&lt;select name="fruit1" id="resultAction_fruit1" 
    onchange="resultAction_fruit1Redirect(this.options.selectedIndex)"&gt; 
    &lt;option value="fruit"&gt;fruit&lt;/option&gt; 
    &lt;option value="meat"&gt;meat&lt;/option&gt; 
&lt;/select&gt; 
&lt;br /&gt; 
&lt;select name="fruit2" id="resultAction_fruit2"&gt; 
&lt;/select&gt; 
&lt;script type="text/javascript"&gt; 
    var resultAction_fruit1Group = new Array(2 + 0);
    for (i = 0; i &lt; (2 + 0); i++)
    resultAction_fruit1Group[i] = new Array();
 
    resultAction_fruit1Group[0][0] = new Option("apple", "apple");
 
    resultAction_fruit1Group[0][1] = new Option("orange", "orange");
 
    resultAction_fruit1Group[0][2] = new Option("banana", "banana");
 
    resultAction_fruit1Group[1][0] = new Option("chicken", "chicken");
 
    resultAction_fruit1Group[1][1] = new Option("pig", "pig");
 
 
    var resultAction_fruit1Temp = document.resultAction.resultAction_fruit2;
    resultAction_fruit1Redirect(0);
    function resultAction_fruit1Redirect(x) {
    	var selected = false;
        for (m = resultAction_fruit1Temp.options.length - 1; m &gt;= 0; m--) {
            resultAction_fruit1Temp.options[m] = null;
        }
 
        for (i = 0; i &lt; resultAction_fruit1Group[x].length; i++) {
            resultAction_fruit1Temp.options[i] = 
	     new Option(
              resultAction_fruit1Group[x][i].text, resultAction_fruit1Group[x][i].value
             );
         }
 
        if ((resultAction_fruit1Temp.options.length &gt; 0) &amp;&amp; (! selected)) {
           	resultAction_fruit1Temp.options[0].selected = true;
        }
    }
&lt;/script&gt;   
&lt;/td&gt; 
&lt;/tr&gt;</pre> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> 好了，&lt;s:doubleselect&gt;标签是真正产生大量的代码。它会创建两个下拉列表， 很多JavaScript代码背后做魔术（第一选择，第二个变化），并且还附上了“onchange()”行为，以第一个下拉框。 </p> 
 <div class="note" style="border:1px solid #D1D1E8;padding:20px;margin:20px 0px;color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#E6E6FC;"> 
  <strong>看起来比较复杂，但简单！</strong>
  <br> 这只是两个&lt;s:select&gt;标记结合在一个标签，看得很清楚了。 
  <pre>&lt;s:doubleselect
name="" list="" 
doubleName="" doubleList="" /&gt;</pre> 
  <p> “<strong>name</strong>”和“<strong>list</strong>”是指第一个下拉列表。“doubleName”和“doubleList”是指所述第二下拉列表。数据群和“<a target="_blank" href="http://www.yiibai.com/struts_2/struts-2-sselect-drop-down-box-example.html">&lt;s:select&gt;</a>”标签是一样的。&nbsp; </p> 
 </div> 
 <h2> Struts2&nbsp;&lt;s:doubleselect&gt;&nbsp;示例 </h2> 
 <p> 在一个完整的例子，例如&lt;S：doubleselect&gt;标签，表示使用OGNL或Java列出数据来填充到下拉列表中。 </p> 
 <h2> 1. Action </h2> 
 <p> Action类来生成两个下拉列表。<br> <strong>DoubleSelectAction.java</strong> </p> 
 <pre>package com.yiibai.common.action;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;

import com.opensymphony.xwork2.ActionSupport;

public class DoubleSelectAction extends ActionSupport{

	private String fruit1;
	private String fruit2;
	
	private String server1;
	private String server2;
	
	private String language1;
	private String language2;
	
	Map languageMap;

	public String getFruit1() {
		return fruit1;
	}

	public void setFruit1(String fruit1) {
		this.fruit1 = fruit1;
	}

	public String getFruit2() {
		return fruit2;
	}

	public void setFruit2(String fruit2) {
		this.fruit2 = fruit2;
	}

	public String getServer1() {
		return server1;
	}

	public void setServer1(String server1) {
		this.server1 = server1;
	}

	public String getServer2() {
		return server2;
	}

	public void setServer2(String server2) {
		this.server2 = server2;
	}

	public String getLanguage1() {
		return language1;
	}

	public void setLanguage1(String language1) {
		this.language1 = language1;
	}

	public String getLanguage2() {
		return language2;
	}

	public void setLanguage2(String language2) {
		this.language2 = language2;
	}

	public Map getLanguageMap() {
		return languageMap;
	}

	public void setLanguageMap(Map languageMap) {
		this.languageMap = languageMap;
	}

	public DoubleSelectAction(){
	  languageMap =new HashMap();		
		
          languageMap.put("Java", 
            new ArrayList&lt;String&gt;(Arrays.asList("Spring", "Hibernate", "Struts 2")));
          languageMap.put(".Net", new ArrayList&lt;String&gt;(Arrays.asList("VB.Net", "C#")));
          languageMap.put("JavaScript", new ArrayList&lt;String&gt;(Arrays.asList("jQuery")));
	}

	public String execute() {
		return SUCCESS;
	}
	
	public String display() {
		return NONE;
	}
	
}</pre> 
 <h2> 2. 结果页面 </h2> 
 <p> 渲染两个下拉下拉框，通过“&lt;s:doubleselect&gt;”标签，并通过Java列表，OGNL列表填充 </p> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <strong>doubleselect.jsp</strong> </p>   
 <pre>&lt;%@ taglib prefix="s" uri="/struts-tags" %&gt;
&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h1&gt;Struts2 &lt;s:doubleselect&gt; 示例&lt;/h1&gt;

&lt;s:form action="resultAction" namespace="/"&gt;

&lt;s:doubleselect label="Fruits (OGNL) " 
name="fruit1" list="{'fruit','meat'}" 
doubleName="fruit2" 
doubleList="top == 'fruit' ? {'apple', 'orange','banana'} : {'chicken', 'pig'}" /&gt;

&lt;s:set name="serverList" 
     value="#{
         'AppServer': {'Apache', 'Tomcat', 'JBoss'},
         'Database': {'Oracle', 'MySQL'}
         }" /&gt;
&lt;s:doubleselect label="Server (OGNL) " 
name="server1" list="#serverList.keySet()" 
doubleName="server2" doubleList="#serverList[top]" /&gt;

&lt;s:doubleselect label="Language (Java List) " 
name="language1" list="languageMap.keySet()" 
doubleName="language2" doubleList="languageMap.get(top)" /&gt;

&lt;s:submit value="submit" name="submit" /&gt;
	
&lt;/s:form&gt;

&lt;/body&gt;
&lt;/html&gt;</pre> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <strong>result.jsp</strong> </p> 
 <pre>&lt;%@ taglib prefix="s" uri="/struts-tags" %&gt;
&lt;html&gt;

&lt;body&gt;
&lt;h1&gt;Struts2 &lt;s:doubleselect&gt; 示例&lt;/h1&gt;

&lt;h2&gt;
  Test #1 : &lt;s:property value="fruit1"/&gt; , &lt;s:property value="fruit2"/&gt;
&lt;/h2&gt; 

&lt;h2&gt;
  Test #2 : &lt;s:property value="server1"/&gt; , &lt;s:property value="server2"/&gt;
&lt;/h2&gt; 

&lt;h2&gt;
  Test #2 : &lt;s:property value="language1"/&gt; , &lt;s:property value="language2"/&gt;
&lt;/h2&gt; 

&lt;/body&gt;
&lt;/html&gt;</pre> 
 <h2 style="font-family:'Helvetica Neue', Helvetica,  font-weight:500;color:#333333;font-size:24px;background-color:#FFFFFF;"> 3. struts.xml </h2> 
 <pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd"&gt;
 
&lt;struts&gt;

 &lt;constant name="struts.devMode" value="true" /&gt;
 	
&lt;package name="default" namespace="/" extends="struts-default"&gt;
		
   &lt;action name="doubleSelectAction" 
         class="com.yiibai.common.action.DoubleSelectAction" method="display"&gt;
	&lt;result name="none"&gt;/pages/doubleselect.jsp&lt;/result&gt;
   &lt;/action&gt;
		
   &lt;action name="resultAction" class="com.yiibai.common.action.DoubleSelectAction"&gt;
	&lt;result name="success"&gt;/pages/result.jsp&lt;/result&gt;
   &lt;/action&gt;
  &lt;/package&gt;
	
&lt;/struts&gt;</pre> 
 <h2 style="font-family:'Helvetica Neue', Helvetica,  font-weight:500;color:#333333;font-size:24px;background-color:#FFFFFF;"> 5. 示例 </h2> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <em>http://localhost:8080/strut2sdoubleselect/doubleSelectAction.action</em> </p> 
 <div class="pic" style="border:1px solid #DDDDDD;margin:20px 0px;padding:20px;text-align:center;color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#F9F9F9;"> 
  <img src="/uploads/tutorial/20151115/1-1511151630424I.png" alt=""> 
 </div> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <em>http://localhost:8080/strut2sdoubleselect/resultAction.action</em> </p> 
 <div class="pic" style="border:1px solid #DDDDDD;margin:20px 0px;padding:20px;text-align:center;color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#F9F9F9;"> 
  <img src="/uploads/tutorial/20151115/1-151115163059202.png" alt=""> 
 </div> 
 <h2> 参考 </h2> 
 <ol> 
  <li> <a target="_blank" href="http://struts.apache.org/2.1.8/docs/doubleselect.html">Struts 2 关联选择框文档</a> </li> 
  <li> <a target="_blank" href="http://www.yiibai.com/struts_2/struts-2-sselect-drop-down-box-example.html">Struts 2 &lt;s:select&gt; 示例</a> </li> 
 </ol> 
 <p> <br> </p> 代码下载：
 <a target="_blank" href="http://pan.baidu.com/s/1hqm8Zje">http://pan.baidu.com/s/1hqm8Zje</a>
 <br>      
</div></body></html>