<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Struts2上传多个文件例子</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 在上章节<a target="_blank" href="http://www.yiibai.com/struts_2/struts-2-file-upload-example.html">Struts2 文件上传示例</a>, 用户允许选择一个文件并上传到服务器。在本教程中，您将学习如何允许用户将多个文件上传到服务器。 </p> 
 <p> <span style="font-family:Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif, sans-serif;color:#535B60;line-height:22px;background-color:#FFFFFF;">这里创建一个Web工程：strut2uploadfiles，来演示</span><span style="font-family:Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif, sans-serif;color:#535B60;line-height:22px;background-color:#FFFFFF;">在多个复选框</span><span style="font-family:Arial, 'Hiragino Sans GB', 'Microsoft YaHei', 微软雅黑, STHeiti, 'WenQuanYi Micro Hei', SimSun, sans-serif, sans-serif;color:#535B60;line-height:22px;background-color:#FFFFFF;">如何设置的默认值，整个项目的结构如下图所示：</span> </p> 
 <p> <img src="/uploads/tutorial/20151115/1-151115160924E5.png" alt=""> </p> 
 <h2> 1. 动作类 </h2> 
 <p> 在Action类，可以使用列表或数组以存储上传的文件。 </p> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <strong>FileUploadAction.java</strong> </p> 
 <pre>package com.yiibai.common.action;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

import com.opensymphony.xwork2.ActionSupport;

public class MultipleFileUploadAction extends ActionSupport{

	private List&lt;File&gt; fileUpload = new ArrayList&lt;File&gt;();
	private List&lt;String&gt; fileUploadContentType = new ArrayList&lt;String&gt;();
	private List&lt;String&gt; fileUploadFileName = new ArrayList&lt;String&gt;();

	public List&lt;File&gt; getFileUpload() {
		return fileUpload;
	}

	public void setFileUpload(List&lt;File&gt; fileUpload) {
		this.fileUpload = fileUpload;
	}

	public List&lt;String&gt; getFileUploadContentType() {
		return fileUploadContentType;
	}

	public void setFileUploadContentType(List&lt;String&gt; fileUploadContentType) {
		this.fileUploadContentType = fileUploadContentType;
	}

	public List&lt;String&gt; getFileUploadFileName() {
		return fileUploadFileName;
	}

	public void setFileUploadFileName(List&lt;String&gt; fileUploadFileName) {
		this.fileUploadFileName = fileUploadFileName;
	}
	
	public String upload() throws Exception{
		
	    for (File file: fileUpload) {
	        System.out.println("File :" + file);
	    }
	    
	    for (String fileName: fileUploadFileName) {
	        System.out.println("Filename : " + fileName);
	    }

	    for (String fileContentType: fileUploadContentType) {
	        System.out.println("File type : " + fileContentType);
	    }
	    
	    return SUCCESS;
		
	}

	public String display() {
		return NONE;
	}
	
}</pre> 
 <h2> 2. 结果页面 </h2> 
 <p> 使用&lt;s:file&gt;标签来渲染多文件上传组件，并设置表单 enctype类型为“multipart/form-data”. </p> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <strong>fileupload.jsp</strong> </p> 
 <pre>&lt;%@ taglib prefix="s" uri="/struts-tags" %&gt;
&lt;html&gt;
&lt;head&gt;
&lt;s:head /&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h1&gt;Struts2上传多个文件示例&lt;/h1&gt;

&lt;s:form action="resultAction" namespace="/" 
method="POST" enctype="multipart/form-data"&gt;

&lt;s:file label="File 1" name="fileUpload" size="40" /&gt;
&lt;s:file label="File 2" name="fileUpload" size="40" /&gt;
&lt;s:file label="FIle 2" name="fileUpload" size="40" /&gt;

&lt;s:submit value="submit" name="submit" /&gt;
	
&lt;/s:form&gt;

&lt;/body&gt;
&lt;/html&gt;</pre> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <strong>result.jsp</strong> </p> 
 <pre>&lt;%@ taglib prefix="s" uri="/struts-tags" %&gt;
&lt;html&gt;

&lt;body&gt;
&lt;h1&gt;Struts2上传多个文件示例&lt;/h1&gt;

&lt;div&gt;&lt;div class="ads-in-post hide_if_width_less_800"&gt;
&lt;script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"&gt;&lt;/script&gt;
&lt;!-- 728x90 - After2ndH4 --&gt;
&lt;ins class="adsbygoogle hide_if_width_less_800" 
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-2836379775501347"
     data-ad-slot="3642936086"
	 data-ad-region="yiibairegion"&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;
&lt;/div&gt;&lt;/div&gt;&lt;h2&gt;
   File Name : &lt;s:property value="fileUploadFileName"/&gt; 
&lt;/h2&gt; 

&lt;h2&gt;
   Content Type : &lt;s:property value="fileUploadContentType"/&gt; 
&lt;/h2&gt; 

&lt;h2&gt;
   File : &lt;s:property value="fileUpload"/&gt; 
&lt;/h2&gt; 

&lt;/body&gt;
&lt;/html&gt;</pre> 
 <h2 style="font-family:'Helvetica Neue', Helvetica,  font-weight:500;color:#333333;font-size:24px;background-color:#FFFFFF;"> 3. struts.xml </h2>   
 <pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd"&gt;
 
&lt;struts&gt;

 	&lt;constant name="struts.devMode" value="true" /&gt;

	&lt;package name="default" namespace="/" extends="struts-default"&gt;
		
	&lt;action name="multipleFileUploadAction" 
	    class="com.yiibai.common.action.MultipleFileUploadAction" 
            method="display"&gt;
		&lt;result name="none"&gt;pages/multiplefileupload.jsp&lt;/result&gt;
	&lt;/action&gt;
		
	&lt;action name="resultAction" 
	     class="com.yiibai.common.action.MultipleFileUploadAction" 
             method="upload"&gt;
		 &lt;result name="success"&gt;pages/result.jsp&lt;/result&gt;
	&lt;/action&gt;
   &lt;/package&gt;
	
&lt;/struts&gt;</pre> 
 <h2 style="font-family:'Helvetica Neue', Helvetica,  font-weight:500;color:#333333;font-size:24px;background-color:#FFFFFF;"> 4. 示例 </h2> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#FFFFFF;"> <em>http://localhost:8080/struts2uploafiles/multipleFileUploadAction.action</em> </p> 
 <div class="pic" style="border:1px solid #DDDDDD;margin:20px 0px;padding:20px;text-align:center;color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#F9F9F9;"> 
  <img src="/uploads/tutorial/20151115/1-151115160G4496.png" alt=""> 
 </div> 
 <div class="pic" style="border:1px solid #DDDDDD;margin:20px 0px;padding:20px;text-align:center;color:#333333;font-family:'Helvetica Neue', Helvetica,  background-color:#F9F9F9;"> 
  <img src="/uploads/tutorial/20151115/1-151115160IJV.png" alt=""> 
 </div> 
 <h2> 参考 </h2> 
 <ol> 
  <li> <a target="_blank" href="http://www.yiibai.com/struts_2/struts-2-file-upload-example.html">Struts2文件上传示例</a> </li> 
  <li> <a target="_blank" href="http://struts.apache.org/2.x/docs/file.html">Struts2文件上传文档</a> </li> 
  <li> <a target="_blank" href="http://struts.apache.org/2.0.14/docs/file-upload.html">http://struts.apache.org/2.0.14/docs/file-upload.html</a> </li> 
  <li> <a target="_blank" href="http://struts.apache.org/2.0.14/docs/how-do-we-upload-files.html">http://struts.apache.org/2.0.14/docs/how-do-we-upload-files.html</a> </li> 
 </ol> 
 <p> <span id="__kindeditor_bookmark_end_1__"></span>下载代码 -&nbsp; </p>
 <br>      
</div></body></html>