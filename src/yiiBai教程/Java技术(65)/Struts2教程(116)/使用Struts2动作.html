<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">使用Struts2动作</h1><div style="width:100%;float:left;" class="article-content">   
 <div> 
  <div>
    在Struts2中，会花大部分的时间用在用动作来处理工作。动作类包含业务逻辑，获取资源包，保存数据，验证，并选择应发回给用户的视图的结果页面。这是Struts2的核心，所以必须要了解动作的基本概念。 
  </div> 
 </div> 
 <h2> 1. 动作 - Action </h2> 
 <p> Struts&nbsp;2动作不强迫你实现任何接口或扩展类，它只是需要你实现一个 execute()方法返回一个字符串来表示其应该返回的结果页面。 </p> 
 <pre class="prettyprint lang-java">package com.yiibai.user.action; 
public class LoginAction{
    //business logic
    public String execute() {
        return "success";
    }
}</pre> 
 <p> 在struts.xml中，配置使用Action类动作(action)标记和类属性。定义结果页面用结果的标签和动作名称返回给用户，可以用它来访问动作类的名称属性。 </p> 
 <pre class="prettyprint lang-java">&lt;package name="user" namespace="/User" extends="struts-default"&gt;
  &lt;action name="validateUser" class="com.yiibai.user.action.LoginAction"&gt;
    &lt;result name="success"&gt;pages/welcome.jsp&lt;/result&gt;
  &lt;/action&gt;
&lt;package&gt;</pre> 
 <div>
   现在，可以通过 .action 扩展名后缀访问动作。 
 </div> 
 <pre>http<span style="background-color:inherit;color:#999999;">:</span><span style="background-color:rgba(255, 255, 255, 0.498039);color:#A67F59;">/</span><span style="background-color:rgba(255, 255, 255, 0.498039);color:#A67F59;">/</span>localhost<span style="background-color:inherit;color:#999999;">:</span><span style="background-color:inherit;color:#990055;">8080</span><span style="background-color:rgba(255, 255, 255, 0.498039);color:#A67F59;">/</span>Struts2Example<span style="background-color:rgba(255, 255, 255, 0.498039);color:#A67F59;">/</span>User<span style="background-color:rgba(255, 255, 255, 0.498039);color:#A67F59;">/</span>validateUser<span style="background-color:inherit;color:#999999;">.</span>action&nbsp;</pre> 
 <div>
   默认.action是可配置的，只需要设置“
  <a target="_blank" href="http://www.yiibai.com/struts_2/how-to-remove-the-action-suffix-extension-in-struts-2.html">struts.action.extension</a>”的值，以满足您的需要。 
 </div> 
 <h2> 2.&nbsp;可选动作接口 </h2> 
 <p> Struts&nbsp;2带有一个可选的动作接口(com.opensymphony.xwork2.Action)。通过实现这个接口，它带来了一些方便和好处，看下面的源代码： </p> 
 <pre class="prettyprint lang-java">package com.opensymphony.xwork2;
public interface Action {
    public static final String SUCCESS = "success";
    public static final String NONE = "none";
    public static final String ERROR = "error";
    public static final String INPUT = "input";
    public static final String LOGIN = "login";
    public String execute() throws Exception;
}</pre> 
 <p> 这个接口是非常简单的，配有5常用常数值：<strong>&nbsp;</strong><strong>success, error, none, input and logic</strong>。现在的动作类可以直接使用常量。 </p> 
 <pre class="prettyprint lang-java">package com.yiibai.user.action;
import com.opensymphony.xwork2.Action;
public class LoginAction{
    //business logic
    public String execute() {
        return SUCCESS;
    }
}</pre> 
 <div> 
  <div>
    不明白为什么很多Struts开发人员喜欢实现此动作接口，它更好地扩展了ActionSupport。 
  </div> 
 </div> 
 <h2> 3. ActionSupport </h2> 
 <div> 
  <div>
    Support&nbsp;类，通常的做法是提供接口的默认实现。 
  </div> 
 </div> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  font-size:16px;"> &nbsp;ActionSupport (<strong>com.opensymphony.xwork2.ActionSupport</strong>),&nbsp;<span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">一个非常强大和方便的类，它提供了几个重要接口的缺省实现：</span> </p> 
 <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  font-size:16px;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;"> </span> </p>   
 <pre class="prettyprint lang-java">public class ActionSupport implements Action, Validateable, 
   ValidationAware, TextProvider, LocaleProvider, Serializable {
 ...
}</pre> 
 <p> ActionSupport&nbsp;类提供一些功能： </p> 
 <p> 1. 验证&nbsp;–&nbsp;声明一个validate()方法，并在里面实现验证代码。 </p> 
 <p> 2.&nbsp;文字本地化&nbsp;–&nbsp;使用gettext()方法来获得资源包的消息。 </p> 
 <pre class="prettyprint lang-java">package com.yiibai.user.action;
import com.opensymphony.xwork2.ActionSupport;
public class LoginAction extends ActionSupport{
    private String username;
    private String password;
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    //business logic
    public String execute() {
        return "SUCCESS";
    }
        //simple validation
    public void validate(){
        if("".equals(getUsername())){
            addFieldError("username", getText("username.required"));
        }
        if("".equals(getPassword())){
            addFieldError("password", getText("password.required"));
        }
    }
}</pre> 
 <div>
   在大多数情况下，应该扩展此类妥当，方便提供功能，除非你有理由不这样做。这也是一个很不错的学习类，以了解如何做一些重要的Struts2接口的实现。 
 </div> 
 <h2> 4. 动作注释 </h2> 
 <p> Struts&nbsp;2对注解有很好的支持，你可以摆脱XML文件，并使用@action在动作类上替换。 </p> 
 <pre class="prettyprint lang-java">package com.yiibai.user.action;
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Namespace;
import org.apache.struts2.convention.annotation.Result;
import org.apache.struts2.convention.annotation.ResultPath;
import com.opensymphony.xwork2.ActionSupport;
@Namespace("/User")
@ResultPath(value="/")
public class ValidateUserAction extends ActionSupport{
    @Action(value="Welcome", results={
        @Result(name="success",location="pages/welcome_user.jsp")
    })
    public String execute() {
        return SUCCESS;
    }
}</pre> 
 <h2> 总结 </h2> 
 <div>
   扩展ActionSupport类，它适合在大多数情况下。 
 </div>
 <br>      
</div></body></html>