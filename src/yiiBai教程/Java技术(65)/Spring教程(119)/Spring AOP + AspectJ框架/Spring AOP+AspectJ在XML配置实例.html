<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring AOP+AspectJ在XML配置实例</h1><div style="width:100%;float:left;" class="article-content">   
 <div> 
  <div>
    在本教程中，我们将向你展示如何转换上章节中&nbsp;
   <a target="_blank" href="http://www.yiibai.com/spring/spring-aop-aspectj-annotation-example.html">Spring&nbsp;AOP+AspectJ 注解</a>转成基于XML的配置。 
  </div> 
 </div> 
 <div> 
  <div>
    对于那些不喜欢注释，使用JDK1.4，则可以基于XML，而不使用 AspectJ。 
  </div> 
  <div>
    再次回顾上个 customerBo 接口中的几个方法，以后你将学会如何在 XML文件实现 AspectJ 拦截。 
  </div> 
  <pre>package com.yiibai.customer.bo;

public interface CustomerBo {

	void addCustomer();
	
	String addCustomerReturnValue();
	
	void addCustomerThrowException() throws Exception;
	
	void addCustomerAround(String name);
}</pre> 
  <h2> 1. AspectJ &lt;aop:before&gt; = @Before </h2> 
  <p> AspectJ @Before 示例. </p> 
  <pre>package com.yiibai.aspect;

import org.aspectj.lang.JoinYiibai;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

@Aspect
public class LoggingAspect {

	@Before("execution(* com.yiibai.customer.bo.CustomerBo.addCustomer(..))")
	public void logBefore(JoinYiibai joinYiibai) {
		//...
	}

}&nbsp;</pre> 
  <p> 在XML同等功能，使用&nbsp;&lt;aop:before&gt;. </p> 
  <pre>&lt;!-- Aspect --&gt;
&lt;bean id="logAspect" class="com.yiibai.aspect.LoggingAspect" /&gt;

&lt;aop:config&gt;

  &lt;aop:aspect id="aspectLoggging" ref="logAspect" &gt;

     &lt;!-- @Before --&gt;
     &lt;aop:pointcut id="pointCutBefore"
	expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomer(..))" /&gt;

     &lt;aop:before method="logBefore" pointcut-ref="pointCutBefore" /&gt;
			
  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;</pre> 
  <h2> 2. AspectJ &lt;aop:after&gt; = @After </h2> 
  <p> AspectJ @After 示例. </p> 
  <pre>package com.yiibai.aspect;

import org.aspectj.lang.JoinYiibai;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.After;

@Aspect
public class LoggingAspect {

	@After("execution(* com.yiibai.customer.bo.CustomerBo.addCustomer(..))")
	public void logAfter(JoinYiibai joinYiibai) {
		//...
	}

}&nbsp;</pre> 
  <p> 在XML同等功能，使用&nbsp;&lt;aop:after&gt;实现。 </p> 
  <pre>&lt;!-- Aspect --&gt;
&lt;bean id="logAspect" class="com.yiibai.aspect.LoggingAspect" /&gt;

&lt;aop:config&gt;

  &lt;aop:aspect id="aspectLoggging" ref="logAspect" &gt;

     &lt;!-- @After --&gt;
     &lt;aop:pointcut id="pointCutAfter"
	expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomer(..))" /&gt;

     &lt;aop:after method="logAfter" pointcut-ref="pointCutAfter" /&gt;
			
  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;</pre> 
  <h2> 3. AspectJ &lt;aop:after-returning&gt; = @AfterReturning </h2> 
  <p> AspectJ @AfterReturning 示例. </p> 
  <pre>package com.yiibai.aspect;

import org.aspectj.lang.JoinYiibai;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.AfterReturning;

@Aspect
public class LoggingAspect {

  @AfterReturning(
   pointcut = "execution(* com.yiibai.customer.bo.CustomerBo.addCustomerReturnValue(..))",
   returning= "result")
   public void logAfterReturning(JoinYiibai joinYiibai, Object result) {
	//...
   }

}</pre> 
  <p> 在XML同等功能 - 使用&nbsp;&lt;aop:after-returning&gt;. </p> 
  <pre>&lt;!-- Aspect --&gt;
&lt;bean id="logAspect" class="com.yiibai.aspect.LoggingAspect" /&gt;

&lt;aop:config&gt;

  &lt;aop:aspect id="aspectLoggging" ref="logAspect" &gt;

    &lt;!-- @AfterReturning --&gt;
    &lt;aop:pointcut id="pointCutAfterReturning"
      expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomerReturnValue(..))" /&gt;

    &lt;aop:after-returning method="logAfterReturning" returning="result" 
      pointcut-ref="pointCutAfterReturning" /&gt;
			
  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;</pre> 
  <h2> 4. AspectJ &lt;aop:after-throwing&gt; = @AfterReturning </h2> 
  <p> AspectJ @AfterReturning 示例. </p> 
  <pre>package com.yiibai.aspect;

import org.aspectj.lang.JoinYiibai;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.AfterThrowing;

@Aspect
public class LoggingAspect {

  @AfterThrowing(
   pointcut = "execution(* com.yiibai.customer.bo.CustomerBo.addCustomerThrowException(..))",
   throwing= "error")
  public void logAfterThrowing(JoinYiibai joinYiibai, Throwable error) {
	//...
  }
}</pre> 
  <p> 在XML同等功能 - 使用&nbsp;&lt;aop:after-throwing&gt;. </p> 
  <pre>&lt;!-- Aspect --&gt;
&lt;bean id="logAspect" class="com.yiibai.aspect.LoggingAspect" /&gt;

&lt;aop:config&gt;

  &lt;aop:aspect id="aspectLoggging" ref="logAspect" &gt;

    &lt;!-- @AfterThrowing --&gt;
    &lt;aop:pointcut id="pointCutAfterThrowing"
      expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomerThrowException(..))" /&gt;
			
    &lt;aop:after-throwing method="logAfterThrowing" throwing="error" 
      pointcut-ref="pointCutAfterThrowing"  /&gt;
			
  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;</pre> 
  <h2> 5. AspectJ &lt;aop:after-around&gt; = @Around </h2> 
  <p> AspectJ @Around 示例. </p>   
  <pre>package com.yiibai.aspect;

import org.aspectj.lang.ProceedingJoinYiibai;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Around;

@Aspect
public class LoggingAspect {

	@Around("execution(* com.yiibai.customer.bo.CustomerBo.addCustomerAround(..))")
	public void logAround(ProceedingJoinYiibai joinYiibai) throws Throwable {
		//...
	}
	
}</pre> 
  <p> 在XML同等功能 - 使用&nbsp;&lt;aop:after-around&gt;. </p> 
  <pre>&lt;!-- Aspect --&gt;
&lt;bean id="logAspect" class="com.yiibai.aspect.LoggingAspect" /&gt;

&lt;aop:config&gt;

   &lt;aop:aspect id="aspectLoggging" ref="logAspect" &gt;

    &lt;!-- @Around --&gt;
   &lt;aop:pointcut id="pointCutAround"
      expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomerAround(..))" /&gt;
			
   &lt;aop:around method="logAround" pointcut-ref="pointCutAround"  /&gt;
			
  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;</pre> 
  <h2> 完整的 XML 实例 </h2> 
  <div>
    查看完整的基于XML的&nbsp;AspectJ&nbsp;配置文件。 
  </div> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:aop="http://www.springframework.org/schema/aop"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
	http://www.springframework.org/schema/aop 
	http://www.springframework.org/schema/aop/spring-aop-3.0.xsd "&gt;

&lt;aop:aspectj-autoproxy /&gt;

&lt;bean id="customerBo" class="com.yiibai.customer.bo.impl.CustomerBoImpl" /&gt;

&lt;!-- Aspect --&gt;
&lt;bean id="logAspect" class="com.yiibai.aspect.LoggingAspect" /&gt;

&lt;aop:config&gt;

  &lt;aop:aspect id="aspectLoggging" ref="logAspect"&gt;

    &lt;!-- @Before --&gt;
    &lt;aop:pointcut id="pointCutBefore"
      expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomer(..))" /&gt;

    &lt;aop:before method="logBefore" pointcut-ref="pointCutBefore" /&gt;

    &lt;!-- @After --&gt;
    &lt;aop:pointcut id="pointCutAfter"
       expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomer(..))" /&gt;

    &lt;aop:after method="logAfter" pointcut-ref="pointCutAfter" /&gt;

    &lt;!-- @AfterReturning --&gt;
    &lt;aop:pointcut id="pointCutAfterReturning"
       expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomerReturnValue(..))" /&gt;

    &lt;aop:after-returning method="logAfterReturning"
      returning="result" pointcut-ref="pointCutAfterReturning" /&gt;

    &lt;!-- @AfterThrowing --&gt;
    &lt;aop:pointcut id="pointCutAfterThrowing"
      expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomerThrowException(..))" /&gt;

    &lt;aop:after-throwing method="logAfterThrowing"
      throwing="error" pointcut-ref="pointCutAfterThrowing" /&gt;

    &lt;!-- @Around --&gt;
    &lt;aop:pointcut id="pointCutAround"
      expression="execution(* com.yiibai.customer.bo.CustomerBo.addCustomerAround(..))" /&gt;

    &lt;aop:around method="logAround" pointcut-ref="pointCutAround" /&gt;

  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;

&lt;/beans&gt;</pre> 
  <div>
    下载源代码 –&nbsp;
   <a target="_blank" href="http://pan.baidu.com/s/1nuwrmOh">http://pan.baidu.com/s/1nuwrmOh</a> 
  </div> 
 </div>
 <br>      
</div></body></html>