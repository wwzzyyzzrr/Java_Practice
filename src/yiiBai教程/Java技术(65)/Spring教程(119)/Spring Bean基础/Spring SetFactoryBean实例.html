<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring SetFactoryBean实例</h1><div style="width:100%;float:left;" class="article-content">   
 <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;"> 
  <div style="background-color:inherit;"> 
   <span style="font-family:'Microsoft Yahei',  Helvetica, font-size:16px;line-height:1.5;background-color:inherit;">SetFactoryBean 类为开发者提供了一种可在 Spring&nbsp;bean 配置文件创建一个具体的Set集合(HashSet 和 TreeSet)。</span> 
  </div> 
 </div> 
 <div> 
  <div style="background-color:inherit;">
    这里有一个 ListFactoryBean。例如，在运行时它将实例化 HashSet，并注入到一个 bean 属性中。 
  </div> 
  <pre>package com.yiibai.common;

import java.util.Set;

public class Customer 
{
	private Set sets;
	//...
}</pre> 
  <div>
    Spring的bean配置文件。 
  </div> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"&gt;

	&lt;bean id="CustomerBean" class="com.yiibai.common.Customer"&gt;
		&lt;property name="sets"&gt;
			&lt;bean class="org.springframework.beans.factory.config.SetFactoryBean"&gt;
				&lt;property name="targetSetClass"&gt;
					&lt;value&gt;java.util.HashSet&lt;/value&gt;
				&lt;/property&gt;
				&lt;property name="sourceSet"&gt;
					&lt;list&gt;
						&lt;value&gt;one&lt;/value&gt;
						&lt;value&gt;2&lt;/value&gt;
						&lt;value&gt;three&lt;/value&gt;
					&lt;/list&gt;
				&lt;/property&gt;
			&lt;/bean&gt;
		&lt;/property&gt;
	&lt;/bean&gt;

&lt;/beans&gt;</pre> 
  <div>
    另外，还可以使用&nbsp;util的模式&nbsp;和&lt;util:set&gt;&nbsp;来做到同样的事情。 
  </div> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	http://www.springframework.org/schema/util
	http://www.springframework.org/schema/util/spring-util-2.5.xsd"&gt;

	&lt;bean id="CustomerBean" class="com.yiibai.common.Customer"&gt;
		&lt;property name="sets"&gt;
			&lt;util:set set-class="java.util.HashSet"&gt;
				&lt;value&gt;one&lt;/value&gt;
				&lt;value&gt;2&lt;/value&gt;
				&lt;value&gt;three&lt;/value&gt;
			&lt;/util:set&gt;
		&lt;/property&gt;
	&lt;/bean&gt;

&lt;/beans&gt;</pre> 
  <div>
    请记住必须包函&nbsp;util&nbsp;模式，否则会出现下面的错误： 
  </div>   
  <pre>Caused by: org.xml.sax.SAXParseException: 
	The prefix "util" for element "util:set" is not bound.</pre> 
  <p> 执行结果 </p> 
  <pre>package com.yiibai.common;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class App 
{
    public static void main( String[] args )
    {
    	ApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");

    	Customer cust = (Customer)context.getBean("CustomerBean");
    	System.out.println(cust);
    	
    }
}</pre> 
  <p> 输出结果： </p> 
  <pre>Customer [sets=[2, one, three]] Type=[class java.util.HashSet]</pre> 
  <div>
    实例化 HashSet，在运行时注入到客户的set集合属性。 
  </div> 
  <div> 
   <br> 
  </div> 
  <div>
    下载代码 – 
   <a target="_blank" href="http://pan.baidu.com/s/1o7woXQU">http://pan.baidu.com/s/1o7woXQU</a> 
  </div> 
  <div> 
   <br> 
  </div> 
 </div>
 <br>      
</div></body></html>