<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring使用@Autowired注解自动装配</h1><div style="width:100%;float:left;" class="article-content">   
 <div> 
  <div>
    在上一篇&nbsp;
   <a target="_blank" href="http://www.yiibai.com/spring/spring-auto-wiring-beans-in-xml.html">Spring在XML自动装配</a>&nbsp;示例中,它会匹配当前Spring容器任何bean的属性自动装配。在大多数情况下，你可能只需要在特定的&nbsp;bean&nbsp;自动装配属性。 
  </div> 
 </div> 
 <div> 
  <div>
    在Spring中，可以使用&nbsp;@Autowired&nbsp;注解通过setter方法，构造函数或字段自动装配Bean。此外，它可以在一个特定的bean属性自动装配。 
  </div> 
  <div> 
   <h4> 注&nbsp;<span style="font-weight:normal;line-height:1.5;">@Autowired注解是通过匹配数据类型自动装配Bean。</span> </h4> 
  </div> 
  <div>
    请参见下面的完整的例子来演示如何使用@Autowired。 
  </div> 
  <h2> 1. Beans </h2> 
  <div>
    一个 Customer&nbsp;bean&nbsp;在bean配置文件中声明。稍后，您将使用&nbsp;“@Autowired”&nbsp;来自动装配一个Person&nbsp;bean。 
  </div> 
  <pre>package com.yiibai.common;

public class Customer 
{
	//you want autowired this field.
	private Person person;
	
	private int type;
	private String action;
	
	//getter and setter method
	
}</pre> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"&gt;

	&lt;bean id="CustomerBean" class="com.yiibai.common.Customer"&gt;
		&lt;property name="action" value="buy" /&gt;
		&lt;property name="type" value="1" /&gt;
	&lt;/bean&gt;

	&lt;bean id="PersonBean" class="com.yiibai.common.Person"&gt;
		&lt;property name="name" value="yiibai" /&gt;
		&lt;property name="address" value="address 123" /&gt;
		&lt;property name="age" value="28" /&gt;
	&lt;/bean&gt;
	
&lt;/beans&gt;</pre> 
  <h2> 2. 注册AutowiredAnnotationBeanPostProcessor </h2> 
  <div>
    要启用@Autowired，必须注册“AutowiredAnnotationBeanPostProcessor'，你可以用两种方式做到这一点： 
  </div> 
  <h3> 1. Include &lt;context:annotation-config /&gt; </h3> 
  <div>
    添加&nbsp;Spring&nbsp;上下文和&lt;context:annotation-config&nbsp;/&gt;在bean配置文件中。 
  </div> 
  <pre>&lt;beans 
	//...
	xmlns:context="http://www.springframework.org/schema/context"
	//...
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context-2.5.xsd"&gt;
	//...

	&lt;context:annotation-config /&gt;
	//...
&lt;/beans&gt;</pre> 
  <p> 下面是完整的实例 </p> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context-2.5.xsd"&gt;

	&lt;context:annotation-config /&gt;

	&lt;bean id="CustomerBean" class="com.yiibai.common.Customer"&gt;
		&lt;property name="action" value="buy" /&gt;
		&lt;property name="type" value="1" /&gt;
	&lt;/bean&gt;

	&lt;bean id="PersonBean" class="com.yiibai.common.Person"&gt;
		&lt;property name="name" value="yiibai" /&gt;
		&lt;property name="address" value="address ABC" /&gt;
		&lt;property name="age" value="29" /&gt;
	&lt;/bean&gt;
	
&lt;/beans&gt;</pre> 
  <h3> 2. &nbsp;包含 AutowiredAnnotationBeanPostProcessor </h3> 
  <div>
    直接在bean配置文件包含“AutowiredAnnotationBeanPostProcessor”。 
  </div> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"&gt;

&lt;bean 
class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor"/&gt;
	
	&lt;bean id="CustomerBean" class="com.yiibai.common.Customer"&gt;
		&lt;property name="action" value="buy" /&gt;
		&lt;property name="type" value="1" /&gt;
	&lt;/bean&gt;

	&lt;bean id="PersonBean" class="com.yiibai.common.Person"&gt;
		&lt;property name="name" value="yiibai" /&gt;
		&lt;property name="address" value="address ABC" /&gt;
		&lt;property name="age" value="29" /&gt;
	&lt;/bean&gt;
	
&lt;/beans&gt;</pre> 
  <h2> 3. @Autowired示例 </h2> 
  <div>
    现在，你可以通过 @Autowired 自动装配 bean，它可以在 setter 方法，构造函数或字段中使用。 
  </div> 
  <h5> 1. @Autowired setter 方法 </h5> 
  <pre>package com.yiibai.common;

import org.springframework.beans.factory.annotation.Autowired;

public class Customer 
{
	private Person person;
	private int type;
	private String action;
	//getter and setter methods
	
	@Autowired
	public void setPerson(Person person) {
		this.person = person;
	}
}</pre> 
  <h5> 2. @Autowired 构造方法 </h5> 
  <pre>package com.yiibai.common;

import org.springframework.beans.factory.annotation.Autowired;

public class Customer 
{
	private Person person;
	private int type;
	private String action;
	//getter and setter methods
	
	@Autowired
	public Customer(Person person) {
		this.person = person;
	}
}</pre> 
  <h5> 3. @Autowired 字段 </h5> 
  <pre>package com.yiibai.common;

import org.springframework.beans.factory.annotation.Autowired;

public class Customer 
{
	@Autowired
	private Person person;
	private int type;
	private String action;
	//getter and setter methods
}</pre> 
  <div>
    上面的例子会自动装配“PersonBean”到Customer的person属性。 
  </div> 
  <p> 执行它 </p> 
  <pre>package com.yiibai.common;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class App 
{
    public static void main( String[] args )
    {
    	ApplicationContext context = 
    	  new ClassPathXmlApplicationContext(new String[] {"applicationContext.xml"});
    	
    	Customer cust = (Customer)context.getBean("CustomerBean");
    	System.out.println(cust);
    	
    }
}</pre> 
  <p> 输出 </p>   
  <pre><span style="line-height:1.5;background-color:inherit;">Customer&nbsp;[person=Person&nbsp;[name=YiibaiA],&nbsp;type=1,&nbsp;action=buy]</span></pre> 
  <h2 style="color:#333333;font-family:'Helvetica Neue', Helvetica,  font-size:24px;font-weight:500;"> 
   <div style="background-color:inherit;">
     依赖检查 
   </div> </h2> 
  <p style="color:#333333;font-family:'Helvetica Neue', Helvetica,  font-size:16px;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">默认情况下，@Autowired将执行相关检查，以确保属性已经装配正常。当Spring无法找到匹配的Bean装配，它会抛出异常。</span><span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;">要解决这个问题，可以通过 @Autowired 的“required”属性设置为false来禁用此检查功能。</span> </p> 
  <pre>package com.yiibai.common;

import org.springframework.beans.factory.annotation.Autowired;

public class Customer 
{
	@Autowired(required=false)
	private Person person;
	private int type;
	private String action;
	//getter and setter methods
}</pre> 
  <div>
    在上面的例子中，如果Spring不能找到一个匹配的Bean，person属性将不设定。 
  </div> 
  <h2> @Qualifier </h2> 
  <div>
    @Qualifier注解我们用来控制bean应在字段上自动装配。例如，具有两个类似的&nbsp;person&nbsp;bean&nbsp;配置文件。 
  </div> 
  <pre>&lt;beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context-2.5.xsd"&gt;

	&lt;context:annotation-config /&gt;

	&lt;bean id="CustomerBean" class="com.yiibai.common.Customer"&gt;
		&lt;property name="action" value="buy" /&gt;
		&lt;property name="type" value="1" /&gt;
	&lt;/bean&gt;

	&lt;bean id="PersonBean1" class="com.yiibai.common.Person"&gt;
		&lt;property name="name" value="yiibai-1" /&gt;
		&lt;property name="address" value="address-1" /&gt;
		&lt;property name="age" value="29" /&gt;
	&lt;/bean&gt;
	
	&lt;bean id="PersonBean2" class="com.yiibai.common.Person"&gt;
		&lt;property name="name" value="yiibai-2" /&gt;
		&lt;property name="address" value="address-2" /&gt;
		&lt;property name="age" value="28" /&gt;
	&lt;/bean&gt;
	
&lt;/beans&gt;</pre> 
  <div>
    Spring知道哪个&nbsp;bean&nbsp;应当装配？ 
  </div> 
  <div>
    为了解决这个问题，可以使用 @Qualifier 自动装配一个特定的 bean，例如， 
  </div> 
  <pre>package com.yiibai.common;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;

public class Customer 
{
	@Autowired
	@Qualifier("PersonBean1")
	private Person person;
	private int type;
	private String action;
	//getter and setter methods
}&nbsp;</pre> 
  <p> 这意味着，“PersonBean1”&nbsp;bean被自动装配到customer的person属性。阅读下面完整的例子&nbsp;–&nbsp;<a target="_blank" href="http://www.yiibai.com/spring/spring-autowiring-qualifier-example.html">Spring自动装配@Qualifier实例</a> </p> 
  <h2> 总结 </h2> 
  <div>
    这@Autowired注解非常灵活，功能强大，绝对比bean配置文件的“autowire”属性要更好。 
  </div> 
  <p> <br> </p> 
  <div>
    下载代码 –&nbsp;&nbsp;
   <a target="_blank" href="http://pan.baidu.com/s/1o7oNBTo">http://pan.baidu.com/s/1o7oNBTo</a> 
  </div> 
  <div> 
  </div> 
 </div>
 <br>      
</div></body></html>