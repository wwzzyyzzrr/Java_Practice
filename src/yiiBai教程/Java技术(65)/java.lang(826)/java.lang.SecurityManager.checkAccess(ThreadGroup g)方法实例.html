<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">java.lang.SecurityManager.checkAccess(ThreadGroup g)方法实例</h1><div style="width:100%;float:left;" class="article-content">   
 <p> <strong>java.lang.SecurityManager.checkAccess(ThreadGroup g)&nbsp;</strong>方法抛出一个SecurityException如果调用线程不允许修改的线程组参数。调用此方法为当前的安全管理器会创建一个新的子线程或子线程组时，并通过setDaemon, setMaxPriority, stop, suspend, resume, 和destroy 的线程组类方法。</p> 
 <p> 如果线程组参数是系统线程组(有一个空父)，则此方法调用checkPermission与RuntimePermission(“modifyThreadGroup”)权限。如果线程组参数是不是系统线程组，这个方法只是返回。想要更严格的规则应该覆盖此方法的应用。如果这个方法被重写，重写额外检查的方法，看看是否调用线程具有RuntimePermission(“modifyThreadGroup”)权限。这是为了确保拥有这个权限(如JDK本身)被允许操作任何线程代码。</p> 
 <p> 如果这种方法被重写，那么super.checkAccess应由第一条语句中重写的方法调用，或等值的安全检查，应放置在重写的方法。</p> 
 <h2> 声明</h2> 
 <p> 以下是java.lang.SecurityManager.checkAccess()方法的声明</p> 
 <pre class="prettyprint" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
public void checkAccess(ThreadGroup g)</pre> 
 <h2> 参数</h2> 
 <ul> 
  <li> <p> gt&nbsp;-- 要检查的线程。</p> </li> 
 </ul> 
 <h2> 返回值</h2> 
 <p> 此方法没有返回值。</p> 
 <h2> 异常</h2> 
 <ul> 
  <li> <p> SecurityException&nbsp;--&nbsp;如果调用线程没有权限修改线程组。</p> </li> 
  <li> <p> NullPointerException&nbsp;--&nbsp;如果线程组参数为null。</p> </li> 
 </ul> 
 <h2> 例子</h2> 
 <p> 我们的示例中，需要为每个命令的权限被阻止。一项新的规则文件设置，仅允许创建和安全管理器的设置。该文件位于C:/java.policy，包含以下文字：</p> 
 <pre class="prettyprint" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
grant {
  permission java.lang.RuntimePermission "setSecurityManager";
  permission java.lang.RuntimePermission "createSecurityManager";
  permission java.lang.RuntimePermission "usePolicy";
};</pre> 
 <p> 下面的例子显示lang.SecurityManager.checkAccess()方法的使用。</p>   
 <pre class="prettyprint" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
package com.yiibai;

public class SecurityManagerDemo extends SecurityManager {

   // check access needs to overriden
   @Override
   public void checkAccess(ThreadGroup a) {
      throw new SecurityException("Not allowed.");
   }

   public static void main(String[] args) {

      // set the policy file as the system securuty policy
      System.setProperty("java.security.policy", "file:/C:/java.policy");

      // create a security manager
      SecurityManagerDemo sm = new SecurityManagerDemo();

      // set the system security manager
      System.setSecurityManager(sm);

      // check if accepting access for thread group is enabled
      sm.checkAccess(new ThreadGroup("example"));

      // print a message if we passed the check
      System.out.println("Allowed!");
   }
}

</pre> 
 <p> 让我们来编译和运行上面的程序，这将产生以下结果：</p> 
 <pre class="prettyprint" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
Exception in thread "main" java.lang.SecurityException: Not allowed.</pre> 
 <br>      
</div></body></html>