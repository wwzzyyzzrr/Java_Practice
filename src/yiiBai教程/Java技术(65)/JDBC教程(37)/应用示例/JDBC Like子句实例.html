<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JDBC Like子句实例</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本教程将演示如何在JDBC应用程序中，从数据库表中查询数据记录， 在查询选择记录时使用Like子句添加其他条件。 在执行以下示例之前，请确保您已经准备好以下操作：</p> 
 <ul> 
  <li>具有数据库管理员权限，以在给定模式的数据库表中查询数据记录。 要执行以下示例，需要用实际用户名和密码替换这里用户名(<code>username</code>)和密码(<code>password</code>)。</li>
  <li>MySQL或数据库已启动并运行。</li>
 </ul> 
 <h2 id="h2-u6240u9700u6B65u9AA4"><a name="所需步骤" class="reference-link"></a><span class="header-link octicon octicon-link"></span>所需步骤</h2>
 <p>使用JDBC应用程序查询表中数据记录需要以下步骤：</p> 
 <ul> 
  <li><p><strong>导入包</strong>：需要包含包含数据库编程所需的JDBC类的包。 大多数情况下，使用<code>import java.sql.*</code>就足够了。</p> </li>
  <li><p><strong>注册JDBC驱动程序</strong>：需要初始化驱动程序，以便可以程序中打开数据库的通信通道。</p> </li>
  <li><p><strong>打开连接</strong>：需要使用<code>DriverManager.getConnection()</code>方法来创建一个<code>Connection</code>对象，它表示与数据库服务器的物理连接。</p> </li>
  <li><p><strong>执行查询</strong>：需要使用类型为<code>Statement</code>的对象来构建和提交SQL语句，以从满足给定条件的表中获取记录。 此查询使用<code>LIKE</code>子句来选择所有<code>first</code>字段的值包含“<code>y</code>”字母的学生信息。</p> </li>
  <li><p><strong>清理环境</strong>：需要明确地关闭所有数据库资源，而不依赖于JVM的垃圾收集。</p> </li>
 </ul> 
 <h2 id="h2-u793Au4F8Bu4EE3u7801"><a name="示例代码" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例代码</h2>
 <p>复制以下示例代码保存到文件：<em>SelectLikeClause.java</em>中，然后编译并运行如下 -</p> 
 <pre><code class="lang-java">//STEP 1. Import required packages
// See more detail at http://www.yiibai.com/jdbc/

import java.sql.*;

public class SelectLikeClause {
   // JDBC driver name and database URL
   static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";  
   static final String DB_URL = "jdbc:mysql://localhost/jdbc_db";

   //  Database credentials
   static final String USER = "root";
   static final String PASS = "123456";

   public static void main(String[] args) {
   Connection conn = null;
   Statement stmt = null;
   try{
      //STEP 2: Register JDBC driver
      Class.forName("com.mysql.jdbc.Driver");

      //STEP 3: Open a connection
      System.out.println("Connecting to a selected database...");
      conn = DriverManager.getConnection(DB_URL, USER, PASS);
      System.out.println("Connected database successfully...");

      //STEP 4: Execute a query
      System.out.println("Creating statement...");
      stmt = conn.createStatement();

      // Extract records without any condition.
      System.out.println("Fetching records without condition...");
      String sql = "SELECT id, first, last, age FROM student";
      ResultSet rs = stmt.executeQuery(sql);

      while(rs.next()){
         //Retrieve by column name
         int id  = rs.getInt("id");
         int age = rs.getInt("age");
         String first = rs.getString("first");
         String last = rs.getString("last");

         //Display values
         System.out.print("ID: " + id);
         System.out.print(", Age: " + age);
         System.out.print(", First: " + first);
         System.out.println(", Last: " + last);
      }

      // Select all records having ID equal or greater than 101
      System.out.println("Fetching records with condition...");
      sql = "SELECT id, first, last, age FROM student" +
                   " WHERE first LIKE '%y%' ";
      rs = stmt.executeQuery(sql);

      while(rs.next()){
         //Retrieve by column name
         int id  = rs.getInt("id");
         int age = rs.getInt("age");
         String first = rs.getString("first");
         String last = rs.getString("last");

         //Display values
         System.out.print("ID: " + id);
         System.out.print(", Age: " + age);
         System.out.print(", First: " + first);
         System.out.println(", Last: " + last);
      }
      rs.close();
   }catch(SQLException se){
      //Handle errors for JDBC
      se.printStackTrace();
   }catch(Exception e){
      //Handle errors for Class.forName
      e.printStackTrace();
   }finally{
      //finally block used to close resources
      try{
         if(stmt!=null)
            conn.close();
      }catch(SQLException se){
      }// do nothing
      try{
         if(conn!=null)
            conn.close();
      }catch(SQLException se){
         se.printStackTrace();
      }//end finally try
   }//end try
   System.out.println("Goodbye!");
}//end main
}//end JDBCExample
</code></pre> 
 <p>编译上面代码，如下 - </p>   
 <pre><code class="lang-shell">F:\worksp\jdbc&gt; javac -Djava.ext.dirs=F:\worksp\jdbc\libs SelectLikeClause.java
</code></pre> 
 <p>执行上面代码，如下 - </p> 
 <pre><code class="lang-shell">## 可先创建表或插入数据 -
## F:\worksp\jdbc&gt; java -Djava.ext.dirs=F:\worksp\jdbc\libs InsertRecords

F:\worksp\jdbc&gt;java -Djava.ext.dirs=F:\worksp\jdbc\libs SelectLikeClause
Connecting to a selected database...
Fri Jun 02 00:33:58 CST 2017 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn't set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to 'false'. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.
Connected database successfully...
Creating statement...
Fetching records without condition...
ID: 100, Age: 18, First: C++, Last: Li
ID: 101, Age: 25, First: Python, Last: Py
ID: 102, Age: 30, First: Ruby, Last: Ru
ID: 103, Age: 28, First: Java, Last: Ja
Fetching records with condition...
ID: 101, Age: 25, First: Python, Last: Py
ID: 102, Age: 30, First: Ruby, Last: Ru
Goodbye!

F:\worksp\jdbc&gt;
</code></pre> 
 <p>在执行上面语句后，可以看到只有 <code>first</code> 字段的值中包含有<code>y</code>字母的两条(ID为101和102)记录查询显示出来。</p>
 <br>      
</div></body></html>