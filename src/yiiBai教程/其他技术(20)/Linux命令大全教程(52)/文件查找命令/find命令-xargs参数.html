<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">find命令-xargs参数</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在使用 <code>find</code> 命令的<code>-exec</code>选项处理匹配到的文件时， <code>find</code>命令将所有匹配到的文件一起传递给<code>exec</code>执行。但有些系统对能够传递给<code>exec</code>的命令长度有限制，这样在<code>find</code>命令运行几分钟之后，就会出现溢出错误。错误信息通常是“参数列太长”或“参数列溢出”。这就是<code>xargs</code>命令的用处所在，特别是与<code>find</code>命令一起使用。 </p> 
 <p><code>find</code>命令把匹配到的文件传递给<code>xargs</code>命令，而<code>xargs</code>命令每次只获取一部分文件而不是全部，不像<code>-exec</code>选项那样。这样它可以先处理最先获取的一部分文件，然后是下一批，并如此继续下去。</p> 
 <p>在有些系统中，使用<code>-exec</code>选项会为处理每一个匹配到的文件而发起一个相应的进程，并非将匹配到的文件全部作为参数一次执行；这样在有些情况下就会出现进程过多，系统性能下降的问题，因而效率不高； 而使用<code>xargs</code>命令则只有一个进程。另外，在使用<code>xargs</code>命令时，究竟是一次获取所有的参数，还是分批取得参数，以及每一次获取参数的数目都会根据该命令的选项及系统内核中相应的可调参数来确定。<br>使用实例：</p> 
 <h3 id="h3--1-xargs-"><a name="实例1： 查找系统中的每一个普通文件，然后使用xargs命令来测试它们分别属于哪类文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例1： 查找系统中的每一个普通文件，然后使用xargs命令来测试它们分别属于哪类文件</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -type f -print | xargs file
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ ll
total 0
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log1.log
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log2020.log
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log3.log
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 20:43 log.log
[yiibai@localhost ~]$ find . -type f -print | xargs file
./.bash_logout:  ASCII text
./.bash_profile: ASCII text
./.bashrc:       ASCII text
./log.log:       empty
./log1.log:      empty
./log2.log:      empty
./log3.log:      empty
./log2018.log:   empty
./log2019.log:   empty
./log2020.log:   empty
</code></pre> 
 <h3 id="h3--2-core-dump-tmpcore-log-"><a name="实例2：在整个系统中查找内存信息转储文件(core dump) ，然后把结果保存到 tmpcore.log 文件中" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例2：在整个系统中查找内存信息转储文件(core dump) ，然后把结果保存到 tmpcore.log 文件中</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find / -name "core" -print | xargs echo "" &gt; /home/yiibai/tmpcore.log
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[root@localhost yiibai]# find / -name "core" -print | xargs echo "" &gt; /home/yiibai/tmpcore.log
[root@localhost yiibai]# cat tmpcore.log
 /dev/core /proc/sys/net/core /usr/lib/python2.7/site-packages/firewall/core /usr/lib/modules/3.10.0-514.el7.x86_64/kernel/drivers/infiniband/core /usr/lib/modules/3.10.0-514.el7.x86_64/kernel/drivers/memstick/core /usr/lib/modules/3.10.0-514.el7.x86_64/kernel/drivers/mmc/core /usr/lib/modules/3.10.0-514.el7.x86_64/kernel/drivers/net/ethernet/mellanox/mlx5/core /usr/lib/modules/3.10.0-514.el7.x86_64/kernel/net/core /usr/lib/modules/3.10.0-514.el7.x86_64/kernel/sound/core /usr/java/jdk1.8.0_121/lib/visualvm/platform/core /usr/java/jdk1.8.0_121/lib/visualvm/visualvm/core
[root@localhost yiibai]#
</code></pre> 
 <h3 id="h3--3-"><a name="实例3:在当前目录下查找所有用户具有读、写和执行权限的文件，并收回相应的写权限" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例3:在当前目录下查找所有用户具有读、写和执行权限的文件，并收回相应的写权限</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -perm -7 -print | xargs chmod o-w
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ ll
total 4
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log1.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log2020.log
-rwxrwxrwx. 1 yiibai yiibai  0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log3.log
-rwxrwxrwx. 1 yiibai yiibai  0 Feb 15 20:43 log.log
drwxrwxr-x. 7 yiibai yiibai 66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai  6 Feb 15 20:48 test3
drwxrwxr-x. 2 yiibai yiibai  6 Feb 15 20:48 test4
-rw-rw-r--. 1 yiibai yiibai  1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$ find . -perm -7 -print | xargs chmod o-w
[yiibai@localhost ~]$ ll
total 4
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log1.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai  0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  0 Feb 15 20:43 log3.log
-rwxrwxr-x. 1 yiibai yiibai  0 Feb 15 20:43 log.log
drwxrwxr-x. 7 yiibai yiibai 66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai  6 Feb 15 20:48 test3
drwxrwxr-x. 2 yiibai yiibai  6 Feb 15 20:48 test4
-rw-rw-r--. 1 yiibai yiibai  1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$
</code></pre> 
 <blockquote> 
  <p>说明：执行命令后，文件<code>log.log</code>和<code>log1.log</code>的权限都发生改变</p> 
 </blockquote> 
 <h2 id="h2--4-grep-spring-"><a name="实例4：用grep命令在所有的普通文件中搜索Spring这个词" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例4：用grep命令在所有的普通文件中搜索Spring这个词</h2>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -type f -print | xargs grep "Spring"
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ ll
total 16
-rw-rw-r--. 1 yiibai yiibai  464 Feb 15 20:58 log1.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai    0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  384 Feb 15 20:59 log3.log
-rwxrwxr-x. 1 yiibai yiibai 1197 Feb 15 20:58 log.log
drwxrwxr-x. 7 yiibai yiibai   66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai    6 Feb 15 20:48 test3
drwxrwxr-x. 2 yiibai yiibai    6 Feb 15 20:48 test4
-rw-rw-r--. 1 yiibai yiibai    1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$ find . -type f -print | xargs grep "Spring"
./log1.log:@SpringBootApplication
./log1.log:public class SpringBootConsoleApplication implements CommandLineRunner {
./log1.log:        SpringApplication.run(SpringBootConsoleApplication.class, args);
[yiibai@localhost ~]$
</code></pre> 
 <h3 id="h3--5-grep-import-"><a name="实例5：用grep命令在当前目录下的所有普通文件中搜索import这个词" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例5：用grep命令在当前目录下的所有普通文件中搜索import这个词</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -name \* -type f -print | xargs grep "import"
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ find . -name \* -type f -print | xargs grep "import"
./log1.log:import org.springframework.boot.CommandLineRunner;
./log3.log:import org.springframework.beans.factory.annotation.Value;
./log3.log:import org.springframework.stereotype.Service;
[yiibai@localhost ~]$
</code></pre> 
 <p>说明：注意，在上面的例子中， \用来取消find命令中的*在shell中的特殊含义。 </p> 
 <h3 id="h3--6-xargs-mv"><a name="实例6：使用xargs执行mv" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例6：使用xargs执行mv</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -name "*.txt" | xargs -i mv {} test4
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ ll
total 20
-rw-rw-r--. 1 yiibai yiibai  464 Feb 15 20:58 log1.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai    0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  384 Feb 15 20:59 log3.log
-rwxrwxr-x. 1 yiibai yiibai 1197 Feb 15 20:58 log.log
drwxrwxr-x. 7 yiibai yiibai   66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai    6 Feb 15 20:48 test3
drwxrwxr-x. 2 yiibai yiibai    6 Feb 15 20:48 test4
-rw-rw-r--. 1 yiibai yiibai   19 Feb 15 21:04 text.txt
-rw-rw-r--. 1 yiibai yiibai    1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$ find . -name "*.txt" | xargs -i mv {} test4
[yiibai@localhost ~]$ ll test4/
total 4
-rw-rw-r--. 1 yiibai yiibai 19 Feb 15 21:04 text.txt
[yiibai@localhost ~]$
</code></pre> 
 <h3 id="h3--7-find-xargs-xargs-argument-line-too-long-"><a name="实例7：find后执行xargs提示xargs: argument line too long解决方法：" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例7：find后执行xargs提示xargs: argument line too long解决方法：</h3>
 <p>命令：</p>   
 <pre><code class="lang-shell">find . -type f -atime +0 -print0 | xargs -0 -l1 -t rm -f
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ cd test4/
[yiibai@localhost test4]$
[yiibai@localhost test4]$
[yiibai@localhost test4]$ ll
total 4
-rw-rw-r--. 1 yiibai yiibai 19 Feb 15 21:04 text.txt
[yiibai@localhost test4]$ find . -type f -atime +0 -print0 | xargs -0 -l1 -t rm -f
rm -f
[yiibai@localhost test4]$
</code></pre> 
 <blockquote> 
  <p>说明：<code>-l1</code>是一次处理一个；<code>-t</code>是处理之前打印出命令</p> 
 </blockquote> 
 <h3 id="h3--8-i-i-txt-"><a name="实例8：使用-i参数默认的前面输出用{}代替，-I参数可以指定其他代替字符，如例子中的[]，把 *.txt 文件拷贝到上级目录中。" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例8：使用-i参数默认的前面输出用{}代替，-I参数可以指定其他代替字符，如例子中的[]，把 *.txt 文件拷贝到上级目录中。</h3>
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost test4]$ ll
total 4
-rw-rw-r--. 1 yiibai yiibai 19 Feb 15 21:04 text.txt
[yiibai@localhost test4]$ find . -name "*.txt" | xargs -I [] cp [] ..
[yiibai@localhost test4]$ ll
total 4
-rw-rw-r--. 1 yiibai yiibai 19 Feb 15 21:04 text.txt
[yiibai@localhost test4]$ cd ..
[yiibai@localhost ~]$ ll
total 20
-rw-rw-r--. 1 yiibai yiibai  464 Feb 15 20:58 log1.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai    0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  384 Feb 15 20:59 log3.log
-rwxrwxr-x. 1 yiibai yiibai 1197 Feb 15 20:58 log.log
drwxrwxr-x. 7 yiibai yiibai   66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai    6 Feb 15 20:48 test3
drwxrwxr-x. 2 yiibai yiibai   22 Feb 15 21:04 test4
-rw-rw-r--. 1 yiibai yiibai   19 Feb 15 21:08 text.txt
-rw-rw-r--. 1 yiibai yiibai    1 Feb 15 20:46 tmpcore.log
</code></pre> 
 <blockquote> 
  <p>说明：使用<code>-i</code>参数默认的前面输出用<code>{}</code>代替，<code>-I</code>参数可以指定其他代替字符，如例子中的<code>[]</code>。 </p> 
 </blockquote> 
 <h3 id="h3--9-xargs-p-"><a name="实例9：xargs的-p参数的使用" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例9：xargs的-p参数的使用</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -name "*.log" | xargs -p -i mv {} ..
</code></pre> 
 <p>演示执行及输出：</p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ ll
total 20
-rw-rw-r--. 1 yiibai yiibai  464 Feb 15 20:58 log1.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai    0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  384 Feb 15 20:59 log3.log
-rwxrwxr-x. 1 yiibai yiibai 1197 Feb 15 20:58 log.log
drwxrwxr-x. 7 yiibai yiibai   66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai   23 Feb 15 21:10 test3
drwxrwxr-x. 2 yiibai yiibai   22 Feb 15 21:04 test4
-rw-rw-r--. 1 yiibai yiibai   19 Feb 15 21:08 text.txt
-rw-rw-r--. 1 yiibai yiibai    1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$ pwd
/home/yiibai
[yiibai@localhost ~]$ ll
total 20
-rw-rw-r--. 1 yiibai yiibai  464 Feb 15 20:58 log1.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai    0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  384 Feb 15 20:59 log3.log
-rwxrwxr-x. 1 yiibai yiibai 1197 Feb 15 20:58 log.log
drwxrwxr-x. 7 yiibai yiibai   66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai   23 Feb 15 21:10 test3
drwxrwxr-x. 2 yiibai yiibai   22 Feb 15 21:04 test4
-rw-rw-r--. 1 yiibai yiibai   19 Feb 15 21:08 text.txt
-rw-rw-r--. 1 yiibai yiibai    1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$ ll test3/
total 0
-rw-rw-r--. 1 yiibai yiibai 0 Feb 15 21:10 test3.log
[yiibai@localhost ~]$ cd test3/
[yiibai@localhost test3]$ find . -name "*.log" | xargs -p -i mv {} ..
mv ./test3.log .. ?...y
[yiibai@localhost test3]$ ll
total 0
[yiibai@localhost test3]$ cd ..
[yiibai@localhost ~]$ ll
total 20
-rw-rw-r--. 1 yiibai yiibai  464 Feb 15 20:58 log1.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2018.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2019.log
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 20:43 log2020.log
-rwxrwxr-x. 1 yiibai yiibai    0 Feb 15 20:43 log2.log
-rw-rw-r--. 1 yiibai yiibai  384 Feb 15 20:59 log3.log
-rwxrwxr-x. 1 yiibai yiibai 1197 Feb 15 20:58 log.log
drwxrwxr-x. 7 yiibai yiibai   66 Feb 15 20:48 project
drwxrwxr-x. 2 yiibai yiibai    6 Feb 15 21:12 test3
-rw-rw-r--. 1 yiibai yiibai    0 Feb 15 21:10 test3.log
drwxrwxr-x. 2 yiibai yiibai   22 Feb 15 21:04 test4
-rw-rw-r--. 1 yiibai yiibai   19 Feb 15 21:08 text.txt
-rw-rw-r--. 1 yiibai yiibai    1 Feb 15 20:46 tmpcore.log
[yiibai@localhost ~]$
</code></pre> 
 <blockquote> 
  <p>说明：<code>-p</code>参数会提示确认是否执行后面的命令,<code>y</code>执行，<code>n</code>不执行。</p> 
 </blockquote>
 <br>      
</div></body></html>