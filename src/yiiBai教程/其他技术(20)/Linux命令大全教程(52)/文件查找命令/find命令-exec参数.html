<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">find命令-exec参数</h1><div style="width:100%;float:left;" class="article-content">   
 <p><strong>find</strong>是很常用的一个Linux命令，但是一般查找出来的并不仅仅是看看而已，还会有进一步的操作，这个时候<code>exec</code>的作用就显现出来了。<br><code>exec</code>解释：</p> 
 <ul> 
  <li><code>-exec</code> 参数后面跟的是<code>command</code>命令，它的终止是以;为结束标志的，所以这句命令后面的分号是不可缺少的，考虑到各个系统中分号会有不同的意义，所以前面加反斜杠。<br><code>{}</code>花括号代表前面<code>find</code>查找出来的文件名。</li>
 </ul> 
 <p>在使用<code>find</code>时，只要把想要的操作写在一个文件里，就可以用<code>exec</code>来配合<code>find</code>查找，很方便的。在有些操作系统中只允许<code>-exec</code>选项执行诸如<code>ls</code>或<code>ls -l</code>这样的命令。大多数用户使用这一选项是为了查找旧文件并删除它们。建议在真正执行<code>rm</code>命令删除文件之前，最好先用ls命令看一下，确认它们是所要删除的文件。 <code>exec</code>选项后面跟随着所要执行的命令或脚本，然后是一对<code>{ }</code>，一个空格和一个<code>\</code>，最后是一个分号。为了使用exec选项，必须要同时使用print选项。如果验证一下find命令，会发现该命令只输出从当前路径起的相对路径及文件名。</p> 
 <h3 id="h3--1-ls-l-find-exec-"><a name="实例1：ls -l命令放在find命令的-exec选项中" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例1：ls -l命令放在find命令的-exec选项中</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -type f -exec ls -l {} \;
</code></pre> 
 <p>演示执行及输出： </p> 
 <pre><code class="lang-shell">[root@localhost yiibai]# find . -type f -exec ls -l {} \;
-rw-r--r--. 1 yiibai yiibai 18 Aug  2  2016 ./.bash_logout
-rw-r--r--. 1 yiibai yiibai 193 Aug  2  2016 ./.bash_profile
-rw-r--r--. 1 yiibai yiibai 231 Aug  2  2016 ./.bashrc
-rw-rw-r--. 1 yiibai yiibai 30 Feb 13 03:14 ./test/mylog1.log
-rw-rw-r--. 1 yiibai yiibai 60 Feb 13 03:15 ./test/mylog2.log
-rw-rw-r--. 1 yiibai yiibai 49 Feb 13 03:20 ./test/log.txt
-rw-rw-r--. 1 yiibai yiibai 388 Feb 13 20:11 ./test/log.log
-rw-r--r--. 1 yiibai yiibai 11843 Feb 13 20:27 ./test/is line 1.
-rw-r--r--. 1 yiibai yiibai 3270 Feb 13 20:29 ./test/t
-rw-r--r--. 1 yiibai yiibai 11843 Feb 13 20:29 ./test/t test]$ cat log.log
-rw-rw-r--. 1 yiibai yiibai 229633 Feb 15 03:06 ./test/ping.log
-rw-rw-r--. 1 yiibai yiibai 9 Feb 12 22:46 ./test3/test4/test41/test.txt
-rw-rw-r--. 1 yiibai yiibai 26 Feb 13 01:15 ./test5/mylog.log
-rw-rw-r--. 1 yiibai yiibai 9 Feb 12 22:46 ./test5/test3/test4/test41/test.txt
-rw-rw-r--. 1 yiibai yiibai 0 Feb 13 01:26 ./mylog.log
-rw-rw-r--. 1 yiibai yiibai 9 Feb 12 22:46 ./test-noexists/test4/test41/test.txt
-rw-------. 1 yiibai yiibai 540 Feb 13 20:34 ./.lesshst
[root@localhost yiibai]#
</code></pre> 
 <p>说明： 上面的例子中，<code>find</code>命令匹配到了当前目录下的所有普通文件，并在<code>-exec</code>选项中使用<code>ls -l</code>命令将它们列出。</p> 
 <h3 id="h3--2-n-"><a name="实例2：在目录中查找更改时间在n日以前的文件并删除它们" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例2：在目录中查找更改时间在n日以前的文件并删除它们</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -type f -mtime +14 -exec rm {} \;
</code></pre> 
 <p>演示执行及输出： </p> 
 <pre><code class="lang-shell">[root@localhost yiibai]# ll
total 0
lrwxrwxrwx. 1 yiibai yiibai   9 Feb 13 01:26 mylog_link.log -&gt; mylog.log
-rw-rw-r--. 1 yiibai yiibai   0 Feb 13 01:26 mylog.log
drwxrwxr-x. 2 yiibai yiibai 143 Feb 15 02:16 test
drwxrwxr-x. 2 yiibai yiibai   6 Feb 12 22:33 test1
drwxrwxr-x. 2 yiibai yiibai   6 Feb 12 22:33 test2
drwxrwxr-x. 3 yiibai yiibai  19 Feb 12 22:58 test3
drwxrwxr-x. 3 yiibai yiibai  36 Feb 13 01:20 test5
drwxrwxr-x. 3 yiibai yiibai  19 Feb 12 22:58 test-noexists
[root@localhost yiibai]# find . -type f -mtime +2 -exec rm {} \;
</code></pre> 
 <blockquote> 
  <p>说明：在shell中用任何方式删除文件之前，应当先查看相应的文件，一定要小心！当使用诸如<code>mv</code>或<code>rm</code>命令时，可以使用<code>-exec</code>选项的安全模式。它将在对每个匹配到的文件进行操作之前提示。</p> 
 </blockquote> 
 <h3 id="h3--3-n-"><a name="实例3：在目录中查找更改时间在n日以前的文件并删除它们，在删除之前先给出提示" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例3：在目录中查找更改时间在n日以前的文件并删除它们，在删除之前先给出提示</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -name "*.log" -mtime +5 -ok rm {} \;
</code></pre> 
 <p>演示执行及输出： </p> 
 <pre><code class="lang-shell">[root@localhost test]# ll
总计 312
-rw-r--r-- 1 root root 302108 11-03 06:19 log2012.log
lrwxrwxrwx 1 root root      7 10-28 15:18 log_link.log -&gt; log.log
drwxr-xr-x 6 root root   4096 10-27 01:58 scf
drwxrwxrwx 2 root root   4096 11-12 19:32 test3
drwxrwxrwx 2 root root   4096 11-12 19:32 test4
[root@localhost test]# find . -name "*.log" -mtime +5 -ok rm {} \;
&lt; rm ... ./log_link.log &gt; ? y
&lt; rm ... ./log2012.log &gt; ? n
</code></pre> 
 <blockquote> 
  <p>说明：在上面的例子中， <code>find</code>命令在当前目录中查找所有文件名以<code>.log</code>结尾、更改时间在<code>5</code>日以上的文件，并删除它们，只不过在删除之前先给出提示。 按<code>y</code>键删除文件，按n键不删除。 </p> 
 </blockquote> 
 <h3 id="h3--4-exec-grep-"><a name="实例4：-exec中使用grep命令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例4：-exec中使用grep命令</h3>
 <p>命令：</p>   
 <pre><code class="lang-shell">find /etc -name "passwd*" -exec grep "root" {} \;
</code></pre> 
 <p>演示执行及输出： </p> 
 <pre><code class="lang-shell">[root@localhost yiibai]# find /etc -name "passwd*" -exec grep "root" {} \;
root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
[root@localhost yiibai]# find /etc -name "passwd*" -exec grep "yiibai" {} \;
yiibai:x:1000:1000:yiibai:/home/yiibai:/bin/bash
yiibai:x:1000:1000:yiibai:/home/yiibai:/bin/bash
[root@localhost yiibai]#
</code></pre> 
 <blockquote> 
  <p>说明：任何形式的命令都可以在<code>-exec</code>选项中使用。在上面的例子中我们使用<code>grep</code>命令。<code>find</code>命令首先匹配所有文件名为“<code>passwd*</code>”的文件，例如：<code>passwd</code>、<code>passwd.old</code>、<code>passwd.bak</code>，然后执行<code>grep</code>命令看看在这些文件中是否存在一个<code>root</code>和<code>yiibai</code>用户(需要以<code>root</code>用户身份操作)。</p> 
 </blockquote> 
 <h3 id="h3--5-"><a name="实例5：查找文件移动到指定目录" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例5：查找文件移动到指定目录</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -name "*.log" -exec mv {} .. \;
</code></pre> 
 <p>演示执行及输出： </p> 
 <pre><code class="lang-shell">[root@localhost yiibai]# find . -name "*.log" -exec mv {} .. \;
[root@localhost yiibai]# ls
test  test1  test2  test3  test5  test-noexists
[root@localhost yiibai]# cd ..
[root@localhost home]# ll
total 280
-rw-rw-r--. 1 yiibai yiibai    388 Feb 13 20:11 log.log
-rw-rw-r--. 1 yiibai yiibai     30 Feb 13 03:14 mylog1.log
-rw-rw-r--. 1 yiibai yiibai     60 Feb 13 03:15 mylog2.log
lrwxrwxrwx. 1 yiibai yiibai      9 Feb 13 01:26 mylog_link.log -&gt; mylog.log
-rw-rw-r--. 1 yiibai yiibai      0 Feb 15 20:15 mylog.log
-rw-rw-r--. 1 yiibai yiibai 229633 Feb 15 03:06 ping.log
-rw-r--r--. 1 yiibai yiibai  11843 Feb 13 20:29 t test]$ cat log.log
drwx------. 8 yiibai yiibai    128 Feb 15 20:21 yiibai
[root@localhost home]#
</code></pre> 
 <h3 id="h3--6-exec-cp-"><a name="实例6：用exec选项执行cp命令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例6：用exec选项执行cp命令</h3>
 <p>命令：</p> 
 <pre><code class="lang-shell">find . -name "*.log" -exec cp {} test3 \;
</code></pre> 
 <p>演示执行及输出： </p> 
 <pre><code class="lang-shell">[yiibai@localhost ~]$ ll
total 0
-rw-r--r--. 1 yiibai yiibai  0 Feb 15 20:23 file2.log
-rw-r--r--. 1 yiibai yiibai  0 Feb 15 20:23 file.log
drwxrwxr-x. 2 yiibai yiibai 48 Feb 15 20:21 test
drwxrwxr-x. 2 yiibai yiibai  6 Feb 12 22:33 test1
drwxrwxr-x. 2 yiibai yiibai  6 Feb 12 22:33 test2
drwxrwxr-x. 3 yiibai yiibai 19 Feb 12 22:58 test3
drwxrwxr-x. 3 yiibai yiibai 19 Feb 15 20:21 test5
drwxrwxr-x. 3 yiibai yiibai 19 Feb 12 22:58 test-noexists
[yiibai@localhost ~]$ ll test3/
total 0
drwxrwxr-x. 3 yiibai yiibai 20 Feb 12 22:46 test4
[yiibai@localhost ~]$ find . -name "*.log" -exec cp {} test3 \;
[yiibai@localhost ~]$ ll test3/
total 0
-rw-r--r--. 1 yiibai yiibai  0 Feb 15 20:28 file2.log
-rw-r--r--. 1 yiibai yiibai  0 Feb 15 20:28 file.log
drwxrwxr-x. 3 yiibai yiibai 20 Feb 12 22:46 test4
[yiibai@localhost ~]$
</code></pre>
 <br>      
</div></body></html>