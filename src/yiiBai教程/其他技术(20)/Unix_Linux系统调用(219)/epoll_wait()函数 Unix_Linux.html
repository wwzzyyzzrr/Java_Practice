<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">epoll_wait()函数 Unix/Linux</h1><div style="width:100%;float:left;" class="article-content">   
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> epoll_wait - 等待在 epoll 文件描述符的I/O事件</p> 
 <h1 class="manpages" style="font-weight: normal; font-size: 18px; line-height: 1.5; font-family: Calibri; margin-bottom: 0px; color: rgb(0, 0, 0);"> 内容简介</h1> 
 <pre style="font-family: 'Courier New', monospace; font-size: 12px; margin-bottom: 0px;">
#include 
  <sys epoll.h="">
    

int epoll_wait(int epfd, struct epoll_event * events, 
               int maxevents, int timeout); 

  </sys></pre> 
 <h1 class="manpages" style="font-weight: normal; font-size: 18px; line-height: 1.5; font-family: Calibri; margin-bottom: 0px; color: rgb(0, 0, 0);"> 描述</h1> 
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> Wait for events on the&nbsp;<b>epoll</b>&nbsp;file descriptor&nbsp;<i>epfd</i>&nbsp;for a maximum time of&nbsp;<i>timeout</i>milliseconds. The memory area pointed to by&nbsp;<i>events</i>&nbsp;will contain the events that will be available for the caller. Up to&nbsp;<i>maxevents</i>&nbsp;are returned by&nbsp;<b>epoll_wait</b>(2).</p> 
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> The&nbsp;<i>maxevents</i>&nbsp;parameter must be greater than zero. Specifying a&nbsp;<i>timeout</i>&nbsp;of -1 makes<b>epoll_wait</b>(2) wait indefinitely, while specifying a&nbsp;<i>timeout</i>&nbsp;equal to zero makes<b>epoll_wait</b>(2) to return immediately even if no events are available (return code equal to zero).</p> 
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> <i>struct epoll_event</i>&nbsp;的定义如下 :</p> 
 <pre style="font-family: 'Courier New', monospace; font-size: 12px; margin-bottom: 0px;">
    typedef union epoll_data {
        void *ptr;
        int fd;
        __uint32_t u32;
        __uint64_t u64;
    } epoll_data_t;


    struct epoll_event {
        __uint32_t events;      /* Epoll events */
        epoll_data_t data;      /* User data variable */
    };
</pre> 
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> The&nbsp;<i>data</i>&nbsp;of each returned structure will contain the same data the user set with a&nbsp;<b>epoll_ctl</b>(2)&nbsp;<i>(</i>EPOLL_CTL_ADD<i>,</i>EPOLL_CTL_MOD<i>)</i>&nbsp;while the&nbsp;<i>events</i>&nbsp;member will contain the returned event bit field.</p> 
 <h1 class="manpages" style="font-weight: normal; font-size: 18px; line-height: 1.5; font-family: Calibri; margin-bottom: 0px; color: rgb(0, 0, 0);"> 返回值</h1> 
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> When successful,&nbsp;<b>epoll_wait</b>(2) returns the number of file descriptors ready for the requested I/O, or zero if no file descriptor became ready during the requested&nbsp;<i>timeout</i>milliseconds. When an error occurs,&nbsp;<b>epoll_wait</b>(2) returns -1 and&nbsp;<i>errno</i>&nbsp;is set appropriately.</p> 
 <h1 class="manpages" style="font-weight: normal; font-size: 18px; line-height: 1.5; font-family: Calibri; margin-bottom: 0px; color: rgb(0, 0, 0);"> 错误</h1> 
 <table border="1" cellpadding="5" cellspacing="0" class="src" style="font-family: verdana, helvetica, arial, sans-serif; border: 1px solid rgb(170, 170, 170); width: 552px; background-color: rgb(241, 241, 241); border-collapse: collapse; padding-left: 5px; vertical-align: top; color: rgb(0, 0, 0);"> 
  <tbody> 
   <tr> 
    <th style="background-color: rgb(205, 205, 205); border-collapse: collapse; border: 1px solid rgb(170, 170, 170);" width="25%"> 标签</th> 
    <th style="background-color: rgb(205, 205, 205); border-collapse: collapse; border: 1px solid rgb(170, 170, 170);"> 描述</th> 
   </tr> 
   <tr valign="top"> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);"> <b>EBADF</b></td> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);" valign="bottom"> <i>epfd</i>&nbsp;is not a valid file descriptor.</td> 
   </tr> 
   <tr valign="top"> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);"> <b>EFAULT</b></td> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);" valign="bottom"> The memory area pointed to by&nbsp;<i>events</i>&nbsp;is not accessible with write permissions.</td> 
   </tr> 
   <tr valign="top"> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);"> <b>EINTR</b></td> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);" valign="bottom"> The call was interrupted by a signal handler before any of the requested events occurred or the&nbsp;<i>timeout</i>&nbsp;expired.</td> 
   </tr> 
   <tr valign="top"> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);"> <b>EINVAL</b></td> 
    <td style="vertical-align: top; margin-bottom: 0px; border-collapse: collapse; border: 1px solid rgb(170, 170, 170);" valign="bottom"> <i>epfd</i>&nbsp;is not an&nbsp;<b>epoll</b>&nbsp;file descriptor, or&nbsp;<i>maxevents</i>&nbsp;is less than or equal to zero.</td> 
   </tr> 
  </tbody> 
 </table> 
 <h1 class="manpages" style="font-weight: normal; font-size: 18px; line-height: 1.5; font-family: Calibri; margin-bottom: 0px; color: rgb(0, 0, 0);"> 遵循于</h1> 
 <p style="text-align: justify; font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> <b>epoll_wait</b>(2) is a new API introduced in Linux kernel 2.5.44. The interface should be finalized by Linux kernel 2.5.66.</p> 
 <h1 class="manpages" style="font-weight: normal; font-size: 18px; line-height: 1.5; font-family: Calibri; margin-bottom: 0px; color: rgb(0, 0, 0);"> 另请参阅</h1> 
 <ul style="font-family: verdana, helvetica, arial, sans-serif; color: rgb(0, 0, 0);"> 
  <li> <p style="text-align: justify;"> <a target="_blank" href="http://www.yiibai.com/unix_system_calls/epoll_create.html" style="color: rgb(144, 11, 9); background-color: transparent;">epoll_create (2)</a></p> </li> 
  <li> <p style="text-align: justify;"> <a target="_blank" href="http://www.yiibai.com/unix_system_calls/epoll_ctl.html" style="color: rgb(144, 11, 9); background-color: transparent;">epoll_ctl (2)</a></p> </li> 
 </ul> 
 <br>      
</div></body></html>