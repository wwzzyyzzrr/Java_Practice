<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">自托管消费WCF服务</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 消费自托管WCF服务的整个过程，一步步地解释以及充足的编码和屏幕截图是非常有必要。</p> 
 <p> 第1步：服务托管，现在我们需要实现的代理类客户端。创建代理的方式不同。</p> 
 <ul> 
  <li> 使用svcutil.exe，我们可以创建代理类和配置文件以及端点。</li> 
  <li> 添加服务引用到客户端应用程序。</li> 
  <li> 实现 ClientBase&lt;T&gt; 类</li> 
 </ul> 
 <p> 这三种方法，实现ClientBase&lt;T&gt;类是最好的做法。如果使用了两个rest方法，需要创建一个代理类，每一次当我们做出改变服务的实现。但是，这不是对ClientBase&lt;T&gt;类情况。这将创建代理只能在运行，所以它会打理一切。</p> 
 <p> 为此，创建一个代理类，其中包括refrencesof System.ServiceModel和MyCalculatorService。</p> 
 <center style="box-sizing: border-box; color: rgb(49, 49, 49); font-family: 'Open Sans', Arial, sans-serif; font-size: 14px; line-height: 22px;"> 
  <img alt="Consuming WCF that is Self hosted" src="/uploads/allimg/141111/0F540DF-0.png" style="box-sizing: border-box; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; padding-bottom: 10px; max-width: 100%;">
 </center> 
 <p style="box-sizing: border-box; color: rgb(0, 0, 0); line-height: 24px; margin: 0em 0.2em 1em; padding: 0px; text-align: justify; font-family: 'Open Sans', Arial, sans-serif; font-size: 14px;"> &nbsp;</p> 
 <pre class="prettyprint" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;
using MyCalculatorService;

namespace MyCalculatorServiceProxy
{
  Public class MyCalculatorServiceProxy : 
  //WCF create proxy for ISimpleCalculator using ClientBase
  ClientBase&lt;ISimpleCalculator&gt;,
  ISimpleCalculator
  {
     Public int Add(int num1, int num2)
     {
        //Call base to do funtion
        returnbase.Channel.Add(num1, num2);
     }
  }
}</pre> 
 <p> 现在，创建一个控制台应用程序，其中包括System.ServiceModel和MyCalculatorServiceProxy的参考。</p> 
 <center style="box-sizing: border-box; color: rgb(49, 49, 49); font-family: 'Open Sans', Arial, sans-serif; font-size: 14px; line-height: 22px;"> 
  <img alt="Consuming WCF that is Self hosted" src="/uploads/allimg/141111/0F5401311-1.png" style="box-sizing: border-box; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; padding-bottom: 10px; max-width: 100%;">
 </center> 
 <p style="box-sizing: border-box; color: rgb(0, 0, 0); line-height: 24px; margin: 0em 0.2em 1em; padding: 0px; text-align: justify; font-family: 'Open Sans', Arial, sans-serif; font-size: 14px;"> &nbsp;</p> 
 <pre class="prettyprint" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;
using MyCalculatorServiceProxy;

namespace MyCalculatorServiceClient
{
  classProgram
  {
     Static void Main(string[] args)
     {
        MyCalculatorServiceProxy.MyCalculatorServiceProxy proxy = newMyCalculatorServiceProxy.MyCalculatorServiceProxy();
        Console.WriteLine("Client is running at " + DateTime.Now.ToString());
        Console.WriteLine("Sum of two numbers... 5+5 =" + proxy.Add(5, 5));
        Console.ReadLine();
     }
  }
}</pre> 
 <p> <strong>步骤2：</strong>结束点(相同服务)的信息应该被添加到客户端应用程序的配置文件。</p>   
 <pre class="prettyprint notranslate" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
&lt;?xmlversion="1.0"encoding="utf-8" ?&gt;
&lt;configuration&gt;
  &lt;system.serviceModel&gt;
	 &lt;client&gt;
		&lt;endpoint address ="http://localhost:8090/MyCalculatorServiceProxy/ISimpleCalculator"
				binding ="wsHttpBinding"
				contract ="MyCalculatorServiceProxy.ISimpleCalculator"&gt;
        &lt;/endpoint&gt;
     &lt;/client&gt;
  &lt;/system.serviceModel&gt;
&lt;/configuration&gt;</pre> 
 <p> <strong>步骤3：</strong>运行客户端应用程序之前，需要运行的服务。客户端应用程序的输出如下所示。</p> 
 <center style="box-sizing: border-box; color: rgb(49, 49, 49); font-family: 'Open Sans', Arial, sans-serif; font-size: 14px; line-height: 22px;"> 
  <img alt="Consuming WCF that is Self hosted" src="/uploads/allimg/141111/0F5405E7-2.png" style="box-sizing: border-box; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; padding-bottom: 10px; max-width: 100%;">
 </center> 
 <br>      
</div></body></html>