<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Yii视图</h1><div style="width:100%;float:left;" class="article-content">   
 <div> 
  <div>
    视图是负责将数据呈现给最终用户。在Web应用程序，视图只是一个PHP脚本文件，它包含HTML和PHP代码。 
  </div> 
 </div> 
 <div> 
  <h2> 
   <div>
     创建视图 
   </div> </h2> 
  <div>
    第1步&nbsp;-&nbsp;让我们来看看基本的应用程序模板里的“About”视图。 
  </div> 
  <pre>&lt;?php
   /* @var $this yii\web\View */
   use yii\helpers\Html;
   $this-&gt;title = 'About';
   $this-&gt;params['breadcrumbs'][] = $this-&gt;title;
?&gt;
&lt;div class="site-about"&gt;
   &lt;h1&gt;&lt;?= Html::encode($this-&gt;title) ?&gt;&lt;/h1&gt;
   &lt;p&gt;
      This is the About page. You may modify the following file to customize its content:
   &lt;/p&gt;
   &lt;code&gt;&lt;?= __FILE__ ?&gt;&lt;/code&gt;
&lt;/div&gt;</pre> 
  <div>
    $this&nbsp;变量是引用视图组件负责管理和渲染此视图模板。 
  </div> 
  <div>
    下面是&nbsp;“About”&nbsp;页面的样子，访问地址：&nbsp;
   <a target="_blank" href="http://localhost:8080/index.php?r=site/about">http://localhost:8080/index.php?r=site/about</a>
   <span>&nbsp;</span>
   <br> 
   <img src="/uploads/tutorial/20160519/1-160519210001D9.png" alt="">
   <br> 
  </div> 
  <p style="text-align:justify;"> 进行编码和/或为了过滤从最终用户来的数据以避免XSS攻击。应该通过调用&nbsp;yii\helpers\Html::encode()&nbsp;编码纯文本，<br> 以及调用&nbsp;yii\helpers\HtmlPurifier&nbsp;过滤HTML内容。 </p> 
  <div>
    第2步&nbsp;-&nbsp;按以下方式修改&nbsp;“About”&nbsp;视图。
   <br> 
  </div> 
  <pre>&lt;?php
   /* @var $this yii\web\View */
   use yii\helpers\Html;
   use yii\helpers\HtmlPurifier;
   $this-&gt;title = '关于我们';
   $this-&gt;params['breadcrumbs'][] = $this-&gt;title;
?&gt;
&lt;div class="site-about"&gt;
   &lt;h1&gt;&lt;?= Html::encode($this-&gt;title) ?&gt;&lt;/h1&gt;
   &lt;p&gt;
      This is the About page. You may modify the following file to customize its content:
   &lt;/p&gt;
   &lt;p&gt;
      &lt;?= Html::encode("&lt;script&gt;alert('alert!');&lt;/script&gt;&lt;h1&gt;ENCODE EXAMPLE&lt;/h1&gt;&gt;") ?&gt;
   &lt;/p&gt;
   &lt;p&gt;
      &lt;?= HtmlPurifier::process("&lt;script&gt;alert('alert!');&lt;/script&gt;&lt;h1&gt; HtmlPurifier EXAMPLE&lt;/h1&gt;") ?&gt;
   &lt;/p&gt;
   &lt;code&gt;&lt;?= __FILE__ ?&gt;&lt;/code&gt;
&lt;/div&gt;</pre> 
  <div>
    第3步-&nbsp;现在打开浏览器并输入URL=&gt;&nbsp;
   <a target="_blank" href="http://localhost:8080/index.php?r=site/about">http://localhost:8080/index.php?r=site/about</a>&nbsp;,&nbsp;将看到以下画面。
   <br> 
   <img src="/uploads/tutorial/20160519/1-160519210030C5.png" width="689" height="449" title="Yii视图" alt="Yii视图">
   <br> 
  </div> 
  <p style="text-align:justify;"> 请注意，Html::encode()函数中的JavaScript代码过滤后显示为纯文本。HtmlPurifier::process()调用后，只有h1标签显示。 </p> 
  <div>
    视图遵守这些约定&nbsp;- 
  </div> 
  <ul> 
   <li> 
    <div>
      视图是由控制器提供的，应该放在@app/views/controllerID文件夹中。 
    </div> </li> 
   <li> 
    <div>
      视图是一个小窗口渲染呈现，应放入&nbsp;widgetPad/&nbsp;views&nbsp;文件夹。 
    </div> </li> 
  </ul> 
  <div>
    要渲染控制器中的视图，可以使用下面的方法 - 
  </div> 
  <ul> 
   <li> <p style="text-align:justify;"> render()&nbsp;−&nbsp;渲染一个视图，并应用布局 </p> </li> 
   <li> <p style="text-align:justify;"> renderPartial()&nbsp;−&nbsp;渲染视图，但不使用布局 </p> </li> 
   <li> <p style="text-align:justify;"> renderAjax()&nbsp;−&nbsp;渲染视图但不使用布局，但所有的注入JS和CSS文件 </p> </li> 
   <li> <p style="text-align:justify;"> renderFile()&nbsp;−&nbsp;在一个给定的文件路径或别名来渲染视图 </p> </li> 
   <li> <p style="text-align:justify;"> renderContent()&nbsp;−&nbsp;渲染一个静态字符串并应用布局 </p> </li> 
  </ul> 
  <div>
    要渲染其他视图中的视图，您可以使用下面的方法&nbsp;- 
  </div> 
  <ul> 
   <li> <p style="text-align:justify;"> render()&nbsp;−&nbsp;渲染一个视图。 </p> </li> 
   <li> <p style="text-align:justify;"> renderAjax()&nbsp;−&nbsp;渲染视图但不使用布局，但所有的注入JS和CSS文件。 </p> </li> 
   <li> <p style="text-align:justify;"> renderFile()&nbsp;−&nbsp;在一个给定的文件路径或别名来渲染视图。 </p> </li> 
  </ul> 
  <p style="text-align:justify;"> 第4步&nbsp;-&nbsp;在&nbsp;views/site&nbsp;文件夹里边，创建两个视图文件：&nbsp;<em>_view</em><em>1</em>.php 和 <em>_view2</em>.php </p> 
  <p style="font-family:Verdana, Geneva, Tahoma,  Helvetica, text-align:justify;font-size:15px !important;background-color:inherit;"> <b>_view1.php</b>&nbsp;− </p> 
  <pre>&lt;h1&gt;这是视图 - _view1.php 的内容&lt;/h1&gt;</pre> 
  <p style="font-family:Verdana, Geneva, Tahoma,  Helvetica, text-align:justify;font-size:15px !important;background-color:inherit;"> <b>_view2.php</b>&nbsp;− </p> 
  <pre>&lt;h1&gt;这是视图 - _view2.php 的内容&lt;/h1&gt;</pre> 
  <div>
    第5步&nbsp;-&nbsp;最扣渲染&nbsp;“About”&nbsp;视图中这两个新创建的视图。 
  </div> 
  <pre>&lt;?php
   /* @var $this yii\web\View */
   use yii\helpers\Html;
   $this-&gt;title = '关于我们';
   $this-&gt;params['breadcrumbs'][] = $this-&gt;title;
?&gt;
&lt;div class="site-about"&gt;
   &lt;h1&gt;&lt;?= Html::encode($this-&gt;title) ?&gt;&lt;/h1&gt;
   &lt;p&gt;
      This is the About page. You may modify the following file to customize its content:
   &lt;/p&gt;
   &lt;?= $this-&gt;render("_view1") ?&gt;
   &lt;?= $this-&gt;render("_view2") ?&gt;
   &lt;code&gt;&lt;?= __FILE__ ?&gt;&lt;/code&gt;
&lt;/div&gt;</pre> 
  <div>
    你会看到下面的输出&nbsp;-
   <br> 
   <img src="/uploads/tutorial/20160519/1-160519210102641.png" alt="">
   <br> 
  </div> 
  <p style="text-align:justify;"> 当渲染视图，可以使用视图名称或视图文件的路径/别名来定义视图。视图名称解析按以下方式&nbsp;- </p> 
  <ul> 
   <li> 
    <div>
      视图名可以省略扩展名。例如，about&nbsp;对应于 about.php 文件。 
    </div> </li> 
   <li> <p style="text-align:justify;"> 如果视图名称开头“/”，那么，如果当前活动的模块是forum，视图名为comment/post，路径将是&nbsp;@app/modules/forum/views/comment/post。如果没有活动的模块，路径将是@app/views/comment/post。 </p> </li> 
   <li> <p style="text-align:justify;"> 如果视图名称以“//”开头，对应的路径是@app/views/ViewName。例如，//site/contact&nbsp;对应于@app/views/site/contact.php </p> </li> 
   <li> 
    <div>
      如果视图名称是contact，并在上下文控制器是&nbsp;SiteController，那么路径将是&nbsp;@app/views/site/contact.php。 
    </div> </li> 
   <li> <p style="text-align:justify;"> 如果&nbsp;price&nbsp;视图要在&nbsp;goods&nbsp;视图中渲染，那么，如果它在&nbsp;@app/views/invoice/goods.php&nbsp;渲染，那么&nbsp;price&nbsp;会被解析为&nbsp;@app/views/invoice/price.php&nbsp;。 </p> </li> 
  </ul> 
  <h2> 
   <div>
     在视图中访问数据 
   </div> </h2> 
  <div>
    要在视图中访问数据，需要通过方法的第二个参数将数据传递到视图中渲染。 
  </div> 
  <div>
    第1步-&nbsp;修改&nbsp;SiteController&nbsp;中的&nbsp;actionAbout&nbsp;函数。 
  </div>   
  <pre>public function actionAbout() {
   $email = "admin@yiibai.com";
   $phone = "13800138000";
   return $this-&gt;render('about',[
      'email' =&gt; $email,
      'phone' =&gt; $phone
   ]);
}</pre> 
  <div>
    在上面的代码中，我们传递了两个变量：$email和$phone&nbsp;到&nbsp;About&nbsp;视图渲染。 
  </div> 
  <div>
    第2步-&nbsp;更改 view/site/about.php 视图代码。 
  </div> 
  <pre>&lt;?php
   /* @var $this yii\web\View */
   use yii\helpers\Html;
   $this-&gt;title = '关于我们';
   $this-&gt;params['breadcrumbs'][] = $this-&gt;title;
?&gt;
&lt;div class = "site-about"&gt;
   &lt;h1&gt;&lt;?= Html::encode($this-&gt;title) ?&gt;&lt;/h1&gt;
   &lt;p&gt;
      This is the About page. You may modify the following file to customize its content:
   &lt;/p&gt;
   &lt;p&gt;
      &lt;b&gt;email:&lt;/b&gt; &lt;?= $email ?&gt;
   &lt;/p&gt;
   &lt;p&gt;
      &lt;b&gt;phone:&lt;/b&gt; &lt;?= $phone ?&gt;
   &lt;/p&gt;
   &lt;code&gt;&lt;?= __FILE__ ?&gt;&lt;/code&gt;
&lt;/div&gt;</pre> 
  <div>
    我们刚刚添加了从&nbsp;SiteController&nbsp;收到的两个变量。 
  </div> 
  <div>
    第3步&nbsp;-&nbsp;输入URL在Web浏览器中：
   <a target="_blank" href="http://localhost:8080/index.php?r=site/about">http://localhost:8080/index.php?r=site/about</a>，将看到以下给出结果 
  </div> 
 </div> 
 <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;"> 
  <img src="/uploads/tutorial/20160519/1-160519210132235.png" alt="">
  <br> 
 </div>
 <br>      
</div></body></html>