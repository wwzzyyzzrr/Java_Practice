<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Yii模块(Modules)</h1><div style="width:100%;float:left;" class="article-content">   
 <div> 
  <div>
    模块是一个有自己的模型，视图，控制器以及其它模块的实体。这实际上是在应用程序内的应用程序。 
  </div> 
 </div> 
 <div> 
  <p style="text-align:justify;"> 第1步-&nbsp;在你的项目根目录内创建一个&nbsp;modules&nbsp;文件夹。在&nbsp;modules&nbsp;文件夹内创建一个名为 admin 的文件夹。这是 admin 模块的基本文件夹。 </p> 
  <div>
    第2步&nbsp;-&nbsp;在&nbsp;admin 文件夹里边，使用以下代码来创建 Admin.php 文件。 
  </div> 
  <pre>&lt;?php
   namespace app\modules\admin;
   class Admin extends \yii\base\Module {
      public function init() {
         parent::init();
      }
   }
?&gt;&nbsp;</pre> 
  <p style="text-align:justify;"> 我们刚刚创建了一个模块类。它位于模块根路径下。每一次模块被访问时，将创建对应的模块类的一个实例。init()函数用于初始化模块的属性。 </p> 
  <p style="text-align:justify;"> 第3步&nbsp;-&nbsp;现在，在&nbsp;admin文件夹内添加两个目录-&nbsp;controllers&nbsp;和&nbsp;views。添加&nbsp;CustomController.php&nbsp;文件到控制器的文件夹中。 </p> 
  <pre>&lt;?php
   namespace app\modules\admin\controllers;
   use yii\web\Controller;
   class CustomController extends Controller {
      public function actionGreet() {
         return $this-&gt;render('greet');
      }
   }
?&gt;&nbsp;</pre> 
  <p style="text-align:justify;"> 当创建一个模块，惯例是把控制器类到模块根路径的&nbsp;controllers&nbsp;目录。我们刚才定义的actionGreet函数，只返回一个&nbsp;greet&nbsp;视图。 </p> 
  <p style="text-align:justify;"> 在模块中视图应该放在模块基本路径的&nbsp;views&nbsp;文件夹中。如果视图是由控制器呈现，那么它们应位于对应于该控制器ID的文件夹中。将&nbsp;custom&nbsp;文件夹添加到&nbsp;views&nbsp;文件夹。 </p> 
  <div>
    第4步&nbsp;-&nbsp;在 custom&nbsp;目录里创建一个名为&nbsp;greet.php&nbsp;文件并使用下面的代码。 
  </div> 
  <pre>&lt;h1&gt;Hello,这是一个自定义模块!&lt;/h1&gt;&nbsp;</pre> 
  <p style="text-align:justify;"> 我们刚刚创建了&nbsp;actionGreet&nbsp;视图。要在模块中使用这个新创建文件，我们还应该配置应用程序。我们应该将模块添加到应用程序的模块属性中。 </p> 
  <div>
    第5步&nbsp;-&nbsp;修改&nbsp;config/web.php&nbsp;文件，如下。 
  </div> 
  <pre>&lt;?php
   $params = require(__DIR__ . '/params.php');
   $config = [
      'id' =&gt; 'basic',
      'basePath' =&gt; dirname(__DIR__),
      'bootstrap' =&gt; ['log'],
      'components' =&gt; [
         'request' =&gt; [
            // !!! insert a secret key in the following (if it is empty) - this is
               //required by cookie validation
            'cookieValidationKey' =&gt; 'Yia-yiibai.com',
         ],
         'cache' =&gt; [
            'class' =&gt; 'yii\caching\FileCache',
         ],
         'user' =&gt; [
            'identityClass' =&gt; 'app\models\User',
            'enableAutoLogin' =&gt; true,
         ],
         'errorHandler' =&gt; [
            'errorAction' =&gt; 'site/error',
         ],
         'mailer' =&gt; [
            'class' =&gt; 'yii\swiftmailer\Mailer',
            // send all mails to a file by default. You have to set
            // 'useFileTransport' to false and configure a transport
            // for the mailer to send real emails.
            'useFileTransport' =&gt; true,
         ],
         'log' =&gt; [
            'traceLevel' =&gt; YII_DEBUG ? 3 : 0,
            'targets' =&gt; [
               [
                  'class' =&gt; 'yii\log\FileTarget',
                  'levels' =&gt; ['error', 'warning'],
               ],
            ],
         ],
         'db' =&gt; require(__DIR__ . '/db.php'),
      ],
      'modules' =&gt; [
         'admin' =&gt; [
            'class' =&gt; 'app\modules\admin\Admin', 
         ],
      ],
      'params' =&gt; $params,
   ];
   if (YII_ENV_DEV) {
      // configuration adjustments for 'dev' environment
      $config['bootstrap'][] = 'debug';
      $config['modules']['debug'] = [
         'class' =&gt; 'yii\debug\Module',
      ];
      $config['bootstrap'][] = 'gii';
      $config['modules']['gii'] = [
         'class' =&gt; 'yii\gii\Module',
      ];
   }
   return $config;
?&gt;</pre> 
  <div>
    模块的控制器路由必须使用模块ID开始，后面控制器ID和动作ID。 
  </div> 
  <div>
    第6步&nbsp;- 如要在应用程序运行 actionGreet，应该使用下面的路由 
  </div>   
  <pre>admin/custom/greet</pre> 
  <div>
    在这里，admin 就是一个模块ID，custom&nbsp;是控制器ID和&nbsp;greet&nbsp;就是一个动作ID。 
  </div> 
  <div>
    第7步-&nbsp;现在，键入URL访问：&nbsp;
   <a target="_blank" href="http://localhost:8080/index.php?r=admin/custom/greet">http://localhost:8080/index.php?r=admin/custom/greet</a>，就会看到下面的输出结果了。
   <br> 
   <img src="/uploads/tutorial/20160519/1-160519205HIH.png" alt="">
   <br> 
  </div> 
  <h2> 要点 </h2> 
  <p style="text-align:justify;"> 模块(Modules)应该 − </p> 
  <ul> 
   <li> 
    <div>
      在大型应用程序中。应划分其功能分成几个应用组。每个应用功能组可以作为一个模块开发。 
    </div> </li> 
   <li> 
    <div>
      可重复使用。一些常用的功能，如搜索引擎优化管理或博客的管理，可以开发成模块，这样在今后的项目中很容易地重用它们。 
    </div> </li> 
  </ul> 
 </div>
 <br>      
</div></body></html>