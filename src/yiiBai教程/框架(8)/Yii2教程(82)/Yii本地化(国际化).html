<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Yii本地化(国际化)</h1><div style="width:100%;float:left;" class="article-content">   
 <div>
   I18N(国际化)是设计一种能够适应于各种语言的应用程序的过程。&nbsp;Yii 中提供了国际化支持。 
 </div> 
 <div> 
  <div>
    语言环境(Locale)是一组参数用来指定用户的语言和国家。例如，en-US代表的是英语语言环境和国家是美国。 
  </div> 
  <div>
    Yii提供两种类型的语言：源语言和目标语言。源语言是在应用程序中的所有文本消息的语言。目标语言是应用于显示内容到最终用户的语言。 
  </div> 
  <div>
    消息转换组件是可从源语言到目标语言翻译(转换)的文本消息。 
  </div> 
  <div>
    要翻译文本消息，文本消息翻译服务必须在消息源中找到它。 
  </div> 
  <div>
    要使用文本消息翻译服务，应该&nbsp;- 
  </div> 
  <ul> 
   <li> 
    <div>
      包裹想要翻译文本消息在&nbsp;Yii::t()&nbsp;方法中 
    </div> </li> 
   <li> 配置文本消息源 </li> 
   <li> 储存文本消息在消息源中 </li> 
  </ul> 
  <div>
    第1步&nbsp;-&nbsp;Yii::t()&nbsp;方法可以像这样使用，如下所示： 
  </div> 
  <pre>echo \Yii::t('app', 'This is a message to translate!');</pre> 
  <div>
    在上面的代码片段中，'app'&nbsp;代表文本消息的类别 
  </div> 
  <div>
    第2步&nbsp;-&nbsp;现在，修改&nbsp;config/web.php&nbsp;文件。 
  </div> 
  <pre>&lt;?php
   $params = require(__DIR__ . '/params.php');
   $config = [
      'id' =&gt; 'basic',
      'basePath' =&gt; dirname(__DIR__),
      'bootstrap' =&gt; ['log'],
      'components' =&gt; [
         'request' =&gt; [
            // !!! insert a secret key in the following (if it is empty) - this
               //is required by cookie validation
            'cookieValidationKey' =&gt; 'the-cookie-validate-key-of-yiibai.com',
         ],
         'cache' =&gt; [
            'class' =&gt; 'yii\caching\FileCache',
         ],
         'i18n' =&gt; [
            'translations' =&gt; [
               'app*' =&gt; [
                  'class' =&gt; 'yii\i18n\PhpMessageSource',
                  'fileMap' =&gt; [
                     'app' =&gt; 'app.php'
                  ],
               ],
            ],
         ],
         'user' =&gt; [
            'identityClass' =&gt; 'app\models\User',
            'enableAutoLogin' =&gt; true,
         ],
         'errorHandler' =&gt; [
            'errorAction' =&gt; 'site/error',
         ],
         'mailer' =&gt; [
            'class' =&gt; 'yii\swiftmailer\Mailer',
            // send all mails to a file by default. You have to set
            // 'useFileTransport' to false and configure a transport
            // for the mailer to send real emails.
            'useFileTransport' =&gt; true,
         ],
         'log' =&gt; [
            'flushInterval' =&gt; 1,
            'traceLevel' =&gt; YII_DEBUG ? 3 : 0,
            'targets' =&gt; [
               [
                  'class' =&gt; 'yii\log\FileTarget',
                  'exportInterval' =&gt; 1,
                  'logVars' =&gt; [],
               ],
            ],
         ],
         'db' =&gt; require(__DIR__ . '/db.php'),
      ],
      // set target language to be Chinese
      'language' =&gt; 'zh-CN',
      // set source language to be English
      'sourceLanguage' =&gt; 'en-US',
      'modules' =&gt; [
         'hello' =&gt; [
            'class' =&gt; 'app\modules\hello\Hello',
         ],
      ],
      'params' =&gt; $params,
   ];
   if (YII_ENV_DEV) {
      // configuration adjustments for 'dev' environment
      $config['bootstrap'][] = 'debug';
      $config['modules']['debug'] = [
         'class' =&gt; 'yii\debug\Module',
      ];
      $config['bootstrap'][] = 'gii';
      $config['modules']['gii'] = [
         'class' =&gt; 'yii\gii\Module',
      ];
   }
   return $config;
?&gt;</pre> 
  <div>
    在上面的代码中，我们定义了源和目标语言。 
  </div> 
  <div>
    还指定是由&nbsp;yii\i18n\PhpMessageSource&nbsp;来支持消息源。 
  </div> 
  <div>
    app*&nbsp;模式表示所有消息开始程式类别必须使用这种特殊的消息源进行翻译(转换)。 
  </div> 
  <div>
    在上面的配置中，所有中文翻译将设在&nbsp;messages/zh-CN/app.php&nbsp;文件。
   <br> 
   <img src="/uploads/tutorial/20160606/1-160606203I4305.png" alt="">
   <br> 
  </div> 
  <div>
    第3步&nbsp;-&nbsp;现在，创建&nbsp;messages/zh-CN&nbsp;的目录结构。在&nbsp;zh-CN&nbsp;文件夹中创建一个文件：app.php&nbsp;。这将存储所有&nbsp;EN&nbsp;→&nbsp;CN&nbsp;的翻译文本消息。 
  </div> 
  <pre>&lt;?php
   return [
      'This is a string to translate' =&gt; '这是一个翻译的字符串'
   ];
?&gt;</pre> 
  <div>
    第4步&nbsp;-&nbsp;在SiteController&nbsp;中创建一个&nbsp;actionTranslation()&nbsp;函数。 
  </div>   
  <pre>public function actionTranslation() {
   echo \Yii::t('app', 'This is a string to translate');
}</pre> 
  <div>
    第5步&nbsp;-&nbsp;在Web浏览器访问URL&nbsp;
   <a target="_blank" href="http://localhost:8080/index.php?r=site/translation">http://localhost:8080/index.php?r=site/translation</a>&nbsp;，会将看到以下内容。
   <br> 
   <img src="/uploads/tutorial/20160606/1-160606203P1O0.png" alt="">
   <br> 
  </div> 
  <div>
    该文本消息会被翻译成中文，因为设定的目标语言是&nbsp;zh-CN。我们也可以动态地改变应用程序的语言。 
  </div> 
  <div>
    第6步&nbsp;-&nbsp;修改&nbsp;actionTranslation()&nbsp;方法，如下代码。 
  </div> 
  <pre>public function actionTranslation() {
   \Yii::$app-&gt;language = 'en-US';
   echo \Yii::t('app', 'This is a string to translate!');
}</pre> 
  <div>
    现在，以英文显示文本消息&nbsp;-
   <br> 
   <img src="/uploads/tutorial/20160606/1-160606203R6313.png" alt="">
   <br> 
  </div> 
  <div> 
   <div>
     第7步&nbsp;-&nbsp;在一个转换(翻译)的消息，可以插入一个或多个参数。 
   </div> 
  </div> 
  <pre>public function actionTranslation() {
   $username = 'Username1';
   // display a translated message with username being "Vladimir"
   echo \Yii::t('app', 'Hello, {username}!', [
      'username' =&gt; $username,
   ]), "&lt;br&gt;";
   $username = 'username2';
   // display a translated message with username being "John"
   echo \Yii::t('app', 'Hello, {username}!', [
      'username' =&gt; $username,
   ]), "&lt;br&gt;";
   $price = 150;
   $count = 3;
   $subtotal = 450;
   echo \Yii::t('app', 'Price: {0}, Count: {1}, Subtotal: {2}', [$price, $count, $subtotal]);
}</pre> 
  <div>
    以下是输出结果：
   <br> 
   <img src="/uploads/tutorial/20160606/1-160606203T63W.png" width="610" height="220" title="Yii本地化(国际化)" alt="Yii本地化(国际化)">
   <br> 
  </div> 
  <div>
    可以翻译整个视图脚本，而不是单独的翻译文本消息。例如，如果目标语言是zh-CN，想翻译是&nbsp;views/site/index.php&nbsp;视图文件， 
  </div> 
  <div>
    那么应该翻译视图并保存在&nbsp;views/site/zh-CN&nbsp;目录下。 
  </div> 
  <div>
    第8步&nbsp;-&nbsp;创建&nbsp;views/site/zh-CN&nbsp;目录。 
  </div> 
  <div>
    然后，zh-CN&nbsp;文件夹中创建一个&nbsp;index.php&nbsp;文件并使用下面的代码。 
  </div> 
  <pre>&lt;?php
   /* @var $this yii\web\View */
   $this-&gt;title = 'My Yii Application';
?&gt;

&lt;div class = "site-index"&gt;
   &lt;div class = "jumbotron"&gt;
      &lt;h1&gt;欢迎您访问!&lt;/h1&gt;
   &lt;/div&gt;
&lt;/div&gt;</pre> 
  <div>
    第9步&nbsp;-&nbsp;目标语言是zh-CN，所以访问URL：
   <a target="_blank" href="http://localhost:8080/index.php?r=site/index">http://localhost:8080/index.php?r=site/index</a>&nbsp;，会看到中文翻译的页面。
   <br> 
   <img src="/uploads/tutorial/20160606/1-160606203ZJ18.png" alt="">
   <br> 
  </div> 
 </div>
 <br>      
</div></body></html>