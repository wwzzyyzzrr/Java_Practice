<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">使用Gii生成代码</h1><div style="width:100%;float:left;" class="article-content">   
 <h1 style="color: rgb(0, 0, 0); font-family: Simsun;"> 使用 Gii 生成代码</h1> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 本章节将介绍如何使用&nbsp;Gii&nbsp;去自动生成 Web 站点常用功能的代码。使用 Gii 生成代码非常简单，只要按照 Gii 页面上的介绍输入正确的信息即可。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 贯穿本章节，你将会学到：</p> 
 <ul style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 
  <li> 在你的应用中开启 Gii</li> 
  <li> 使用 Gii 去生成活动记录类</li> 
  <li> 使用 Gii 去生成数据表操作的增查改删(CRUD)代码</li> 
  <li> 自定义 Gii 生成的代码</li> 
 </ul> 
 <h2 style="color: rgb(0, 0, 0); font-family: Simsun;"> 开始 Gii</h2> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> Gii&nbsp;是 Yii 中的一个模块。可以通过配置应用的 [[yiiaseApplication::modules|modules]] 属性开启它。通常来讲在&nbsp;<code>config/web.php</code>&nbsp;文件中会有以下配置代码：</p> 
 <pre>
<code class="lang-php">$config = [ ... ];

if (YII_ENV_DEV) {
    $config['bootstrap'][] = 'gii';
    $config['modules']['gii'] = 'yiigiiModule';
}</code></pre> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 这段配置的意思是如果当前是开发环境，应用会包含&nbsp;<code>gii</code>&nbsp;模块，模块类是 [[yiigiiModule]]。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 如果你检查应用的入口脚本&nbsp;<code>web/index.php</code>，将看到这行代码将&nbsp;<code>YII_ENV_DEV</code>&nbsp;设为 true：</p> 
 <pre>
<code class="lang-php">defined('YII_ENV') or define('YII_ENV', 'dev');</code></pre> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 代码设置应用处于开发模式下，按照上面的配置会打开 Gii 模块。你可以直接通过 URL 访问 Gii：</p> 
 <div style="float:left;margin-bottom: 10px;">  
 </div>
 <div style="float:left;margin-bottom: 10px;">  
 </div>
 <pre>
<code>http://hostname/index.php?r=gii</code></pre> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> <img alt="Gii" src="file:///D:/360Downloads/images/start-gii.png"></p> 
 <h2 style="color: rgb(0, 0, 0); font-family: Simsun;"> 生成活动记录类</h2> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 选择 “Model Generator” (点击 Gii 首页的链接)去生成活动记录类。并像这样填写表单：</p> 
 <ul style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 
  <li> Table Name:&nbsp;<code>country</code></li> 
  <li> Model Class:&nbsp;<code>Country</code></li> 
 </ul> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> <img alt="模型生成器" src="file:///D:/360Downloads/images/start-gii-model.png"></p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 然后点击 “Preview” 按钮。你会看到&nbsp;<code>models/Country.php</code>&nbsp;被列在将要生成的文件列表中。可以点击文件名预览内容。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 如果你已经创建过同样的文件，使用 Gii 可以覆写它，点击文件名旁边的&nbsp;<code>diff</code>&nbsp;能查看现有文件与将要生成的文件的内容区别。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> <img alt="模型生成器预览" src="file:///D:/360Downloads/images/start-gii-model-preview.png"></p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 想要覆写已存在文件，选中 “overwrite” 下的复选框然后点击 “Generator”。如果是新文件，只点击 “Generator” 就好。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 接下来你会看到一个包含已生成文件的说明页面。如果生成过程中覆写过文件，还会有一条信息说明代码是重新生成覆盖的。</p> 
 <h2 style="color: rgb(0, 0, 0); font-family: Simsun;"> 生成 CRUD 代码</h2> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> CRUD 代表增，查，改，删操作，这是绝大多数 Web 站点常用的数据处理方式。选择 Gii 中的 “CRUD Generator” (点击 Gii 首页的链接)去创建 CRUD 功能。之前的 “country” 例子需要像这样填写表单：</p> 
 <ul style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 
  <li> Model Class:&nbsp;<code>appmodelsCountry</code></li> 
  <li> Search Model Class:&nbsp;<code>appmodelsCountrySearch</code></li> 
  <li> Controller Class:&nbsp;<code>appcontrollersCountryController</code></li> 
 </ul> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> <img alt="CRUD 生成器" src="file:///D:/360Downloads/images/start-gii-crud.png"></p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 然后点击 “Preview” 按钮。你会看到下述将要生成的文件列表。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> [[NEED THE IMAGE HERE / 等待官方补充图片]]</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 如果你之前创建过&nbsp;<code>controllers/CountryController.php</code>&nbsp;和&nbsp;<code>views/country/index.php</code>&nbsp;文件(在指南的使用数据库小节)，选中 “overwrite” 下的复选框覆写它们(之前的文件没能全部支持 CRUD)。</p> 
 <h2 style="color: rgb(0, 0, 0); font-family: Simsun;"> 尝试下</h2> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 用浏览器访问下面的 URL 查看生成代码的运行：</p>   
 <pre>
<code>http://hostname/index.php?r=country/index</code></pre> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 可以看到一个栅格显示着从数据表中获取的国家数据。支持在列头对数据进行排序，输入筛选条件进行筛选。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 可以浏览详情，编辑，或删除栅格中的每个国家。还可以点击栅格上方的 “Create Country” 按钮通过表单创建新国家。</p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> <img alt="国家的数据栅格" src="file:///D:/360Downloads/images/start-gii-country-grid.png"></p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> <img alt="编辑一个国家" src="file:///D:/360Downloads/images/start-gii-country-update.png"></p> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 下面列出由 Gii 生成的文件，以便你研习功能和实现，或修改它们。</p> 
 <ul style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 
  <li> 控制器：<code>controllers/CountryController.php</code></li> 
  <li> 模型：<code>models/Country.php</code>&nbsp;和&nbsp;<code>models/CountrySearch.php</code></li> 
  <li> 视图：<code>views/country/*.php</code></li> 
 </ul> 
 <blockquote style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 
  <p> 补充：Gii 被设计成高度可定制和可扩展的代码生成工具。使用它可以大幅提高应用开发速度。请参考&nbsp;Gii&nbsp;小节了解更多内容。</p> 
 </blockquote> 
 <h2 style="color: rgb(0, 0, 0); font-family: Simsun;"> 总结</h2> 
 <p style="color: rgb(0, 0, 0); font-family: Simsun; font-size: medium;"> 本章学习了如何使用 Gii 去生成为数据表中数据实现完整 CRUD 功能的代码。</p> 
 <br>      
</div></body></html>