<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Laravel发送邮件</h1><div style="width:100%;float:left;" class="article-content">   
 <div>
   Laravel使用功能丰富免费的“SwiftMailer”程序库来发送电子邮件。&nbsp;使用这个库函数，我们可以轻松地发送电子邮件。电子邮件模板以视图同样的方式加载，这意味着可以使用&nbsp;Blade&nbsp;语法并数据注入到你的模板。以下是发送函数的语法。 
 </div> 
 <div> 
  <table border="1" cellpadding="2" cellspacing="0" style="font-size:14px;color:#313131;font-family:Verdana, Geneva, Tahoma,  Helvetica, background-color:inherit;"> 
   <tbody> 
    <tr> 
     <th style="border:1px solid #999999;background-color:#EEEEEE;"> 语法 </th> 
     <td style="border:1px solid #999999;background-color:inherit;"> void send(string|array $view, array $data, Closure|string $callback) </td> 
    </tr> 
    <tr> 
     <th style="border:1px solid #999999;background-color:#EEEEEE;"> 参数 </th> 
     <td style="border:1px solid #999999;background-color:inherit;"> 
      <ul style="background-color:inherit;"> 
       <li style="background-color:inherit;color:#000000;"> <p style="text-align:justify;font-size:15px !important;background-color:inherit;"> $view(string|array) –&nbsp;<span style="background-color:inherit;font-size:inherit;line-height:1.5;">包含电子邮件的视图的名称</span> </p> </li> 
       <li style="background-color:inherit;color:#000000;"> <p style="text-align:justify;font-size:15px !important;background-color:inherit;"> $data(array) –&nbsp;<span style="background-color:inherit;font-size:inherit;line-height:1.5;">数组数据用来传递到视图</span> </p> </li> 
       <li style="background-color:inherit;color:#000000;"> <p style="text-align:justify;font-size:15px !important;background-color:inherit;"> $callback –&nbsp;<span style="background-color:inherit;font-size:inherit;line-height:1.5;">接收邮件的实例，可自定义收件人，主题和邮件等方面的闭合回调</span> </p> </li> 
      </ul> </td> 
    </tr> 
    <tr> 
     <th style="border:1px solid #999999;background-color:#EEEEEE;"> 返回值 </th> 
     <td style="border:1px solid #999999;background-color:inherit;"> nothing </td> 
    </tr> 
    <tr> 
     <th style="border:1px solid #999999;background-color:#EEEEEE;"> 描述 </th> 
     <td style="border:1px solid #999999;background-color:inherit;"> 发送邮件 </td> 
    </tr> 
   </tbody> 
  </table> 
  <div>
    在第三个参数，&nbsp;$callback封闭收到消息实例以及与实例，我们还可以调用下面函数并更改信息，如下图所示。 
  </div> 
  <ul> 
   <li> $message-&gt;subject('Welcome to the Yiibai Yiibai'); </li> 
   <li> $message-&gt;from('email@example.com', 'Mr. Example'); </li> 
   <li> $message-&gt;to('email@example.com', 'Mr. Example'); </li> 
  </ul> 
  <div>
    一些不太常用的方法包括&nbsp;- 
  </div> 
  <ul> 
   <li> $message-&gt;sender('email@example.com', 'Mr. Example'); </li> 
   <li> $message-&gt;returnPath('email@example.com'); </li> 
   <li> $message-&gt;cc('email@example.com', 'Mr. Example'); </li> 
   <li> $message-&gt;bcc('email@example.com', 'Mr. Example'); </li> 
   <li> $message-&gt;replyTo('email@example.com', 'Mr. Example'); </li> 
   <li> $message-&gt;priority(2); </li> 
  </ul> 
  <div>
    要附加或嵌入文件，可以使用以下方法&nbsp;- 
  </div> 
  <ul> 
   <li> $message-&gt;attach('path/to/attachment.txt'); </li> 
   <li> $message-&gt;embed('path/to/attachment.jpg'); </li> 
  </ul> 
  <p style="text-align:justify;"> 邮件可以发送HTML或文本。您可以通过传递一个数组指明发送邮件的类型，如下图所示的第一个参数。默认类型为HTML。如果您想发送纯文本邮件，然后使用以下语法。 </p> 
  <h2> 语法 </h2> 
  <pre>Mail::send([‘text’=&gt;’text.view’], $data, $callback);</pre> 
  <div>
    在此语法中，第一个参数需要一个数组。使用“text”为键，这个键对应的值是“name&nbsp;of&nbsp;the&nbsp;view”。&nbsp; 
  </div> 
  <h2> 示例 </h2> 
  <p style="text-align:justify;"> 第1步&nbsp;- 现在要从Gmail帐户发送电子邮件，那么这里需要配置Laravel环境文件中的Gmail帐户&nbsp;— .env&nbsp;文件。Gmail帐户启用两步验证，创建一个应用程序并指定密码，如下图所示修改&nbsp;.env&nbsp;中的参数。 </p> 
  <h3> .env </h3> 
  <pre>MAIL_DRIVER = smtp
MAIL_HOST = smtp.qq.com
MAIL_PORT = 587
MAIL_USERNAME = QQ邮箱地址，如：2211@qq.com
MAIL_PASSWORD = QQ密码
MAIL_ENCRYPTION = tls</pre> 
  <div>
    第2步&nbsp;-&nbsp;修改&nbsp;.env&nbsp;文件执行下面的两个命令来清除缓存，并重新启动Laravel服务器之后。 
  </div> 
  <pre>php artisan config:cache</pre> 
  <div>
    第3步&nbsp;-&nbsp;通过执行以下命令来创建一个名为&nbsp;MailController&nbsp;的控制器。 
  </div> 
  <pre>php artisan make:controller MailController</pre> 
  <div>
    第4步&nbsp;-&nbsp;成功执行后，您会收到以下输出&nbsp;-
   <br> 
   <img src="/uploads/tutorial/20160516/1-16051621361B35.png" alt="">
   <br> 
  </div> 
  <p> 第5步&nbsp;-&nbsp;复制下面的代码到&nbsp;app/Http/Controllers/MailController.php&nbsp;文件，具体代码如下： </p> 
  <pre>&lt;?php
namespace App\Http\Controllers;
use Illuminate\Http\Request;
use Mail;

use App\Http\Requests;
use App\Http\Controllers\Controller;

class MailController extends Controller {
   public function basic_email(){
      $data = array('name'=&gt;"<span style="font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;line-height:1.5;">Yiibai-User</span><span style="font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;line-height:1.5;">");</span> Mail::send(['text'=&gt;'mail'], $data, function($message) {
         $message-&gt;to('yiibai.com@gmail.com', 'Yiibai Yiibai')-&gt;subject
            ('Laravel Basic Testing Mail');
         $message-&gt;from('xxxxxx@qq.com','Yiibai Author');
      });
      echo "Basic Email Sent. Check your inbox.";
   }

   public function html_email(){
      $data = array('name'=&gt;"<span style="font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;line-height:1.5;">Yiibai-User</span><span style="font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;line-height:1.5;">");</span> Mail::send('mail', $data, function($message) {
         $message-&gt;to('yiibai_com@qq.com', 'Yiibai Yiibai')-&gt;subject
            ('Laravel HTML Testing Mail');
         $message-&gt;from('xxxxx@qq.com','Yiibai Author');
      });
      echo "HTML Email Sent. Check your inbox.";
   }
   
   public function attachment_email(){
      $data = array('name'=&gt;"<span style="font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;line-height:1.5;">Yiibai-User</span><span style="font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;line-height:1.5;">");</span> Mail::send('mail', $data, function($message) {
         $message-&gt;to('yiibai.com@gmail.com', 'Yiibai Yiibai')-&gt;subject
            ('Laravel Testing Mail with Attachment');
         $message-&gt;attach('D:\laravel\public\uploads\image.png');
         $message-&gt;attach('D:\laravel\public\uploads\test.txt');
         $message-&gt;from('xxxx@qq.com','Yiibai Author');
      });
      echo "Email Sent with attachment. Check your inbox.";
   }
}</pre> 
  <div>
    第6步&nbsp;-&nbsp;将以下代码复制到resources/views/mail.blade.php&nbsp;文件。 
  </div> 
  <p> resources/views/mail.blade.php </p>   
  <pre>&lt;h1&gt;Hi, {{ $name }}&lt;/h1&gt;
&lt;p&gt;Sending Mail from Laravel.&lt;/p&gt;</pre> 
  <div>
    第7步&nbsp;-&nbsp;添加以下行添加到&nbsp;app/Http/routes.php&nbsp;文件。 
  </div> 
  <p> app/Http/routes.php </p> 
  <pre>Route::get('sendbasicemail','MailController@basic_email');
Route::get('sendhtmlemail','MailController@html_email');
Route::get('sendattachmentemail','MailController@attachment_email');</pre> 
  <div>
    第8步&nbsp;-&nbsp;访问以下网址测试基本电子邮件。 
  </div> 
  <p> <em>http://localhost:8000/sendbasicemail</em> </p> 
  <div>
    第9步&nbsp;-&nbsp;输出的画面将是这个样子。请检查您的收件箱是否看到基本的电子邮件输出。 
  </div> 
  <img src="/uploads/tutorial/20160516/1-160516213J0527.png" alt="">
  <br> 
  <div>
    第10步&nbsp;-&nbsp;访问以下网址来测试HTML电子邮件。 
  </div> 
  <p> <em>http://localhost:8000/sendhtmlemail</em> </p> 
  <p> 第11步&nbsp;-&nbsp;输出的画面将是这个样子。请检查您的收件箱是否看到HTML的电子邮件输出。 </p> 
  <img src="/uploads/tutorial/20160516/1-160516213T32T.png" alt="">
  <br> 
  <div>
    第12步&nbsp;-&nbsp;请访问以下网址使用附件测试HTML电子邮件。 
  </div> 
  <p> <em>http://localhost:8000/sendattachmentemail</em> </p> 
  <div>
    第13步&nbsp;-&nbsp;输出画面将是这个样子。请检查您的收件箱看到有附件的HTML电子邮件输出。 
  </div> 
  <img src="/uploads/tutorial/20160516/1-160516213920c8.png" alt=""> 
 </div> 
 <div style="font-family:微软雅黑;font-size:14px;background-color:#FFFFFF;"> 
  <br> 
 </div> 
 <div>
   打开邮件后：
  <br> 
  <img src="/uploads/tutorial/20160516/1-16051621394Kb.png" alt="">
  <br> 
 </div> 
 <div> 
  <p> 注&nbsp;-&nbsp;在MailController.php文件中的表单方法的电子邮件地址是用来发送电子邮件的电子邮件地址。一般来说，它应是服务器上配置的电子邮件地址。 </p> 
 </div>
 <br>      
</div></body></html>