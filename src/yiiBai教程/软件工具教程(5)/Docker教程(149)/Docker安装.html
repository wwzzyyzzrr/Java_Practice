<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Docker安装</h1><div style="width:100%;float:left;" class="article-content">   
 <p>可以在任何操作系统上安装Docker，无论是Mac，Windows，Linux还是任何云服务器。Docker 引擎在Linux发行版上运行。 在这里，我们将以Linux Ubuntu Xenial-16.04 [LTS]作为演示安装Docker引擎的过程。</p> 
 <h2 id="h2--"><a name="前提条件：" class="reference-link"></a><span class="header-link octicon octicon-link"></span>前提条件：</h2>
 <p>Docker需要两个重要的安装要求：</p> 
 <ul> 
  <li>它仅适用于64位Linux安装，<strong>注意</strong>：是64位的Linux系统。</li>
  <li>它需要Linux内核版本<code>3.10</code>或更高版本。</li>
 </ul> 
 <p>要查看当前的内核版本，请打开终端并键入<code>uname -r</code>命令以查看内核版本：</p> 
 <p>查看内核版本命令如下：</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ uname -r
4.4.0-31-generic
yiibai@ubuntu:~$
</code></pre> 
 <p>查看操作系统是32位还是64位：</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo uname --m
[sudo] password for yiibai:
x86_64
yiibai@ubuntu:~$
</code></pre> 
 <h2 id="h2--apt-"><a name="更新apt源" class="reference-link"></a><span class="header-link octicon octicon-link"></span>更新apt源</h2>
 <p>按照以下说明更新<code>apt</code>源。</p> 
 <ol> 
  <li>打开一个终端窗口。</li>
  <li>使用<code>sudo</code>命令作为<code>root</code>用户登录。</li>
  <li>更新包信息并安装CA证书。</li>
 </ol> 
 <p><strong>命令：</strong></p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get update
yiibai@ubuntu:~$ sudo apt-get install apt-transport-http ca-certificates
</code></pre> 
 <p>参见下面的屏幕截图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201706/0206/799170611_23505.png" alt=""></p> 
 <ol> 
  <li>添加新的GPG密钥，使用以下命令下载密钥。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
</code></pre> 
 <p>如下所示 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
Executing: /tmp/tmp.Eix5oqerzZ/gpg.1.sh --keyserver
hkp://ha.pool.sks-keyservers.net:80
--recv-keys
58118E89F3A912897C070ADBF76221572C52609D
gpg: requesting key 2C52609D from hkp server ha.pool.sks-keyservers.net
gpg: key 2C52609D: public key "Docker Release Tool (releasedocker) &lt;docker@docker.com&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>运行以下命令，它将替换文件的操作系统的相应条目。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ echo "&lt;REPO&gt;" | sudo tee /etc/apt/sources.list.d/docker.list
</code></pre> 
 <p>执行上面命令，输出结果如下 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ echo "&lt;REPO&gt;" | sudo tee /etc/apt/sources.list.d/docker.list
&lt;REPO&gt;
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>打开文件<code>/etc/apt/sources.list.d/docker.list</code>并将以下行粘贴到文件中。</li>
 </ol> 
 <pre><code class="lang-shell">deb http://apt.dockerproject.org/repo ubuntu-xenial main
</code></pre> 
 <p>使用 vi 创建并打开文件 <code>/etc/apt/sources.list.d/docker.list</code> 如下所示 -</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo vi /etc/apt/sources.list.d/docker.list
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>现在再次更新apt包索引。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get update
</code></pre> 
 <p>执行更新apt包索引，添加 docker 源地址，上面语句执行结果如下 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get update
Get:1 http://apt.dockerproject.org/repo ubuntu-xenial InRelease [48.7 kB]
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Get:3 http://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages [4,177 B]
Hit:4 http://nginx.org/packages/ubuntu xenial InRelease
Hit:5 http://us.archive.ubuntu.com/ubuntu xenial InRelease
Get:6 http://us.archive.ubuntu.com/ubuntu xenial-updates InRelease [102 kB]
Get:7 http://us.archive.ubuntu.com/ubuntu xenial-backports InRelease [102 kB]
Fetched 359 kB in 20s (17.3 kB/s)
Reading package lists... Done
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>验证APT是否从正确的仓库中拉出。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-cache policy docker-engine
</code></pre> 
 <p>上面语句执行结果如下 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-cache policy docker-engine
docker-engine:
  Installed: (none)
  Candidate: 17.05.0~ce-0~ubuntu-xenial
  Version table:
     17.05.0~ce-0~ubuntu-xenial 500
        500 http://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     17.04.0~ce-0~ubuntu-xenial 500
        500 http://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     17.03.1~ce-0~ubuntu-xenial 500
        500 http://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
... ... 
... ...
     1.11.0-0~xenial 500
        500 http://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>安装推荐的软件包</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get install linux-image-extra-$(uname -r) linux-image-extra-virtual
</code></pre> 
 <p>执行上面安装命令，输出结果如下 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get install linux-image-extra-$(uname -r) linux-image-                                                                                        extra-virtual
Reading package lists... Done
Building dependency tree
Reading state information... Done
linux-image-extra-4.4.0-31-generic is already the newest version (4.4.0-31.50).
linux-image-extra-4.4.0-31-generic set to manually installed.
The following additional packages will be installed:
  linux-generic linux-headers-4.4.0-78 linux-headers-4.4.0-78-generic
  linux-headers-generic linux-image-4.4.0-78-generic
  linux-image-extra-4.4.0-78-generic linux-image-generic
Suggested packages:
  fdutils linux-doc-4.4.0 | linux-source-4.4.0 linux-tools
Recommended packages:
... ...
... ...
Generating grub configuration file ...
Warning: Setting GRUB_TIMEOUT to a non-zero value when GRUB_HIDDEN_TIMEOUT is set is no longer supported.
Found linux image: /boot/vmlinuz-4.4.0-78-generic
Found initrd image: /boot/initrd.img-4.4.0-78-generic
Found linux image: /boot/vmlinuz-4.4.0-31-generic
Found initrd image: /boot/initrd.img-4.4.0-31-generic
done
Setting up linux-image-generic (4.4.0.78.84) ...
Setting up linux-headers-4.4.0-78 (4.4.0-78.99) ...
Setting up linux-headers-4.4.0-78-generic (4.4.0-78.99) ...
Setting up linux-headers-generic (4.4.0.78.84) ...
Setting up linux-generic (4.4.0.78.84) ...
Setting up linux-image-extra-virtual (4.4.0.78.84) ...
yiibai@ubuntu:~$
</code></pre> 
 <h2 id="h2--docker-"><a name="安装最新的Docker版本" class="reference-link"></a><span class="header-link octicon octicon-link"></span>安装最新的Docker版本</h2>
 <ol> 
  <li>更新apt包索引。</li>
 </ol>   
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get update
</code></pre> 
 <p>执行上面代码，结果如下 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get update
[sudo] password for yiibai:
Hit:1 http://apt.dockerproject.org/repo ubuntu-xenial InRelease
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Hit:3 http://us.archive.ubuntu.com/ubuntu xenial InRelease
Get:4 http://us.archive.ubuntu.com/ubuntu xenial-updates InRelease [102 kB]
Hit:5 http://nginx.org/packages/ubuntu xenial InRelease
Get:6 http://us.archive.ubuntu.com/ubuntu xenial-backports InRelease [102 kB]
Fetched 306 kB in 9s (31.2 kB/s)
Reading package lists... Done
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>安装Docker引擎。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get install docker-engine
</code></pre> 
 <p>执行上面代码，结果如下 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo apt-get install docker-engine
... ...
... ...
update-alternatives: using /usr/bin/prename to provide /usr/bin/rename (rename) in auto mode
Setting up aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Setting up cgroupfs-mount (1.2) ...
Setting up libltdl7:amd64 (2.4.6-0.1) ...
Setting up docker-engine (17.05.0~ce-0~ubuntu-xenial) ...
Setting up liberror-perl (0.17-1.2) ...
Setting up git-man (1:2.7.4-0ubuntu1.1) ...
Setting up git (1:2.7.4-0ubuntu1.1) ...
Setting up patch (2.7.5-1) ...
Setting up rename (0.20-4) ...
update-alternatives: using /usr/bin/file-rename to provide /usr/bin/rename (rename) in auto mode
Setting up xz-utils (5.1.1alpha+20120614-2ubuntu2) ...
update-alternatives: using /usr/bin/xz to provide /usr/bin/lzma (lzma) in auto mode
Processing triggers for libc-bin (2.23-0ubuntu3) ...
Processing triggers for systemd (229-4ubuntu7) ...
Processing triggers for ureadahead (0.100.0-19) ...
yiibai@ubuntu:~$
</code></pre> 
 <ol> 
  <li>启动docker守护进程。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo service docker start
</code></pre> 
 <ol> 
  <li>通过运行<code>hello-world</code>映像来验证Docker是否正确安装。</li>
 </ol> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ sudo docker run hello-world
</code></pre> 
 <p>如下面的屏幕截图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201706/0206/853180618_77564.png" alt=""></p> 
 <p>以上命令下载测试映像并在容器中运行。当容器运行时，它会打印一条消息并退出。</p>
 <br>      
</div></body></html>