<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Git处理冲突</h1><div style="width:100%;float:left;" class="article-content">   
 <p>假设要在<code>wchar_support</code>分支中执行更改，修改<code>wchar_support</code>分支中的代码。添加一个计算长度的函数：<code>count_len(obj)</code>，代码变化如下 - </p> 
 <pre><code class="lang-shell">$ git branch
  master
* wchar_support

Administrator@MY-PC /D/worksp/sample/src (wchar_support)
$ git diff
diff --git a/src/string.py b/src/string.py
index ba6d584..4307fe2 100644
--- a/src/string.py
+++ b/src/string.py
@@ -13,4 +13,7 @@ a = '我'  #
 b = 'ab'
 ab = '我ab'

-print(len(a), len(b), len(ab), len('='))
\ No newline at end of file
+print(len(a), len(b), len(ab), len('='))
+
+def count_len(obj):
+    return len(obj)
\ No newline at end of file
</code></pre> 
 <p>假设验证代码后，没有问题就提交这些更改。</p> 
 <pre><code class="lang-shell">$ git status
On branch wchar_support
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

        modified:   string.py

no changes added to commit (use "git add" and/or "git commit -a")

Administrator@MY-PC /D/worksp/sample/src (wchar_support)
$ git add string.py

Administrator@MY-PC /D/worksp/sample/src (wchar_support)
$ git commit -m "add new function: count_len(obj)"
[wchar_support 1cc9ddb] add new function: count_len(obj)
 1 file changed, 4 insertions(+), 1 deletion(-)
</code></pre> 
 <h2 id="h2--master-"><a name="执行 master 分支变更" class="reference-link"></a><span class="header-link octicon octicon-link"></span>执行 master 分支变更</h2>
 <p>同时在<code>master</code>分支中，另外一个开发人员(<code>minsu</code>)还会更改了内容，并将其更改推送到<code>master</code>分支。</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~/git/sample/src$ git diff
diff --git a/src/string.py b/src/string.py
index ba6d584..5eb2a5d 100644
--- a/src/string.py
+++ b/src/string.py
@@ -13,4 +13,6 @@ a = '我'  #
b = 'ab'
ab = '我ab'

-print(len(a), len(b), len(ab), len('='))
\ No newline at end of file
+print(len(a), len(b), len(ab), len('='))
+def obj_len(obj):
+    return len(obj)
yiibai@ubuntu:~/git/sample/src$
</code></pre> 
 <p>验证差异后，现在就提交更新内容。</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~/git/sample/src$ git status
On branch master
Your branch is up-to-date with 'origin/master'.
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

        modified:   string.py

no changes added to commit (use "git add" and/or "git commit -a")
yiibai@ubuntu:~/git/sample/src$ git add string.py
yiibai@ubuntu:~/git/sample/src$ git commit -m 'Changed function name from w_strlen to my_wc_strlen'
[master 07cd5af] Changed function name from w_strlen to my_wc_strlen
 1 file changed, 3 insertions(+), 1 deletion(-)
yiibai@ubuntu:~/git/sample/src$ git push origin master
Username for 'http://git.oschina.net': 769728683@qq.com
Password for 'http://769728683@qq.com@git.oschina.net':
Counting objects: 4, done.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 398 bytes | 0 bytes/s, done.
Total 4 (delta 1), reused 0 (delta 0)
To http://git.oschina.net/yiibai/sample.git
   e7d1734..07cd5af  master -&gt; master
</code></pre> 
 <p>在<code>wchar_support</code>分支上，我们已经实现了一个<code>count_len(obj)</code>函数。假设经过测试后，提交并将其更改推送到<code>wchar_support</code>分支。</p> 
 <h2 id="h2-u51FAu73B0u51B2u7A81"><a name="出现冲突" class="reference-link"></a><span class="header-link octicon octicon-link"></span>出现冲突</h2>
 <p>假设另外一个开发人员(<code>minsu</code>)想看看我们在<code>wchar_branch</code>分支上做了什么，他试图从<code>wchar_support</code>分支中拉出最新的变化，但是Git会中断这个操作，并显示以下错误消息。</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~/git/sample/src$ git pull origin wchar_support
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 4 (delta 1), reused 0 (delta 0)
Unpacking objects: 100% (4/4), done.
From http://git.oschina.net/yiibai/sample
 * branch            wchar_support -&gt; FETCH_HEAD
   e7d1734..1cc9ddb  wchar_support -&gt; origin/wchar_support
Auto-merging src/string.py
CONFLICT (content): Merge conflict in src/string.py
Automatic merge failed; fix conflicts and then commit the result.
yiibai@ubuntu:~/git/sample/src$
</code></pre> 
 <h2 id="h2-u89E3u51B3u51B2u7A81"><a name="解决冲突" class="reference-link"></a><span class="header-link octicon octicon-link"></span>解决冲突</h2>
 <p>从错误消息中，很明显文件：<em>src/string.py</em> 中存在冲突。运行<code>git diff</code>命令查看更多细节。</p>   
 <pre><code class="lang-shell">yiibai@ubuntu:~/git/sample/src$ git diff
diff --cc src/string.py
index 5eb2a5d,4307fe2..0000000
--- a/src/string.py
+++ b/src/string.py
@@@ -14,5 -14,6 +14,11 @@@ b = 'ab
  ab = 'æˆ‘ab'

  print(len(a), len(b), len(ab), len('='))
++&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
 +def obj_len(obj):
 +    return len(obj)
++=======
+
+ def count_len(obj):
 -    return len(obj)
++    return len(obj)
++&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1cc9ddb410561976b006106590481cc01b79080e
yiibai@ubuntu:~/git/sample/src$
</code></pre> 
 <p>由于两个人同进修改了<code>string.py</code>中的代码，所以Git处于混乱状态，并且要求用户手动解决冲突。</p> 
 <p>假设<code>maxsu</code>决定保留修改的代码，并删除了自己定义的函数：<code>obj_len(obj)</code>。删除冲突标记后(<code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> 和 <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>的行)，现在冲突的代码如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201707/1107/950160741_77053.png" alt=""></p> 
 <p>解决冲突需要修改代码后，如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201707/1107/576160744_51269.png" alt=""></p> 
 <p><code>git diff</code>将如下所示 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~/git/sample/src$ git diff
diff --cc src/string.py
index 5eb2a5d,4307fe2..0000000
--- a/src/string.py
+++ b/src/string.py
@@@ -14,5 -14,6 +14,7 @@@ b = 'ab
  ab = 'æˆ‘ab'

  print(len(a), len(b), len(ab), len('='))
+
 -def count_len(obj):
 -    return len(obj)
 +def obj_len(obj):
 +    return len(obj)
++
yiibai@ubuntu:~/git/sample/src$
</code></pre> 
 <p>由于<code>minsu</code>已经修改了这些文件，所以必须首先提交这些修改，然后就可以提出这些修改。如下所示 - </p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~/git/sample/src$ git add .
yiibai@ubuntu:~/git/sample/src$ git commit -a -m 'Resolved conflict'
[master 33f0406] Resolved conflict
yiibai@ubuntu:~/git/sample/src$ git pull origin wchar_support
</code></pre> 
 <p>已经解决了冲突，现在执行<code>git pull</code>应该没有问题了。</p>
 <br>      
</div></body></html>