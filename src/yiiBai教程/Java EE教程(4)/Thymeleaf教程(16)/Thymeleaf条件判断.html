<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Thymeleaf条件判断</h1><div style="width:100%;float:left;" class="article-content">   
 <p>本文章将介绍Thymeleaf标准表达式语法中的概念。我们将使用<code>th:if</code>和<code>th:unless</code>标记在模板中迭代显示产品列表，如果产品的价格大于100，则会显示:<em>“特殊提供”</em>。</p> 
 <p>编辑源代码以便将产品列表显示为表格行。已经将<code>Product</code>类的对象列表设置为具有变量名称<code>productList</code>的上下文模型(参考:<code>MyController.java</code>中的实现)。</p> 
 <p>如果要上机实践，请参考:<a target="_blank" href="https://www.yiibai.com/thymeleaf/thymeleaf-springmvc5.html" title="Thymeleaf+SpringMVC5示例项目">Thymeleaf+SpringMVC5示例项目</a>。这里不再重复创建项目的过程，这里将只介绍如何使用<code>Thymeleaf</code>标准表达式和标签。</p> 
 <p>这里创建一个Maven Web项目: <em>thymeleaf-tutorials</em> ，其目录结构如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201802/1402/876150238_78276.png" alt=""></p> 
 <p>数据访问类的实现:<em>DAO.java</em> - </p> 
 <pre><code class="lang-java">
package com.yiibai.dao;

import java.math.BigDecimal;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import com.yiibai.spring.bean.*;

/**
 * Mock persistence.
 */
public class DAO {

    private static final String NO_WEBSITE = null;

    public static Product loadProduct() {
        try {
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
            return new Product("Wooden wardrobe with glass doors", Integer.valueOf(850), sdf.parse("2013-02-18"));
        } catch (ParseException ex) {
            throw new RuntimeException("Invalid date");
        }
    }

    public static List&lt;Product&gt; loadAllProducts() {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        List&lt;Product&gt; products = new ArrayList&lt;Product&gt;();
        try {
            products.add(new Product("花生油", Integer.valueOf(125), sdf.parse("2018-02-18")));
            products.add(new Product("苏打饼干", Integer.valueOf(15), sdf.parse("208-02-15")));
            products.add(new Product("拿铁", Integer.valueOf(45), sdf.parse("2019-02-20")));
            products.add(new Product("调和油", Integer.valueOf(20), sdf.parse("2019-02-21")));
            products.add(new Product("大豆油", Integer.valueOf(49), sdf.parse("2019-02-15")));
            products.add(new Product("玉米汁", Integer.valueOf(80), sdf.parse("2019-02-17")));
        } catch (ParseException ex) {
            throw new RuntimeException("Invalid date");
        }
        return products;
    }



    public static Timestamp loadReleaseDate() {
        try {
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm");
            Date date = sdf.parse("2014-01-31 15:00");
            return new Timestamp(date.getTime());
        } catch (ParseException ex) {
            throw new RuntimeException("Invalid date");
        }
    }

}
</code></pre> 
 <p>控制器类的实现:<em>MyController.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.spring.controller;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

import com.yiibai.dao.DAO;
import com.yiibai.spring.bean.Product;

@Controller
public class MyController {

    @GetMapping("/")
    public String index(Model model) throws ParseException {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        Product product = new Product("花生油", 129, sdf.parse("2018-02-18"));
        model.addAttribute("product", product);
        return "index";
    }

    @GetMapping("/escape")
    public String escape(Model model) throws ParseException {
        String html = "Welcome to our &lt;b&gt;fantastic&lt;/b&gt; grocery store!";
        model.addAttribute("html", html);
        return "escape";
    }

    @GetMapping("/iteration")
    public String iteration(Model model) throws ParseException {
        List productList = DAO.loadAllProducts();
        model.addAttribute("productList", productList);
        return "iteration";
    }

    @GetMapping("/conditional")
    public String conditional(Model model) throws ParseException {
        List productList = DAO.loadAllProducts();
        model.addAttribute("productList", productList);
        return "conditional";
    }

}
</code></pre> 
 <p>模板文件的实现:<em>/webapp/WEB-INFO/views/conditional.html</em> - </p> 
 <pre><code class="lang-html">&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
&lt;link rel="stylesheet" th:href="@{/css/main.css}" /&gt;
&lt;style&gt;
span.offer {
    font-weight: bold;
    color: green;
}
&lt;/style&gt;
&lt;title&gt;SpringMVC5+Thymeleaf条件示例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;Spring MVC5 + Thymeleaf条件示例&lt;/h2&gt;
    &lt;table&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th&gt;行序号&lt;/th&gt;
                &lt;th&gt;产品名称&lt;/th&gt;
                &lt;th&gt;价格&lt;/th&gt;
                &lt;th&gt;有效日期&lt;/th&gt;
                &lt;th&gt;备注&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody th:remove="all-but-first"&gt;
            &lt;tr th:each="product : ${productList}"&gt;
            &lt;td th:text="${productStat.count}"&gt;1&lt;/td&gt;
                &lt;td th:text="${product.description}"&gt;Red chair&lt;/td&gt;
                &lt;td th:text="${'￥' + #numbers.formatDecimal(product.price, 1, 2)}"&gt;￥350&lt;/td&gt;
                &lt;td th:text="${#dates.format(product.availableFrom, 'dd-MM-yyyy')}"&gt;2018-02-20&lt;/td&gt;
                &lt;td&gt;&lt;span th:if="${product.price gt 100}" class="offer"&gt;特殊提供&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;White table&lt;/td&gt;
                &lt;td&gt;￥200&lt;/td&gt;
                &lt;td&gt;2018-04-10&lt;/td&gt;
                &lt;td&gt; &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Reb table&lt;/td&gt;
                &lt;td&gt;￥200&lt;/td&gt;
                &lt;td&gt;2018-02-20&lt;/td&gt;
                &lt;td&gt; &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Blue table&lt;/td&gt;
                &lt;td&gt;￥200&lt;/td&gt;
                &lt;td&gt;2018-02-20&lt;/td&gt;
                &lt;td&gt; &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>运行上面项目，在浏览器中显示效果如下 -<br><img src="http://www.yiibai.com/uploads/images/201802/2202/532160255_39689.png" alt=""></p> 
 <h2 id="h2-u9AD8u7EA7u5E94u7528"><a name="高级应用" class="reference-link"></a><span class="header-link octicon octicon-link"></span>高级应用</h2>
 <p>在这部分中，我们将演示其它几个标签(如:<code>th:switch</code>，<code>th:case</code>和<code>th:unless</code>)的用法。</p> 
 <p>需要重写以下几个文件，<em>DAO.java</em> - </p> 
 <pre><code class="lang-java">
package com.yiibai.dao;

import java.math.BigDecimal;
import java.sql.Timestamp;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import com.yiibai.spring.bean.*;

/**
 * Mock persistence.
 */
public class DAO {

    private static final String NO_WEBSITE = null;

    public static Product loadProduct() {
        try {
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
            return new Product("Wooden wardrobe with glass doors", Integer.valueOf(850), sdf.parse("2013-02-18"), "");
        } catch (ParseException ex) {
            throw new RuntimeException("Invalid date");
        }
    }

    public static List&lt;Product&gt; loadAllProducts() {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        List&lt;Product&gt; products = new ArrayList&lt;Product&gt;();
        try {
            products.add(new Product("花生油", Integer.valueOf(125), sdf.parse("2018-02-18"),"CG"));
            products.add(new Product("苏打饼干", Integer.valueOf(15), sdf.parse("208-02-15"),"CG"));
            products.add(new Product("拿铁", Integer.valueOf(45), sdf.parse("2019-02-20"),"PT"));
            products.add(new Product("调和油", Integer.valueOf(20), sdf.parse("2019-02-21"),"CX"));
            products.add(new Product("大豆油", Integer.valueOf(49), sdf.parse("2019-02-15"),""));
            products.add(new Product("玉米汁", Integer.valueOf(80), sdf.parse("2019-02-17"),""));
        } catch (ParseException ex) {
            throw new RuntimeException("Invalid date");
        }
        return products;
    }



    public static Timestamp loadReleaseDate() {
        try {
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm");
            Date date = sdf.parse("2014-01-31 15:00");
            return new Timestamp(date.getTime());
        } catch (ParseException ex) {
            throw new RuntimeException("Invalid date");
        }
    }

}
</code></pre> 
 <p>产品类的实现:<em>Product.java</em> - </p>   
 <pre><code class="lang-java">package com.yiibai.spring.bean;

import java.util.Date;

public class Product {

    private String description;
    private Integer price;
    private Date availableFrom;
    private String saleType;// 销售类型:促销，拼团，闪购，其它

    public String getSaleType() {
        return saleType;
    }

    public void setSaleType(String saleType) {
        this.saleType = saleType;
    }

    public Product(final String description, final Integer price, final Date availableFrom, final String saleType) {
        this.description = description;
        this.price = price;
        this.availableFrom = availableFrom;
        this.saleType = saleType;
    }

    public Date getAvailableFrom() {
        return this.availableFrom;
    }

    public void setAvailableFrom(final Date availableFrom) {
        this.availableFrom = availableFrom;
    }

    public String getDescription() {
        return this.description;
    }

    public void setDescription(final String description) {
        this.description = description;
    }

    public Integer getPrice() {
        return this.price;
    }

    public void setPrice(final Integer price) {
        this.price = price;
    }

}
</code></pre> 
 <p>控制器类的实现:<em>MyController.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai.spring.controller;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

import com.yiibai.dao.DAO;
import com.yiibai.spring.bean.Product;

@Controller
public class MyController {

    @GetMapping("/")
    public String index(Model model) throws ParseException {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        Product product = new Product("花生油", 129, sdf.parse("2018-02-18"), "");
        model.addAttribute("product", product);
        return "index";
    }

    @GetMapping("/escape")
    public String escape(Model model) throws ParseException {
        String html = "Welcome to our &lt;b&gt;fantastic&lt;/b&gt; grocery store!";
        model.addAttribute("html", html);
        return "escape";
    }

    @GetMapping("/iteration")
    public String iteration(Model model) throws ParseException {
        List productList = DAO.loadAllProducts();
        model.addAttribute("productList", productList);
        return "iteration";
    }

    @GetMapping("/conditional")
    public String conditional(Model model) throws ParseException {
        List productList = DAO.loadAllProducts();
        model.addAttribute("productList", productList);
        return "conditional";
    }

}
</code></pre> 
 <p>模板文件的实现:<em>/webapp/WEB-INFO/views/conditional.html</em> - </p> 
 <pre><code class="lang-html">&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
&lt;link rel="stylesheet" th:href="@{/css/main.css}" /&gt;
&lt;style&gt;
span.offer {
    font-weight: bold;
    color: green;
}
&lt;/style&gt;
&lt;title&gt;SpringMVC5+Thymeleaf条件示例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;Spring MVC5 + Thymeleaf条件示例&lt;/h2&gt;
    &lt;table&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th&gt;行序号&lt;/th&gt;
                &lt;th&gt;产品名称&lt;/th&gt;
                &lt;th&gt;价格&lt;/th&gt;
                &lt;th&gt;有效日期&lt;/th&gt;
                &lt;th&gt;销售类型&lt;/th&gt;
                &lt;th&gt;备注&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody th:remove="all-but-first"&gt;
            &lt;tr th:each="product : ${productList}"&gt;
            &lt;td th:text="${productStat.count}"&gt;1&lt;/td&gt;
                &lt;td th:text="${product.description}"&gt;Red chair&lt;/td&gt;
                &lt;td th:text="${'￥' + #numbers.formatDecimal(product.price, 1, 2)}"&gt;￥350&lt;/td&gt;
                &lt;td th:text="${#dates.format(product.availableFrom, 'dd-MM-yyyy')}"&gt;2018-02-20&lt;/td&gt;
                &lt;td th:switch="${product.saleType}"&gt;
                    &lt;span th:case="'CG'"&gt;闪购&lt;/span&gt;
                    &lt;span th:case="'PT'"&gt;拼团&lt;/span&gt;
                    &lt;span th:case="'CX'"&gt;促销&lt;/span&gt;
                        &lt;span th:case="*"&gt;其它&lt;/span&gt;
                    &lt;/td&gt;
                &lt;td&gt;&lt;span th:class="${product.price gt 100}?'offer'" th:text="${product.price}"&gt;特殊提供&lt;/span&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;White table&lt;/td&gt;
                &lt;td&gt;￥200&lt;/td&gt;
                &lt;td&gt;2018-04-10&lt;/td&gt;
                &lt;td&gt; &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Reb table&lt;/td&gt;
                &lt;td&gt;￥200&lt;/td&gt;
                &lt;td&gt;2018-02-20&lt;/td&gt;
                &lt;td&gt; &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Blue table&lt;/td&gt;
                &lt;td&gt;￥200&lt;/td&gt;
                &lt;td&gt;2018-02-20&lt;/td&gt;
                &lt;td&gt; &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>执行上面示例代码，得到以下结果 -<br><img src="http://www.yiibai.com/uploads/images/201802/2202/804180252_24617.png" alt=""></p>
 <br>      
</div></body></html>