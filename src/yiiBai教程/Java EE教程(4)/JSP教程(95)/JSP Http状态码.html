<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JSP Http状态码</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，我们将在JSP中讨论Http状态码。HTTP请求和HTTP响应消息的格式相似，并具有以下结构 -</p> 
 <ul> 
  <li>初始状态行+ CRLF(回车+换行+新行)</li>
  <li>零个或多个标头行+ CRLF</li>
  <li>空白行，即 CRLF</li>
  <li>一个可选的消息正文，如文件，查询数据或查询输出。</li>
 </ul> 
 <p>例如，服务器响应标头如下所示：</p> 
 <pre><code class="lang-html">HTTP/1.1 200 OK
Content-Type: text/html
Header2: ...
...
HeaderN: ...
   (Blank Line)
&lt;!doctype ...&gt;

&lt;html&gt;
   &lt;head&gt;...&lt;/head&gt;

   &lt;body&gt;
      ...
   &lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>状态行由HTTP版本(示例中为<code>HTTP/1.1</code>)，状态码(示例中为<code>200</code>)和与状态代码相对应的非常短的消息(示例中为<code>“OK”</code>)组成。</p> 
 <p>下表列出了所有从Web服务器返回HTTP状态代码和关联的消息 -</p> 
 <table> 
  <thead> 
   <tr> 
    <th>代码</th> 
    <th>消息</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td><code>100</code></td> 
    <td><code>Continue</code></td> 
    <td>服务器只收到请求的一部分，但只要尚未被拒绝，客户端应继续请求</td> 
   </tr> 
   <tr> 
    <td><code>101</code></td> 
    <td><code>Switching Protocols</code></td> 
    <td>服务器切换协议。</td> 
   </tr> 
   <tr> 
    <td><code>200</code></td> 
    <td><code>OK</code></td> 
    <td>请求成功</td> 
   </tr> 
   <tr> 
    <td><code>201</code></td> 
    <td><code>Created</code></td> 
    <td>请求完成，并创建一个新的资源</td> 
   </tr> 
   <tr> 
    <td><code>202</code></td> 
    <td><code>Accepted</code></td> 
    <td>请求被接受处理，但处理不完整。</td> 
   </tr> 
   <tr> 
    <td><code>203</code></td> 
    <td><code>Non-authoritative Information</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>204</code></td> 
    <td><code>No Content</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>205</code></td> 
    <td><code>Reset Content</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>206</code></td> 
    <td><code>Partial Content</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>300</code></td> 
    <td><code>Multiple Choices</code></td> 
    <td>链接列表; 用户可以选择链接并转到该位置。最多有五个地址。</td> 
   </tr> 
   <tr> 
    <td><code>301</code></td> 
    <td><code>Moved Permanently</code></td> 
    <td>所请求的页面已被移动到新的URL。</td> 
   </tr> 
   <tr> 
    <td><code>302</code></td> 
    <td><code>Found</code></td> 
    <td>请求的页面暂时移动到新的URL。</td> 
   </tr> 
   <tr> 
    <td><code>303</code></td> 
    <td><code>See Other</code></td> 
    <td>请求的页面可以在其它(不同的)URL下找到。</td> 
   </tr> 
   <tr> 
    <td><code>304</code></td> 
    <td><code>Not Modified</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>305</code></td> 
    <td><code>Use Proxy</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>306</code></td> 
    <td><code>Unused</code></td> 
    <td>此代码在以前的版本中使用。它不再使用，但代码是保留的。</td> 
   </tr> 
   <tr> 
    <td><code>307</code></td> 
    <td><code>Temporary Redirect</code></td> 
    <td>请求的页面暂时移动到新的URL。</td> 
   </tr> 
   <tr> 
    <td><code>400</code></td> 
    <td><code>Bad Request</code></td> 
    <td>服务器不了解的请求。</td> 
   </tr> 
   <tr> 
    <td><code>401</code></td> 
    <td><code>Unauthorized</code></td> 
    <td>请求的页面需要用户名和密码。</td> 
   </tr> 
   <tr> 
    <td><code>402</code></td> 
    <td><code>Payment Required</code></td> 
    <td>不能使用此代码。</td> 
   </tr> 
   <tr> 
    <td><code>403</code></td> 
    <td><code>Forbidden</code></td> 
    <td>禁止访问请求的页面</td> 
   </tr> 
   <tr> 
    <td><code>404</code></td> 
    <td><code>Not Found</code></td> 
    <td>服务器找不到请求的页面。</td> 
   </tr> 
   <tr> 
    <td><code>405</code></td> 
    <td><code>Method Not Allowed</code></td> 
    <td>请求中指定的方法是不允许的</td> 
   </tr> 
   <tr> 
    <td><code>406</code></td> 
    <td><code>Not Acceptable</code></td> 
    <td>服务器只能生成不被客户端接受的响应。</td> 
   </tr> 
   <tr> 
    <td><code>407</code></td> 
    <td><code>Proxy Authentication Required</code></td> 
    <td>可以在提供此请求之前，使用代理服务器进行身份验证。</td> 
   </tr> 
   <tr> 
    <td><code>408</code></td> 
    <td><code>Request Timeout</code></td> 
    <td>请求比服务器准备等待的时间更长，请求超时了。</td> 
   </tr> 
   <tr> 
    <td><code>409</code></td> 
    <td><code>Conflict</code></td> 
    <td>由于冲突，请求无法完成。</td> 
   </tr> 
   <tr> 
    <td><code>410</code></td> 
    <td><code>Gone</code></td> 
    <td>请求的页面不再可用。</td> 
   </tr> 
   <tr> 
    <td><code>411</code></td> 
    <td><code>Length Required</code></td> 
    <td><code>“Content-Length”</code>未定义，服务器不接受请求。</td> 
   </tr> 
   <tr> 
    <td><code>412</code></td> 
    <td><code>Precondition Failed</code></td> 
    <td>请求中给出的前提条件由服务器评估求值结果为<code>false</code>。</td> 
   </tr> 
   <tr> 
    <td><code>413</code></td> 
    <td><code>Request Entity Too Large</code></td> 
    <td>服务器将不接受请求，因为请求实体太大了。</td> 
   </tr> 
   <tr> 
    <td><code>414</code></td> 
    <td><code>Request-url Too Long</code></td> 
    <td>因为网址太长，服务器将不接受该请求。 当将<code>“POST”</code>请求转换为具有长查询信息的<code>“GET”</code>请求时，可能会发生这种情况。</td> 
   </tr> 
   <tr> 
    <td><code>415</code></td> 
    <td><code>Unsupported Media Type</code></td> 
    <td>因为不支持媒体类型，服务器将不接受该请求。</td> 
   </tr> 
   <tr> 
    <td><code>417</code></td> 
    <td><code>Expectation Failed</code></td> 
    <td></td> 
   </tr> 
   <tr> 
    <td><code>500</code></td> 
    <td><code>Internal Server Error</code></td> 
    <td>请求未完成，服务器遇到意外(错误)情况。</td> 
   </tr> 
   <tr> 
    <td><code>501</code></td> 
    <td><code>Not Implemented</code></td> 
    <td>请求未完成，服务器不支持所需的功能。</td> 
   </tr> 
   <tr> 
    <td><code>502</code></td> 
    <td><code>Bad Gateway</code></td> 
    <td>请求未完成，服务器从上游服务器收到无效响应。</td> 
   </tr> 
   <tr> 
    <td><code>503</code></td> 
    <td><code>Service Unavailable</code></td> 
    <td>请求未完成，服务器暂时超载或关闭。</td> 
   </tr> 
   <tr> 
    <td><code>504</code></td> 
    <td><code>Gateway Timeout</code></td> 
    <td>网关已经超时了</td> 
   </tr> 
   <tr> 
    <td><code>505</code></td> 
    <td><code>HTTP Version Not Supported</code></td> 
    <td>服务器不支持“http协议”版本。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2--http-"><a name="设置HTTP状态代码的方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>设置HTTP状态代码的方法</h2>
 <p>以下方法可用于在servlet程序中设置HTTP状态代码。 这些方法可用于<code>HttpServletResponse</code>对象。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>public void setStatus ( int statusCode )</code></td> 
    <td>此方法设置任意状态代码。 <code>setStatus()</code>方法将一个<code>int</code>(状态代码)作为参数。如果响应包含特殊的状态代码和文档，请确保在实际返回<code>PrintWriter</code>的内容之前调用<code>setStatus()</code>方法。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>public void sendRedirect(String url)</code></td> 
    <td>此方法将生成<code>302</code>响应以及给出新文档的URL的位置标头。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>public void sendError(int code, String message)</code></td> 
    <td>该方法发送状态码(通常为<code>404</code>)以及自动格式化在HTML文档内并发送给客户端的短消息。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-http-"><a name="HTTP状态代码示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>HTTP状态代码示例</h2>
 <p>以下示例显示如何将<code>407</code>错误代码发送到客户端浏览器。之后，浏览器会显示<code>“需要验证!!!”</code>的 信息。</p> 
 <p>打开Eclipse，创建一个动态Web项目：<em>HttpStatusCode</em> ， 其目录结构如下所示 - </p> 
 <p>文件：<em>index.jsp</em> 的代码如下所示 - </p>   
 <pre><code class="lang-html">&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;发送HTTP状态码&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;%
        // Set error code and reason.
        response.sendError(407, "Need authentication!!!");
    %&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>部署上面项目，然后打开浏览器访问URL： <a target="_blank" href="http://localhost:8080/HttpStatusCode/index.jsp">http://localhost:8080/HttpStatusCode/index.jsp</a> ， 可以看到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/1910/864211000_54535.png" alt=""><br>为了使用HTTP状态代码更友好，可尝试设置不同的状态代码及其描述说明。</p>
 <br>      
</div></body></html>