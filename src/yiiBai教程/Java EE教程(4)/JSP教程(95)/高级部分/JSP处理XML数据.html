<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JSP处理XML数据</h1><div style="width:100%;float:left;" class="article-content">   
 <p>当通过HTTP发送XML数据时，使用JSP处理传入和传出的XML文档是有意义的; 例如RSS文档。 由于XML文档只是一堆文本，通过JSP创建一个文本文档比创建HTML文档要容易得多。</p> 
 <h2 id="h2--jsp-xml"><a name="从JSP发送XML" class="reference-link"></a><span class="header-link octicon octicon-link"></span>从JSP发送XML</h2>
 <p>可以使用JSP以与发送HTML相同的方式发送XML内容。 唯一的区别是必须将页面的内容类型设置为<code>text/xml</code>。 要设置内容类型，请使用<code>&lt;%@ page%&gt;</code>标签，如下所示：</p> 
 <pre><code class="lang-html">&lt;%@ page contentType = "text/xml" %&gt;
</code></pre> 
 <p>以下示例是展示如何将XML内容发送到浏览器 -</p> 
 <pre><code class="lang-html">&lt;%@ page contentType = "text/xml" %&gt;

&lt;books&gt;
   &lt;book&gt;
      &lt;name&gt;Padam History&lt;/name&gt;
      &lt;author&gt;Maxsu&lt;/author&gt;
      &lt;price&gt;198&lt;/price&gt;
   &lt;/book&gt;
&lt;/books&gt;
</code></pre> 
 <h2 id="h2--jsp-xml"><a name="在JSP中处理XML" class="reference-link"></a><span class="header-link octicon octicon-link"></span>在JSP中处理XML</h2>
 <p>为了更好地演示，打开Eclipse创建一个动态Web项目：<em>XmlData</em>，其目录结构如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/2610/475081053_70111.png" alt=""></p> 
 <p>在使用JSP进行XML处理之前，需要将以下两个XML和XPath相关的库复制到<code>&lt;Tomcat安装目录&gt;\lib</code>中，或者复制到<code>{webapp}/WEB-INFO/lib</code>目录下 -</p> 
 <ul> 
  <li><code>XercesImpl.jar</code> - 从 <a target="_blank" href="http://www.apache.org/dist/xerces/j/">http://www.apache.org/dist/xerces/j/</a> 下载</li>
  <li><code>xalan.jar</code> - 从 <a target="_blank" href="http://xml.apache.org/xalan-j/index.html">http://xml.apache.org/xalan-j/index.html</a> 下载</li>
 </ul> 
 <p>将以下内容放在<code>books.xml</code>文件中 -</p> 
 <pre><code class="lang-xml">&lt;books&gt;
   &lt;book&gt;
      &lt;name&gt;Padam History&lt;/name&gt;
      &lt;author&gt;Maxsu&lt;/author&gt;
      &lt;price&gt;198&lt;/price&gt;
   &lt;/book&gt;

   &lt;book&gt;
      &lt;name&gt;Great Mistry&lt;/name&gt;
      &lt;author&gt;NewWong&lt;/author&gt;
      &lt;price&gt;1000&lt;/price&gt;
   &lt;/book&gt;
&lt;/books&gt;
</code></pre> 
 <p>创建一个<code>read_xml.jsp</code>，保存在Web应用目录中 -</p> 
 <pre><code class="lang-html">&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@ taglib prefix="x" uri="http://java.sun.com/jsp/jstl/xml"%&gt;

&lt;html&gt;
&lt;head&gt;
&lt;title&gt;JSP+XML&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div style="margin: auto; width: 90%"&gt;
        &lt;h3&gt;图书信息:&lt;/h3&gt;
        &lt;c:import var="bookInfo" url="http://localhost:8080/XmlData/books.xml" /&gt;
        &lt;x:parse xml="${bookInfo}" var="output" /&gt;
        &lt;b&gt;The title of the first book is&lt;/b&gt;:
        &lt;x:out select="$output/books/book[1]/name" /&gt;
        &lt;br /&gt; &lt;b&gt;The price of the second book&lt;/b&gt;:
        &lt;x:out select="$output/books/book[2]/price" /&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>在编写完成上面的代码后，部署项目并打开浏览器访问URL：<code>http://localhost:8080/XmlData/read_xml.jsp</code> 访问上述JSP，将显示以下结果 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/2610/884081047_23977.png" alt=""></p> 
 <h2 id="h2--jsp-xml"><a name="使用JSP格式化XML" class="reference-link"></a><span class="header-link octicon octicon-link"></span>使用JSP格式化XML</h2>
 <p>考虑以下XSLT样式表文件：<em>style.xsl</em> -</p> 
 <pre><code class="lang-xml">&lt;?xml version = "1.0"?&gt;
&lt;xsl:stylesheet xmlns:xsl = "http://www.w3.org/1999/XSL/Transform" 
   version = "1.0"&gt;

   &lt;xsl:output method = "html" indent = "yes"/&gt;
   &lt;xsl:template match = "/"&gt;
      &lt;html&gt;
         &lt;body&gt;
            &lt;xsl:apply-templates/&gt;
         &lt;/body&gt;
      &lt;/html&gt;
   &lt;/xsl:template&gt;

   &lt;xsl:template match = "books"&gt;
      &lt;table border = "1" width = "100%"&gt;
         &lt;xsl:for-each select = "book"&gt;
            &lt;tr&gt;
               &lt;td&gt;
                  &lt;i&gt;&lt;xsl:value-of select = "name"/&gt;&lt;/i&gt;
               &lt;/td&gt;

               &lt;td&gt;
                  &lt;xsl:value-of select = "author"/&gt;
               &lt;/td&gt;

               &lt;td&gt;
                  &lt;xsl:value-of select = "price"/&gt;
               &lt;/td&gt;
            &lt;/tr&gt;
         &lt;/xsl:for-each&gt;
      &lt;/table&gt;

   &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</code></pre> 
 <p>创建一个JSP文件：<em>formatxml.jsp</em></p>   
 <pre><code class="lang-html">&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;
&lt;%@ taglib prefix="x" uri="http://java.sun.com/jsp/jstl/xml"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;使用JSP格式化XML&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div style="margin:auto;width:90%"&gt;
&lt;h3&gt;图书信息:&lt;/h3&gt;
      &lt;c:set var = "xmltext"&gt;
         &lt;books&gt;
            &lt;book&gt;
               &lt;name&gt;Padam History&lt;/name&gt;
               &lt;author&gt;Maxsu&lt;/author&gt;
               &lt;price&gt;99&lt;/price&gt;
            &lt;/book&gt;

            &lt;book&gt;
               &lt;name&gt;Great Mistry&lt;/name&gt;
               &lt;author&gt;NewWong&lt;/author&gt;
               &lt;price&gt;1998&lt;/price&gt;
            &lt;/book&gt;
         &lt;/books&gt;
      &lt;/c:set&gt;

      &lt;c:import url = "http://localhost:8080/XmlData/style.xsl" var = "xslt"/&gt;
      &lt;x:transform xml = "${xmltext}" xslt = "${xslt}"/&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>在编写完成上面的代码后，部署项目并打开浏览器访问URL：<code>http://localhost:8080/XmlData/formatxml.jsp</code> 访问上述JSP，将显示以下结果 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/2610/465081052_33579.png" alt=""></p> 
 <p>要了解更多有关使用JSTL的XML处理，可以查看<a target="_blank" href="http://www.yiibai.com/jsp/jstl.html" title="JSP标准库">JSP标准库</a>。</p>
 <br>      
</div></body></html>