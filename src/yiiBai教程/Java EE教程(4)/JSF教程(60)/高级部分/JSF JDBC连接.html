<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JSF JDBC连接</h1><div style="width:100%;float:left;" class="article-content">   
 <p>我们可以将JSF应用程序集成到jdbc。 JDBC可将数据存储到数据库表中。在本教程中，我们创建一个应用程序并创建jdbc连接来存储用户输入的数据。</p> 
 <h2 id="h2-jsf-mysql-jdbc-"><a name="JSF + MySQL JDBC实例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>JSF + MySQL JDBC实例</h2>
 <p>打开 <strong>NetBeans IDE</strong>，创建一个名称为：<strong>JdbcConnectivity</strong> 的 Web 工程，其目录结构如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2704/544110417_81655.png" alt=""></p> 
 <blockquote> 
  <p>提示： 需要加入 <code>mysql-connector-java</code> Jar包。 </p> 
 </blockquote> 
 <p>此应用程序包含用户输入表单，委托bean和响应页面，如以下步骤。</p> 
 <h3 id="h3-u521Bu5EFAu6570u636Eu5E93u548Cu8868"><a name="创建数据库和表" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建数据库和表</h3>
 <p>我们使用mysql数据库创建数据库和表。</p> 
 <p><strong>创建数据库</strong></p> 
 <p>使用以下SQL命令，创建一个数据库：<code>test</code> ;</p> 
 <pre><code class="lang-sql">create database test;
</code></pre> 
 <p>在这个数据中，创建一个表: <code>user</code> - </p> 
 <pre><code class="lang-sql">create table user(
    id int not null auto_increment primary key, 
    name varchar(100) not null, 
    email varchar(50) not null 
);
</code></pre> 
 <p>创建数据库和表后，现在创建一个用户表单来获取输入的用户信息。</p> 
 <h3 id="h3-u521Bu5EFAu7528u6237u8868u5355"><a name="创建用户表单" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建用户表单</h3>
 <p>创建一个名称为：<code>index.xhtml</code> 的文件，其代码如下所示 -</p> 
 <pre><code class="lang-html">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;  
&lt;html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;  
    &lt;h:head&gt;  
        &lt;title&gt;User Form&lt;/title&gt;  
    &lt;/h:head&gt;  
    &lt;h:body&gt;  
        &lt;h:form&gt;  
            &lt;h:outputLabel for="username" value="User Name "/&gt;  
            &lt;h:inputText id="username" value="#{user.userName}"&gt;  
            &lt;/h:inputText&gt;&lt;br/&gt;  
            &lt;h:outputLabel for="email" value="Email ID "/&gt;  
            &lt;h:inputText id="email" value="#{user.email}"&gt;  
            &lt;/h:inputText&gt;&lt;br/&gt;&lt;br/&gt;  
            &lt;h:commandButton action="#{user.submit()}" value="submit"/&gt;  
        &lt;/h:form&gt;  
    &lt;/h:body&gt;  
&lt;/html&gt;
</code></pre> 
 <h3 id="h3--bean"><a name="创建一个委托Bean" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建一个委托Bean</h3>
 <p>此文件还包含属性，数据库连接和页面导航。创建一个名称为：<code>User.java</code> 的文件，其代码如下所示 -</p> 
 <pre><code class="lang-java">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.yiibai;

/**
 *
 * @author Maxsu
 */
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ReferencedBean;

@ManagedBean
@ReferencedBean
public class User {

    String userName;
    String email;

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public boolean save() {
        int result = 0;
        try {
            Class.forName("com.mysql.jdbc.Driver");
            Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/test", "root", "123456");
            PreparedStatement stmt = con.prepareStatement("insert into user(name,email) values(?,?)");
            stmt.setString(1, this.getUserName());
            stmt.setString(2, this.getEmail());
            result = stmt.executeUpdate();
        } catch (Exception e) {
            System.out.println(e);
        }
        if (result == 1) {
            return true;
        } else {
            return false;
        }
    }

    public String submit() {
        if (this.save()) {
            return "result.xhtml";
        } else {
            return "index.xhtml";
        }
    }
}
</code></pre> 
 <h3 id="h3-u521Bu5EFAu54CDu5E94u7ED3u679Cu9875u9762"><a name="创建响应结果页面" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建响应结果页面</h3>
 <p>创建一个名称为：<code>result.xhtml</code> 的文件，其代码如下所示 -</p>   
 <pre><code class="lang-html">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;  
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;  
&lt;html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://xmlns.jcp.org/jsf/html"&gt;  
    &lt;h:head&gt;  
        &lt;title&gt;Response Page&lt;/title&gt;  
    &lt;/h:head&gt;  
    &lt;h:body&gt;  
        &lt;h1&gt;&lt;h:outputText value="Hello #{user.userName}"/&gt;&lt;/h1&gt;  
        &lt;h:outputText value="Your Record has been Saved Successfully!"/&gt;  
    &lt;/h:body&gt;  
&lt;/html&gt;
</code></pre> 
 <p>运行上面项目，打开浏览器访问：<code>http://localhost:8084/JdbcConnectivity/</code>，并提交表单，向数据库表中写入数据 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2704/415110421_92119.png" alt=""></p> 
 <p>向上面表单中，写入一个示例数据，提示得到以下结果 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2704/472110421_94822.png" alt=""></p> 
 <p>现在，您可以看到表：<code>user</code> 中的数据，应该会看到上面表单提交的数据了 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2704/673110423_49918.png" alt=""></p>
 <br>      
</div></body></html>