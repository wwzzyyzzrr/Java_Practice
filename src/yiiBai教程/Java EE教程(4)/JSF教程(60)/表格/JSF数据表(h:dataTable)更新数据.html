<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JSF数据表(h:dataTable)更新数据</h1><div style="width:100%;float:left;" class="article-content">   
 <p>JSF中有一个叫作<code>DataTable</code>的控件，可用来渲染和格式化<code>html</code>表格。使用<code>DataTable</code>，我们可以迭代收集或数组数组来显示数据。下面我们来学习如何向<code>DataTable</code>更新数据。</p> 
 <p>要使用<code>DataTable</code>，我们需要添加以下HTML头。</p> 
 <pre><code class="lang-html">&lt;html 
   xmlns="http://www.w3.org/1999/xhtml"   
   xmlns:h="http://java.sun.com/jsf/html"&gt;
&lt;/html&gt;
</code></pre> 
 <p>以下JSF标签 - </p> 
 <pre><code class="lang-html">&lt;h:dataTable value="#{userData.employees}" var="employee"
   styleClass="employeeTable"
   headerClass="employeeTableHeader"
   rowClasses="employeeTableOddRow,employeeTableEvenRow"&gt;
   &lt;h:column&gt;            
      &lt;f:facet name="header"&gt;Name&lt;/f:facet&gt;            
      #{employee.name}
   &lt;/h:column&gt;
   &lt;h:column&gt;
      &lt;f:facet name="header"&gt;Department&lt;/f:facet&gt;
      #{employee.department}
   &lt;/h:column&gt;
   &lt;h:column&gt;
      &lt;f:facet name="header"&gt;Age&lt;/f:facet&gt;
      #{employee.age}
   &lt;/h:column&gt;
   &lt;h:column&gt;
      &lt;f:facet name="header"&gt;Salary&lt;/f:facet&gt;
      #{employee.salary}
   &lt;/h:column&gt;
&lt;/h:dataTable&gt;
</code></pre> 
 <p>被渲染成以下HTML标签。</p> 
 <pre><code class="lang-html">&lt;table class="employeeTable"&gt;
&lt;thead&gt;&lt;tr&gt;
   &lt;th class="employeeTableHeader" scope="col"&gt;Name&lt;/th&gt;
   &lt;th class="employeeTableHeader" scope="col"&gt;Department&lt;/th&gt;
   &lt;th class="employeeTableHeader" scope="col"&gt;Age&lt;/th&gt;
   &lt;th class="employeeTableHeader" scope="col"&gt;Salary&lt;/th&gt;
&lt;/tr&gt;&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="employeeTableOddRow"&gt;
   &lt;td&gt;Tom&lt;/td&gt;
   &lt;td&gt;Marketing&lt;/td&gt;
   &lt;td&gt;10&lt;/td&gt;
   &lt;td&gt;2000.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="employeeTableEvenRow"&gt;
   &lt;td&gt;Robert&lt;/td&gt;
   &lt;td&gt;Marketing&lt;/td&gt;
   &lt;td&gt;15&lt;/td&gt;
   &lt;td&gt;1000.0&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</code></pre> 
 <h2 id="h2-jsf-"><a name="JSF数据表更新行数据实例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>JSF数据表更新行数据实例</h2>
 <p>打开 <strong>NetBeans IDE</strong> 创建一个Web工程：<strong>DataTableUpdate</strong>，其目录结构如下所示 -</p> 
 <p>![JSF数据表更新行数据实例]<img src="http://www.yiibai.com/uploads/images/201704/2604/725100414_66185.png" alt=""></p> 
 <p>创建以下文件代码，文件：<em>index.xhtml</em> 的代码内容如下所示 -</p> 
 <pre><code class="lang-html">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      &gt;
    &lt;h:head&gt;
        &lt;h:outputStylesheet library="css" name="table-style.css"  /&gt;
    &lt;/h:head&gt;
    &lt;h:body&gt;

        &lt;h1&gt;JSF 2 dataTable example&lt;/h1&gt;
        &lt;h:form&gt;
            &lt;h:dataTable value="#{book.bookList}" var="o"
                         styleClass="book-table"
                         headerClass="book-table-header"
                         rowClasses="book-table-odd-row,book-table-even-row"
                         &gt;

                &lt;h:column&gt;

                    &lt;f:facet name="header"&gt;Book No&lt;/f:facet&gt;

                    &lt;h:inputText value="#{o.bookNo}" size="10" rendered="#{o.editable}" /&gt;

                    &lt;h:outputText value="#{o.bookNo}" rendered="#{not o.editable}" /&gt;

                &lt;/h:column&gt;

                &lt;h:column&gt;

                    &lt;f:facet name="header"&gt;Product Name&lt;/f:facet&gt;

                    &lt;h:inputText value="#{o.productName}" size="20" rendered="#{o.editable}" /&gt;

                    &lt;h:outputText value="#{o.productName}" rendered="#{not o.editable}" /&gt;

                &lt;/h:column&gt;

                &lt;h:column&gt;

                    &lt;f:facet name="header"&gt;Price&lt;/f:facet&gt;

                    &lt;h:inputText value="#{o.price}" size="10" rendered="#{o.editable}" /&gt;

                    &lt;h:outputText value="#{o.price}" rendered="#{not o.editable}" /&gt;

                &lt;/h:column&gt;

                &lt;h:column&gt;

                    &lt;f:facet name="header"&gt;Quantity&lt;/f:facet&gt;

                    &lt;h:inputText value="#{o.qty}" size="5" rendered="#{o.editable}" /&gt;

                    &lt;h:outputText value="#{o.qty}" rendered="#{not o.editable}" /&gt;

                &lt;/h:column&gt;

                &lt;h:column&gt;

                    &lt;f:facet name="header"&gt;Action&lt;/f:facet&gt;

                    &lt;h:commandLink value="Edit" action="#{book.editAction(o)}" rendered="#{not o.editable}" /&gt;

                &lt;/h:column&gt;

            &lt;/h:dataTable&gt;

            &lt;h:commandButton value="Save Changes" action="#{book.saveAction}" /&gt;

        &lt;/h:form&gt;
    &lt;/h:body&gt;

&lt;/html&gt;
</code></pre> 
 <p>文件：<em>User.java</em> 的代码内容如下所示 -</p>   
 <pre><code class="lang-java">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.yiibai;

/**
 *
 * @author Maxsu
 */
import java.io.Serializable;
import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Arrays;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean(name = "book")
@SessionScoped
public class User implements Serializable {

    private static final long serialVersionUID = 1L;
    private static final ArrayList&lt;Book&gt; bookList
            = new ArrayList&lt;Book&gt;(Arrays.asList(
                    new Book("1", "CSS", new BigDecimal("722.22"), 1),
                    new Book("2", "HTML", new BigDecimal("533.33"), 2),
                    new Book("3", "Java", new BigDecimal("11444.44"), 8),
                    new Book("4", "Javascript", new BigDecimal("5255.55"), 3),
                    new Book("5", "SQL", new BigDecimal("166.66"), 10)
            ));

    public ArrayList&lt;Book&gt; getBookList() {
        return bookList;
    }

    public String saveAction() {
        //get all existing value but set "editable" to false 
        for (Book book : bookList) {
            book.setEditable(false);
        }
        //return to current page
        return null;
    }

    public String editAction(Book book) {
        book.setEditable(true);
        return null;
    }

    public static class Book {

        String bookNo;
        String productName;
        BigDecimal price;
        int qty;
        boolean editable;

        public Book(String bookNo, String productName, BigDecimal price, int qty) {
            this.bookNo = bookNo;
            this.productName = productName;
            this.price = price;
            this.qty = qty;
        }

        public boolean isEditable() {
            return editable;
        }

        public void setEditable(boolean editable) {
            this.editable = editable;
        }

        public String getBookNo() {
            return bookNo;
        }

        public void setBookNo(String bookNo) {
            this.bookNo = bookNo;
        }

        public String getProductName() {
            return productName;
        }

        public void setProductName(String productName) {
            this.productName = productName;
        }

        public BigDecimal getPrice() {
            return price;
        }

        public void setPrice(BigDecimal price) {
            this.price = price;
        }

        public int getQty() {
            return qty;
        }

        public void setQty(int qty) {
            this.qty = qty;
        }
    }
}
</code></pre> 
 <p>右键运行工程：<strong>DataTableUpdate</strong>，如果没有任何错误，打开浏览器访问：</p> 
 <pre><code>http://localhost:8084/DataTableUpdate/
</code></pre>
 <p>应该会看到以下结果 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2604/912100420_37250.png" alt=""></p> 
 <p>在上图中，您可以点击某个项，并保存。</p>
 <br>      
</div></body></html>