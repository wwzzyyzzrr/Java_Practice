<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JSF生命周期</h1><div style="width:100%;float:left;" class="article-content">   
 <p>JSF(JavaServer Faces)应用程序框架的简单程序是自动管理生命周期阶段，并允许您手动管理。JSF(JavaServer Faces)应用程序的生命周期从客户端对页面发出HTTP请求时开始，并在服务器响应页面时结束。</p> 
 <p>JSF生命周期分为两个主要阶段：</p> 
 <ul> 
  <li>执行阶段</li>
  <li>渲染阶段</li>
 </ul> 
 <h2 id="h2-1-"><a name="1. 执行阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 执行阶段</h2>
 <p>在执行阶段，当第一次请求时，构建或恢复应用程序视图。 对于其他后续请求，执行其他操作，如应用请求参数值，对组件值执行转换和验证，受托管的<code>bean</code>将使用组件值进行更新，并调用应用程序逻辑。<br>执行阶段被进一步分成以下子阶段。</p> 
 <ul> 
  <li>恢复视图阶段</li>
  <li>应用请求值阶段</li>
  <li>流程验证阶段</li>
  <li>更新模型值阶段</li>
  <li>调用应用阶段</li>
  <li>渲染响应阶段</li>
 </ul> 
 <h3 id="h3-u6062u590Du89C6u56FEu9636u6BB5"><a name="恢复视图阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>恢复视图阶段</h3>
 <p>当客户端请求一个JavaServer Faces页面时，JavaServer Faces实现开始恢复视图阶段。 在此阶段，JSF将视图中的组件构建为请求页面，线性事件处理程序和验证器的视图，并将视图保存在FacesContext实例中。</p> 
 <p>如果对该页面的请求是回发，那么与该页面相对应的视图已经存在于FacesContext实例中。 在此阶段，JavaServer Faces实现通过使用保存在客户端或服务器上的状态信息来还原视图。</p> 
 <h3 id="h3-u5E94u7528u8BF7u6C42u503Cu9636u6BB5"><a name="应用请求值阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>应用请求值阶段</h3>
 <p>在此阶段，在回发请求期间恢复组件树。 组件树是表单元素的集合。树中的每个组件通过使用其<code>decode(processDecodes())</code>方法从请求参数中提取其新值。 之后，该值将本地存储在每个组件上。</p> 
 <ul> 
  <li>如果任何解码方法或事件侦听器在当前FacesContext实例上调用了renderResponse方法，则JavaServer Faces实现将跳过“渲染响应”阶段。</li>
  <li>如果任何事件在此阶段已排队，则JavaServer Faces实现将事件广播到有兴趣的监听器。</li>
  <li>如果应用程序需要重定向到其他Web应用程序资源或生成不包含任何JavaServer Faces组件的响应，则可以调用<code>FacesContext.responseComplete()</code>方法。</li>
  <li>如果当前请求被识别为部分请求，则从FacesContext检索部分上下文，并应用部分处理方法。</li>
 </ul> 
 <h3 id="h3-u6D41u7A0Bu9A8Cu8BC1u9636u6BB5"><a name="流程验证阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>流程验证阶段</h3>
 <p>在此阶段，JavaServer Faces通过使用其<code>validate()</code>方法来处理在组件上注册的所有验证器。 它检查指定验证规则的组件属性，并将这些规则与为组件存储的本地值进行比较。 JavaServer Faces还完成了没有将<code>immediate</code>属性设置为<code>true</code>的输入组件的转换。</p> 
 <ul> 
  <li>如果任何验证方法或事件侦听器在当前FacesContext上调用了<code>renderResponse</code>方法，则JavaServer Faces实现将跳过“渲染响应”阶段。</li>
  <li>如果应用程序需要重定向到不同的Web应用程序资源或生成不包含任何JavaServer Faces组件的响应，则可以调用<code>FacesContext.responseComplete</code>方法。</li>
  <li>如果事件在此阶段已排队，则JavaServer Faces实现将它们广播给有兴趣的监听器。</li>
  <li>如果当前请求被识别为部分请求，则从FacesContext检索部分上下文，并应用部分处理方法。</li>
 </ul> 
 <h3 id="h3-u66F4u65B0u6A21u578Bu503Cu9636u6BB5"><a name="更新模型值阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>更新模型值阶段</h3>
 <p>确保数据有效后，它遍历组件树，并将相应的服务器端对象属性设置为组件的本地值。 JavaServer Faces实现只更新输入组件的<code>value</code>属性指向<code>bean</code>属性。 如果本地数据无法转换为<code>bean</code>属性指定的类型，生命周期将直接前进到“渲染响应”阶段，以便重新呈现页面并显示错误。</p> 
 <ul> 
  <li>如果任何updateModels方法或任何监听器在当前FacesContext实例上调用了<code>renderResponse()</code>方法，则JavaServer Faces实现将跳过“渲染响应”阶段。</li>
  <li>如果应用程序需要重定向到其他Web应用程序资源或生成不包含任何JavaServer Faces组件的响应，则可以调用<code>FacesContext.responseComplete()</code>方法。</li>
  <li>如果任何事件在此阶段已排队，JavaServer Faces实现将它们广播到有兴趣的监听器。</li>
  <li>如果当前请求被识别为部分请求，则从FacesContext检索部分上下文，并应用部分处理方法。</li>
 </ul> 
 <h3 id="h3-u8C03u7528u5E94u7528u9636u6BB5"><a name="调用应用阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>调用应用阶段</h3>
 <p>在此阶段，JSF处理应用程序级事件，例如提交表单或链接到另一个页面。<br>现在，如果应用程序需要重定向到其他Web应用程序资源或生成不包含任何JSF组件的响应，则可以调用<code>FacesContext.responseComplete()</code>方法。</p> 
 <p>之后，JavaServer Faces实现将控制转移到“渲染响应”阶段。</p> 
 <h3 id="h3-u6E32u67D3u54CDu5E94u9636u6BB5"><a name="渲染响应阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>渲染响应阶段</h3>
 <p>这是JSF生命周期的最后阶段。 在此阶段，JSF将构建视图并将权限委托给相应的资源来呈现页面。</p> 
 <ul> 
  <li>如果这是初始请求，则页面上表示的组件将被添加到组件树中。</li>
  <li>如果这不是初始请求，组件已经添加到树中，不需要再添加。</li>
  <li>如果请求是回应，并且在应用请求值阶段，过程验证阶段或更新模型值阶段期间遇到错误，则在此阶段将再次呈现原始页面。</li>
 </ul> 
 <p>如果页面包含<code>h:message</code>或<code>h:messages</code>标签，页面上会显示任何排队的错误消息。<br>在渲染视图的内容之后，保存响应的状态，以便后续请求可以访问它。 恢复视图阶段可以使用保存的状态。</p> 
 <h2 id="h2-2-"><a name="2. 渲染阶段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 渲染阶段</h2>  
 <p>在此阶段，请求的视图作为对客户端浏览器的响应。 视图渲染是以HTML或XHTML生成输出的过程。 所以，用户可以在浏览器看到它。</p> 
 <p>在渲染过程中采取以下步骤。</p> 
 <ul> 
  <li>当客户端对<code>index.xhtml</code>网页进行初始请求时，编译应用程序。</li>
  <li>应用程序在编译后执行，并为应用程序构建一个新的组件树，并放置在FacesContext中。</li>
  <li>使用由<code>EL</code>表达式表示的组件和与其关联受托管<code>bean</code>属性填充组件树。</li>
  <li>基于组件树。 建立了新的视图。</li>
  <li>该视图作为响应呈现给请求客户端。</li>
  <li>组件树被自动销毁。</li>
  <li>在后续请求中，重新构建组件树，并应用已保存的状态。</li>
 </ul>
 <br>      
</div></body></html>