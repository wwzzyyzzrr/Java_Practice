<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">JSF自定义验证器类</h1><div style="width:100%;float:left;" class="article-content">   
 <p>我们可以在JSF中创建自己的自定义验证器。以下列表是在JSF中创建自定义验证器的步骤。</p> 
 <ul> 
  <li>通过实现<code>javax.faces.validator.Validator</code>接口创建一个验证器类。</li>
  <li>实现上面接口的<code>validate()</code>方法。</li>
  <li>使用注释<code><a target="_blank" href="https://github.com/FacesValidator" title="@FacesValidator" class="at-link">@FacesValidator</a></code>为自定义验证器分配唯一的ID。</li>
 </ul> 
 <h2 id="h2-u81EAu5B9Au4E49u9A8Cu8BC1u5668u7C7Bu5B9Eu4F8B"><a name="自定义验证器类实例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>自定义验证器类实例</h2>
 <p>打开 <strong>NetBeans IDE</strong> 创建一个Web工程：<strong>CustomValidator</strong>，其目录结构如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2504/449110439_35872.png" alt=""></p> 
 <p>创建以下文件代码，文件：<em>index.xhtml</em> 的代码内容如下所示 -</p> 
 <pre><code class="lang-html">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"&gt;
    &lt;h:body&gt;
        &lt;h:form&gt;
            &lt;h:panelGrid columns="3"&gt;
                Enter your email :
                &lt;h:inputText id="email" value="#{user.email}" 
                             size="20" required="true" label="Email Address"&gt;
                    &lt;f:validator validatorId="com.yiibai.EmailValidator" /&gt;
                &lt;/h:inputText&gt;
                &lt;h:message for="email" style="color:red" /&gt;
            &lt;/h:panelGrid&gt;
            &lt;h:commandButton value="Submit" action="result" /&gt;
        &lt;/h:form&gt;
    &lt;/h:body&gt;
&lt;/html&gt;
</code></pre> 
 <p>文件：<em>result.xhtml</em> 的代码内容如下所示 -</p> 
 <pre><code class="lang-html">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      &gt;
    &lt;h:body&gt;

        &lt;h1&gt;Custom validator in JSF 2.0&lt;/h1&gt;

        &lt;h:panelGrid columns="2"&gt;

            Email Address :  
            &lt;h:outputText value="#{user.email}" /&gt;

        &lt;/h:panelGrid&gt;

    &lt;/h:body&gt;
&lt;/html&gt;
</code></pre> 
 <p>文件：<em>EmailValidator.java</em> 的代码内容如下所示 -</p> 
 <pre><code class="lang-java">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.yiibai;

/**
 *
 * @author Administrator
 */
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.validator.FacesValidator;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;

@FacesValidator("com.yiibai.EmailValidator")
public class EmailValidator implements Validator {

    private static final String EMAIL_PATTERN = "^[_A-Za-z0-9-]+(\\."
            + "[_A-Za-z0-9-]+)*@[A-Za-z0-9]+(\\.[A-Za-z0-9]+)*"
            + "(\\.[A-Za-z]{2,})$";

    private Pattern pattern;
    private Matcher matcher;

    public EmailValidator() {
        pattern = Pattern.compile(EMAIL_PATTERN);
    }

    @Override
    public void validate(FacesContext context, UIComponent component,
            Object value) throws ValidatorException {

        matcher = pattern.matcher(value.toString());
        if (!matcher.matches()) {

            FacesMessage msg
                    = new FacesMessage("E-mail validation failed.",
                            "Invalid E-mail format.");
            msg.setSeverity(FacesMessage.SEVERITY_ERROR);
            throw new ValidatorException(msg);

        }

    }

}
</code></pre> 
 <p>文件：<em>User.java</em> 的代码内容如下所示 -</p>   
 <pre><code class="lang-java">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.yiibai;

/**
 *
 * @author Maxsu
 */
import java.io.Serializable;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean(name = "user")
@SessionScoped
public class User implements Serializable {

    private static final long serialVersionUID = 1L;

    String email;

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

}
</code></pre> 
 <p>右键运行工程：<strong>CustomValidator</strong>，如果没有任何错误，打开浏览器访问：</p> 
 <pre><code>http://localhost:8084/CustomValidator/
</code></pre>
 <p>应该会看到以下结果 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2504/697110448_87132.png" alt=""></p> 
 <p>简单写入一些信息(输入一个无效的Email地址)，然后提交 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201704/2504/162110445_51053.png" alt=""></p>
 <br>      
</div></body></html>