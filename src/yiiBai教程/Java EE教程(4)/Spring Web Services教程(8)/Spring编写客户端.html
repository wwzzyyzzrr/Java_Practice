<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Spring编写客户端</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，我们将学习如何使用Spring WS为<a target="_blank" href="https://www.yiibai.com/springws/springws_write_server.html" title="Spring WS编写服务器">Spring WS编写服务器</a>中创建的Web应用程序服务器创建客户端。</p> 
 <p><strong>第1步:</strong> 按照Spring WS编写服务章节中的说明,更新项目<em>countryService</em> 下的<code>com.yiibai</code>包。</p> 
 <p><strong>第2步:</strong> 按照以下步骤中的说明在<code>com.yiibai.client</code>包创建一个文件:<em>CountryServiceClient.java</em>，以及在<code>com.yiibai</code>包下创建一个文件:<code>MainApp.java</code> 。</p> 
 <p>文件:<em>CountryServiceClient.java</em> 的代码如下 - </p> 
 <pre><code class="lang-java">package com.yiibai.client;

import org.springframework.ws.client.core.support.WebServiceGatewaySupport;
import com.yiibai.GetCountryRequest;
import com.yiibai.GetCountryResponse;

public class CountryServiceClient extends WebServiceGatewaySupport {
   public GetCountryResponse getCountryDetails(String country){
      String uri = "http://localhost:8080/countryService/";
      GetCountryRequest request = new GetCountryRequest();
      request.setName(country);

      GetCountryResponse response =(GetCountryResponse) getWebServiceTemplate()
         .marshalSendAndReceive(uri, request);
      return response;
   }
}
</code></pre> 
 <p>文件:<em>CountryServiceClient.java</em> 的代码如下 - </p> 
 <pre><code class="lang-java">package com.yiibai;

import org.springframework.oxm.jaxb.Jaxb2Marshaller;
import com.yiibai.client.CountryServiceClient;

public class MainApp {
   public static void main(String[] args) {
      CountryServiceClient client = new CountryServiceClient();
      Jaxb2Marshaller marshaller = new Jaxb2Marshaller();
      marshaller.setContextPath("com.yiibai");
      client.setMarshaller(marshaller);
      client.setUnmarshaller(marshaller);
      GetCountryResponse response = client.getCountryDetails("United States");

      System.out.println("Country : " + response.getCountry().getName());
      System.out.println("Capital : " + response.getCountry().getCapital());
      System.out.println("Population : " + response.getCountry().getPopulation());
      System.out.println("Currency : " + response.getCountry().getCurrency());
   }
}
</code></pre> 
 <p><strong>启动Web服务</strong></p> 
 <p>启动Tomcat服务器，并确保可以使用标准浏览器从webapps文件夹访问其他网页。</p> 
 <p><strong>测试Web服务客户端</strong></p> 
 <p>在Eclipse下的应用程序中右键单击<code>MainApp.java</code>并使用作为Java Application命令运行。 如果应用程序一切正常，它将打印以下消息。</p>   
 <pre><code class="lang-shell">Country : United States
Capital : Washington
Population : 46704314
Currency : USD
</code></pre> 
 <p>在这里，我们基于SOAP的Web服务创建了一个Client - <code>CountryServiceClient.java</code>。 MainApp使用<code>CountryServiceClient</code>命中Web服务，发出POST请求并获取数据。</p>
 <br>      
</div></body></html>