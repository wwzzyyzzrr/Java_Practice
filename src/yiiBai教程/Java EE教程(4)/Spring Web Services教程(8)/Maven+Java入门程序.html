<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Maven+Java入门程序</h1><div style="width:100%;float:left;" class="article-content">   
 <p>本指南将引导您使用Maven构建一个简单的Java项目。</p> 
 <p><strong>创建什么功能？</strong></p> 
 <p>我们将学习如何创建一个提供时间的应用程序，然后使用Maven构建它。</p> 
 <p><strong>需要什么？</strong></p> 
 <ul> 
  <li>大约15分钟的时间</li>
  <li>最喜欢的文本编辑器或IDE</li>
  <li>JDK8或更高版本</li>
 </ul> 
 <p><strong>如何完成本指南</strong></p> 
 <p>像大多数Spring入门教程一样，可以从头开始并完成每个步骤，也可以绕过已熟悉的基本设置步骤。无论哪种方式，最后需要编写代码。</p> 
 <h2 id="h2-u8BBEu7F6Eu9879u76EE"><a name="设置项目" class="reference-link"></a><span class="header-link octicon octicon-link"></span>设置项目</h2>
 <p>首先，我们需要为Maven创建一个Java项目。要将重点放在Maven上，并尽可能简化项目。 在选择的项目文件夹中创建此结构。</p> 
 <p><strong>创建目录结构</strong></p> 
 <p>在您选择的项目目录中，创建以下子目录结构; 例如，在*nix系统上使用 <code>mkdir -p src/ main/java/hello</code>(在Windows系统上，请自己创建这个目录结构，在本示例创建的目录是:<code>D:\worksp\springws\firstapp</code>):</p> 
 <pre><code class="lang-shell">└── src
    └── main
        └── java
            └── hello
</code></pre> 
 <p>在<code>src/main/java/hello</code>目录中，可以创建任何想要的Java类。 但是要与本教程的其余部分保持一致，请创建这两个类:<code>HelloWorld.java</code>和<code>Greeter.java</code>。</p> 
 <p>文件:<em>src/main/java/hello/HelloWorld.java</em> - </p> 
 <pre><code class="lang-java">package hello;

public class HelloWorld {
    public static void main(String[] args) {
        Greeter greeter = new Greeter();
        System.out.println(greeter.sayHello());
    }
}
</code></pre> 
 <p>文件:<em>src/main/java/hello/Greeter.java</em> - </p> 
 <pre><code class="lang-java">package hello;

public class Greeter {
    public String sayHello() {
        return "Hello world!";
    }
}
</code></pre> 
 <p>既然已经准备好使用Maven构建项目，那么下一步就是安装Maven。</p> 
 <p>Maven可以在 <a target="_blank" href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a> 或 <a target="_blank" href="http://mirrors.hust.edu.cn/apache/maven/">http://mirrors.hust.edu.cn/apache/maven/</a> 下载为zip文件。只使用二进制文件，所以请查看<code>apache-maven-{version}-bin.zip</code>或<code>apache-maven-{version}bin.tar.gz</code>的链接。</p> 
 <p>下载完压缩文件后，将其解压缩到您的计算机上。 然后将<code>bin</code>文件夹添加到环境变量路径中。</p> 
 <blockquote> 
  <p>注意:如果了解如何安装Maven，请参考: <a target="_blank" href="https://www.yiibai.com/maven/maven_environment_setup.html">https://www.yiibai.com/maven/maven_environment_setup.html</a> </p> 
 </blockquote> 
 <p>要测试Maven安装，请从命令行运行mvn:</p> 
 <pre><code class="lang-shell">mvn -v
</code></pre> 
 <p>如果一切顺利，应该看到一些关于Maven安装的信息。它看起来类似于(但可能略有不同)以下输出内容:</p> 
 <pre><code class="lang-shell">C:\Users\Administrator&gt;mvn -v
Apache Maven 3.5.3 (3383c37e1f9e9b3bc3df5050c29c8aff9f295297; 2018-02-25T03:49:0
5+08:00)
Maven home: D:\software\apache-maven-3.5.3\bin\..
Java version: 1.8.0_65, vendor: Oracle Corporation
Java home: D:\Program Files\Java\jdk1.8.0_65\jre
Default locale: zh_CN, platform encoding: GBK
OS name: "windows 7", version: "6.1", arch: "amd64", family: "windows"
</code></pre> 
 <p>恭喜！ 你现在已经成功地安装了Maven。</p> 
 <h2 id="h2--maven-"><a name="定义一个简单的Maven构建" class="reference-link"></a><span class="header-link octicon octicon-link"></span>定义一个简单的Maven构建</h2>
 <p>既然已经安装了Maven，需要创建一个Maven项目定义。 Maven项目使用名为<code>pom.xml</code>的XML文件进行定义。 除此之外，该文件还提供项目的名称，版本和它在外部库上的依赖关系。</p> 
 <p>在项目的根目录下创建一个名为<code>pom.xml</code>的文件(即将其放在src文件夹同级)并为其提供以下内容:</p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-maven&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;properties&gt;
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer
                                    implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                                    &lt;mainClass&gt;hello.HelloWorld&lt;/mainClass&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre> 
 <p>除了可选的<code>&lt;packaging&gt;</code>元素外，其它可以省略，这是构建Java项目所需的最简单的<code>pom.xml</code>文件。 它包含项目配置的以下详细信息:</p> 
 <ul> 
  <li><code>&lt;modelVersion&gt;</code> - POM模型版本(当前使用<code>4.0.0</code>)。</li>
  <li><code>&lt;groupId&gt;</code> - 该项目所属的组或组织， 通常使用反向域名表示。</li>
  <li><code>&lt;artifactId&gt;</code> - 要赋予项目库工件的名称(例如，其JAR或WAR文件的名称)。</li>
  <li><code>&lt;version&gt;</code> - 正在构建的项目版本。</li>
  <li><code>&lt;packaging&gt;</code> - 项目应该如何打包。JAR文件打包默认为“jar”。 WAR文件打包使用“war”。</li>
 </ul> 
 <p>到了这里，您已经定义了一个最小但功能强大的Maven项目。</p> 
 <h2 id="h2--java-"><a name="构建Java代码" class="reference-link"></a><span class="header-link octicon octicon-link"></span>构建Java代码</h2>
 <p>Maven现在已准备好构建该项目。 您现在可以使用Maven执行几个构建生命周期目标，包括编译项目代码的目标，创建库包(如JAR文件)以及将库安装在本地Maven依赖项存储库中。</p> 
 <p>要尝试构建，请在命令行中输入以下内容:</p> 
 <pre><code class="lang-shell">mvn compile
</code></pre> 
 <p>这将运行Maven，告诉它执行编译目标。 完成后，应该在<code>target/classes</code>目录中找到已编译的<code>.class</code>文件。</p> 
 <p>由于不想直接分发或处理<code>.class</code>文件，那么可运行包目标:</p> 
 <pre><code class="lang-shell">mvn package
</code></pre> 
 <p>包目标将编译您的Java代码，并运行测试，并通过将代码打包到目标目录中的JAR文件中完成。 JAR文件的名称将基于项目的<code>&lt;artifactId&gt;</code>和<code>&lt;version&gt;</code>。 例如，上面给出的最小<code>pom.xml</code>文件，JAR文件将被命名为<code>gs-maven-0.1.0.jar</code>。</p> 
 <p>如果您已将<code>&lt;packaging&gt;</code>的值从“jar”更改为“war”，则结果将是目标目录中的WAR文件而不是JAR文件。</p> 
 <p>Maven还在本地机器上维护一个依赖库(通常位于主目录的<code>.m2/repository</code>目录中)，以便快速访问项目依赖项。如果想将项目的JAR文件安装到本地存储库，那么应该调用安装目标:</p> 
 <pre><code class="lang-shell">mvn install
</code></pre> 
 <p>安装目标将编译，测试和打包项目代码，然后将其复制到本地依赖项存储库中，以供其他项目将其作为依赖项引用。</p> 
 <p>说到依赖关系，现在是时候在Maven构建中声明依赖关系了。</p> 
 <h2 id="h2-u58F0u660Eu4F9Du8D56u5173u7CFB"><a name="声明依赖关系" class="reference-link"></a><span class="header-link octicon octicon-link"></span>声明依赖关系</h2>
 <p>简单的Hello World示例是完全自包含的，不依赖于任何其他库。 然而，大多数应用程序依赖于外部库来处理常见和复杂的功能。</p> 
 <p>例如，假设除了说出“Hello World！”之外，还希望应用程序打印当前的日期和时间。 您可以在本地Java库中使用日期和时间工具实现，但这里为了更好的演示，使用Joda Time库来实现。</p> 
 <p>首先，将<em>HelloWorld.java</em> (文件:<em>src/main/java/hello/HelloWorld.java</em>)改为如下所示:</p> 
 <pre><code class="lang-java">package hello;

import org.joda.time.LocalTime;

public class HelloWorld {
    public static void main(String[] args) {
        LocalTime currentTime = new LocalTime();
        System.out.println("The current local time is: " + currentTime);
        Greeter greeter = new Greeter();
        System.out.println(greeter.sayHello());
    }
}
</code></pre> 
 <p>这里HelloWorld使用Joda Time的LocalTime类来获取并打印当前时间。</p> 
 <p>如果现在要运行<code>mvn compile</code>来构建项目，则构建会失败，因为我们尚未将Joda Time声明为构建中的编译依赖项。可以通过将以下行添加到<code>pom.xml</code>(在<code>&lt;project&gt;</code>元素中)来解决该问题:</p>   
 <pre><code class="lang-xml">&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;joda-time&lt;/groupId&gt;
            &lt;artifactId&gt;joda-time&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre> 
 <p>这个XML块为项目声明了一个依赖关系列表。 具体来说，它声明了Joda时间库的一个依赖项。 在<code>&lt;dependency&gt;</code>元素中，依赖关系坐标由三个子元素定义:</p> 
 <ul> 
  <li><code>&lt;groupId&gt;</code> - 依赖项所属的组或组织。</li>
  <li><code>&lt;artifactId&gt;</code> - 需要的类库。</li>
  <li><code>&lt;version&gt;</code> - 需要的库的特定版本。</li>
 </ul> 
 <p>默认情况下，所有依赖项的作用范围都是编译依赖关系。 也就是说，它们应该在编译时可用(并且如果正在构建WAR文件，包括WAR中的<code>/WEB-INF/libs</code>文件夹)。 另外，可以指定一个<code>&lt;scope&gt;</code>元素来指定下列其中一个范围:</p> 
 <ul> 
  <li><code>provided</code> - 编译项目代码所需的依赖项，但运行时由运行代码的容器(例如Java Servlet API)提供。</li>
  <li><code>test</code> - 用于编译和运行测试的依赖项，但不是构建或运行项目运行时代码所必需的。</li>
 </ul> 
 <p>现在，如果运行<code>mvn compile</code>或mvn包，Maven应该解决来自Maven Central存储库的Joda Time依赖关系，并且构建将会成功。</p> 
 <h2 id="h2-u7F16u5199u6D4Bu8BD5"><a name="编写测试" class="reference-link"></a><span class="header-link octicon octicon-link"></span>编写测试</h2>
 <p>首先将JUnit作为依赖添加到<code>pom.xml</code>中，在测试范围内:</p> 
 <pre><code class="lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;junit&lt;/groupId&gt;
    &lt;artifactId&gt;junit&lt;/artifactId&gt;
    &lt;version&gt;4.12&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre> 
 <p>然后创建一个测试用例(文件:<em>src/test/java/hello/GreeterTest.java</em>):</p> 
 <pre><code class="lang-java">package hello;

import static org.hamcrest.CoreMatchers.containsString;
import static org.junit.Assert.*;

import org.junit.Test;

public class GreeterTest {

    private Greeter greeter = new Greeter();

    @Test
    public void greeterSaysHello() {
        assertThat(greeter.sayHello(), containsString("Hello"));
    }

}
</code></pre> 
 <p>Maven使用名为“surefire”的插件来运行单元测试。 该插件的默认配置编译并运行<code>src/test/java</code>中名称匹配<code>*Test</code>的所有类。 您可以像这样在命令行上运行测试 - </p> 
 <pre><code class="lang-shell">mvn test
</code></pre> 
 <p>或者只是使用mvn安装步骤，因为我们已经在上面展示过了(有一个生命周期定义，其中“test”包含在“install”中的一个阶段)。</p> 
 <p>以下是完整的<code>pom.xml</code>文件代码:</p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-maven&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;properties&gt;
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;!-- tag::joda[] --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;joda-time&lt;/groupId&gt;
            &lt;artifactId&gt;joda-time&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- end::joda[] --&gt;
        &lt;!-- tag::junit[] --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;!-- end::junit[] --&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                                    &lt;mainClass&gt;hello.HelloWorld&lt;/mainClass&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre> 
 <p>完成的<em>pom.xml</em> 文件使用Maven Shade插件来简化JAR文件的可执行性。本教程是使用Maven来开发，不使用特定的插件。</p> 
 <p>编译结果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201805/2805/511090545_52225.png" alt=""></p> 
 <p>运行测试结果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201805/2805/321090547_68418.png" alt=""></p> 
 <p>运行输出结果 - </p> 
 <pre><code class="lang-shell">D:\worksp\springws\firstapp&gt;java -jar target/gs-maven-0.1.0.jar
The current local time is: 09:52:01.046
Hello world!

D:\worksp\springws\firstapp&gt;
</code></pre> 
 <p>可以看到，程序已经输出当前时间。</p>
 <br>      
</div></body></html>