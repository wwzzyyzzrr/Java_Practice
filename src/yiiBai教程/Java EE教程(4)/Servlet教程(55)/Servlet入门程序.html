<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Servlet入门程序</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在这节中，我们将演示如何手动来创建一个简单的Servlet应用程序。需要遵循以下步骤，这些步骤对于所有Web服务器是常见的。在这个示例中，使用的是Apache Tomcat8服务器。Apache Tomcat是用于测试servlet和JSP技术的开源Web服务器。</p> 
 <p>这一节非常关键，希望您能仔细按照步骤说明来操作。能否手动开发一个Servlet运行成功，可能会影响到学习的热情。</p> 
 <p>在开始之前，需要安装两个软件：</p> 
 <ul> 
  <li>Java/JDK 8</li>
  <li>Tomcat 8</li>
 </ul> 
 <blockquote> 
  <p>注意： Java安装好后，需要将它加到系统的环境变量中。可参考：<a target="_blank" href="http://www.yiibai.com/java/java_environment_setup.html">http://www.yiibai.com/java/java_environment_setup.html</a> </p> 
 </blockquote> 
 <p><strong>安装Tomcat</strong></p> 
 <p>在开始编写代码之前，需要您自己<a target="_blank" href="http://tomcat.apache.org/download-80.cgi" title="下载最新版本的Tomcat Server">下载最新版本的Tomcat Server</a>并将其安装在您的计算机上。</p> 
 <p>打开网址： <a target="_blank" href="http://tomcat.apache.org/download-80.cgi">http://tomcat.apache.org/download-80.cgi</a> 下载 <em>apache-tomcat-8.5.23-windows-x64.zip</em> ，如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/0910/753171029_43773.png" alt=""></p> 
 <p>下载完成后，将它解压到一个合适的位置，如：<em>D:\software\apache-tomcat-8.5.23</em> ， 然后运行Tomcat服务器测试运行情况，可通过双击文件：<em>D:\software\apache-tomcat-8.5.23\bin\startup.bat</em> 来启动，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/0910/512171032_16132.png" alt=""></p> 
 <p>测试运行Tomcat服务器运行情况，打开浏览器，访问地址：<a target="_blank" href="http://localhost:8080">http://localhost:8080</a> 应该会看到类似的界面 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/0910/268171034_17364.png" alt=""></p> 
 <p>在机器上安装<em>Tomcat Server</em>后，请按照以下步骤操作：</p> 
 <ol> 
  <li>创建应用程序目录结构。</li>
  <li>创建一个Servlet</li>
  <li>编译Servlet</li>
  <li>创建应用程序部署描述符</li>
  <li>启动服务器并部署应用程序</li>
 </ol> 
 <p>下面详细介绍所有这五个步骤，首先创建第一个Servlet应用程序。</p> 
 <h2 id="h2-1-"><a name="1.创建应用程序目录结构" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1.创建应用程序目录结构</h2>
 <p><em>Sun Microsystem</em>定义了创建servlet应用程序必须遵循的目录结构。这里以一个名称为：<em>First</em> 的应用为示例，介绍一个典型servlet应用程序的目录结构 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/0910/887161002_10639.jpg" alt=""></p> 
 <p>在<em>Apache-Tomcat\webapps</em>目录下创建上述目录结构。所有HTML，静态文件(图像，css等)都直接保存在Web应用程序(<em>webapps</em>)文件夹下。 而所有Servlet类都保存在<code>classes</code>文件夹中。</p> 
 <p><code>web.xml</code>(部署描述符)文件保存在<em>WEB-INF</em>文件夹下。</p> 
 <h2 id="h2-2-servlet"><a name="2.创建一个Servlet" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2.创建一个Servlet</h2>
 <p>创建<code>servlet</code>有三种不同的方法。</p> 
 <ol> 
  <li>通过实现<code>Servlet</code>接口</li>
  <li>扩展<code>GenericServlet</code>类</li>
  <li>通过扩展<code>HttpServlet</code>类</li>
 </ol> 
 <p>但是大部分<code>servlet</code>是通过扩展<code>HttpServlet</code>抽象类创建的。如前所述<code>HttpServlet</code>给出了<code>Servlet</code>接口的<code>service()</code>方法的定义。我们将创建<code>Servlet</code>类但不需要覆盖<code>service()</code>方法。<code>Servlet</code>类将仅覆盖<code>doGet()</code>或<code>doPost()</code>方法。</p> 
 <p>当<code>servlet</code>的请求进入时，Web容器首先将调用<code>servlet</code>的<code>service()</code>方法，并根据<code>service()</code>方法的请求类型来调用<code>doGet()</code>或<code>doPost()</code>方法)。</p> 
 <blockquote> 
  <p>注意：默认情况下，请求是<code>Get</code>请求。</p> 
 </blockquote> 
 <p>创建一个类：<em>MyServlet.java</em>，并将这个类文件放在<em>F:\worksp\servlet\First</em>目录下，其代码如下所示 - </p> 
 <pre><code class="lang-java">import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;

public class MyServlet extends HttpServlet
{
 public void doGet(HttpServletRequest request,HttpServletResponse response) 
                     throws ServletException, IOException 
 {
   response.setContentType("text/html");
   PrintWriter out = response.getWriter();
   out.println("&lt;html&gt;&lt;body&gt;");
   out.println("&lt;h2 style='text-align:center'&gt;Hello Servlet ~&lt;/h2&gt;");
   out.println("&lt;/body&gt;&lt;/html&gt;");
 }
}
</code></pre> 
 <p>然后编译它(在下一步中解释)，并将类生成的<em>MyServlet.class</em>文件粘贴到<em>WEB-INF/classes/</em>目录中，此<em>WEB-INF/classes/</em>目录必须在<em>Tomcat/webapps</em>目录中创建。</p> 
 <h2 id="h2-3-servlet-"><a name="3.编译Servlet类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3.编译Servlet类</h2>
 <p>要编译Servlet，需要一个JAR文件。不同的服务器需要不同的JAR文件。在Apache Tomcat服务器需要的是<code>servlet-api.jar</code>文件来编译servlet类。</p> 
 <p>编译Servlet的步骤如下 - </p> 
 <ul> 
  <li>首先需要确定是否已将JDK加到系统环境变量中，可通过在命令行上输入验证：<code>java -version</code>，如已添加，则应该返回类似的结果 -<br><img src="http://www.yiibai.com/uploads/images/201710/0910/419161018_61766.png" alt=""></li>
  <li>下载<code>servlet-api.jar</code>文件，下载地址：<a target="_blank" href="http://mvnrepository.com/artifact/javax.servlet/servlet-api/3.0-alpha-1">http://mvnrepository.com/artifact/javax.servlet/servlet-api/3.0-alpha-1</a> 或者从Tomcat的安装目录：<em>D:\software\apache-tomcat-8.5.23\lib</em> 中找到。</li>
  <li>将下载好的<code>servlet-api.jar</code>文件粘贴到一个目录，如：<code>F:\worksp\servlet\library</code>目录下，用于编译<code>Servlet</code>类。</li>
  <li>编译<code>MyServlet</code>类，如下所示 - </li>
 </ul>   
 <pre><code class="lang-shell">F:\worksp\servlet\First&gt; javac -Djava.ext.dirs=F:\worksp\servlet\library MyServlet.java
</code></pre> 
 <p>如果编译没有问题，那么将会在当前目录下生成一个类文件：<em>MyServlet.class</em> ，然后将类文件<em>MyServlet.class</em>粘贴到<code>F:\worksp\servlet\First\WEB-INF\classes</code>目录中。</p> 
 <h2 id="h2-4-"><a name="4.创建部署描述符" class="reference-link"></a><span class="header-link octicon octicon-link"></span>4.创建部署描述符</h2>
 <p>部署描述符(DD)是由Web容器用于运行Servlet和JSP页面的XML文档。部署描述符用于完成几个重要的工作，如：</p> 
 <ul> 
  <li>将URL映射到Servlet类</li>
  <li>初始化参数</li>
  <li>定义错误页面</li>
  <li>安全角色</li>
  <li>声明标签库</li>
 </ul> 
 <p>稍后将详细讨论所有这些。现在来看看我们为这个Web应用程序创建一个简单的<code>web.xml</code>文件。</p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5"&gt;
  &lt;display-name&gt;MyFirstServlet&lt;/display-name&gt;
  &lt;welcome-file-list&gt;
    &lt;!--// 默认主页--&gt;
    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;
    &lt;welcome-file&gt;default.html&lt;/welcome-file&gt;
    &lt;welcome-file&gt;default.html&lt;/welcome-file&gt;
    &lt;welcome-file&gt;default.jsp&lt;/welcome-file&gt;
  &lt;/welcome-file-list&gt;
  &lt;servlet&gt;
    &lt;description&gt;&lt;/description&gt;
    &lt;display-name&gt;MyServlet&lt;/display-name&gt;&lt;!--// 类的显示名称 --&gt;
    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;&lt;!--// 类的别名 --&gt;
    &lt;servlet-class&gt;MyServlet&lt;/servlet-class&gt;&lt;!--// 类的名称 --&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;&lt;!--// 类的别名 --&gt;
    &lt;url-pattern&gt;/hello&lt;/url-pattern&gt;&lt;!--// 请求此类的对应URL --&gt;
  &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</code></pre> 
 <p><strong>web.xml文件元素的说明</strong></p> 
 <p><code>web.xml</code>文件中的元素太多。以下是上述<code>web.xml</code>文件中使用的一些元素的说明 - </p> 
 <ul> 
  <li><code>&lt;web-app&gt;</code>表示整个应用程序。</li>
  <li><code>&lt;servlet&gt;</code>是<code>&lt;web-app&gt;</code>的子元素，代表servlet。</li>
  <li><code>&lt;servlet-name&gt;</code>是<code>&lt;servlet&gt;</code>的子元素，表示servlet的名称。</li>
  <li><code>&lt;servlet-class&gt;</code>是<code>&lt;servlet&gt;</code>的子元素，表示servlet的类。</li>
  <li><code>&lt;servlet-mapping&gt;</code>是<code>&lt;web-app&gt;</code>的子元素。它用于映射servlet。</li>
  <li><code>&lt;url-pattern&gt;</code>是<code>&lt;servlet-mapping&gt;</code>的子元素。客户端使用此模式来调用servlet。</li>
 </ul> 
 <h2 id="h2-5-"><a name="5.启动服务器并部署应用程序" class="reference-link"></a><span class="header-link octicon octicon-link"></span>5.启动服务器并部署应用程序</h2>
 <p>将目录<em>F:\worksp\servlet\First</em> 拷贝到 <em>D:\software\apache-tomcat-8.5.23\webapps</em> 下部署这个应用程序。</p> 
 <p>双击<code>startup.bat</code>文件启动Apache Tomcat服务器。</p> 
 <p>或者，在Windows机器上在命令行提示执行以下命令。</p> 
 <pre><code class="lang-shell">D:\software\apache-tomcat-8.5.23\bin&gt; startup.bat
</code></pre> 
 <p>运行Servlet应用程序，打开浏览器输入并访问网址：http:localhost:8080/First/hello ，应该会看到类似的结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/0910/110171044_14202.png" alt=""></p> 
 <p>这样，我们的第一个Servlet应用程序就成功运行了。</p>
 <br>      
</div></body></html>