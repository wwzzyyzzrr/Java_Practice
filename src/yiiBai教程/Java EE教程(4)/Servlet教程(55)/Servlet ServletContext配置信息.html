<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Servlet ServletContext配置信息</h1><div style="width:100%;float:left;" class="article-content">   
 <p><code>ServletContext</code>的对象由Web容器在部署项目时创建。 该对象可用于从<code>web.xml</code>文件获取配置信息。 每个Web应用程序只有一个<code>ServletContext</code>对象。</p> 
 <p>如果有信息要共享给多个servlet使用，最好在<code>web.xml</code>文件中使用<code>&lt;context-param&gt;</code>元素提供它。</p> 
 <h2 id="h2-servletcontext-"><a name="ServletContext的优点" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ServletContext的优点</h2>
 <p>如果有任何信息要共享给所有的servlet使用，并且要让它容易维护，最好的办法就是在<code>web.xml</code>文件中提供这些信息，所以如果信息要更改直接在<code>web.xml</code>中修改，而不需要修改<code>servlet</code>代码。</p> 
 <p><strong>ServletContext接口的使用</strong></p> 
 <p>有很多ServletContext对象可以使用。 其中一些如下：</p> 
 <ul> 
  <li>ServletContext对象提供容器和servlet之间的接口。</li>
  <li>使用ServletContext对象在<code>web.xml</code>文件获取配置信息。</li>
  <li>ServletContext对象可用于设置，获取或删除<code>web.xml</code>文件中属性。</li>
  <li>ServletContext对象可用于提供应用程序间通信。</li>
 </ul> 
 <p>参考以下示意图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/1110/684161042_62257.jpg" alt=""></p> 
 <p><strong>常用的ServletContext接口方法</strong></p> 
 <p>给出了一些常用的<code>ServletContext</code>接口方法。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>序号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>public String getInitParameter(String name)</code></td> 
    <td>返回指定参数名称的参数值。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>public Enumeration getInitParameterNames()</code></td> 
    <td>返回上下文的初始化参数的名称。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>public void setAttribute(String name,Object object)</code></td> 
    <td>在应用程序范围内设置给定的对象。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>public Object getAttribute(String name)</code></td> 
    <td>返回指定名称的属性。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>public Enumeration getInitParameterNames()</code></td> 
    <td>返回上下文的初始化参数的名称，作为<code>String</code>对象的枚举。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>public void removeAttribute(String name)</code></td> 
    <td>从servlet上下文中删除给定名称的属性。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>如何获取ServletContext接口的对象?</strong></p> 
 <ul> 
  <li>通过<code>ServletConfig</code>接口的<code>getServletContext()</code>方法返回<code>ServletContext</code>对象。</li>
  <li>通过<code>GenericServlet</code>类的<code>getServletContext()</code>方法返回<code>ServletContext</code>对象。</li>
 </ul> 
 <p><strong>getServletContext()方法的语法</strong></p> 
 <pre><code class="lang-java">public ServletContext getServletContext()
</code></pre> 
 <p><strong>getServletContext()方法的示例</strong></p> 
 <pre><code class="lang-java">//We can get the ServletContext object from ServletConfig object  
ServletContext application=getServletConfig().getServletContext();  

//Another convenient way to get the ServletContext object  
ServletContext application=getServletContext();
</code></pre> 
 <p><strong>在Context范围内提供初始化参数的语法</strong></p> 
 <p>Web应用程序的<code>context-param</code>元素的子元素用于定义应用程序范围中的初始化参数。 参数名称和参数值是<code>context-param</code>的子元素。<code>param-name</code>元素定义参数名称，<code>param-value</code>定义其值。参考以下配置代码片段 - </p> 
 <pre><code class="lang-xml">&lt;web-app&gt;  
 ......  
  &lt;context-param&gt;  
    &lt;param-name&gt;parameter_name&lt;/param-name&gt;  
    &lt;param-value&gt;parameter_value&lt;/param-value&gt;  
  &lt;/context-param&gt;
 ......  
&lt;/web-app&gt;
</code></pre> 
 <h2 id="h2--servletcontext-"><a name="获取初始化参数的ServletContext示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>获取初始化参数的ServletContext示例</h2>
 <p>这个例子中，从<code>web.xml</code>文件获取初始化参数并打印初始化参数的值。请注意，<code>ServletContext</code>的对象表示应用程序范围。所以如果从<code>web.xml</code>文件中更改参数的值，所有的<code>servlet</code>类都将获得更改的值。所以不需要修改每个servlet中的值。最好通过<code>web.xml</code>文件中的<code>context-param</code>元素为多个<code>servlet</code>提供公共信息。下面来看一个简单的例子：</p> 
 <p>打开Eclipse，创建一个动态Web项目，其项目结构如下所示 - </p> 
 <p>以下是几个主要的代码文件 - </p> 
 <p>文件：<em>ContextServlet.java</em> - </p> 
 <pre><code class="lang-java">package com.yiibai;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class ContextServlet
 */
public class ContextServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse
     *      response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        // TODO Auto-generated method stub
        response.setContentType("text/html");
        PrintWriter pw = response.getWriter();

        // creating ServletContext object
        ServletContext context = getServletContext();

        // Getting the value of the initialization parameter and printing it
        String driverName = context.getInitParameter("dname");
        pw.println("driver name is = &lt;b&gt;'" + driverName+"'&lt;/b&gt;");

        pw.close();
    }

}
</code></pre> 
 <p>文件：<em>web.xml</em> - </p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
    id="WebApp_ID" version="3.1"&gt;
    &lt;display-name&gt;ServletContext&lt;/display-name&gt;
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;ContextServ&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.yiibai.ContextServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;

    &lt;context-param&gt;
        &lt;param-name&gt;dname&lt;/param-name&gt;
        &lt;param-value&gt;com.mysql.jdbc.Driver&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;ContextServ&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/context&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</code></pre> 
 <p>在编写完成上述代码后，部署这个Web应用，打开浏览器访问URL： <a target="_blank" href="http://localhost:8080/ServletContext/context">http://localhost:8080/ServletContext/context</a> ，如果程序没有错误，应该会看到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/1110/877171014_97705.png" alt=""></p> 
 <h2 id="h2--servletcontext-"><a name="获取所有初始化参数的ServletContext示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>获取所有初始化参数的ServletContext示例</h2>
 <p>在这个例子中，我们将从<code>web.xml</code>文件中获取所有初始化参数。要获取所有参数，需要在servlet类中使用<code>getInitParameterNames()</code>方法。</p> 
 <p>在上面项目中，新建一个名称为：<em>ContextServletAll.java</em> 的Servlet，其代码如下 - </p>   
 <pre><code class="lang-java">package com.yiibai;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.Enumeration;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class ContextServletAll
 */
public class ContextServletAll extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse
     *      response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        // TODO Auto-generated method stub
        response.setContentType("text/html");
        PrintWriter out = response.getWriter();

        ServletContext context = getServletContext();
        Enumeration&lt;String&gt; e = context.getInitParameterNames();
        String str = "";
        while (e.hasMoreElements()) {
            str = e.nextElement();
            out.print("&lt;br&gt; " + context.getInitParameter(str));
        }
    }

}
</code></pre> 
 <p>文件：<em>web.xml</em> - </p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
    id="WebApp_ID" version="3.1"&gt;
    &lt;display-name&gt;ServletContext&lt;/display-name&gt;
    &lt;welcome-file-list&gt;
        &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;
    &lt;/welcome-file-list&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;ContextServ&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.yiibai.ContextServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;
    &lt;context-param&gt;
        &lt;param-name&gt;dname&lt;/param-name&gt;
        &lt;param-value&gt;com.mysql.jdbc.Driver&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;ContextServ&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/context&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;ContextServAll&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.yiibai.ContextServletAll&lt;/servlet-class&gt;
    &lt;/servlet&gt;
    &lt;context-param&gt;
        &lt;param-name&gt;dname&lt;/param-name&gt;
        &lt;param-value&gt;com.mysql.jdbc.Driver&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;context-param&gt;
        &lt;param-name&gt;username&lt;/param-name&gt;
        &lt;param-value&gt;root&lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;context-param&gt;
        &lt;param-name&gt;password&lt;/param-name&gt;
        &lt;param-value&gt;mypasswd&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;servlet-mapping&gt;

        &lt;servlet-name&gt;ContextServAll&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/contextall&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</code></pre> 
 <p>在编写完成上述代码后，部署这个Web应用，打开浏览器访问URL： <a target="_blank" href="http://localhost:8080/ServletContext/contextall">http://localhost:8080/ServletContext/contextall</a> ，如果程序没有错误，应该会看到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201710/1110/745171041_67489.png" alt=""></p>
 <br>      
</div></body></html>