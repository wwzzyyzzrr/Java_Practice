<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Python日期和时间</h1><div style="width:100%;float:left;" class="article-content">   
 <p>Python程序可以通过多种方式处理日期和时间。日期格式之间的转换是计算机常见问题。Python的时间(<code>time</code>)和日历(<code>calendar</code>)模块可用于跟踪日期和时间。</p> 
 <h3 id="h3-u4E00u4E9Bu5E38u7528u4EE3u7801u793Au4F8B"><a name="一些常用代码示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>一些常用代码示例</h3>
 <ul> 
  <li><a target="_blank" href="http://www.yiibai.com/python/python_between_days.html" title="获取当前时间和日期">获取当前时间和日期</a>，如：2018-08-18 12：12：00</li>
  <li><a target="_blank" href="http://www.yiibai.com/python/python_between_days.html" title="计算两个日期相差天数">计算两个日期相差天数</a></li>
  <li>计算程序运行的时间</li>
 </ul> 
 <pre><code class="lang-python">#!/usr/bin/python3
#coding=utf-8

import time  
import datetime  

starttime = datetime.datetime.now()  

time.sleep(5)  

endtime = datetime.datetime.now()  
print ((endtime - starttime).seconds )
</code></pre> 
 <ul> 
  <li>计算十天之后的日期时间</li>
 </ul> 
 <pre><code class="lang-python">#!/usr/bin/python3
#coding=utf-8

import time  
import datetime  

d1 = datetime.datetime.now()  
d3 = d1 + datetime.timedelta(days =10)  

print (str(d3))
print (d3.ctime())
</code></pre> 
 <ul> 
  <li>获取两个日期时间的时间差</li>
 </ul> 
 <pre><code class="lang-python">t = (datetime.datetime(2019,1,13,12,0,0) - datetime.datetime.now()).total_seconds()
print ("t = ", t)
## 输出结果
t = 49367780.076406
</code></pre> 
 <p>Python中有提供与日期和时间相关的<code>4</code>个模块。它们分别是 - </p> 
 <table> 
  <thead> 
   <tr> 
    <th>模块</th> 
    <th>说明</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td><code>time</code></td> 
    <td><code>time</code>是一个仅包含与日期和时间相关的函数和常量的模块，在本模块中定义了<code>C/C++</code>编写的几个类。 例如，<code>struct_time</code>类。</td> 
   </tr> 
   <tr> 
    <td><code>datetime</code></td> 
    <td><code>datetime</code>是一个使用面向对象编程设计的模块，可以在Python中使用日期和时间。它定义了几个表示日期和时间的类。</td> 
   </tr> 
   <tr> 
    <td><code>calendar</code></td> 
    <td>日历是一个提供函数的模块，以及与<code>Calendar</code>相关的几个类，它们支持将日历映像生成为text，html，….</td> 
   </tr> 
   <tr> 
    <td><code>locale</code></td> 
    <td>该模块包含用于格式化或基于区域设置分析日期和时间的函数。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-1-"><a name="1. 时间间隔" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 时间间隔</h2>
 <p>时间间隔是以秒为单位的浮点数。 从1970年1月1日上午12:00(<em>epoch</em>)，这是一种时间的特殊时刻表示。</p> 
 <p>在Python中，当前时刻与上述特殊的某个时间点之间以秒为单位的时间。这个时间段叫做Ticks。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201706/2006/700100641_71063.png" alt=""></p> 
 <p><code>time</code>模块中的<code>time()</code>函数返回从1970年1月1日上午12点开始的秒数。</p> 
 <pre><code class="lang-python"># Import time module.
import time;

# Seconds
ticks = time.time()


print ("Number of ticks since 12:00am, January 1, 1970: ", ticks)
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">Number of ticks since 12:00am, January 1, 1970:  1497970093.6243818
</code></pre> 
 <p>但是，这个形式不能表示在时代(<em>1970年1月1日上午12:00</em>)之前的日期。在未来的日子也不能以这种方式表示 - 截止点是在<code>2038</code>年的UNIX和Windows的某个时刻。</p> 
 <h2 id="h2-2-timetuple-"><a name="2. 什么是TimeTuple？" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 什么是TimeTuple？</h2>
 <p>许多Python时间函数将时间处理为<code>9</code>个数字的元组，如下所示：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>索引</th> 
    <th>字段</th> 
    <th>值</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>0</td> 
    <td><code>4</code>位数，表示年份</td> 
    <td>2018，2019…</td> 
   </tr> 
   <tr> 
    <td>1</td> 
    <td>月份</td> 
    <td>1 ~ 12</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td>日期</td> 
    <td>1 ~ 31</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td>小时</td> 
    <td>0 ~ 23</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td>分钟</td> 
    <td>0 ~ 59</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td>秒</td> 
    <td>0 ~ 61(<code>60</code>或<code>61</code>是闰秒)</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td>星期几</td> 
    <td>0 ~ 6(<code>0</code>是星期一)</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td>一年的第几天</td> 
    <td>1 ~ 366(朱利安日)</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td>夏令时</td> 
    <td>-1，0，1，-1表示库确定DST</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>一个示例</strong></p> 
 <pre><code class="lang-python">import time
print (time.localtime());
</code></pre> 
 <p>这将产生如下结果：</p> 
 <pre><code class="lang-shell">time.struct_time(tm_year = 2016, tm_mon = 2, tm_mday = 15, tm_hour = 9, 
   tm_min = 29, tm_sec = 2, tm_wday = 0, tm_yday = 46, tm_isdst = 0)
</code></pre> 
 <p>上面的元组相当于<code>struct_time</code>结构。此结构具有以下属性 -</p> 
 <table> 
  <thead> 
   <tr> 
    <th>索引</th> 
    <th>字段</th> 
    <th>值</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>0</td> 
    <td>tm_year</td> 
    <td>2018，2019…</td> 
   </tr> 
   <tr> 
    <td>1</td> 
    <td>tm_mon</td> 
    <td>1 ~ 12</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td>tm_mday</td> 
    <td>1 ~ 31</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td>tm_hour</td> 
    <td>0 ~ 23</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td>tm_min</td> 
    <td>0 ~ 59</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td>tm_sec</td> 
    <td>0 ~ 61(<code>60</code>或<code>61</code>是闰秒)</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td>tm_wday</td> 
    <td>0 ~ 6(<code>0</code>是星期一)</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td>tm_yday</td> 
    <td>1 ~ 366(朱利安日)</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td>tm_isdst</td> 
    <td>-1，0，1，-1表示库确定DST</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>能用图片说明白的尽量用图片说明 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201706/2006/852100659_39889.png" alt=""></p> 
 <h3 id="h3-2-1-"><a name="2.1.获取当前时间" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2.1.获取当前时间</h3>
 <p>要将从时间浮点值开始的秒数瞬间转换为时间序列，将浮点值传递给返回具有所有有效九个项目的时间元组的函数(例如本地时间)。</p> 
 <pre><code class="lang-python">#!/usr/bin/python3
import time

localtime = time.localtime(time.time())
print ("Local current time :", localtime)

# 当前时间
curtime = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime())
print (curtime)
</code></pre> 
 <p>执行上面代码，这将产生如下结果 - </p> 
 <pre><code class="lang-shell">Local current time : time.struct_time(tm_year=2017, tm_mon=6, tm_mday=20, tm_hour=23, tm_min=9, tm_sec=36, tm_wday=1, tm_yday=171, tm_isdst=0)
Curtime is =&gt;  2017-06-20 23:09:36
</code></pre> 
 <h3 id="h3-2-2-"><a name="2.2.获取格式化时间" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2.2.获取格式化时间</h3>
 <p>可以根据需要格式化任何时间，但也可使用可读格式获取时间的简单方法是 - <code>asctime()</code> -</p> 
 <pre><code class="lang-python">#!/usr/bin/python3
import time

localtime = time.asctime( time.localtime(time.time()) )
print ("Local current time :", localtime)
</code></pre> 
 <p>执行上面代码，这将产生如下结果 - </p> 
 <pre><code class="lang-shell">Local current time : Mon Feb 15 10:32:13 2018
</code></pre> 
 <h3 id="h3-2-3-"><a name="2.3.获取一个月的日历" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2.3.获取一个月的日历</h3>
 <p><code>calendar</code>模块提供了广泛的方法来显示年历和月度日历。 在这里，将打印一个给定月份的日历(2021年11月) -</p> 
 <pre><code class="lang-python">#!/usr/bin/python3
import calendar

cal = calendar.month(2021, 11)
print ("Here is the calendar:")
print (cal)
</code></pre> 
 <p>执行上面代码后，将输出以下结果 - </p> 
 <pre><code class="lang-shell">   November 2021
Mo Tu We Th Fr Sa Su
 1  2  3  4  5  6  7
 8  9 10 11 12 13 14
15 16 17 18 19 20 21
22 23 24 25 26 27 28
29 30
</code></pre> 
 <h2 id="h2-3-"><a name="3.时间模块" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3.时间模块</h2>
 <p>Python中有一个受欢迎的时间(<code>time</code>)模块，它提供了处理时间和表示之间转换的功能。以下是所有时间(<code>time</code>)可用方法的列表。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_altzone.html" title="time.altzone">time.altzone</a></td> 
    <td>本地DST时区的偏移量(以秒为单位的UTC)，如果定义了有一个定义的话。 如果本地的DST时区是UTC的东部(如在西欧，包括英国)，那么它是负数值。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_asctime.html" title="time.asctime([tupletime])">time.asctime([tupletime])</a></td> 
    <td>接受时间元组，并返回一个可读的<code>24</code>个字符的字符串，例如’Tue Dec 11 22:07:14 2019’。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_clock.html" title="time.clock( )">time.clock( )</a></td> 
    <td>将当前CPU时间返回为浮点数秒。 为了测量不同方法的计算成本，<code>time.clock</code>的值比<code>time.time()</code>的值更有用。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_ctime.html" title="time.ctime([secs])">time.ctime([secs])</a></td> 
    <td>类似于<code>asctime(localtime(secs))</code>，而没有参数就像<code>asctime()</code></td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_gmtime.html" title="time.gmtime([secs])">time.gmtime([secs])</a></td> 
    <td>接受从时代(<em>epoch</em>)以秒为单位的瞬间，并返回与UTC时间相关的时间元组<code>t</code>。 注 - <code>t.tm_isdst</code>始终为<code>0</code></td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_localtime.html" title="time.localtime([secs])">time.localtime([secs])</a></td> 
    <td>接受从时代(<em>epoch</em>)以秒为单位的瞬间，并返回与本地时间相关的时间<code>t</code>(<code>t.tm_isdst</code>为<code>0</code>或<code>1</code>，具体取决于DST是否适用于本地规则的瞬时秒)。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_mktime.html" title="time.mktime(tupletime)">time.mktime(tupletime)</a></td> 
    <td>接受在本地时间表示为时间元组的瞬间，并返回浮点值，该时间点以秒为单位表示。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_sleep.html" title="time.sleep(secs)">time.sleep(secs)</a></td> 
    <td>暂停调用线程<code>secs</code>秒。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_strftime.html" title="time.strftime(fmt[,tupletime])">time.strftime(fmt[,tupletime])</a></td> 
    <td>接受在本地时间表示为时间元组的瞬间，并返回一个表示由字符串<code>fmt</code>指定的时间的字符串。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_strptime.html" title="time.strptime(str,fmt = '%a %b %d %H:%M:%S %Y">time.strptime(str,fmt = ‘%a %b %d %H:%M:%S %Y’)</a>“)</td> 
    <td>根据格式字符串<code>fmt</code>解析<code>str</code>，并返回时间元组格式的时间。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_time.html" title="time.time( )">time.time( )</a></td> 
    <td>返回当前时间时刻，即从时代(<em>epoch</em>)开始的浮点数秒数。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><a target="_blank" href="http://www.yiibai.com/python/time_tzset.html" title="time.tzset()">time.tzset()</a></td> 
    <td>重置库例程使用的时间转换规则。环境变量<code>TZ</code>指定如何完成。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>时间(<code>time</code>)模块有两个重要的属性可用。它们是 -</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>time.timezone</code></td> 
    <td>属性<code>time.timezone</code>是UTC和本地时区(不含DST)之间的偏移量(美洲为 &gt; <code>0</code>，欧洲，亚洲，非洲大部分地区为 <code>0</code>)。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>time.tzname</code></td> 
    <td>属性<code>time.tzname</code>是一对与区域相关的字符串，它们分别是没有和具有DST的本地时区的名称。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-4-"><a name="4.日历模块" class="reference-link"></a><span class="header-link octicon octicon-link"></span>4.日历模块</h2>
 <p><code>calendar</code>模块提供与日历相关的功能，包括为给定的月份或年份打印文本日历的功能。</p> 
 <p>默认情况下，日历将星期一作为一周的第一天，将星期日作为最后一天。 如果想要更改这个，可调用<code>calendar.setfirstweekday()</code>函数设置修改。</p> 
 <p>以下是<code>calendar</code>模块可用的功能函数列表 -</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>函数</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>calendar.calendar(year,w = 2,l = 1,c = 6)</code></td> 
    <td>返回一个具有年份日历的多行字符串格式化为三列，以<code>c</code>个空格分隔。 <code>w</code>是每个日期的字符宽度; 每行的长度为<code>21 * w + 18 + 2 * c</code>，<code>l</code>是每周的行数。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>calendar.firstweekday( )</code></td> 
    <td>返回当前设置每周开始的星期。默认情况下，当日历首次导入时设置为：<code>0</code>，表示为星期一。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>calendar.isleap(year)</code></td> 
    <td>如果给定年份(<code>year</code>)是闰年则返回<code>True</code>; 否则返回：<code>False</code>。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>calendar.leapdays(y1,y2)</code></td> 
    <td>返回在范围<code>(y1，y2)</code>内的年份中的闰年总数。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>calendar.month(year,month,w = 2,l = 1)</code></td> 
    <td>返回一个多行字符串，其中包含年份月份的日历，每周一行和两个标题行。 <code>w</code>是每个日期的字符宽度; 每行的长度为<code>7 * w + 6</code>。 <code>l</code>是每周的行数。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>calendar.monthcalendar(year,month)</code></td> 
    <td>返回<code>int</code>类型的列表。每个子列表表示一个星期。年份月份以外的天数设置为<code>0</code>; 该月内的日期设定为月份的第几日：1 ~ 31。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>calendar.monthrange(year,month)</code></td> 
    <td>返回两个整数。第一个是年度月(<code>month</code>)的星期几的代码; 第二个是当月的天数。表示星期几为<code>0</code>(星期一)至<code>6</code>(星期日); 月份是<code>1</code>到<code>12</code>。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>calendar.prcal(year,w = 2,l = 1,c = 6)</code></td> 
    <td>类似于：<code>calendar.calendar(year，w，l，c)</code>的打印。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>calendar.prmonth(year,month,w = 2,l = 1)</code></td> 
    <td>类似于：<code>calendar.month(year,month,w,l)</code>的打印。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>calendar.setfirstweekday(weekday)</code></td> 
    <td>将每周的第一天设置为星期几的代码。 星期几的代码为<code>0</code>(星期一)至<code>6</code>(星期日)。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>calendar.timegm(tupletime)</code></td> 
    <td><code>time.gmtime</code>的倒数：以时间元组的形式接受时刻，并返回与从时代(<code>epoch</code>)开始的浮点数相同的时刻。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>calendar.weekday(year,month,day)</code></td> 
    <td>返回给定日期的星期几的代码。星期几的代码为<code>0</code>(星期一)至<code>6</code>(星期日); 月数是<code>1</code>(1月)到<code>12</code>(12月)。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-5-"><a name="5.其他模块和功能" class="reference-link"></a><span class="header-link octicon octicon-link"></span>5.其他模块和功能</h2>
 <p>如果您有兴趣，那么可以在Python中找到其他重要的模块和功能列表，其中包含日期和时间。以下列出其它有用的模块 -</p> 
 <ul> 
  <li><code>datetime</code>模块</li>
  <li><code>pytz</code>模块</li>
  <li><code>dateutil</code>模块</li>
 </ul>
 <br>      
</div></body></html>