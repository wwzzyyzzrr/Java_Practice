<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">TCL包</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 包用于创建代码的可重用单位。程序包由提供特定功能的文件的集合。文件的这个集合是由包名称标识，可以有多个版本的相同的文件。所述包可以在Tcl脚本，二进制库的集合或两者的组合。</p> 
 <p> 包使用的命名空间的概念来避免变量名和过程名发生冲突。查看更多在我们的下一个<a target="_blank" href="http://www.yiibai.com/tcl/tcl_namespaces.html">命名空间教程</a>。</p> 
 <h2> 创建包</h2> 
 <p> 包可以以最小的两个文件的帮助下被创建。一个文件包含包代码。另一个文件包含声明包索引文件包。</p> 
 <p> 创建和使用程序包步骤列表如下。</p> 
 <h3> 步骤1：创建代码</h3> 
 <p> 对于包文件夹内创建代码表示 HelloWorld。该文件可以使用代码命名HelloWorld.tcl，如下所示。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># /Users/rajkumar/Desktop/helloworld/HelloWorld.tcl </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># Create the namespace</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">namespace</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">eval</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
 
  </span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># Export MyProcedure</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
  </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">namespace</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">export</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">MyProcedure</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
 
  </span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># My Variables</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
   </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">set</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> version </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.0</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
   </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">set</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">MyDescription</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"HelloWorld"</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
 
  </span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># Variable for the path of the script</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
   variable home </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">[</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">file join </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">[</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pwd</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">]</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">[</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">file dirname </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">[</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">info script</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">]]]</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
 
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
 
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># Definition of the procedure MyProcedure</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
proc </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">MyProcedure</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{}</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
	puts $HelloWorld</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">MyDescription</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">

</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">package</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> provide </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> $HelloWorld</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">version
</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">package</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">require</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Tcl</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">8.0</span></pre> 
 <h3> 第2步：创建包INDEX</h3> 
 <p> 打开tclsh。切换到HelloWorld目录，并使用pkg_mkIndex命令创建索引文件，如下图所示。</p> 
 <pre class="result notranslate" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; margin-bottom: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); line-height: 22px; background-color: rgb(241, 241, 241);">
% cd /Users/rajkumar/Desktop/helloworld 
% pkg_mkIndex . *.tcl</pre> 
 <h3> 第三步：添加目录到AUTOPATH</h3> 
 <p> 使用lappend命令来添加程序包到全局列表如下所示。</p>   
 <pre class="result notranslate" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; margin-bottom: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); line-height: 22px; background-color: rgb(241, 241, 241);">
% lappend auto_path "/Users/rajkumar/Desktop/helloworld"</pre> 
 <h3> 步骤4：添加软件包</h3> 
 <p> 接下来添加程序包使用程序包编程要求声明如下所示。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">%</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">package</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">require</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.0</span></pre> 
 <h3> 第5步：调用过程</h3> 
 <p> 现在，一切都被设置，可以调用我们的程序如下图所示。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">%</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> puts </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">[</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">MyProcedure</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">]</span></pre> 
 <p> 会得到下面的结果。</p> 
 <pre class="result notranslate" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; margin-bottom: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); line-height: 22px; background-color: rgb(241, 241, 241);">
HelloWorld</pre> 
 <p> 前两个步骤创建软件包。当程序包被创建，可以通过添加最后三个报表如下图所示，使用它在任何Tcl文件。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">lappend auto_path </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"/Users/rajkumar/Desktop/helloworld"</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">package</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">require</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.0</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
puts </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">[</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">::</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">MyProcedure</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">]</span></pre> 
 <p> 会得到下面的结果。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HelloWorld</span></pre> 
 <br>      
</div></body></html>