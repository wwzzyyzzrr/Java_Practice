<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">NumPy在数组上的迭代</h1><div style="width:100%;float:left;" class="article-content">   
 <h1 id="h1-numpy-"><a name="NumPy - 数组上的迭代" class="reference-link"></a><span class="header-link octicon octicon-link"></span>NumPy - 数组上的迭代</h1>
 <p>NumPy 包包含一个迭代器对象<code>numpy.nditer</code>。 它是一个有效的多维迭代器对象，可以用于在数组上进行迭代。 数组的每个元素可使用 Python 的标准<code>Iterator</code>接口来访问。</p> 
 <p>让我们使用<code>arange()</code>函数创建一个 3X4 数组，并使用<code>nditer</code>对它进行迭代。</p> 
 <h3 id="h3--1"><a name="示例 1" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例 1</h3>
 <pre><code class="lang-python">import numpy as np
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '原始数组是：'  
print a print  '\n'  
print  '修改后的数组是：'  
for x in np.nditer(a):  
    print x,
</code></pre> 
 <p>输出如下：</p> 
 <pre><code class="lang-python">原始数组是：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

修改后的数组是：
0 5 10 15 20 25 30 35 40 45 50 55
</code></pre> 
 <h3 id="h3--2"><a name="示例 2" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例 2</h3>
 <p>迭代的顺序匹配数组的内容布局，而不考虑特定的排序。 这可以通过迭代上述数组的转置来看到。</p> 
 <pre><code class="lang-python">import numpy as np 
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '原始数组是：'  
print a 
print  '\n'  
print  '原始数组的转置是：' 
b = a.T 
print b 
print  '\n'  
print  '修改后的数组是：'  
for x in np.nditer(b):  
    print x,
</code></pre> 
 <p>输出如下：</p> 
 <pre><code class="lang-python">原始数组是：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

原始数组的转置是：
[[ 0 20 40]
 [ 5 25 45]
 [10 30 50]
 [15 35 55]]

修改后的数组是：
0 5 10 15 20 25 30 35 40 45 50 55
</code></pre> 
 <h2 id="h2-u8FEDu4EE3u987Au5E8F"><a name="迭代顺序" class="reference-link"></a><span class="header-link octicon octicon-link"></span>迭代顺序</h2>
 <p>如果相同元素使用 F 风格顺序存储，则迭代器选择以更有效的方式对数组进行迭代。</p> 
 <h3 id="h3--1"><a name="示例 1" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例 1</h3>
 <pre><code class="lang-python">import numpy as np
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '原始数组是：'  
print a print  '\n'  
print  '原始数组的转置是：' 
b = a.T 
print b 
print  '\n'  
print  '以 C 风格顺序排序：' 
c = b.copy(order='C')  
print c for x in np.nditer(c):  
    print x,  
print  '\n'  
print  '以 F 风格顺序排序：' 
c = b.copy(order='F')  
print c 
for x in np.nditer(c):  
    print x,
</code></pre> 
 <p>输出如下：</p> 
 <pre><code>原始数组是：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

原始数组的转置是：
[[ 0 20 40]
 [ 5 25 45]
 [10 30 50]
 [15 35 55]]

以 C 风格顺序排序：
[[ 0 20 40]
 [ 5 25 45]
 [10 30 50]
 [15 35 55]]
0 20 40 5 25 45 10 30 50 15 35 55

以 F 风格顺序排序：
[[ 0 20 40]
 [ 5 25 45]
 [10 30 50]
 [15 35 55]]
0 5 10 15 20 25 30 35 40 45 50 55
</code></pre>
 <h3 id="h3--2"><a name="示例 2" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例 2</h3>
 <p>可以通过显式提醒，来强制<code>nditer</code>对象使用某种顺序：</p> 
 <pre><code class="lang-python">import numpy as np 
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '原始数组是：'  
print a 
print  '\n'  
print  '以 C 风格顺序排序：'  
for x in np.nditer(a, order =  'C'):  
    print x,  
print  '\n'  
print  '以 F 风格顺序排序：'  
for x in np.nditer(a, order =  'F'):  
    print x,
</code></pre> 
 <p>输出如下：</p> 
 <pre><code>原始数组是：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

以 C 风格顺序排序：
0 5 10 15 20 25 30 35 40 45 50 55

以 F 风格顺序排序：
0 20 40 5 25 45 10 30 50 15 35 55
</code></pre>
 <h2 id="h2-u4FEEu6539u6570u7EC4u7684u503C"><a name="修改数组的值" class="reference-link"></a><span class="header-link octicon octicon-link"></span>修改数组的值</h2>
 <p><code>nditer</code>对象有另一个可选参数<code>op_flags</code>。 其默认值为只读，但可以设置为读写或只写模式。 这将允许使用此迭代器修改数组元素。</p> 
 <h3 id="h3-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h3>  
 <pre><code>import numpy as np
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '原始数组是：'  
print a 
print  '\n'  
for x in np.nditer(a, op_flags=['readwrite']): 
    x[...]=2*x 
print  '修改后的数组是：'  
print a
</code></pre>
 <p>输出如下：</p> 
 <pre><code>原始数组是：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

修改后的数组是：
[[ 0 10 20 30]
 [ 40 50 60 70]
 [ 80 90 100 110]]
</code></pre>
 <h2 id="h2-u5916u90E8u5FAAu73AF"><a name="外部循环" class="reference-link"></a><span class="header-link octicon octicon-link"></span>外部循环</h2>
 <p><code>nditer</code>类的构造器拥有<code>flags</code>参数，它可以接受下列值：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>序号</th> 
    <th>参数及描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1.</td> 
    <td><code>c_index</code> 可以跟踪 C 顺序的索引</td> 
   </tr> 
   <tr> 
    <td>2.</td> 
    <td><code>f_index</code> 可以跟踪 Fortran 顺序的索引</td> 
   </tr> 
   <tr> 
    <td>3.</td> 
    <td><code>multi-index</code> 每次迭代可以跟踪一种索引类型</td> 
   </tr> 
   <tr> 
    <td>4.</td> 
    <td><code>external_loop</code> 给出的值是具有多个值的一维数组，而不是零维数组</td> 
   </tr> 
  </tbody> 
 </table> 
 <h3 id="h3-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h3>
 <p>在下面的示例中，迭代器遍历对应于每列的一维数组。</p> 
 <pre><code>import numpy as np 
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '原始数组是：'  
print a 
print  '\n'  
print  '修改后的数组是：'  
for x in np.nditer(a, flags =  ['external_loop'], order =  'F'):  
    print x,
</code></pre>
 <p>输出如下：</p> 
 <pre><code>原始数组是：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

修改后的数组是：
[ 0 20 40] [ 5 25 45] [10 30 50] [15 35 55]
</code></pre>
 <h2 id="h2-u5E7Fu64ADu8FEDu4EE3"><a name="广播迭代" class="reference-link"></a><span class="header-link octicon octicon-link"></span>广播迭代</h2>
 <p>如果两个数组是<strong>可广播的</strong>，<code>nditer</code>组合对象能够同时迭代它们。 假设数组<code>a</code>具有维度 3X4，并且存在维度为 1X4 的另一个数组<code>b</code>，则使用以下类型的迭代器(数组<code>b</code>被广播到<code>a</code>的大小)。</p> 
 <h3 id="h3-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h3>
 <pre><code>import numpy as np 
a = np.arange(0,60,5) 
a = a.reshape(3,4)  
print  '第一个数组：'  
print a 
print  '\n'  
print  '第二个数组：' 
b = np.array([1,  2,  3,  4], dtype =  int)  
print b 
print  '\n'  
print  '修改后的数组是：'  
for x,y in np.nditer([a,b]):  
    print  "%d:%d"  %  (x,y),
</code></pre>
 <p>输出如下：</p> 
 <pre><code>第一个数组：
[[ 0 5 10 15]
 [20 25 30 35]
 [40 45 50 55]]

第二个数组：
[1 2 3 4]

修改后的数组是：
0:1 5:2 10:3 15:4 20:1 25:2 30:3 35:4 40:1 45:2 50:3 55:4
</code></pre>
 <br>      
</div></body></html>