<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MariaDB Intersect运算符</h1><div style="width:100%;float:left;" class="article-content">   
 <p><code>INTERSECT</code>运算符用于返回<code>2</code>个或更多表的交集。 如果两个表中都存在记录，它将被包含在<code>INTERSECT</code>结果中。 否则，它将从<code>INTERSECT</code>结果中被省略。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-sql">SELECT expression1, expression2, ... expression_n  
FROM tables  
[WHERE conditions]  
INTERSECT  
SELECT expression1, expression2, ... expression_n  
FROM tables  
[WHERE conditions];
</code></pre> 
 <p>说明图如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2911/523141151_63711.png" alt=""></p> 
 <blockquote> 
  <p>注意：MariaDB不支持<code>INTERSECT</code>运算符，但是通过使用<code>IN</code>运算符来模拟<code>INTERSECT</code>查询，可以看到相同的结果，如下示例中所示。</p> 
 </blockquote> 
 <h4 id="h4-1-intersect-"><a name="1. INTERSECT运算符返回单个字段" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. INTERSECT运算符返回单个字段</h4>
 <p>以下是针对<code>INTERSECT</code>运算符的一般查询，但不会在MariaDB中超混杂。</p> 
 <p>假设有两张表:<code>students</code>和<code>teachers</code>。对应的表结构和数据如下 - </p> 
 <p><code>students</code>表中的数据：</p> 
 <pre><code class="lang-sql">MariaDB [testdb]&gt; select * from students;
+------------+--------------+-----------------+----------------+
| student_id | student_name | student_address | admission_date |
+------------+--------------+-----------------+----------------+
|          1 | Maxsu        | Haikou          | 2017-01-07     |
|          2 | JMaster      | Beijing         | 2016-05-07     |
|          3 | Mahesh       | Guangzhou       | 2016-06-07     |
|          4 | Kobe         | Shanghai        | 2016-02-07     |
|          5 | Blaba        | Shenzhen        | 2016-08-07     |
+------------+--------------+-----------------+----------------+
5 rows in set (0.00 sec)
</code></pre> 
 <p><code>teachers</code>表中的数据：</p> 
 <pre><code class="lang-sql">USE testdb;
DROP TABLE teachers;
CREATE TABLE teachers(  
    teacher_id INT NOT NULL AUTO_INCREMENT,  
    name VARCHAR(100) NOT NULL,  
    address VARCHAR(40) NOT NULL,  
    admission_date DATE,  
    PRIMARY KEY ( teacher_id )
);
-- 插入数据
INSERT INTO teachers  
(teacher_id, name, address, admission_date)  
VALUES(1,'Maxsu','Haikou','2013-06-07 00:00:00');

INSERT INTO teachers  
(teacher_id, name, address, admission_date)  
VALUES(2,'张天经','广州','2013-08-08 00:00:00');

INSERT INTO teachers  
(teacher_id, name, address, admission_date)  
VALUES(3,'李四光','三亚','2014-09-07 00:00:00');
</code></pre> 
 <p>经过上创建和插入数据，现在<code>teachers</code>表中拥有以下数据记录 - </p> 
 <pre><code class="lang-sql">MariaDB [testdb]&gt; select * from teachers;
+------------+--------+---------+----------------+
| teacher_id | name   | address | admission_date |
+------------+--------+---------+----------------+
|          1 | Maxsu  | Haikou  | 2013-06-07     |
|          2 | 张天经 | 广州    | 2013-08-08     |
|          3 | 李四光 | 三亚    | 2014-09-07     |
+------------+--------+---------+----------------+
3 rows in set (0.00 sec)
</code></pre> 
 <p>假设现在要查询学生和老师的姓名有哪几个？参考以下查询语句 - </p>   
 <pre><code class="lang-sql">-- 理想语句，但是MariaDB中不支持 
SELECT student_name  
FROM Students
INTERSECT  
SELECT name  
FROM teachers;
</code></pre> 
 <p>上面语句的代替语句是 - </p> 
 <pre><code class="lang-sql">SELECT s.student_name AS name
FROM Students s
WHERE s.student_name IN (SELECT t.name FROM teachers t);
</code></pre> 
 <p>执行上面查询语句，得到以下结果 - </p> 
 <pre><code class="lang-shell">MariaDB [testdb]&gt; SELECT s.student_name AS name
    -&gt; FROM Students s
    -&gt; WHERE s.student_name IN (SELECT t.name FROM teachers t);
+-------+
| name  |
+-------+
| Maxsu |
+-------+
1 row in set (0.10 sec)
</code></pre> 
 <p>它显示了两个表中<code>name</code>列都有存在的值 - <code>'Maxsu'</code>。</p> 
 <h4 id="h4-2-intersect-where-"><a name="2. INTERSECT运算符指定WHERE条件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. INTERSECT运算符指定WHERE条件</h4>
 <p>以下是针对<code>INTERSECT</code>运算符的一般查询，但不能在MariaDB中正常使用。参考以下语句 - </p> 
 <pre><code class="lang-sql">-- 理想语句，但是MariaDB中不支持 
SELECT s.student_name  
FROM Students s WHERE student_id&lt;100
INTERSECT  
SELECT t.name  
FROM teachers t
WHERE t.address = 'Haikou';
</code></pre> 
 <p>上面语句的代替语句是 - </p> 
 <pre><code class="lang-sql">SELECT s.student_name AS name
FROM Students s
WHERE s.student_id&lt;100 AND s.student_name IN (SELECT t.name FROM teachers t  WHERE t.address = 'Haikou');
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">MariaDB [testdb]&gt; SELECT s.student_name AS name
    -&gt; FROM Students s
    -&gt; WHERE s.student_id&lt;100 AND s.student_name IN (SELECT t.name FROM teachers t  WHERE t.address = 'Haikou');
+-------+
| name  |
+-------+
| Maxsu |
+-------+
1 row in set (0.00 sec)
</code></pre>
 <br>      
</div></body></html>