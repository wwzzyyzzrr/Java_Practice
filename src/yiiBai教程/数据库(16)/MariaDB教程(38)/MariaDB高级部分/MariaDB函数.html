<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MariaDB函数</h1><div style="width:100%;float:left;" class="article-content">   
 <p>MariaDB函数是一个存储的程序，用于将参数传递给它们并获取函数的返回值。</p> 
 <p>我们可以在MariaDB中创建和删除函数。</p> 
 <h4 id="h4-1-mariadb-"><a name="1. MariaDB创建函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. MariaDB创建函数</h4>
 <p>可以在MariaDB中创建自己的函数：</p> 
 <p><strong>语法：</strong></p> 
 <pre><code class="lang-sql">CREATE   
[ DEFINER = { CURRENT_USER | user_name } ]   
FUNCTION function_name [ (parameter datatype [, parameter datatype]) ]  
RETURNS return_datatype [ LANGUAGE SQL  
| DETERMINISTIC  
| NOT DETERMINISTIC  
| { CONTAINS SQL   
| NO SQL  
| READS SQL DATA  
| MODIFIES SQL DATA }  
| SQL SECURITY { DEFINER | INVOKER }  
| COMMENT 'comment_value'  
BEGIN  
   declaration_section  
   executable_section  
END;
</code></pre> 
 <h4 id="h4-1-"><a name="1. 创建函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 创建函数</h4>
 <p>在MariaDB数据库中创建一个函数<code>CalcValue</code>。参考下面代码 - </p> 
 <pre><code class="lang-sql">DELIMITER //
CREATE FUNCTION CalcValue ( starting_value INT )
RETURNS INT DETERMINISTIC
BEGIN
   DECLARE total_value INT;
   SET total_value = 0;
   label1: WHILE total_value &lt;= 3000 DO
     SET total_value = total_value + starting_value;
   END WHILE label1;
   RETURN total_value;
END; //
DELIMITER ;
</code></pre> 
 <p><strong>参数说明</strong></p> 
 <ul> 
  <li><em>DEFINER子句</em>：它是一个可选的子句。如果没有指定，定义者是创建函数的用户。 如果您希望指定不同的定义者，则必须包含<code>DEFINER</code>子句，其中<code>user_name</code>是该函数的定义者。</li>
  <li><em>function_name</em>：指定要在MariaDB中分配给此函数的名称。</li>
  <li><em>return_datatype</em>：它指定函数返回值的数据类型。</li>
  <li><em>LANGUAGE SQL</em>：语法为可移植语法，但不会影响函数。</li>
  <li><em>DETERMINISTIC</em>：表示该函数将总是返回给定一组输入参数的一个结果。</li>
  <li><em>NOT DETERMINISTIC</em>：表示给定一组输入参数，该函数可能会返回不同的结果。 结果可能受到表数据，随机数字或服务器变量的影响。</li>
  <li><em>CONTAINS SQL</em>：这是默认的。这是一个告知MariaDB该函数包含SQL的信息性子句，但数据库不验证为真。</li>
  <li><em>NO SQL</em>：没有使用的信息性子句将不会影响函数。</li>
  <li><em>READS SQL DATA</em>：一个告知MariaDB该函数将使用<code>SELECT</code>语句读取数据但不修改任何数据的信息性子句。</li>
  <li><em>MODIFIES SQL DATA</em>：一个告知MariaDB该函数将使用<code>INSERT</code>，<code>UPDATE</code>，<code>DELETE</code>或其他DDL语句修改SQL数据的信息性子句。</li>
  <li><em>declaration_section</em>：声明局部变量的函数的地方。</li>
  <li><em>executable_section</em>：在函数中输入函数代码的地方。</li>
 </ul> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2911/155091100_71337.png" alt=""></p> 
 <h4 id="h4-2-"><a name="2. 调用函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 调用函数</h4>
 <p>可以看到程序成功执行并创建了一个新的函数。现在可以调用这个新创建的函数了，如下所示：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2911/540091112_97699.png" alt=""></p> 
 <h4 id="h4-3-"><a name="3. 删除函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3. 删除函数</h4>
 <p>要删除MariaDB数据库中的自定义函数很容易。比如要上我们上面创建的函数，请参考以下语法。</p> 
 <p><strong>语法：</strong></p>   
 <pre><code class="lang-sql">DROP FUNCTION [ IF EXISTS ] function_name;
</code></pre> 
 <p><strong>参数说明</strong></p> 
 <ul> 
  <li><em>function_name</em>：它指定想要删除的函数的名字。</li>
 </ul> 
 <p><strong>示例：</strong></p> 
 <p>在上面，我们已经创建了一个名为<em>“CalcValue”</em>的函数。假设现在要删除这个函数，可通过以下语句 - </p> 
 <pre><code class="lang-sql">DROP FUNCTION CalcValue;
</code></pre> 
 <p>现在，可以看到该函数已被删除，不再出现在左侧列表中。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2911/891091121_79095.png" alt=""></p> 
 <p>或通过查询下面语句 - </p> 
 <pre><code class="lang-sql">MariaDB [testdb]&gt; SELECT *, EVENT_SCHEMA AS `Db`, EVENT_NAME AS `Name` FROM information_schema.`EVENTS` WHERE `EVENT_SCHEMA`='testdb';
Empty set (0.01 sec)
</code></pre>
 <br>      
</div></body></html>