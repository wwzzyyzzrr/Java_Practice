<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">CouchDB删除文档</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本篇文章中，我们来学习如何删除 CouchDB 数据库中的文档。删除 CouchDB 数据库中的文档有两种方法，下面分别来看看如何操作。</p> 
 <h2 id="h2-couchdb-fauxton-"><a name="CouchDB使用Fauxton删除文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>CouchDB使用Fauxton删除文档</h2>
 <p>打开Fauxton url：</p> 
 <pre><code>http://127.0.0.1:5984/_utils/
</code></pre>
 <p>首先选择包含所有文档的数据库。这里是数据库“<code>yiibai_db</code>”中的所有三个文件：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/1605/957160511_87533.png" alt=""></p> 
 <p>选择要删除的文档，假设要删除ID为<code>001</code>的文档，那么就点击ID为<code>001</code>的这个文档进入详细信息，如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/1605/602160513_24398.png" alt=""></p> 
 <p>在ID为<code>001</code>的这个文档进入详细信息页面中，点击“<strong>Delete Document…</strong>”来删除当前这条信息，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/1605/527160515_96025.png" alt=""></p> 
 <p>点击“<strong>Delete</strong>”确认删除就好。如下图中所示，ID为<code>001</code>的这个文档已经被删除了 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/1605/754160516_57787.png" alt=""></p> 
 <h2 id="h2-2-couchdb-curl-"><a name="2. CouchDB使用cURL工具删除文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. CouchDB使用cURL工具删除文档</h2>
 <p>在CouchDB中，通过使用cURL实用程序向服务器发送HTTP DELETE方法请求来删除文档。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-shell">curl -H 'Content-Type: application/json' -X DELETE http://127.0.0.1:5984/database_name/database_id?_rev
</code></pre> 
 <blockquote> 
  <p>注意：<code>-X</code>用于指定与HTTP服务器通信时使用的HTTP的自定义请求方法。 要删除文档，可通过<code>/database_name/database_id/</code>这个url传递最近的修订版本号。“<code>？</code>” 用于指定数据结构的属性。</p> 
 </blockquote> 
 <p><strong>例子：</strong></p> 
 <p>在数据库“<code>yiibai_db</code>”中，有一个<code>id</code>为<code>10010</code>的文档，假设现在要删除这个文档，首先使用以下命令获取这个文档的<code>rev_id</code>值：</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ curl -X GET http://127.0.0.1:5984/yiibai_db/10010
{"_id":"10010","_rev":"3-592bfcd696098263c19dfe761bf92929","age":"22","name":"Maxsu"}
yiibai@ubuntu:~$
</code></pre> 
 <p>这里<code>_rev</code>是“<code>3-592bfcd696098263c19dfe761bf92929</code>”。现在使用以下命令删除<code>id</code>为<code>10010</code>的文档。</p>   
 <pre><code class="lang-shell">yiibai@ubuntu:~$ curl -H 'Content-Type: application/json' -X DELETE http://127.0.0.1:5984/yiibai_db/10010?rev=3-592bfcd696098263c19dfe761bf92929
{"ok":true,"id":"10010","rev":"4-a21004c06af1cf39634e552547b79e81"}
yiibai@ubuntu:~$ curl -X GET http://127.0.0.1:5984/yiibai_db/10010
{"error":"not_found","reason":"deleted"}
yiibai@ubuntu:~$
</code></pre> 
 <p>CouchDB对上面的删除命令的响应包含<code>3</code>个字段：</p> 
 <ul> 
  <li>“<strong>ok</strong>”：它表示操作成功。</li>
  <li>“<strong>id</strong>”：它存储文档的<code>id</code>。</li>
  <li>“<strong>rev</strong>”：表示修订ID。 每次修改(更新，修改或删除)文档时，CouchDB将生成<code>_rev</code>值。 如果要更新或删除文档，CouchDB需要您包含要更改的修订版本的<code>_rev</code>字段。 当CouchDB接受更改时，它将生成一个新的修订版本号。</li>
 </ul> 
 <p><strong>验证</strong></p> 
 <p>可以使用以下命令验证文档是否被删除：</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:~$ curl -X GET http://127.0.0.1:5984/yiibai_db/10010
{"error":"not_found","reason":"deleted"}
yiibai@ubuntu:~$
</code></pre>
 <br>      
</div></body></html>