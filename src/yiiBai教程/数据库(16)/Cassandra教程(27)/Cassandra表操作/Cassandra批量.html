<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Cassandra批量</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在Cassandra中，<code>BATCH</code>用于同时执行多个修改语句(插入，更新，删除)。 当你必须更新一些以及删除一些现有的列是非常有用的。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-sql">BEGIN BATCH  
&lt;insert-stmt&gt;/ &lt;update-stmt&gt;/ &lt;delete-stmt&gt;  
APPLY BATCH
</code></pre> 
 <p><strong>实例：</strong></p> 
 <p>让我们举个例子来演示<code>BATCH</code>命令。 在这里，我们有一个名为“<code>student</code>”的表，其中包含列(<code>student_id</code>，<code>student_fees</code>，<code>student_name</code>)，具有以下数据。</p> 
 <p>在这个例子中，我们将执行BATCH(插入，更新和删除)操作：</p> 
 <ul> 
  <li>插入一个包含以下信息的新行(<code>4</code>，<code>4000</code>，<code>Sumsu</code>)。</li>
  <li>更新行ID为<code>3</code>的学生的<code>student_fees</code>列的值为<code>8000</code>。</li>
  <li>删除具有行ID为<code>2</code>的雇员的<code>student_fees</code>值。</li>
 </ul> 
 <p>完整的语句如下所示 - </p> 
 <pre><code class="lang-sql">## 创建表
CREATE TABLE student(  
   student_id int PRIMARY KEY,  
   student_name text,  
   student_fees varint
 );   
## 插入数据
INSERT INTO student (student_id, student_fees, student_name)   
VALUES(1,5000, 'Maxsu');  
INSERT INTO student (student_id, student_fees, student_name)   
VALUES(2,3000, 'Minsu');  
INSERT INTO student (student_id, student_fees, student_name)   
VALUES(3, 2000, 'Modlee');
</code></pre> 
 <p>查询数据结果如下 -</p> 
 <pre><code class="lang-sql">cqlsh:yiibai_ks&gt; select * from student;

 student_id | student_fees | student_name
------------+--------------+--------------
          1 |         5000 |        Maxsu
          2 |         3000 |        Minsu
          3 |         2000 |       Modlee

(3 rows)
cqlsh:yiibai_ks&gt;
</code></pre> 
 <p>执行<code>BATCH</code>命令 - </p>   
 <pre><code class="lang-sql">BEGIN BATCH
INSERT INTO student(student_id, student_fees, student_name) values(4, 5500, Sumlee);
UPDATE student SET student_fees=8000 WHERE  student_id=3;
DELETE student_fees FROM student WHERE student_id=2;
APPLY BATCH;
</code></pre> 
 <p>现在执行了<code>BATCH</code>命令之后。 您可以使用SELECT命令验证它。</p> 
 <pre><code class="lang-sql">cqlsh:yiibai_ks&gt; BEGIN BATCH
             ... INSERT INTO student(student_id, student_fees, student_name) values(4, 5500, 'Sumlee');
             ... UPDATE student SET student_fees=8000 WHERE  student_id=3;
             ... DELETE student_fees FROM student WHERE student_id=2;
             ... APPLY BATCH;
cqlsh:yiibai_ks&gt; SELECT * FROM student;

 student_id | student_fees | student_name
------------+--------------+--------------
          1 |         5000 |        Maxsu
          2 |         null |        Minsu
          4 |         5500 |       Sumlee
          3 |         8000 |       Modlee

(4 rows)
cqlsh:yiibai_ks&gt;
</code></pre>
 <br>      
</div></body></html>