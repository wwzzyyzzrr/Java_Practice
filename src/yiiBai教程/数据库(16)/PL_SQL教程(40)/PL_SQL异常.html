<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PL/SQL异常</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 程序执行过程中出现错误情况被称为在PL/SQL异常。 PL/SQL支持程序员在程序中使用异常块捕获这样的条件并采取适当的动作应对错误情况。有两种类型的异常：</p> 
 <ul> 
  <li> <p> 系统定义的异常</p> </li> 
  <li> <p> 用户定义的异常</p> </li> 
 </ul> 
 <h2> 异常处理语法</h2> 
 <p> 一般异常处理的语法如下。在这里可以列出下来很多，要处理异常。默认的异常将使用WHEN others THEN处理：</p> 
 <pre class="prettyprint lang-sql prettyprinted" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
<span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">DECLARE</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&lt;</span><span class="pln" style="margin: 0px; padding: 0px;">declarations section</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">BEGIN</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&lt;</span><span class="pln" style="margin: 0px; padding: 0px;">executable command</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="pln" style="margin: 0px; padding: 0px;">s</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">)&gt;</span><span class="pln" style="margin: 0px; padding: 0px;">
EXCEPTION
   </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&lt;</span><span class="pln" style="margin: 0px; padding: 0px;">exception handling goes here </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> exception1 </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;"> 
       exception1-handling-statements 
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> exception2  </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;"> 
      exception2-handling-statements 
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> exception3 </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;"> 
      exception3-handling-statements
   </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">........</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> others </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      exception3-handling-statements
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">END</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span></pre> 
 <h2> 示例</h2> 
 <p> 写一些简单的代码来说明这个概念。将使用我们已经创建，并在前面的章节中使用的CUSTOMERS表：</p> 
 <pre class="prettyprint lang-sql prettyprinted" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
<span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">DECLARE</span><span class="pln" style="margin: 0px; padding: 0px;">
   c_id customers</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">id</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">%</span><span class="pln" style="margin: 0px; padding: 0px;">type </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">:=</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="lit" style="margin: 0px; padding: 0px; color: rgb(0, 102, 102);">8</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
   c_name  customers</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">%</span><span class="pln" style="margin: 0px; padding: 0px;">type</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
   c_addr customers</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">address</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">%</span><span class="pln" style="margin: 0px; padding: 0px;">type</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">BEGIN</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">SELECT</span><span class="pln" style="margin: 0px; padding: 0px;">  name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">,</span><span class="pln" style="margin: 0px; padding: 0px;"> address </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">INTO</span><span class="pln" style="margin: 0px; padding: 0px;">  c_name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">,</span><span class="pln" style="margin: 0px; padding: 0px;"> c_addr
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">FROM</span><span class="pln" style="margin: 0px; padding: 0px;"> customers
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHERE</span><span class="pln" style="margin: 0px; padding: 0px;"> id </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">=</span><span class="pln" style="margin: 0px; padding: 0px;"> c_id</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">

   DBMS_OUTPUT</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">PUT_LINE </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'Name: '</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">||</span><span class="pln" style="margin: 0px; padding: 0px;">  c_name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
   DBMS_OUTPUT</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">PUT_LINE </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'Address: '</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">||</span><span class="pln" style="margin: 0px; padding: 0px;"> c_addr</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
EXCEPTION
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> no_data_found </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      dbms_output</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">put_line</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'No such customer!'</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> others </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      dbms_output</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">put_line</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'Error!'</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">END</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">/</span></pre> 
 <p> 当上述代码在SQL提示符执行时，它产生了以下结果：</p> 
 <pre class="result" style="margin-bottom: 0px; font-size: 12px; overflow: auto; background-color: rgb(241, 241, 241);">
No such customer!

PL/SQL procedure successfully completed.&nbsp;</pre> 
 <p> 上述程序显示一个客户的ID给出的名字和地址。由于在我们的数据库没有ID值为8的客户，该程序运行时引发一个异常NO_DATA_FOUND，这是捕获异常EXCEPTION块。</p> 
 <h2> 引发异常</h2> 
 <p> 异常是数据库服务器自动在内部数据库错误，但异常可以明确地提出由程序员使用命令RAISE。以下是引发异常的简单的语法：</p> 
 <pre class="prettyprint lang-sql prettyprinted" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
<span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">DECLARE</span><span class="pln" style="margin: 0px; padding: 0px;">
   exception_name EXCEPTION</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">BEGIN</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">IF</span><span class="pln" style="margin: 0px; padding: 0px;"> condition </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      RAISE exception_name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">END</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">IF</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
EXCEPTION
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> exception_name </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
   statement</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">END</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span></pre> 
 <p> 可以在引发Oracle的标准异常或任何用户定义的异常使用上述语法。下一节会显示如何引发用户定义异常，引发Oracle标准异常以及类似的方法的例子。</p> 
 <h2> 用户自定义异常</h2> 
 <p> PL/SQL允许根据程序的需要定义自己的异常。用户定义的异常必须声明，然后明确地提出使用一个RAISE语句或程序DBMS_STANDARD.RAISE_APPLICATION_ERROR。</p> 
 <p> 声明一个异常的语法是：</p> 
 <pre class="prettyprint lang-sql prettyprinted" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
<span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">DECLARE</span><span class="pln" style="margin: 0px; padding: 0px;">
   my-exception EXCEPTION</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span></pre> 
 <h2> 示例:</h2> 
 <p> 下面的例子说明了这个概念。该程序需要一个客户ID，当用户输入了一个无效的ID，异常invalid_id引发。</p> 
 <div style="float:left;margin-bottom: 10px;">  
 </div>
 <div style="float:left;margin-bottom: 10px;">  
 </div>
 <pre class="prettyprint lang-sql prettyprinted" style="border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; font-size: 12px; overflow: auto;">
<span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">DECLARE</span><span class="pln" style="margin: 0px; padding: 0px;">
   c_id customers</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">id</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">%</span><span class="pln" style="margin: 0px; padding: 0px;">type </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">:=</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&amp;</span><span class="pln" style="margin: 0px; padding: 0px;">cc_id</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
   c_name  customers</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">%</span><span class="pln" style="margin: 0px; padding: 0px;">type</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
   c_addr customers</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">address</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">%</span><span class="pln" style="margin: 0px; padding: 0px;">type</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">

   </span><span class="com" style="margin: 0px; padding: 0px; color: rgb(136, 0, 0);">-- user defined exception</span><span class="pln" style="margin: 0px; padding: 0px;">
   ex_invalid_id  EXCEPTION</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">BEGIN</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">IF</span><span class="pln" style="margin: 0px; padding: 0px;"> c_id </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">&lt;=</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="lit" style="margin: 0px; padding: 0px; color: rgb(0, 102, 102);">0</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      RAISE ex_invalid_id</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">ELSE</span><span class="pln" style="margin: 0px; padding: 0px;">
      </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">SELECT</span><span class="pln" style="margin: 0px; padding: 0px;">  name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">,</span><span class="pln" style="margin: 0px; padding: 0px;"> address </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">INTO</span><span class="pln" style="margin: 0px; padding: 0px;">  c_name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">,</span><span class="pln" style="margin: 0px; padding: 0px;"> c_addr
      </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">FROM</span><span class="pln" style="margin: 0px; padding: 0px;"> customers
      </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHERE</span><span class="pln" style="margin: 0px; padding: 0px;"> id </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">=</span><span class="pln" style="margin: 0px; padding: 0px;"> c_id</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
	  
      DBMS_OUTPUT</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">PUT_LINE </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'Name: '</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">||</span><span class="pln" style="margin: 0px; padding: 0px;">  c_name</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
      DBMS_OUTPUT</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">PUT_LINE </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'Address: '</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">||</span><span class="pln" style="margin: 0px; padding: 0px;"> c_addr</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">END</span><span class="pln" style="margin: 0px; padding: 0px;"> </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">IF</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
EXCEPTION
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> ex_invalid_id </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      dbms_output</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">put_line</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'ID must be greater than zero!'</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> no_data_found </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      dbms_output</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">put_line</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'No such customer!'</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;">
   </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">WHEN</span><span class="pln" style="margin: 0px; padding: 0px;"> others </span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">THEN</span><span class="pln" style="margin: 0px; padding: 0px;">
      dbms_output</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">.</span><span class="pln" style="margin: 0px; padding: 0px;">put_line</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">(</span><span class="str" style="margin: 0px; padding: 0px; color: rgb(0, 136, 0);">'Error!'</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">);</span><span class="pln" style="margin: 0px; padding: 0px;"> 
</span><span class="kwd" style="margin: 0px; padding: 0px; color: rgb(0, 0, 136);">END</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">;</span><span class="pln" style="margin: 0px; padding: 0px;">
</span><span class="pun" style="margin: 0px; padding: 0px; color: rgb(102, 102, 0);">/</span></pre> 
 <p> 当上述代码在SQL提示符执行时，它产生了以下结果：</p>   
 <pre class="result" style="margin-bottom: 0px; font-size: 12px; overflow: auto; background-color: rgb(241, 241, 241);">
Enter value for cc_id: -6 (let's enter a value -6)
old  2: c_id customers.id%type := &amp;cc_id;
new  2: c_id customers.id%type := -6;
ID must be greater than zero!

PL/SQL procedure successfully completed.</pre> 
 <h2> 预定义异常</h2> 
 <p> PL/SQL提供许多预先定义的异常，这是在被执行时的任何数据库规则由程序引发。例如，预定义异常NO_DATA_FOUND时引发一个SELECT INTO语句返回数据行。下表列出了一些重要的预先定义的异常：</p> 
 <table class="src" style="margin: 8px 0px; padding: 0px;  border-color: rgb(214, 214, 214); width: 560px; border-collapse: collapse; vertical-align: top; color: rgb(0, 0, 0);  background-color: rgb(247, 247, 247);"> 
  <tbody style="margin: 0px; padding: 0px;"> 
   <tr style="margin: 0px; padding: 0px;"> 
    <th style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214); width: 134px; background-color: rgb(238, 238, 238);"> Exception</th> 
    <th style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214); width: 45px; background-color: rgb(238, 238, 238);"> Oracle Error</th> 
    <th style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214); width: 59px; background-color: rgb(238, 238, 238);"> SQLCODE</th> 
    <th style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214); background-color: rgb(238, 238, 238);"> 描述</th> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> ACCESS_INTO_NULL</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06530</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6530</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当一个空对象会自动分配一个值引发此异常</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> CASE_NOT_FOUND</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06592</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6592</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当没有任何选择，在当选择一个CASE语句的子句，并且没有ELSE子句时被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> COLLECTION_IS_NULL</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06531</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6531</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当程序试图申请其他收集方法不是存在未初始化的嵌套表或VARRAY，或程序试图值分配给未初始化的嵌套表或变长数组的元素时被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> DUP_VAL_ON_INDEX</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 00001</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -1</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当重复值试图被存储在具有唯一索引的列时被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> INVALID_CURSOR</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01001</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -1001</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当尝试以使这是不允许的，如关闭一个未打开的游标的游标操作时被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> INVALID_NUMBER</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01722</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -1722</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当一个字符的字符串转换成一个数失败，因为字符串不表示一个有效的数据被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> LOGIN_DENIED</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01017</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -1017</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当程序试图登录到数据库使用无效的用户名或密码被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> NO_DATA_FOUND</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01403</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> +100</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 它被引发当一个SELECT INTO语句无任何行返回</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> NOT_LOGGED_ON</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01012</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -1012</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 在不连接到数据库发出数据库调用它被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> PROGRAM_ERROR</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06501</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6501</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 它被引发当PL/SQL有一个内部问题</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> ROWTYPE_MISMATCH</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06504</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6504</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当游标取值有不兼容的数据类型的变量被引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> SELF_IS_NULL</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 30625</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -30625</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 它被引发，当对象的成员方法被调用，但对象类型的实例没有被初始化。</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> STORAGE_ERROR</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06500</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6500</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 它被引发当PL/SQL内存不足或内存已损坏</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> TOO_MANY_ROWS</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01422</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -1422</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 它被引发当SELECT INTO语句返回多行</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> VALUE_ERROR</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 06502</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> -6502</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 当算术，转换，截短，或大小约束错误时引发</td> 
   </tr> 
   <tr style="margin: 0px; padding: 0px;"> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> ZERO_DIVIDE</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 01476</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 1476</td> 
    <td style="margin: 0px; padding: 5px; border-collapse: collapse;  border-color: rgb(214, 214, 214);"> 它被引发当一个数试图除以零。</td> 
   </tr> 
  </tbody> 
 </table> 
 <br> 
 <br>      
</div></body></html>