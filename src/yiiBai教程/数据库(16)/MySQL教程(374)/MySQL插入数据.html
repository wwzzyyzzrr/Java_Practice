<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MySQL插入数据</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本教程中，您将学习如何使用MySQL <code>INSERT</code>语句将数据插入到数据库表中。</p> 
 <h2 id="h2-1-mysql-insert-"><a name="1. 简单的MySQL INSERT语句" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 简单的MySQL INSERT语句</h2>
 <p>MySQL <code>INSERT</code>语句允许您将一行或多行插入到表中。下面说明了<code>INSERT</code>语句的语法：</p> 
 <pre><code class="lang-sql">INSERT INTO table(column1,column2...)
VALUES (value1,value2,...);
</code></pre> 
 <p><strong>首先</strong>，在<code>INSERT INTO</code>子句之后，在括号内指定表名和逗号分隔列的列表。<br><strong>然后</strong>，将括号内的相应列的逗号分隔值放在<code>VALUES</code>关键字之后。</p> 
 <p>在执行插入语句前，需要具有执行<code>INSERT</code>语句的<code>INSERT</code>权限。<br>让我们创建一个名为<code>tasks</code>的新表来练习<code>INSERT</code>语句，参考以下创建语句 - </p> 
 <pre><code class="lang-sql">USE testdb;

CREATE TABLE IF NOT EXISTS tasks (
    task_id INT(11) AUTO_INCREMENT,
    subject VARCHAR(45) DEFAULT NULL,
    start_date DATE DEFAULT NULL,
    end_date DATE DEFAULT NULL,
    description VARCHAR(200) DEFAULT NULL,
    PRIMARY KEY (task_id)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre> 
 <p>例如，如果要将任务插入到<code>tasts</code>表中，则使用<code>INSERT</code>语句如下：</p> 
 <pre><code class="lang-sql">INSERT INTO tasks(subject,start_date,end_date,description)
VALUES('Learn MySQL INSERT','2017-07-21','2017-07-22','Start learning..');
</code></pre> 
 <p>执行该语句后，MySQL返回一条消息以通知受影响的行数。 在这种情况下，有一行受到影响。<br>现在使用以下语句查询 <code>tasks</code> 中的数据，如下所示 - </p> 
 <pre><code class="lang-sql">SELECT * FROM tasks;
</code></pre> 
 <p>执行上面查询语句，得到以下结果 - </p> 
 <pre><code class="lang-sql">+---------+--------------------+------------+------------+------------------+
| task_id | subject            | start_date | end_date   | description      |
+---------+--------------------+------------+------------+------------------+
|       1 | Learn MySQL INSERT | 2017-07-21 | 2017-07-22 | Start learning.. |
+---------+--------------------+------------+------------+------------------+
1 row in set
</code></pre> 
 <h2 id="h2-2-mysql-insert-"><a name="2. MySQL INSERT - 插入多行" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. MySQL INSERT - 插入多行</h2>
 <p>想要在表中一次插入多行，可以使用具有以下语法的<code>INSERT</code>语句：</p> 
 <pre><code class="lang-sql">INSERT INTO table(column1,column2...)
VALUES (value1,value2,...),
       (value1,value2,...),
...;
</code></pre> 
 <p>在这种形式中，每行的值列表用逗号分隔。 例如，要将多行插入到<code>tasks</code>表中，请使用以下语句：</p> 
 <pre><code class="lang-sql">INSERT INTO tasks(subject,start_date,end_date,description)
VALUES ('任务-1','2017-01-01','2017-01-02','Description 1'),
       ('任务-2','2017-01-01','2017-01-02','Description 2'),
       ('任务-3','2017-01-01','2017-01-02','Description 3');
</code></pre> 
 <p>执行上面语句后，返回 - </p> 
 <pre><code class="lang-shell">Query OK, 3 rows affected
Records: 3  Duplicates: 0  Warnings: 0
</code></pre> 
 <p>现在查询<code>tasks</code>表中的数据，如下所示 - </p> 
 <pre><code class="lang-sql">select * from tasks;
</code></pre> 
 <p>执行上面查询语句，得到以下结果 - </p> 
 <pre><code class="lang-sql">+---------+--------------------+------------+------------+------------------+
| task_id | subject            | start_date | end_date   | description      |
+---------+--------------------+------------+------------+------------------+
|       1 | Learn MySQL INSERT | 2017-07-21 | 2017-07-22 | Start learning.. |
|       2 | 任务-1             | 2017-01-01 | 2017-01-02 | Description 1    |
|       3 | 任务-2             | 2017-01-01 | 2017-01-02 | Description 2    |
|       4 | 任务-3             | 2017-01-01 | 2017-01-02 | Description 3    |
+---------+--------------------+------------+------------+------------------+
4 rows in set
</code></pre> 
 <p>如果为表中的所有列指定相应列的值，则可以忽略<code>INSERT</code>语句中的列列表，如下所示：</p> 
 <pre><code class="lang-sql">INSERT INTO table
VALUES (value1,value2,...);
</code></pre> 
 <p>或者-</p> 
 <pre><code class="lang-sql">INSERT INTO table
VALUES (value1,value2,...),
       (value1,value2,...),
...;
</code></pre> 
 <blockquote> 
  <p>请注意，不必为自动递增列(例如<code>taskid</code>列)指定值，因为MySQL会自动为<a target="_blank" href="http://www.yiibai.com/mysql/sequence.html" title="自动递增">自动递增</a>列生成值。</p> 
 </blockquote> 
 <h2 id="h2-3-select-mysql-insert"><a name="3. 具有SELECT子句的MySQL INSERT" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3. 具有SELECT子句的MySQL INSERT</h2>
 <p>在MySQL中，可以使用<a target="_blank" href="http://www.yiibai.com/mysql/select-statement-query-data.html" title="SELECT语句">SELECT语句</a>返回的列和值来填充<code>INSERT</code>语句的值。 此功能非常方便，因为您可以使用<code>INSERT</code>和<code>SELECT</code>子句完全或部分<a target="_blank" href="http://www.yiibai.com/mysql/copy-table-data.html" title="复制表">复制表</a>，如下所示：</p> 
 <pre><code class="lang-sql">INSERT INTO table_1
SELECT c1, c2, FROM table_2;
</code></pre> 
 <p>假设要将<code>tasks</code>表复制到<code>tasks_bak</code>表。</p> 
 <p><strong>首先</strong>，通过复制<code>tasks</code>表的结构，创建一个名为<code>tasks_bak</code>的新表，如下所示：</p> 
 <pre><code class="lang-sql">CREATE TABLE tasks_bak LIKE tasks;
</code></pre> 
 <p><strong>第二步</strong>，使用以下<code>INSERT</code>语句将<code>tasks</code>表中的数据插入<code>tasks_bak</code>表：</p> 
 <pre><code class="lang-sql">INSERT INTO tasks_bak
SELECT * FROM tasks;
</code></pre> 
 <p><strong>第三步</strong>，检查<code>tasks_bak</code>表中的数据，看看是否真正从<code>tasks</code>表复制完成了。</p> 
 <pre><code class="lang-sql">mysql&gt; select * from tasks;
+---------+--------------------+------------+------------+------------------+
| task_id | subject            | start_date | end_date   | description      |
+---------+--------------------+------------+------------+------------------+
|       1 | Learn MySQL INSERT | 2017-07-21 | 2017-07-22 | Start learning.. |
|       2 | 任务-1             | 2017-01-01 | 2017-01-02 | Description 1    |
|       3 | 任务-2             | 2017-01-01 | 2017-01-02 | Description 2    |
|       4 | 任务-3             | 2017-01-01 | 2017-01-02 | Description 3    |
+---------+--------------------+------------+------------+------------------+
4 rows in set
</code></pre> 
 <h2 id="h2-4-mysql-insert-on-duplicate-key-update"><a name="4. MySQL INSERT与ON DUPLICATE KEY UPDATE" class="reference-link"></a><span class="header-link octicon octicon-link"></span>4. MySQL INSERT与ON DUPLICATE KEY UPDATE</h2>
 <p>如果新行违反<a target="_blank" href="http://www.yiibai.com/mysql/primary-key.html" title="主键(PRIMARY KEY)">主键(PRIMARY KEY)</a>或<code>UNIQUE</code>约束，MySQL会发生错误。 例如，如果执行以下语句：</p>   
 <pre><code class="lang-sql">INSERT INTO tasks(task_id,subject,start_date,end_date,description)
VALUES (4,'Test ON DUPLICATE KEY UPDATE','2017-01-01','2017-01-02','Next Priority');
</code></pre> 
 <p>MySQL很不高兴，并向你扔来一个错误消息：</p> 
 <pre><code class="lang-sql">Error Code: 1062. Duplicate entry '4' for key 'PRIMARY' 0.016 sec
</code></pre> 
 <p>因为表中的主键<code>task_id</code>列已经有一个值为 <code>4</code> 的行了，所以该语句违反了<code>PRIMARY KEY</code>约束。</p> 
 <p>但是，如果在<code>INSERT</code>语句中指定<a target="_blank" href="http://www.yiibai.com/mysql/insert-or-update-on-duplicate-key-update.html" title="ON DUPLICATE KEY UPDATE">ON DUPLICATE KEY UPDATE</a>选项，MySQL将<a target="_blank" href="http://www.yiibai.com/mysql/insert-or-update-on-duplicate-key-update.html" title="插入新行或使用新值更新原行记录">插入新行或使用新值更新原行记录</a>。</p> 
 <p>例如，以下语句使用新的<code>task_id</code>和<code>subject</code>来更新<code>task_id</code>为<code>4</code>的行。</p> 
 <pre><code class="lang-sql">INSERT INTO tasks(task_id,subject,start_date,end_date,description)
VALUES (4,'Test ON DUPLICATE KEY UPDATE','2017-01-01','2017-01-02','Next Priority')
ON DUPLICATE KEY UPDATE 
   task_id = task_id + 1, 
   subject = 'Test ON DUPLICATE KEY UPDATE';
</code></pre> 
 <p>执行上面语句后，MySQL发出消息说<code>2</code>行受影响。现在，我们来看看<code>tasks</code>表中的数据：</p> 
 <pre><code class="lang-sql">mysql&gt; select * from tasks;
+---------+------------------------------+------------+------------+------------------+
| task_id | subject                      | start_date | end_date   | description      |
+---------+------------------------------+------------+------------+------------------+
|       1 | Learn MySQL INSERT           | 2017-07-21 | 2017-07-22 | Start learning.. |
|       2 | 任务-1                       | 2017-01-01 | 2017-01-02 | Description 1    |
|       3 | 任务-2                       | 2017-01-01 | 2017-01-02 | Description 2    |
|       5 | Test ON DUPLICATE KEY UPDATE | 2017-01-01 | 2017-01-02 | Description 3    |
+---------+------------------------------+------------+------------+------------------+
4 rows in set
</code></pre> 
 <p>新行没有被插入，但是更新了<code>task_id</code>值为<code>4</code>的行。上面的<code>INSERT ON DUPLICATE KEY UPDATE</code>语句等效于以下<a target="_blank" href="http://www.yiibai.com/mysql/update-data.html" title="UPDATE语句">UPDATE语句</a>：</p> 
 <pre><code class="lang-sql">UPDATE tasks 
SET 
    task_id = task_id + 1,
    subject = 'Test ON DUPLICATE KEY UPDATE'
WHERE
    task_id = 4;
</code></pre> 
 <p>有关<code>INSERT ON DUPLICATE KEY UPDATE</code>语句的更多信息，请查看<a target="_blank" href="http://www.yiibai.com/mysql/insert-or-update-on-duplicate-key-update.html" title="MySQL插入或更新教程">MySQL插入或更新教程</a>。</p> 
 <p>在本教程中，我们向您展示了如何使用各种形式的MySQL <code>INSERT</code>语句将数据插入到表中。</p>
 <br>      
</div></body></html>