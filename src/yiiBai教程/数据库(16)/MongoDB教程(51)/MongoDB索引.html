<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MongoDB索引</h1><div style="width:100%;float:left;" class="article-content">   
 <p>索引支持查询的有效地提高效率。没有索引，MongoDB必须扫描集合的每个文档，以选择与查询语句匹配的文档。这种扫描效率很低，需要 MongoDB 处理大量的数据。</p> 
 <p>索引是特殊的数据结构，以易于遍历的形式存储数据集的一小部分。 索引存储特定字段或一组字段的值，按照索引中指定的字段值排序。</p> 
 <h2 id="h2-ensureindex-"><a name="ensureIndex()方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ensureIndex()方法</h2>
 <p>要创建索引，需要使用MongoDB的<code>ensureIndex()</code>方法。</p> 
 <p><strong>语法</strong></p> 
 <p><code>ensureIndex()</code>方法的基本语法如下 - </p> 
 <pre><code class="lang-shell">&gt;db.COLLECTION_NAME.ensureIndex({KEY:1})
</code></pre> 
 <p>这里的<code>key</code>是要在其上创建索引的字段的名称，<code>1</code>是升序。 要按降序创建索引，需要使用<code>-1</code>。</p> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-shell">&gt;db.mycol.ensureIndex({"title":1})
</code></pre> 
 <p>在<code>ensureIndex()</code>方法中，可以传递多个字段，以在多个字段上创建索引。</p> 
 <pre><code class="lang-shell">&gt;db.mycol.ensureIndex({"title":1,"description":-1})
&gt;
</code></pre> 
 <p><code>ensureIndex()</code>方法也接受选项列表(可选)。 以下是列表 -</p> 
 <table> 
  <thead> 
   <tr> 
    <th>参数</th> 
    <th>类型</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td><code>background</code></td> 
    <td><code>Boolean</code></td> 
    <td>在后台构建索引，以便构建索引不会阻止其他数据库活动，则指定<code>background</code>的值为<code>true</code>。默认值为<code>false</code>。</td> 
   </tr> 
   <tr> 
    <td><code>unique</code></td> 
    <td><code>Boolean</code></td> 
    <td>创建一个唯一的索引，使得集合不会接受索引键或键匹配索引中现有值的文档的插入。 指定<code>true</code>以创建唯一索引。 默认值为<code>false</code>。</td> 
   </tr> 
   <tr> 
    <td><code>name</code></td> 
    <td><code>String</code></td> 
    <td>索引的名称。如果未指定，则MongoDB通过连接索引字段的名称和排序顺序来生成索引名称。</td> 
   </tr> 
   <tr> 
    <td><code>dropDups</code></td> 
    <td><code>Boolean</code></td> 
    <td>在可能有重复项的字段上创建唯一索引。MongoDB仅索引第一次出现的键，并从集合中删除包含该键的后续出现的所有文档。指定<code>true</code>以创建唯一索引。 默认值为<code>false</code>。</td> 
   </tr> 
   <tr> 
    <td><code>sparse</code></td> 
    <td><code>Boolean</code></td> 
    <td>如果为<code>true</code>，则索引仅引用具有指定字段的文档。这些索引在某些情况下(特别是排序)使用的空间较小，但行为不同。默认值为<code>false</code>。</td> 
   </tr> 
   <tr> 
    <td><code>expireAfterSeconds</code></td> 
    <td><code>integer</code></td> 
    <td>指定一个值(以秒为单位)作为<code>TTL</code>，以控制MongoDB在此集合中保留文档的时间。</td> 
   </tr> 
   <tr> 
    <td><code>v</code></td> 
    <td>索引版本</td> 
    <td>索引版本号。默认索引版本取决于创建索引时运行的MongoDB的版本。</td> 
   </tr> 
   <tr> 
    <td><code>weights</code></td> 
    <td>文档</td> 
    <td>权重是从<code>1</code>到<code>99999</code>之间的数字，并且表示该字段相对于其他索引字段在分数方面的意义。</td> 
   </tr> 
   <tr> 
    <td><code>default_language</code></td> 
    <td><code>String</code></td> 
    <td>对于文本索引，确定停止词列表的语言以及句柄和分词器的规则。 默认值为英文。</td> 
   </tr> 
   <tr> 
    <td><code>language_override</code></td> 
    <td><code>String</code></td> 
    <td>对于文本索引，要指定文档中包含覆盖默认语言的字段名称。默认值为<code>language</code>。</td> 
   </tr> 
  </tbody> 
 </table>
 <br>      
</div></body></html>