<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MongoDB ObjectId</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在前面学习的所有章节中，都有使用了MongoDB对象标识符。 在本章中，我们将了解ObjectId的结构。</p> 
 <p><em>ObjectId</em> 是具有以下结构的12字节BSON类型 -</p> 
 <ul> 
  <li>前<code>4</code>个字节表示从unix纪元开始的秒数</li>
  <li>接下来的<code>3</code>个字节是机器标识符</li>
  <li>接下来的<code>2</code>个字节由进程ID组成</li>
  <li>最后<code>3</code>个字节是随机计数器值</li>
 </ul> 
 <p>MongoDB使用<code>ObjectIds</code>作为每个文档的<code>_id</code>字段的默认值，这是在创建任何文档时生成的。 <code>ObjectId</code>的复杂组合使得所有<code>_id</code>字段都是唯一的。</p> 
 <pre><code class="lang-shell">&gt;newObjectId = ObjectId()
</code></pre> 
 <p>上述语句返回以下唯一生成的id -</p> 
 <pre><code class="lang-shell">ObjectId("595b99d9f6a6243715b3c312")
</code></pre> 
 <p>还可以提供一个<code>12</code>字节的 <code>id</code> 来可代替 MongoDB 生成 ObjectId -</p> 
 <pre><code class="lang-shell">&gt;myObjectId = ObjectId("595b99d9f6a6243715b3c312")
</code></pre> 
 <h2 id="h2-u521Bu5EFAu6587u6863u7684u65F6u95F4u6233"><a name="创建文档的时间戳" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建文档的时间戳</h2>
 <p>由于<code>_id</code> ObjectId默认存储<code>4</code>字节的时间戳，在大多数情况下，不需要存储任何文档的创建时间。可以使用<code>getTimestamp</code>方法获取文档的创建时间 -</p>   
 <pre><code class="lang-shell">&gt;ObjectId("595b99d9f6a6243715b3c312").getTimestamp()
</code></pre> 
 <p>这将以ISO日期格式返回此文档的创建时间 -</p> 
 <pre><code class="lang-shell">&gt; ObjectId("595b99d9f6a6243715b3c312").getTimestamp()
ISODate("2017-07-04T13:36:25Z")
</code></pre> 
 <h2 id="h2--objectid-string"><a name="将ObjectId转换为String" class="reference-link"></a><span class="header-link octicon octicon-link"></span>将ObjectId转换为String</h2>
 <p>在某些情况下，可能需要使用字符串格式的<code>ObjectId</code>值。 要转换<code>ObjectId</code>为字符串，请使用以下代码 -</p> 
 <pre><code class="lang-shell">&gt;newObjectId.str
</code></pre> 
 <p>上面的代码将返回Guid的字符串格式 -</p> 
 <pre><code class="lang-shell">595b99d9f6a6243715b3c312
</code></pre>
 <br>      
</div></body></html>