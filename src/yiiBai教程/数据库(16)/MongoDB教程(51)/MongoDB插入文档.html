<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MongoDB插入文档</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，我们将学习如何在MongoDB集合中插入文档。</p> 
 <h2 id="h2-insert-"><a name="insert()方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>insert()方法</h2>
 <p>要将数据插入到 MongoDB 集合中，需要使用 MongoDB 的 <code>insert()</code>或<code>save()</code>方法。</p> 
 <p><strong>语法</strong></p> 
 <p><code>insert()</code>命令的基本语法如下：</p> 
 <pre><code class="lang-shell">&gt;db.COLLECTION_NAME.insert(document)
</code></pre> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-shell">&gt;db.mycol.insert({
   _id: 100,
   title: 'MongoDB Overview', 
   description: 'MongoDB is no sql database',
   by: 'yiibai tutorials',
   url: 'http://www.yiibai.com',
   tags: ['mongodb', 'database', 'NoSQL'],
   likes: 100,
})
</code></pre> 
 <p>这里<code>mycol</code>是集合的名称，在前一章中所创建的。如果数据库中不存在集合，则MongoDB将创建此集合，然后将文档插入到该集合中。</p> 
 <p>在插入的文档中，如果不指定<code>_id</code>参数，那么 MongoDB 会为此文档分配一个唯一的ObjectId。</p> 
 <p><code>_id</code>为集合中的每个文档唯一的<code>12</code>个字节的十六进制数。 <code>12</code>字节划分如下 -</p> 
 <pre><code class="lang-shell">_id: ObjectId(4 bytes timestamp, 3 bytes machine id, 2 bytes process id, 
   3 bytes incrementer)
</code></pre> 
 <p>要在单个查询中插入多个文档，可以在<code>insert()</code>命令中传递文档数组。如下所示 - </p> 
 <pre><code class="lang-shell">&gt; db.mycol.insert([
   {
      _id: 101,
      title: 'MongoDB Guide', 
      description: 'MongoDB is no sql database',
      by: 'yiibai tutorials',
      url: 'http://www.yiibai.com',
      tags: ['mongodb', 'database', 'NoSQL'],
      likes: 100
   },

   {
      _id: 102,
      title: 'NoSQL Database', 
      description: "NoSQL database doesn't have tables",
      by: 'yiibai tutorials',
      url: 'http://www.yiibai.com',
      tags: ['mongodb', 'database', 'NoSQL'],
      likes: 210, 
      comments: [
         {
            user:'user1',
            message: 'My first comment',
            dateCreated: new Date(2017,11,10,2,35),
            like: 0 
         }
      ]
   },
   {
      _id: 104,
      title: 'Python Quick Guide', 
      description: "Python Quick start ",
      by: 'yiibai tutorials',
      url: 'http://www.yiibai.com',
      tags: ['Python', 'database', 'NoSQL'],
      likes: 30, 
      comments: [
         {
            user:'user1',
            message: 'My first comment',
            dateCreated: new Date(2018,11,10,2,35),
            like: 590 
         }
      ]
   }
])
</code></pre> 
 <p>要插入文档，也可以使用<code>db.post.save(document)</code>。 如果不在文档中指定<code>_id</code>，那么<code>save()</code>方法将与<code>insert()</code>方法一样自动分配ID的值。如果指定<code>_id</code>，则将以<code>save()</code>方法的形式替换包含<code>_id</code>的文档的全部数据。</p> 
 <h2 id="h2-u5176u5B83u63D2u5165u6587u6863u7684u65B9u6CD5"><a name="其它插入文档的方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>其它插入文档的方法</h2>
 <h3 id="h3-db-collection-insertone-"><a name="db.collection.insertOne()方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db.collection.insertOne()方法</h3>
 <p><code>db.collection.insertOne()</code>方法将单个文档插入到集合中。以下示例将新文档插入到库存集合中。 如果文档没有指定<code>_id</code>字段，MongoDB会自动将<code>_id</code>字段与<code>ObjectId</code>值添加到新文档。</p>   
 <pre><code class="lang-shell">db.inventory.insertOne(
   { item: "canvas", qty: 100, tags: ["cotton"], size: { h: 28, w: 35.5, uom: "cm" } }
)
</code></pre> 
 <p><code>db.collection.insertOne()</code>方法返回包含新插入的文档的`_id```字段值的文档。</p> 
 <p>执行结果如下 - </p> 
 <pre><code class="lang-shell">&gt; db.inventory.insertOne(
...    { item: "canvas", qty: 100, tags: ["cotton"], size: { h: 28, w: 35.5, uom: "cm" } }
... )
{
        "acknowledged" : true,
        "insertedId" : ObjectId("5955220846be576f199feb55")
}
&gt;
</code></pre> 
 <h3 id="h3-db-collection-insertmany-"><a name="db.collection.insertMany()方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db.collection.insertMany()方法</h3>
 <p><code>db.collection.insertMany()</code>方法将多个文档插入到集合中，可将一系列文档传递给<code>db.collection.insertMany()</code>方法。以下示例将三个新文档插入到库存集合中。如果文档没有指定<code>_id</code>字段，MongoDB会向每个文档添加一个ObjectId值的<code>_id</code>字段。</p> 
 <pre><code class="lang-shell">db.inventory.insertMany([
   { item: "journal", qty: 25, tags: ["blank", "red"], size: { h: 14, w: 21, uom: "cm" } },
   { item: "mat", qty: 85, tags: ["gray"], size: { h: 27.9, w: 35.5, uom: "cm" } },
   { item: "mousepad", qty: 25, tags: ["gel", "blue"], size: { h: 19, w: 22.85, uom: "cm" } }
])
</code></pre> 
 <p><code>insertMany()</code>返回包含新插入的文档<code>_id</code>字段值的文档。执行结果如下 - </p> 
 <pre><code class="lang-shell">&gt; db.inventory.insertMany([
...    { item: "journal", qty: 25, tags: ["blank", "red"], size: { h: 14, w: 21, uom: "cm" } },
...    { item: "mat", qty: 85, tags: ["gray"], size: { h: 27.9, w: 35.5, uom: "cm" } },
...    { item: "mousepad", qty: 25, tags: ["gel", "blue"], size: { h: 19, w: 22.85, uom: "cm" } }
... ])
{
        "acknowledged" : true,
        "insertedIds" : [
                ObjectId("59552c1c46be576f199feb56"),
                ObjectId("59552c1c46be576f199feb57"),
                ObjectId("59552c1c46be576f199feb58")
        ]
}
&gt;
</code></pre>
 <br>      
</div></body></html>