<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PHP连接MongoDB操作</h1><div style="width:100%;float:left;" class="article-content">   
 <p>要使用PHP与MongoDB交互存储数据，需要使用MongoDB PHP驱动程序(<a target="_blank" href="http://pecl.php.net/package/mongo)。">http://pecl.php.net/package/mongo)。</a> 从url下载驱动程序下载PHP驱动程序并确保下载的是正确的版本(如在本示例中：Win10 64位下载的版本是：<code>php_mongo-1.6.8-5.6-ts-vc11-x64.zip</code>)。 现在解压缩存档并将<code>php_mongo.dll</code>放入PHP扩展目录(默认为“<code>ext</code>”)，并将以下行添加到<code>php.ini</code>文件中 -</p> 
 <pre><code class="lang-shell">extension = php_mongo.dll
</code></pre> 
 <p>然后重新启动 Apache 服务器，查看 <code>phpinfo()</code> 函数的输出结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201707/0307/657150715_41628.png" alt=""></p> 
 <h2 id="h2-u8FDBu884Cu8FDEu63A5u5E76u9009u62E9u6570u636Eu5E93"><a name="进行连接并选择数据库" class="reference-link"></a><span class="header-link octicon octicon-link"></span>进行连接并选择数据库</h2>
 <p>要进行连接，需要指定数据库名称，如果数据库不存在，那么MongoDB会自动创建它。</p> 
 <p>以下是连接到数据库的代码片段 -</p> 
 <pre><code class="lang-php">&lt;?php
   // connect to mongodb
   $m = new MongoClient();

   echo "Connection to database successfully&lt;br/&gt;";
   // select a database
   $db = $m-&gt;mydb;

   echo "Database mydb selected";
?&gt;
</code></pre> 
 <p>执行程序时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">Connection to database successfully
Database mydb selected
</code></pre> 
 <h2 id="h2-u521Bu5EFAu4E00u4E2Au96C6u5408"><a name="创建一个集合" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建一个集合</h2>
 <p>以下是创建集合的代码片段 -</p> 
 <pre><code class="lang-php">&lt;?php
   // connect to mongodb
   $m = new MongoClient();
   echo "Connection to database successfully";

   // select a database
   $db = $m-&gt;mydb;
   echo "Database mydb selected";
   $collection = $db-&gt;createCollection("phpcol");
   echo "Collection created succsessfully";
?&gt;
</code></pre> 
 <p>执行程序时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">Connection to database successfully
Database mydb selected
Collection created succsessfully
</code></pre> 
 <h2 id="h2-u63D2u5165u6587u6863"><a name="插入文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>插入文档</h2>
 <p>要将文档插入到MongoDB中，请使用<code>insert()</code>方法。<br>以下是插入文档的代码片段 -</p> 
 <pre><code class="lang-shell">&lt;?php
   // connect to mongodb
   $m = new MongoClient();
   echo "Connection to database successfully";

   // select a database
   $db = $m-&gt;mydb;
   echo "Database mydb selected";
   $collection = $db-&gt;phpcol;
   echo "Collection selected succsessfully";

   $document = array( 
      "title" =&gt; "MongoDB", 
      "description" =&gt; "database", 
      "likes" =&gt; 100,
      "url" =&gt; "http://www.yiibai.com/mongodb/",
      "by", "tutorials point"
   );

   $collection-&gt;insert($document);
   echo "Document inserted successfully";
?&gt;
</code></pre> 
 <p>执行程序时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">Connection to database successfully
Database mydb selected
Collection selected succsessfully
Document inserted successfully
</code></pre> 
 <h2 id="h2-u67E5u627Eu6240u6709u6587u4EF6"><a name="查找所有文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>查找所有文件</h2>
 <p>要从集合中选择所有文档，请使用<code>find()</code>方法。</p> 
 <pre><code class="lang-php">
&lt;?php
   // connect to mongodb
   $m = new MongoClient();
   echo "Connection to database successfully";

   // select a database
   $db = $m-&gt;mydb;
   echo "Database mydb selected";
   $collection = $db-&gt;phpcol;
   echo "Collection selected succsessfully";

   $cursor = $collection-&gt;find();
   // iterate cursor to display title of documents

   foreach ($cursor as $document) {
      echo $document["title"]. ', URL is=&gt; ' .$document["url"] .  "
";
   }
?&gt;
</code></pre> 
 <p>以下是选择所有文档的代码片段 -</p> 
 <pre><code class="lang-shell">Connection to database successfully
Database mydb selected
Collection selected succsessfully 
MongoDB, URL is=&gt; http://www.yiibai.com/mongodb/
</code></pre> 
 <h2 id="h2-u66F4u65B0u6587u6863"><a name="更新文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>更新文档</h2>
 <p>要更新文档，需要使用<code>update()</code>方法。</p> 
 <p>在下面的例子中，将把插入的文档的标题更新为：<em>MongoDB教程</em> 。 以下是更新文档的代码段 -</p>   
 <pre><code class="lang-php">&lt;?php
   // connect to mongodb
   $m = new MongoClient();
   echo "Connection to database successfully";

   // select a database
   $db = $m-&gt;mydb;
   echo "Database mydb selected";
   $collection = $db-&gt;mycol;
   echo "Collection selected succsessfully";

   // now update the document
   $collection-&gt;update(array("title"=&gt;"MongoDB"), 
      array('$set'=&gt;array("title"=&gt;"MongoDB教程")));
   echo "Document updated successfully";

   // now display the updated document
   $cursor = $collection-&gt;find();

   // iterate cursor to display title of documents
   echo "Updated document";

   foreach ($cursor as $document) {
      echo $document["title"] .', URL =&gt; '.$document["url"] . "
";
   }
?&gt;
</code></pre> 
 <p>以下是选择所有文档的代码片段 -</p> 
 <pre><code class="lang-shell">Connection to database successfully
Database mydb selected
Collection selected succsessfully 
MongoDB, URL is=&gt; http://www.yiibai.com/mongodb/
</code></pre> 
 <h2 id="h2-u5220u9664u6587u6863"><a name="删除文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>删除文档</h2>
 <p>要删除文档，可使用<code>remove()</code>方法。</p> 
 <p>在下面的示例中，将删除标题为：<em>MongoDB教程</em> 的文档。 以下是删除文档的代码片段 -</p> 
 <pre><code class="lang-php">&lt;?php
   // connect to mongodb
   $m = new MongoClient();
   echo "Connection to database successfully";

   // select a database
   $db = $m-&gt;mydb;
   echo "Database mydb selected";
   $collection = $db-&gt;phpcol;
   echo "Collection selected succsessfully";

   // now remove the document
   $collection-&gt;remove(array("title"=&gt;"MongoDB教程"),false);
   echo "Documents deleted successfully";

   // now display the available documents
   $cursor = $collection-&gt;find();

   foreach ($cursor as $document) {
      echo $document["title"] . "
";
   }
?&gt;
</code></pre> 
 <p>以下是选择所有文档的代码片段 -</p> 
 <pre><code class="lang-shell">Connection to database successfully
Database mydb selected
Collection selected succsessfully 
Documents deleted successfully
</code></pre> 
 <p>在上面的例子中，第二个参数是布尔类型，用于<code>remove()</code>方法的<code>justOne</code>字段。<br>其余的MongoDB方法<code>findOne()</code>，<code>save()</code>，<code>limit()</code>，<code>skip()</code>，<code>sort()</code>等与上述相同。</p> 
 <p>由于此篇教程文章是一个入门级的教程文章，只是讲解有关简单入门的操作，有关更高级的内容，请参考：<a target="_blank" href="http://docs.mongodb.com/php-library/">http://docs.mongodb.com/php-library/</a></p>
 <br>      
</div></body></html>