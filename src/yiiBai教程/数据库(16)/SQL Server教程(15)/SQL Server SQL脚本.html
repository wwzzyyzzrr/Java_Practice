<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">SQL Server SQL脚本</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 在前面的课程，我们使用“编辑前200行”选项添加数据到我们的数据库表。在这一课中，我们将着眼于如何编写SQL脚本来更新并运行对数据库进行查询。</p> 
 <p> SQL脚本可用于插入数据，读取数据，更新数据，和删除数据。它们也可以用于创建数据库对象，如表，视图，存储过程，他们甚至可以用于创建整个数据库本身 - 完整的表，数据，用户，等等。</p> 
 <h2> Transact-SQL</h2> 
 <p style="color: rgb(0, 0, 0);  Verdana,  font-size: 16px; line-height: 27.2000007629395px;"> SQL Server支持的、Transact-SQL作为脚本语言。&nbsp;Transact-SQL是基于SQL（结构化查询语言），它是用于应用程序和它们的数据库之间的接口的编程语言。Transact-SQL是一个相对容易的语言学习，我强烈建议熟悉它。<span style="line-height: 27.2000007629395px;">在这里</span><span style="line-height: 27.2000007629395px;">每当指SQL脚本，意思就是一个Transact-SQL脚本。</span></p> 
 <h2> SQL语句</h2> 
 <p> SQL脚本通常由一个或多个“语句”。每个语句告诉SQL Server该怎么做。</p> 
 <p> SQL脚本可以包含许多语句。例如，SQL脚本可以包含一个语句创建一个表，另一份声明将数据插入到该表，而另一份语句中，以选择所有刚刚插入到表中的数据。事实上，SQL有一个用于那些确切的三项具体语句：CREATE语句，INSERT语句和SELECT语句。</p> 
 <p> 一般来说，语句开始使用想要执行的任务的指令。如果你想创建一个数据库对象时，声明开始后创建。我说：“一般来说”，因为，还有一些其他的点点滴滴，你可以在抛出一个SQL语句可能会及所希望的语句。</p> 
 <h2> SQL语句示例</h2> 
 <p> 也许最简单的SQL语句是学习SELECT语句。下面是在其最简单的SELECT语句的一个例子：</p> 
 <div class="code-snippet" style="border-left-width: 6px; border-left-style: solid; border-left-color: rgb(255, 204, 0); padding: 0px 10px 10px; font-size: 0.8em; color: rgb(0, 0, 0);  Verdana,  line-height: 27.2000007629395px; background: rgb(255, 244, 200);"> 
  <span class="button" data-clipboard-target="bodyTextNo1" id="copy-button-bodyTextNo1" style="color: rgb(255, 204, 0); cursor: pointer;" title="Click to copy">✂</span> 
  <pre class="prettyprint overthrow prettyprinted" id="bodyTextNo1" style="'Anonymous Pro', Monaco, Menlo, Courier, monospace; tab-size: 4; padding: 2px; border: 0px; max-width: 700px; overflow: auto;">
<span class="pln" style="color: rgb(102, 51, 0);">SELECT </span><span class="pun" style="color: rgb(255, 153, 0);">*</span><span class="pln" style="color: rgb(102, 51, 0);"> FROM </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span></pre> 
 </div> 
 <p> 上面的语句从任务表中的选择所有列。星号（*）的意思是“所有列”。上面的语句可以略作修改，只返回一个特定的列，我们可以添加一个WHERE子句来过滤数据，只有那些我们感兴趣的记录：</p> 
 <div class="code-snippet" style="border-left-width: 6px; border-left-style: solid; border-left-color: rgb(255, 204, 0); padding: 0px 10px 10px; font-size: 0.8em; color: rgb(0, 0, 0);  Verdana,  line-height: 27.2000007629395px; background: rgb(255, 244, 200);"> 
  <span class="button" data-clipboard-target="bodyTextNo2" id="copy-button-bodyTextNo2" style="color: rgb(255, 204, 0); cursor: pointer;" title="Click to copy">✂</span> 
  <pre class="prettyprint overthrow prettyprinted" id="bodyTextNo2" style="'Anonymous Pro', Monaco, Menlo, Courier, monospace; tab-size: 4; padding: 2px; border: 0px; max-width: 700px; overflow: auto;">
<span class="pln" style="color: rgb(102, 51, 0);">SELECT </span><span class="typ" style="color: rgb(66, 113, 174);">TaskName</span><span class="pln" style="color: rgb(102, 51, 0);"> FROM </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pln" style="color: rgb(102, 51, 0);"> </span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="pln" style="color: rgb(102, 51, 0);"> </span><span class="str" style="color: rgb(0, 136, 0);">"3"</span></pre> 
 </div> 
 <p> 上述语句选择从任务表中的TaskName列，但它只返回那些具有StatusId为3的记录。值为3可能是“To Do”或“Done”，或不管它是什么，我们只希望它表示具体的意思。在我们的TaskTracker数据库中，我们将创建一个新的表称为Status，我们将指定“3”是指什么（“1”和“2”又表示什么）。这些数字只是在StatusId字段中（我们指定为标识列 - 一个自动编号）的值。每个这些数字将在StatusName字段相应值将告诉我们实际上是什么状态。</p> 
 <p> 然后，一旦我们已经创建了状态表中，我们可以修改上面的SQL语句，以包括状态表，以便我们可以编写为WHERE StatusName=“To Do”，而不是试图记住“To Do”数字是什么。</p> 
 <p> 但是，我们需要首先创建我们的Status表...&nbsp;</p> 
 <h2> 使用SQL脚本创建表</h2> 
 <p> 下面是一个SQL脚本，将在我们的数据库中另一个表- 一个名为Status表。如果不熟悉SQL它可能看起来有点怪异。&nbsp;当看到列及其相应的数据类型的名称是什么，那么也就对它有一些了解。在此脚本中，我们并不容许任何NULL字段（因此NOT NULL毗邻每一列）。我们也创建了主键StatusId字段，我们设定的默认值的dateCreated字段，使用（getdate()）。</p> 
 <p> 要运行此脚本，请执行以下操作：</p> 
 <ol> 
  <li> 脚本复制到剪贴板</li> 
  <li> 在SQL Server管理套件，单击工具栏上的新建查询按钮：</li> 
  <li> 脚本粘贴到查询窗口</li> 
  <li> 点击！执行该工具栏上的按钮：</li> 
 </ol> 
 <p> 一旦脚本运行，你应该看到一条消息，读取命令已成功完成。</p> 
 <img alt="Screenshot of the New Query button" class="screenshot" src="/uploads/allimg/150426/12354A200-0.png" style="border: 0px solid transparent; max-width: 100%; margin: 10px 0px 20px; -webkit-box-shadow: rgba(0, 0, 0, 0.4) 5px 5px 30px; box-shadow: rgba(0, 0, 0, 0.4) 5px 5px 30px; color: rgb(0, 0, 0);  Verdana,  font-size: 16px; line-height: 27.2000007629395px;"> 
 <p> 这里是脚本：</p> 
 <div class="code-snippet" style="border-left-width: 6px; border-left-style: solid; border-left-color: rgb(255, 204, 0); padding: 0px 10px 10px; font-size: 0.8em; color: rgb(0, 0, 0);  Verdana,  line-height: 27.2000007629395px; background: rgb(255, 244, 200);"> 
  <span class="button" data-clipboard-target="bodyTextNo3" id="copy-button-bodyTextNo3" style="color: rgb(255, 204, 0); cursor: pointer;" title="Click to copy">✂</span> 
  <pre class="prettyprint overthrow prettyprinted" id="bodyTextNo3" style="'Anonymous Pro', Monaco, Menlo, Courier, monospace; tab-size: 4; padding: 2px; border: 0px; max-width: 700px; overflow: auto;">
<span class="pln" style="color: rgb(102, 51, 0);">CREATE TABLE </span><span class="typ" style="color: rgb(66, 113, 174);">Status</span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="pln" style="color: rgb(102, 51, 0);">
	</span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pln" style="color: rgb(102, 51, 0);"> </span><span class="kwd" style="color: rgb(255, 140, 0);">int</span><span class="pln" style="color: rgb(102, 51, 0);"> IDENTITY</span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="lit" style="color: rgb(245, 135, 31);">1</span><span class="pun" style="color: rgb(255, 153, 0);">,</span><span class="lit" style="color: rgb(245, 135, 31);">1</span><span class="pun" style="color: rgb(255, 153, 0);">)</span><span class="pln" style="color: rgb(102, 51, 0);"> NOT NULL</span><span class="pun" style="color: rgb(255, 153, 0);">,</span><span class="pln" style="color: rgb(102, 51, 0);">
	</span><span class="typ" style="color: rgb(66, 113, 174);">StatusName</span><span class="pln" style="color: rgb(102, 51, 0);"> varchar</span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="lit" style="color: rgb(245, 135, 31);">50</span><span class="pun" style="color: rgb(255, 153, 0);">)</span><span class="pln" style="color: rgb(102, 51, 0);"> NOT NULL</span><span class="pun" style="color: rgb(255, 153, 0);">,</span><span class="pln" style="color: rgb(102, 51, 0);">
	</span><span class="typ" style="color: rgb(66, 113, 174);">DateCreated</span><span class="pln" style="color: rgb(102, 51, 0);"> datetime NOT NULL CONSTRAINT DF_Status_DateCreated  DEFAULT </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="pln" style="color: rgb(102, 51, 0);">getdate</span><span class="pun" style="color: rgb(255, 153, 0);">()),</span><span class="pln" style="color: rgb(102, 51, 0);">
	CONSTRAINT PK_Status PRIMARY KEY CLUSTERED </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">)</span><span class="pln" style="color: rgb(102, 51, 0);">
</span><span class="pun" style="color: rgb(255, 153, 0);">)</span></pre> 
 </div> 
 <h2> 键盘快捷键</h2> 
 <div> 
  <p> <strong>注：</strong>也可以通过按F5键盘上运行一个查询。</p> 
  <p> 另外，你甚至可以通过选择要运行的部分，然后按F5运行查询的一部分。这非常上包含大量的SQL语句的较大的脚本，但是，当由于某种原因，只要运行的一个或两个（或甚至运行所有这些，但只是一次一个）。</p> 
 </div> 
 <h2> 通过SQL脚本添加数据</h2> 
 <p> 也可以通过SQL脚本添加数据。该脚本将使用INSERT语句将数据插入到指定的表。 你可以使用脚本插入数据到所有列在表中，或者只是那些指定的表。</p> 
 <p> 下面的脚本将数据插入状态表，然后选择该数据（所以我们可以看到，它进入了）。运行此脚本，你做了上述脚本）以同样的方式：</p> 
 <div class="code-snippet" style="border-left-width: 6px; border-left-style: solid; border-left-color: rgb(255, 204, 0); padding: 0px 10px 10px; font-size: 0.8em; color: rgb(0, 0, 0);  Verdana,  line-height: 27.2000007629395px; background: rgb(255, 244, 200);"> 
  <span class="button" data-clipboard-target="bodyTextNo4" id="copy-button-bodyTextNo4" style="color: rgb(255, 204, 0); cursor: pointer;" title="Click to copy">✂</span> 
  <pre class="prettyprint overthrow prettyprinted" id="bodyTextNo4" style="'Anonymous Pro', Monaco, Menlo, Courier, monospace; tab-size: 4; padding: 2px; border: 0px; max-width: 700px; overflow: auto;">
<span class="pln" style="color: rgb(102, 51, 0);">INSERT INTO </span><span class="typ" style="color: rgb(66, 113, 174);">Status</span><span class="pln" style="color: rgb(102, 51, 0);"> </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="typ" style="color: rgb(66, 113, 174);">StatusName</span><span class="pun" style="color: rgb(255, 153, 0);">)</span><span class="pln" style="color: rgb(102, 51, 0);"> VALUES </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="str" style="color: rgb(0, 136, 0);">'To Do'</span><span class="pun" style="color: rgb(255, 153, 0);">);</span><span class="pln" style="color: rgb(102, 51, 0);">
INSERT INTO </span><span class="typ" style="color: rgb(66, 113, 174);">Status</span><span class="pln" style="color: rgb(102, 51, 0);"> </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="typ" style="color: rgb(66, 113, 174);">StatusName</span><span class="pun" style="color: rgb(255, 153, 0);">)</span><span class="pln" style="color: rgb(102, 51, 0);"> VALUES </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="str" style="color: rgb(0, 136, 0);">'In Progress'</span><span class="pun" style="color: rgb(255, 153, 0);">);</span><span class="pln" style="color: rgb(102, 51, 0);">
INSERT INTO </span><span class="typ" style="color: rgb(66, 113, 174);">Status</span><span class="pln" style="color: rgb(102, 51, 0);"> </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="typ" style="color: rgb(66, 113, 174);">StatusName</span><span class="pun" style="color: rgb(255, 153, 0);">)</span><span class="pln" style="color: rgb(102, 51, 0);"> VALUES </span><span class="pun" style="color: rgb(255, 153, 0);">(</span><span class="str" style="color: rgb(0, 136, 0);">'Done'</span><span class="pun" style="color: rgb(255, 153, 0);">);</span><span class="pln" style="color: rgb(102, 51, 0);">

SELECT </span><span class="pun" style="color: rgb(255, 153, 0);">*</span><span class="pln" style="color: rgb(102, 51, 0);"> FROM </span><span class="typ" style="color: rgb(66, 113, 174);">Status</span></pre> 
 </div> 
 <p> 这里是这个样子的：</p> 
 <img alt="Screenshot SQL query results" class="screenshot" src="/uploads/allimg/150426/12354Aa7-1.png" style="border: 0px solid transparent; max-width: 100%; margin: 10px 0px 20px; -webkit-box-shadow: rgba(0, 0, 0, 0.4) 5px 5px 30px; box-shadow: rgba(0, 0, 0, 0.4) 5px 5px 30px; color: rgb(0, 0, 0);  Verdana,  font-size: 16px; line-height: 27.2000007629395px;"> 
 <p> 正如你所看到的，查询的结果显示在底部窗格中。</p> 
 <h3> 交叉参考数据</h3> 
 <p> 现在，我们已经得到了Status表，让我们一值添加到任务表的StatusId字段中（还记得我们保留那个字段为空的所有记录，因为我们还没有Status表）。</p> 
 <p> 所以我们增加值要任务表链接到Status表。 在任务表中的每个记录现在将有一个StatusId，它的值可能是1，2或3（在状态表的StatusId字段中匹配的值）。</p> 
 <p> 要做到这一点，我们需要使用UPDATE语句（因为我们正在更新记录，而不是插入新的）。</p> 
 <p> 因此，事不宜迟，让我们运行下面的脚本：</p> 
 <div class="code-snippet" style="border-left-width: 6px; border-left-style: solid; border-left-color: rgb(255, 204, 0); padding: 0px 10px 10px; font-size: 0.8em; color: rgb(0, 0, 0);  Verdana,  line-height: 27.2000007629395px; background: rgb(255, 244, 200);"> 
  <span class="button" data-clipboard-target="bodyTextNo5" id="copy-button-bodyTextNo5" style="color: rgb(255, 204, 0); cursor: pointer;" title="Click to copy">✂</span>   
  <pre class="prettyprint overthrow prettyprinted" id="bodyTextNo5" style="'Anonymous Pro', Monaco, Menlo, Courier, monospace; tab-size: 4; padding: 2px; border: 0px; max-width: 700px; overflow: auto;">
<span class="pln" style="color: rgb(102, 51, 0);">UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'1'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'1'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'1'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'2'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'2'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'3'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'3'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'4'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'3'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'5'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'2'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'6'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

UPDATE </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span><span class="pln" style="color: rgb(102, 51, 0);">
SET </span><span class="typ" style="color: rgb(66, 113, 174);">StatusId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'1'</span><span class="pln" style="color: rgb(102, 51, 0);">
WHERE </span><span class="typ" style="color: rgb(66, 113, 174);">TaskId</span><span class="pun" style="color: rgb(255, 153, 0);">=</span><span class="str" style="color: rgb(0, 136, 0);">'7'</span><span class="pun" style="color: rgb(255, 153, 0);">;</span><span class="pln" style="color: rgb(102, 51, 0);">

SELECT </span><span class="pun" style="color: rgb(255, 153, 0);">*</span><span class="pln" style="color: rgb(102, 51, 0);"> FROM </span><span class="typ" style="color: rgb(66, 113, 174);">Tasks</span></pre> 
 </div> 
 <p> 现在应该看到其StatusId字段中填写的所有记录您的任务表，完整。应该是这样的：</p> 
 <img alt="Screenshot SQL query results" class="screenshot" src="/uploads/allimg/150426/12354A403-2.png" style="border: 0px solid transparent; max-width: 100%; margin: 10px 0px 20px; -webkit-box-shadow: rgba(0, 0, 0, 0.4) 5px 5px 30px; box-shadow: rgba(0, 0, 0, 0.4) 5px 5px 30px; color: rgb(0, 0, 0);  Verdana,  font-size: 16px; line-height: 27.2000007629395px;"> 
 <h2> 合并脚本</h2> 
 <p> 事实上，我们可能只是很容易地结合上述所有脚本并运行它们为一体。我只保留了它们，才能分离出来，使其更易于了解哪些部分做什么。</p> 
 <p> 如果您想了解更多关于创建SQL语句，请看看<a target="_blank" href="http://www.yiibai.com/sql/">SQL教程</a>。</p> 
 <h2> 区分大小写</h2> 
 <p> SQL不区分大小写。所以下面的语句都是执行同样的事情：</p> 
 <ul style="color: rgb(0, 0, 0);  Verdana,  font-size: 16px; line-height: 27.2000007629395px;"> 
  <li> <code style="'Anonymous Pro', Monaco, Menlo, Courier, monospace;">SELECT * FROM TASKS</code></li> 
  <li> <code style="'Anonymous Pro', Monaco, Menlo, Courier, monospace;">SELECT * FROM Tasks</code></li> 
  <li> <code style="'Anonymous Pro', Monaco, Menlo, Courier, monospace;">Select * From Tasks</code></li> 
  <li> <code style="'Anonymous Pro', Monaco, Menlo, Courier, monospace;">select * from tasks</code></li> 
 </ul> 
 <h2> 数据库管理</h2> 
 <p> 大多数的数据库管理任务（如创建用户，备份等），可以在SSMS通过图形用户界面进行编程，可以通过SQL脚本来执行。本教程集中使用的图形用户界面，主要是因为它通常是一个更容易为新用户得到一个简单的入门。&nbsp;当你更熟悉SQL Server，就可以使用SQL脚本来执行许多任务，也可通过图形用户界面做自己的事情。</p> 
 <p> 接下来，我们看一下<a target="_blank" href="http://www.yiibai.com/sql_server/query_designer.html">查询设计</a>。</p> 
 <br>      
</div></body></html>