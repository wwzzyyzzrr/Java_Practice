<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Access分组数据</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，我们将介绍Access中如何计算如何分组记录。 我们创建了一个按行计算或按记录计算的字段来创建行总计或小计字段，但是如果想通过分组记录而不是单个记录来计算，那该怎么办呢？ 可以通过创建聚合查询来实现这一点。</p> 
 <h2 id="h2-u805Au5408u67E5u8BE2"><a name="聚合查询" class="reference-link"></a><span class="header-link octicon octicon-link"></span>聚合查询</h2>
 <p>聚合查询也称为总计或汇总查询是总和，质量或组的详细信息。它可以是总金额或总金额或记录的组或子集。 聚合查询可以执行许多操作。下面是一个简单的表格，列出了分组记录中总的方法。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>聚合函数</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td>Sum</td> 
    <td>相加字段值</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td>Avg</td> 
    <td>字段值的平均值</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td>Min</td> 
    <td>字段值的最小值</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td>Max</td> 
    <td>字段值的最小值</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td>Count</td> 
    <td>计数值(记录/行数量)</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td>StDev</td> 
    <td>字段值的标准偏差包括日期/时间字段</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td>Var</td> 
    <td>字段值的变化，包括日期/时间</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>打开数据库并转到查询设计，这是一个图书销售管理数据库。其中包含以下几个表 -<br><img src="http://www.yiibai.com/uploads/images/201712/2812/955081257_18845.png" alt=""></p> 
 <p>这是一个简单的查询，只显示两个字段 - 书名(<code>BookTitle</code>)和购买数量(<code>BuyNumber</code>)，当运行它，我们看到数据库中的每一个单独的订单。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/334091209_35947.png" alt=""></p> 
 <p>现在运行这个查询，会看到下面的结果。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/913091210_84691.png" alt=""></p> 
 <p>可以看到书名有重复。 这里的每本书都有单独的订单，而且订购的数量也不同。 让我们假设只想看到只列出了有购买记录的书名的摘要。 然后是其旁边列出的数量的总和。</p> 
 <p>打开进入设计视图，在设计选项卡中，将看到一个西格玛符号。 这是用于总计按钮。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/516091217_38997.png" alt=""></p> 
 <p>单击将在表格行中的字段下方打开另一行的西格玛符号，从这里可以指定如何对此查询进行分组。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/394091220_81806.png" alt=""></p> 
 <p>现在可以看到所有订单中每本图书的购买数量。运行结果如下 -<br><img src="http://www.yiibai.com/uploads/images/201712/2812/112091223_13444.png" alt=""></p> 
 <h2 id="h2-access-"><a name="Access中的连接" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Access中的连接</h2>
 <p>我们学习了规范化的过程，将信息存储在不同的字段。 有时，您想要查看或查看数据，例如将<code>Name</code>和<code>phone</code>字段组合为单个字段。可以通过创建连接一个或多个字符串的计算字段一起显示该信息。还可以添加其他字符，如逗号或句点，也可能需要。</p> 
 <p>要在Access中进行连接，可以使用两个不同的运算符(<code>&amp;</code>)和加号(<code>+</code>)。</p> 
 <p><code>&amp;</code>符号将两个字符串合并为一个，而加号将合并两个字符串并使用<code>NULL</code>值，例如，如果一个值为<code>NULL</code>，则整个表达式的计算结果为<code>null</code>。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>  
 <p>下面举一个简单的例子来理解使用查询设计创建新查询的过程。 这将是一个非常简单的查询，从客户的表中提取信息。</p> 
 <p>现在添加<code>tblCustomers</code>表关闭显示表对话框。将尝试一些简单的命名字段的连接。</p> 
 <p>现在添加<code>Name</code>,<code>Address</code>和<code>Phone</code>字段构成一个送化地址并运行查询。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/375091231_49528.png" alt=""></p> 
 <p>正如所看到的，<code>Name</code>,<code>Address</code>和<code>Phone</code>分成三个不同的字段。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/390091240_44264.png" alt=""></p> 
 <p>返回到设计视图，在第四个字段中创建一个名为全名的新字段。 现在，添加完整名称并键入连接这三个字段的表达式：<code>送货地址: tblCustomers.Address+tblCustomers.Name+tblCustomers.Phone</code>。如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/2812/432091246_72781.png" alt=""></p> 
 <p>运行查询，会看到一个新的计算字段 - <code>送货地址</code>。<br><img src="http://www.yiibai.com/uploads/images/201712/2812/467091248_29432.png" alt=""></p> 
 <p>它可以将来自这三个字段的信息连接在一起，但它并不完全以想要的方式出现。 它运行显示所有的文本，因为它按照要求的方式执行。现在必须要求Access在这两个字段的信息之间增加空格 - <code>送货地址: [tblCustomers].[Address]+" "+[tblCustomers].[Name]+" "+[tblCustomers].[Phone]</code>。执行结果如下 -<br><img src="http://www.yiibai.com/uploads/images/201712/2812/335091250_85560.png" alt=""></p>
 <br>      
</div></body></html>