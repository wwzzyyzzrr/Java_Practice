<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Access多对多关系</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，让我们了解和学习多对多的关系。要表示多对多关系，必须创建第三个表(通常称为联接表)，将多对多关系分解为两个一对多关系。 为此，我们还需要添加一个联接表。 下面先添加一个表<code>tblAuthers</code>。表的定义如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201712/2712/747091228_34454.png" alt=""></p> 
 <p>现在创建一个多对多的关系。假设有多个作者在多个项目上工作，反之亦然。 如您所知，我们在<code>Projects</code>中有一个<code>Author</code>字段，所以为它创建了一个表。但现在不再需要这个字段了。<br><img src="http://www.yiibai.com/uploads/images/201712/2712/189091234_72500.png" alt=""></p> 
 <p>选择<code>Author</code>字段，然后按下<strong>删除</strong> 按钮，将看到以下消息。<br><img src="http://www.yiibai.com/uploads/images/201712/2712/877091234_58793.png" alt=""></p> 
 <p>单击<strong>是</strong>，现在还需要创建一个联连表：<em>tblAuthorJunction</em>。 这个联连表有两个外键，如下图所示。<br><img src="http://www.yiibai.com/uploads/images/201712/2712/375091249_57856.png" alt=""></p> 
 <p>这些外键字段将是链接在一起的两个表的主键 - <code>tblAuthers</code>和<code>tblProjects</code>。</p> 
 <p>要在Access中创建组合键，请选择这两个字段，然后从<strong>表工具设计</strong>选项卡中，直接单击该主键，这里标记这两个字段。如下图所示 -<br><img src="http://www.yiibai.com/uploads/images/201712/2712/165091251_43742.png" alt=""></p> 
 <p>这两个字段的组合是表的唯一标识符。 现在把这个表保存为 - <code>tblAuthorJunction</code>。</p> 
 <p>回到关系视图，并通过单击“显示表”来创建这些关系。选择上述三个表，然后单击<strong>添加</strong>按钮，然后关闭此对话框。如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201712/2712/877091254_61917.png" alt=""></p> 
 <p>从<code>tblAuthors</code>中单击并拖动<code>AuthorID</code>字段，并将其放在<code>tblAuthorJunction</code>表的<code>AuthorID</code>之上。<br><img src="http://www.yiibai.com/uploads/images/201712/2712/297091256_38391.png" alt=""></p> 
 <p>创建的关系是Access将被视为一对多的关系。也将执行参照诚信。 现在打开<strong>级联更新</strong>并点击<strong>创建</strong>按钮，如下图所示。<br><img src="http://www.yiibai.com/uploads/images/201712/2712/397091258_91343.png" alt=""><br>结果 -<br><img src="http://www.yiibai.com/uploads/images/201712/2712/117101200_36255.png" alt=""></p> 
 <p>现在单击并拖动<code>ProjectID</code>，放在<code>tblAuthorJunction</code>的<code>ProjectID</code>字段上。</p> 
 <p>我们将强化参照完整性和级联更新相关字段。如下图所示 -<br><img src="http://www.yiibai.com/uploads/images/201712/2712/446101201_27808.png" alt=""></p> 
 <p>以下是多对多的关系。<br><img src="http://www.yiibai.com/uploads/images/201712/2712/273101202_94000.png" alt=""></p>
 <br>      
</div></body></html>