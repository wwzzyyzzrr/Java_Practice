<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">PHP连接SQLite数据库</h1><div style="width:100%;float:left;" class="article-content">   
 <p>SQLite3扩展名在<code>PHP 5.3.0+</code>以上都会默认启用。可以在编译时使用<code>--without-sqlite3</code>来禁用它。</p> 
 <p>Windows用户可通过启用<code>php_sqlite3.dll</code>才能使用此扩展。 <code>php_sqlite3.dll</code>默认包含在<code>PHP 5.3.0</code>之后的PHP发行版中。</p> 
 <p>有关详细的安装说明，请查看<a target="_blank" href="http://www.yiibai.com/php/" title="PHP教程">PHP教程</a>及其官方网站。</p> 
 <h2 id="h2--sqlite-"><a name="连接到SQLite数据库" class="reference-link"></a><span class="header-link octicon octicon-link"></span>连接到SQLite数据库</h2>
 <p>以下PHP代码显示如何连接到SQLite数据库。 如果数据库不存在，那么它将创建一个新的数据库，最后将返回一个数据库对象。</p> 
 <pre><code class="lang-php">&lt;?php
   class SQLiteDB extends SQLite3
   {
      function __construct()
      {
         $this-&gt;open('phpdb.db');
      }
   }
   $db = new SQLiteDB();
   if(!$db){
      echo $db-&gt;lastErrorMsg();
   } else {
      echo "Yes, Opened database successfully\n";
   }
?&gt;
</code></pre> 
 <p>现在，运行上面的程序在当前目录中创建指定数据库：<code>phpdb.db</code>。可以根据需要更改路径。 如果数据库成功创建，则会提供以下消息：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/259100531_59991.png" alt=""></p> 
 <p>在执行上面语句后，应该也会在相同的目录下自动创建一个名称为：<code>phpdb.db</code>的数据库文件。如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/235100532_26778.png" alt=""></p> 
 <h2 id="h2-u521Bu5EFAu8868"><a name="创建表" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建表</h2>
 <p>以下PHP程序将用于在上面创建的数据库(<code>phpdb.db</code>)中创建一个表：</p> 
 <pre><code class="lang-php">&lt;?php
class SQLiteDB extends SQLite3
{
  function __construct()
  {
     $this-&gt;open('phpdb.db');
  }
}
$db = new SQLiteDB();
if(!$db){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Opened database successfully&lt;br/&gt;\n";
}

$sql =&lt;&lt;&lt;EOF
      CREATE TABLE company
      (ID INT PRIMARY KEY     NOT NULL,
      NAME           TEXT    NOT NULL,
      AGE            INT     NOT NULL,
      ADDRESS        CHAR(50),
      SALARY         REAL);
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Table created successfully&lt;br/&gt;\n";
}
$db-&gt;close();
</code></pre> 
 <p>当执行上述程序时，它将在数据库(<code>phpdb.db</code>)中创建一个名称为：<code>company</code>的表，并显示以下消息：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/117100536_84319.png" alt=""></p> 
 <h2 id="h2-u63D2u5165u6570u636Eu64CDu4F5C"><a name="插入数据操作" class="reference-link"></a><span class="header-link octicon octicon-link"></span>插入数据操作</h2>
 <p>以下PHP程序显示了如何在上述示例中创建的<code>company</code>表中插入数据记录：</p> 
 <pre><code class="lang-php">&lt;?php
class SQLiteDB extends SQLite3
{
  function __construct()
  {
     $this-&gt;open('phpdb.db');
  }
}
$db = new SQLiteDB();
if(!$db){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Opened database successfully&lt;br/&gt;\n";
}

// 先删除后创建表
$sql = "DROP table company";
$ret = $db-&gt;exec($sql);

// 创建表语句

$sql =&lt;&lt;&lt;EOF
      CREATE TABLE if not exists company
      (ID INT PRIMARY KEY     NOT NULL,
      NAME           TEXT    NOT NULL,
      AGE            INT     NOT NULL,
      ADDRESS        CHAR(50),
      SALARY         REAL);
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Table created successfully&lt;br/&gt;\n";
}

// $db-&gt;close();

$sql =&lt;&lt;&lt;EOF
      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (1, 'Maxsu', 26, 'Haikou', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (2, 'Allen', 25, 'Guangzhou', 15000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (3, 'Tenny', 23, 'Shanghai', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (4, 'Weiwang', 25, 'Beijing ', 65000.00 );
EOF;

   $ret = $db-&gt;exec($sql);
   if(!$ret){
      echo $db-&gt;lastErrorMsg();
   } else {
      echo "Yes, Some Records has Inserted successfully&lt;br/&gt;\n";
   }
   $db-&gt;close();
</code></pre> 
 <p>当执行上述程序时，将向<code>company</code>表中插入给定的记录，并显示如下：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/335100542_45875.png" alt=""></p> 
 <h2 id="h2-select-"><a name="SELECT操作" class="reference-link"></a><span class="header-link octicon octicon-link"></span>SELECT操作</h2>
 <p>以下PHP程序显示了如何从上述示例中创建的<code>company</code>表中获取并显示数据记录：</p> 
 <pre><code class="lang-php">&lt;?php
class SQLiteDB extends SQLite3
{
  function __construct()
  {
     $this-&gt;open('phpdb.db');
  }
}
$db = new SQLiteDB();
if(!$db){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Opened database successfully&lt;br/&gt;\n";
}

// 先删除后创建表
$sql = "DROP table company";
$ret = $db-&gt;exec($sql);

// 创建表

$sql =&lt;&lt;&lt;EOF
      CREATE TABLE if not exists company
      (ID INT PRIMARY KEY     NOT NULL,
      NAME           TEXT    NOT NULL,
      AGE            INT     NOT NULL,
      ADDRESS        CHAR(50),
      SALARY         REAL);
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Table created successfully&lt;br/&gt;\n";
}

// $db-&gt;close();

$sql =&lt;&lt;&lt;EOF
      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (1, 'Maxsu', 26, 'Haikou', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (2, 'Allen', 25, 'Guangzhou', 15000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (3, 'Tenny', 23, 'Shanghai', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (4, 'Weiwang', 25, 'Beijing ', 65000.00 );
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Some Records has Inserted successfully&lt;br/&gt;\n";
}

// 查询表中的数据

echo "&lt;b&gt; Select Data from company table :&lt;/b&gt;&lt;hr/&gt;";

$sql =&lt;&lt;&lt;EOF
  SELECT * from COMPANY;
EOF;

$ret = $db-&gt;query($sql);
while($row = $ret-&gt;fetchArray(SQLITE3_ASSOC) ){
  echo "ID = ". $row['ID'] . "&lt;br/&gt;\n";
  echo "NAME = ". $row['NAME'] ."&lt;br/&gt;\n";
  echo "ADDRESS = ". $row['ADDRESS'] ."&lt;br/&gt;\n";
  echo "SALARY =  ".$row['SALARY'] ."&lt;br/&gt;\n\n";
  echo '----------------------------------&lt;br/&gt;';
}

echo "Operation done successfully\n";

$db-&gt;close();
</code></pre> 
 <p>执行上述程序时，会产生以下结果：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/748100547_18696.png" alt=""></p> 
 <h2 id="h2-u66F4u65B0u64CDu4F5C"><a name="更新操作" class="reference-link"></a><span class="header-link octicon octicon-link"></span>更新操作</h2>
 <p>以下PHP代码显示了如何使用<code>UPDATE</code>语句来更新记录，然后从<code>company</code>表中获取并显示更新的记录：</p> 
 <pre><code class="lang-php">&lt;?php
class SQLiteDB extends SQLite3
{
  function __construct()
  {
     $this-&gt;open('phpdb.db');
  }
}
$db = new SQLiteDB();
if(!$db){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Opened database successfully&lt;br/&gt;\n";
}

// 先删除后创建表
$sql = "DROP table company";
$ret = $db-&gt;exec($sql);

// 创建表

$sql =&lt;&lt;&lt;EOF
      CREATE TABLE if not exists company
      (ID INT PRIMARY KEY     NOT NULL,
      NAME           TEXT    NOT NULL,
      AGE            INT     NOT NULL,
      ADDRESS        CHAR(50),
      SALARY         REAL);
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Table created successfully&lt;br/&gt;\n";
}

// $db-&gt;close();

$sql =&lt;&lt;&lt;EOF
      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (1, 'Maxsu', 26, 'Haikou', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (2, 'Allen', 25, 'Guangzhou', 15000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (3, 'Tenny', 23, 'Shanghai', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (4, 'Weiwang', 25, 'Beijing ', 65000.00 );
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Some Records has Inserted successfully&lt;br/&gt;\n";
}

// 更新ID=1的薪水为：29999

$sql = 'UPDATE COMPANY set SALARY = 29999.00 where ID=1';
$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo $db-&gt;changes(), " Record(ID=1) updated successfully&lt;br/&gt;\n";
}


// 查询表中的数据

echo "&lt;b&gt; Select Data from company table :&lt;/b&gt;&lt;hr/&gt;";

$sql =&lt;&lt;&lt;EOF
  SELECT * from COMPANY;
EOF;

$ret = $db-&gt;query($sql);
while($row = $ret-&gt;fetchArray(SQLITE3_ASSOC) ){
  echo "ID = ". $row['ID'] . "&lt;br/&gt;\n";
  echo "NAME = ". $row['NAME'] ."&lt;br/&gt;\n";
  echo "ADDRESS = ". $row['ADDRESS'] ."&lt;br/&gt;\n";
  echo "SALARY =  ".$row['SALARY'] ."&lt;br/&gt;\n\n";
  echo '----------------------------------&lt;br/&gt;';
}

echo "Operation done successfully\n";

$db-&gt;close();
</code></pre> 
 <p>执行上述程序时，会产生以下结果：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2705/942120534_53074.png" alt=""></p> 
 <h2 id="h2-u5220u9664u64CDu4F5C"><a name="删除操作" class="reference-link"></a><span class="header-link octicon octicon-link"></span>删除操作</h2>
 <p>以下PHP代码显示了如何使用<code>DELETE</code>语句删除任何记录，然后从<code>company</code>表中获取并显示剩余的记录：</p>   
 <pre><code class="lang-php">&lt;?php
class SQLiteDB extends SQLite3
{
  function __construct()
  {
     $this-&gt;open('phpdb.db');
  }
}
$db = new SQLiteDB();
if(!$db){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Opened database successfully&lt;br/&gt;\n";
}

// 先删除后创建表
$sql = "DROP table company";
$ret = $db-&gt;exec($sql);

// 创建表

$sql =&lt;&lt;&lt;EOF
      CREATE TABLE if not exists company
      (ID INT PRIMARY KEY     NOT NULL,
      NAME           TEXT    NOT NULL,
      AGE            INT     NOT NULL,
      ADDRESS        CHAR(50),
      SALARY         REAL);
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Table created successfully&lt;br/&gt;\n";
}

// $db-&gt;close();

$sql =&lt;&lt;&lt;EOF
      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (1, 'Maxsu', 26, 'Haikou', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (2, 'Allen', 25, 'Guangzhou', 15000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (3, 'Tenny', 23, 'Shanghai', 20000.00 );

      INSERT INTO company (ID,NAME,AGE,ADDRESS,SALARY)
      VALUES (4, 'Weiwang', 25, 'Beijing ', 65000.00 );
EOF;

$ret = $db-&gt;exec($sql);
if(!$ret){
  echo $db-&gt;lastErrorMsg();
} else {
  echo "Yes, Some Records has Inserted successfully&lt;br/&gt;\n";
}

// 更新ID小于等于2的数据记录

$sql =&lt;&lt;&lt;EOF
  DELETE from COMPANY where ID&lt;=2;
EOF;
$ret = $db-&gt;exec($sql);
if(!$ret){
 echo $db-&gt;lastErrorMsg();
} else {
  echo $db-&gt;changes(), " Record(ID&lt;=2) deleted successfully&lt;br/&gt;\n";
}

// 查询表中的数据

echo "&lt;b&gt; Select Data from company table :&lt;/b&gt;&lt;hr/&gt;";

$sql =&lt;&lt;&lt;EOF
  SELECT * from COMPANY;
EOF;

$ret = $db-&gt;query($sql);
while($row = $ret-&gt;fetchArray(SQLITE3_ASSOC) ){
  echo "ID = ". $row['ID'] . "&lt;br/&gt;\n";
  echo "NAME = ". $row['NAME'] ."&lt;br/&gt;\n";
  echo "ADDRESS = ". $row['ADDRESS'] ."&lt;br/&gt;\n";
  echo "SALARY =  ".$row['SALARY'] ."&lt;br/&gt;\n\n";
  echo '----------------------------------&lt;br/&gt;';
}

echo "Operation done successfully\n";

$db-&gt;close();
</code></pre> 
 <p>执行上述程序时，会产生以下结果：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2705/960120537_20458.png" alt=""></p> 
 <p>由于其它操作都类似，只需写上对应SQL语句，然后使用PHP执行即可，所以其它的示例在这里就不再一一演示了。如有疑问，可以留言联系。</p>
 <br>      
</div></body></html>