<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Java连接SQLite数据库</h1><div style="width:100%;float:left;" class="article-content">   
 <p>要使用java程序连接SQLite，并与SQLite进行数据存取操作，必须在系统上设置SQLite JDBC驱动程序和安装Java JDK。按照以下步骤进行：</p> 
 <ul> 
  <li>从sqlite-jdbc存储库下载最新版本的<code>sqlite-jdbc-(VERSION).jar</code>。</li>
  <li>将下载的jar文件添加到类路径。</li>
  <li>使用java连接到SQLite数据库。</li>
 </ul> 
 <h2 id="h2-1-sqlite-"><a name="1. 连接到SQLite数据库" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 连接到SQLite数据库</h2>
 <p>打开Eclipse IDE，创建一个JAVA工程：<strong>JavaWithSQLite</strong>，下载所需的<code>sqlite-jdbc-(VERSION).jar</code>(下载地址：<a target="_blank" href="http://bitbucket.org/xerial/sqlite-jdbc/downloads/">http://bitbucket.org/xerial/sqlite-jdbc/downloads/</a> 或者 <a target="_blank" href="http://mvnrepository.com/artifact/org.xerial/sqlite-jdbc/3.18.0">http://mvnrepository.com/artifact/org.xerial/sqlite-jdbc/3.18.0</a> )，并将它放入到项目的类库中。</p> 
 <p>使用以下代码使用Java编程语言连接到SQLite数据库，首先创建一个类：<code>ConnectSQLite.java</code>，其代码如下所示 -</p> 
 <pre><code class="lang-java">package com.yiibai;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class ConnectSQLite {
    /**
     * Connect to a sample database
     */
    public static void connect() {
        Connection conn = null;
        try {
            // db parameters
            String url = "jdbc:sqlite:D:/software/sqlite/java-sqlite.db";
            // create a connection to the database
            conn = DriverManager.getConnection(url);

            System.out.println("Connection to SQLite has been established.");

        } catch (SQLException e) {
            System.out.println(e.getMessage());
        } finally {
            try {
                if (conn != null) {
                    conn.close();
                }
            } catch (SQLException ex) {
                System.out.println(ex.getMessage());
            }
        }
    }

    /**
     * @param args
     *            the command line arguments
     */
    public static void main(String[] args) {
        connect();
    }
}
</code></pre> 
 <p>执行上面代码后，应该会创建一个文件：<code>D:/software/sqlite/java-sqlite.db</code>，并与数据库<code>java-sqlite.db</code>连接。</p> 
 <h2 id="h2--java-"><a name="使用java创建数据库" class="reference-link"></a><span class="header-link octicon octicon-link"></span>使用java创建数据库</h2>
 <p>还可以使用java编程语言在SQLite中创建一个新的数据库。假设要使用Java来创建一个名为<strong>java_sqlite.db</strong>的数据库。创建一个公共类：<code>CreateDB.java</code>并使用以下代码：</p> 
 <pre><code class="lang-java">package com.yiibai;

import java.sql.Connection;
import java.sql.DatabaseMetaData;
import java.sql.DriverManager;
import java.sql.SQLException;

public class CreateDB {

    public static void createNewDatabase(String fileName) {

        String url = "jdbc:sqlite:" + fileName;

        try {
            Connection conn = DriverManager.getConnection(url);
            if (conn != null) {
                DatabaseMetaData meta = conn.getMetaData();
                System.out.println("The driver name is " + meta.getDriverName());
                System.out.println("A new database has been created.");
            }

        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
    }

    public static void main(String[] args) {
        createNewDatabase("D:/software/sqlite/create-db.db");
    }
}
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">The driver name is SQLiteJDBC
A new database has been created.
</code></pre> 
 <p>现在创建一个名为“<code>create-db.db</code>”的新数据库。可以看到对应创建目录有一个文件：<code>create-db.db</code>存在。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/210150529_15504.png" alt=""></p> 
 <h2 id="h2--java-"><a name="使用java创建一个表" class="reference-link"></a><span class="header-link octicon octicon-link"></span>使用java创建一个表</h2>
 <p>假设要通过Java程序在SQLite中创建一个名为<code>tb_emp</code>的表，<code>tb_emp</code>表具有<code>id</code>,<code>name</code>和<code>capacity</code>这三列。首先创建一个Java类：<code>CreateTable.java</code>，并使用以下代码：</p> 
 <pre><code class="lang-java">package com.yiibai;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class CreateTable {

    public static void createNewTable() {
        // SQLite connection string
        String url = "jdbc:sqlite:D:/software/sqlite/java-sqlite.db";

        // SQL statement for creating a new table
        String sql = "CREATE TABLE IF NOT EXISTS employees (\n" + " id integer PRIMARY KEY,\n"
                + " name text NOT NULL,\n" + " capacity real\n" + ");";

        try {
            Connection conn = DriverManager.getConnection(url);
            Statement stmt = conn.createStatement();
            stmt.execute(sql);
            System.out.println("Create table finished.");
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
    }

    /**
     * @param args
     *            the command line arguments
     */
    public static void main(String[] args) {
        createNewTable();
    }

}
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">Create table finished.
</code></pre> 
 <p>执行上面代码后，将在<code>java-sqlite.db</code>数据库中创建一个名称为：<code>employees</code> 的表。</p> 
 <h2 id="h2-u5411u8868u4E2Du63D2u5165u8BB0u5F55"><a name="向表中插入记录" class="reference-link"></a><span class="header-link octicon octicon-link"></span>向表中插入记录</h2>
 <p>创建表后，使用以下代码在表中插入一些记录。 创建一个新的Java类：<code>InsertRecords</code>，具有以下代码：</p>   
 <pre><code class="lang-java">package com.yiibai;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class InsertRecords {

    private Connection connect() {
        // SQLite connection string
        String url = "jdbc:sqlite:D:/software/sqlite/java-sqlite.db";
        Connection conn = null;
        try {
            conn = DriverManager.getConnection(url);
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
        return conn;
    }

    public void insert(String name, double capacity) {
        String sql = "INSERT INTO employees(name, capacity) VALUES(?,?)";

        try {
            Connection conn = this.connect();
            PreparedStatement pstmt = conn.prepareStatement(sql);
            pstmt.setString(1, name);
            pstmt.setDouble(2, capacity);
            pstmt.executeUpdate();
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
    }

    public static void main(String[] args) {

        InsertRecords app = new InsertRecords();
        // insert three new rows
        app.insert("Maxsu", 30000);
        app.insert("Minsu", 40000);
        app.insert("Miswong", 50000);
        System.out.println("Insert data finished.");
    }

}
</code></pre> 
 <p>现在记录被插入到表中。 可以使用<code>SELECT</code>命令查看它：</p> 
 <pre><code class="lang-shell">sqlite&gt; .open java-sqlite.db
sqlite&gt; .tables
employees
sqlite&gt; select * from employees;
id,name,capacity
1,Maxsu,30000.0
2,Minsu,40000.0
3,Miswong,50000.0
sqlite&gt;
sqlite&gt;
</code></pre> 
 <h2 id="h2--"><a name="查询/选择记录" class="reference-link"></a><span class="header-link octicon octicon-link"></span>查询/选择记录</h2>
 <p>要使用Java程序从表中选择/查询记录，请使用以下代码。 创建一个新的Java类 - <code>SelectRecords.java</code>，使用以下代码 - </p> 
 <pre><code class="lang-java">package com.yiibai;

import java.sql.DriverManager;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SelectRecords {

    private Connection connect() {
        // SQLite connection string
        String url = "jdbc:sqlite:D:/software/sqlite/java-sqlite.db";
        Connection conn = null;
        try {
            conn = DriverManager.getConnection(url);
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
        return conn;
    }

    public void selectAll() {
        String sql = "SELECT * FROM employees";

        try {
            Connection conn = this.connect();
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);

            // loop through the result set
            while (rs.next()) {
                System.out.println(rs.getInt("id") + "\t" + rs.getString("name") + "\t" + rs.getDouble("capacity"));
            }
        } catch (SQLException e) {
            System.out.println(e.getMessage());
        }
    }

    /**
     * @param args
     *            the command line arguments
     */
    public static void main(String[] args) {
        SelectRecords app = new SelectRecords();
        app.selectAll();
    }

}
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201705/2605/242160508_40225.png" alt=""></p> 
 <blockquote> 
  <p><strong>注意</strong>： 因为都是通过使用相同的编程过程，所以您可自己编写其它数据库操作，比如：更新和删除表中的数据等等。</p> 
 </blockquote>
 <br>      
</div></body></html>