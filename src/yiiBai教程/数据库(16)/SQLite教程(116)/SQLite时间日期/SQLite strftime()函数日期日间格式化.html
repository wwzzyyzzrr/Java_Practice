<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">SQLite strftime()函数日期日间格式化</h1><div style="width:100%;float:left;" class="article-content">   
 <p>SQLite <code>strftime()</code>是一个功能非常强大的函数，可以用来获取日期和时间，并且还可以执行日期计算。</p> 
 <p><strong>语法：</strong></p> 
 <pre><code class="lang-sql">strftime(format, timestring [, modifier1, modifier2, ... modifier_n ] )
</code></pre> 
 <p>这里，<code>format</code>可以是以下任何一种：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>格式</th> 
    <th>解释/描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>%Y</code></td> 
    <td><code>4</code>位数表示年份(0000至9999)</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>%W</code></td> 
    <td>表示一年之中的第几周(00至53)</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>%w</code></td> 
    <td>星期几(<code>0</code>到<code>6</code>，其中<code>0</code>表示星期日)</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>%m</code></td> 
    <td>表示一年之中的第几月(01至12)</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>%d</code></td> 
    <td>表示一个月之中的第几天(00至31)</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>%H</code></td> 
    <td>小时 (00 至 24)</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>%M</code></td> 
    <td>分钟 (00 至 60)</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>%S</code></td> 
    <td>秒(00至59)</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>%s</code></td> 
    <td>自<code>1970-01-01</code>以来的秒数</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>%f</code></td> 
    <td>小数秒(<code>SS.SSS</code>)</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>%j</code></td> 
    <td>一年之中的第几天(001 至 366)</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>%J</code></td> 
    <td>儒略日的数字值</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>这里，<code>timestring</code>是一个日期值，可以是以下任何一个：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th><code>timestring</code>的值</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>now</code></td> 
    <td>用来返回当前日期的字面值</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>YYYY-MM-DD</code></td> 
    <td>指定格式为<code>YYYY-MM-DD</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>YYYY-MM-DD HH:MM</code></td> 
    <td>指定格式为<code>YYYY-MM-DD HH:MM</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>YYYY-MM-DD HH:MM:SS</code></td> 
    <td>指定格式为<code>YYYY-MM-DD HH:MM:SS</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>YYYY-MM-DD HH:MM:SS.SSS</code></td> 
    <td>指定格式为<code>YYYY-MM-DD HH:MM:SS.SSS</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>HH:MM</code></td> 
    <td>指定格式为<code>HH:MM</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>HH:MM:SS</code></td> 
    <td>指定格式为<code>HH:MM:SS</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>HH:MM:SS.SSS</code></td> 
    <td>指定格式为<code>HH:MM:SS.SSS</code>的日期值</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>YYYY-MM-DDTHH:MM</code></td> 
    <td>指定格式化为<code>YYYY-MM-DDTHH：MM</code>的日期值，其中<code>T</code>是一个文本字符分隔符，用于分隔日期和时间。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>YYYY-MM-DDTHH:MM:SS</code></td> 
    <td>指定格式化为<code>YYYY-MM-DDTHH:MM:SS</code>的日期值，其中<code>T</code>是一个文本字符分隔符，用于分隔日期和时间。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>YYYY-MM-DDTHH:MM:SS.SSS</code></td> 
    <td>指定格式化为<code>YYYY-MM-DDTHH:MM:SS.SSS</code>的日期值，其中<code>T</code>是一个文本字符分隔符，用于分隔日期和时间。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>DDDDDDDDDD</code></td> 
    <td>指定儒略日的日期数</td> 
   </tr> 
  </tbody> 
 </table> 
 <ul> 
  <li><em>modifier1</em>, <em>modifier2</em>, <em>… modifier_n</em>: 这些修饰符是可选的。这些字符与时间字符串一起使用来添加或减少时间，日期或年份。</li>
 </ul> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>修辞符</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>[+-]NNN years</code></td> 
    <td>用于指定添加/减去日期的年数</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>[+-]NNN months</code></td> 
    <td>用于指定添加/减去日期的月数</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>[+-]NNN days</code></td> 
    <td>用于指定添加/减去日期的天数</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>[+-]NNN hours</code></td> 
    <td>用于指定添加/减去日期的小时数</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>[+-]NNN minutes</code></td> 
    <td>用于指定添加/减去日期的分钟数</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>[+-]NNN seconds</code></td> 
    <td>用于指定添加/减去日期的秒数</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>[+-]NNN.NNNN seconds</code></td> 
    <td>用于指定添加/减去日期的秒数(和小数秒)</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>start of year</code></td> 
    <td>用于将日期重新转移到年初</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>start of month</code></td> 
    <td>用于将日期重新转移到月初</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>start of day</code></td> 
    <td>用于将日期重新移动到一天的开始</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>weekday N</code></td> 
    <td>用于将日期向前移动到工作日数为<code>N</code>的下一个日期(0=Sunday, 1=Monday, 2=Tuesday, 3=Wednesday, 4=Thursday, 5=Friday, 6=Saturday)</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>unixepoch</code></td> 
    <td>它与<code>DDDDDDDDDD</code>时间字符串一起用于将日期解释为UNIX时间(即：自<code>1970-01-01</code>以来的秒数)</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>localtime</code></td> 
    <td>用于将日期调整为本地时间，假设时间戳以<code>UTC</code>表示</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>utc</code></td> 
    <td>它用于将日期调整为<code>utc</code>，假设时间戳以本地时间表达</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>示例1：</strong></p> 
 <p>检索当前日期：</p>   
 <pre><code class="lang-sql">SELECT strftime('%Y %m %d', 'now');  
SELECT strftime('%Y-%m-%d %H:%M', 'now');
</code></pre> 
 <p>执行上面语句，得到以下结果 -</p> 
 <pre><code class="lang-shell">sqlite&gt; SELECT strftime('%Y %m %d', 'now');
2017 05 24
sqlite&gt; SELECT strftime('%Y-%m-%d %H:%M', 'now');
2017-05-24 19:04
sqlite&gt;
</code></pre> 
 <p><strong>示例2：</strong></p> 
 <p>检索本月的第一天：</p> 
 <pre><code class="lang-sql">SELECT strftime('%Y-%m-%d', '2017-09-14', 'start of month');  
SELECT strftime('%Y-%m-%d', 'now', 'start of month');  
SELECT strftime('%Y-%m-%d', '2017-03-07', '-6 days');  
SELECT strftime('%Y-%m-%d', 'now', '-13 days');
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <pre><code class="lang-sql">sqlite&gt; SELECT strftime('%Y-%m-%d', '2017-09-14', 'start of month');
2017-09-01
sqlite&gt; SELECT strftime('%Y-%m-%d', 'now', 'start of month');
2017-05-01
sqlite&gt; SELECT strftime('%Y-%m-%d', '2017-03-07', '-6 days');
2017-03-01
sqlite&gt; SELECT strftime('%Y-%m-%d', 'now', '-13 days');
2017-05-11
sqlite&gt;
</code></pre> 
 <p><strong>示例3：</strong></p> 
 <p>检索本月的最后一天：</p> 
 <pre><code class="lang-sql">SELECT strftime('%Y-%m-%d', '2017-12-07', 'start of month', '+1 month', '-1 day');   
SELECT strftime('%Y-%m-%d', 'now', 'start of month', '+1 month', '-1 day');  
SELECT strftime('%Y-%m-%d', '2017-08-07', '+24 days');  
SELECT strftime('%Y-%m-%d', 'now', '+24 days');
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <pre><code class="lang-sql">sqlite&gt; SELECT strftime('%Y-%m-%d', '2017-12-07', 'start of month', '+1 month', '-1 day');
2017-12-31
sqlite&gt; SELECT strftime('%Y-%m-%d', 'now', 'start of month', '+1 month', '-1 day');
2017-05-31
sqlite&gt; SELECT strftime('%Y-%m-%d', '2017-08-07', '+24 days');
2017-08-31
sqlite&gt; SELECT strftime('%Y-%m-%d', 'now', '+24 days');
2017-06-17
sqlite&gt;
</code></pre> 
 <p><strong>示例4：</strong></p> 
 <p>在当前日期时间上添加/减去年数和天数：</p> 
 <pre><code class="lang-sql">SELECT strftime('%Y-%m-%d', '2017-11-14', '+2 years');  
SELECT strftime('%Y-%m-%d', 'now', '-2 years');  
SELECT strftime('%Y-%m-%d', '2017-10-14', '+7 days');  
SELECT strftime('%Y-%m-%d', 'now', '-10 days');
</code></pre> 
 <p>执行上面代码，得到以下结果 - </p> 
 <pre><code class="lang-sql">sqlite&gt; SELECT strftime('%Y-%m-%d', '2017-11-14', '+2 years');
2019-11-14
sqlite&gt; SELECT strftime('%Y-%m-%d', 'now', '-2 years');
2015-05-24
sqlite&gt; SELECT strftime('%Y-%m-%d', '2017-10-14', '+7 days');
2017-10-21
sqlite&gt; SELECT strftime('%Y-%m-%d', 'now', '-10 days');
2017-05-14
sqlite&gt;
</code></pre>
 <br>      
</div></body></html>