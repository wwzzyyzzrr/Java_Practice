<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">MVC框架 - 第一个应用程序</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 让我们到实践中去，使用视图和控制器创建我们的第一个MVC应用程序。 一旦我们有一个关于如何一个基本的MVC应用程序的运行一个小实践经验，我们将学习所有单独的组件和概念在接下来的章节。</p> 
 <h2> 按以下步骤来创建第一个MVC应用程序</h2> 
 <p> <strong>步骤 1:&nbsp;</strong>启动Visual Studio并选择 File-&gt;New-&gt;Project。 选择 Web-&gt;ASP.NET MVC Web Application ，并命名该项目为 FirstMVCApplication. 选择位置 C:\MVC。点击OK。</p> 
 <img alt="create_new_mvc_project_step_1" src="/uploads/allimg/150530/1H125C53-0.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p style="box-sizing: border-box; color: rgb(0, 0, 0); line-height: 24px; margin: 0em 0.2em 1em; word-wrap: break-word; padding: 0px; text-align: justify;  font-size: 14px;"> &nbsp;</p> 
 <img alt="create_new_mvc_project_step_2" src="/uploads/allimg/150530/1H125LI-1.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> <strong>步骤 2:&nbsp;</strong>打开项目模板选项。选择空的模板和视图引擎为Razor。点击确定。</p> 
 <img alt="select_mvc_template" src="/uploads/allimg/150530/1H1254V7-2.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> 由此，Visual Studio将创建我们的第一个MVC项目如（截图所示）：</p> 
 <img alt="mvc_project_structure" src="/uploads/allimg/150530/1H1255957-3.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> <strong>第3步：</strong><strong>&nbsp;</strong>现在，我们将创建我们的应用程序的第一个控制器。控制器是一个包含多个公共方法，被称为动作方法的简单C#类。 要添加新的控制器，右击Controllers文件夹在我们的项目，并选择Add-&gt;Controller. 命名为控制器为HomeContoller点击添加。</p> 
 <img alt="add_mvc_controller" src="/uploads/allimg/150530/1H12525P-4.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p style="box-sizing: border-box; color: rgb(0, 0, 0); line-height: 24px; margin: 0em 0.2em 1em; word-wrap: break-word; padding: 0px; text-align: justify;  font-size: 14px;"> &nbsp;</p> 
 <img alt="create_homecontroller" src="/uploads/allimg/150530/1H125M10-5.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> 这将在控制器文件夹中创建类文件HomeController.cs，用下面的默认代码。</p> 
 <pre class="prettyprint prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">using</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">System</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">using</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">System</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Web</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Mvc</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span><span class="pln" style="box-sizing: border-box;">

</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">namespace</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">FirstMVCApplication</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Controllers</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">public</span><span class="pln" style="box-sizing: border-box;"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">class</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HomeController</span><span class="pln" style="box-sizing: border-box;"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Controller</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{</span><span class="pln" style="box-sizing: border-box;">
     </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">public</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">ViewResult</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Index</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">()</span><span class="pln" style="box-sizing: border-box;">
        </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{</span><span class="pln" style="box-sizing: border-box;">
            </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">return</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">View</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">();</span><span class="pln" style="box-sizing: border-box;">
        </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span><span class="pln" style="box-sizing: border-box;">

    </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span></pre> 
 <p> 上面的代码基本上定义了一个公共的方法Index ，HomeController并返回一个ViewResult对象。在接下来的步骤中，我们将学习如何使用返回ViewResult对象视图。</p> 
 <p> <strong>第4步：</strong>现在，我们将添加一个新的视图在 Home 控制器。要添加新的视图，右键单击HomeController.cs并点击 Add-&gt;View.</p> 
 <img alt="add_mvc_view" src="/uploads/allimg/150530/1H1254932-6.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> 命名新的视图和索引视图引擎为Razor（SCHTML）。单击添加。</p> 
 <img alt="create_index_view" src="/uploads/allimg/150530/1H12524H-7.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> 这里面添加下面的代码在Views/Home文件夹的一个新文件cshtml：</p> 
 <pre class="prettyprint notranslate tryit prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); cursor: default; background-image: url(http://cdn.yiibai.com/images/link.png) !important; background-attachment: initial !important; background-size: initial !important; background-origin: initial !important; background-clip: initial !important; background-position: 100% 0%; background-repeat: no-repeat !important;">
<span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">@{</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Layout</span><span class="pln" style="box-sizing: border-box;"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="pln" style="box-sizing: border-box;"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">null</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span><span class="pln" style="box-sizing: border-box;">

</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">&lt;html&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">&lt;head&gt;</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;</span><span class="pln" style="box-sizing: border-box;">meta name</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"viewport"</span><span class="pln" style="box-sizing: border-box;"> content</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"width=device-width"</span><span class="pln" style="box-sizing: border-box;"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/&gt;</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">&lt;title&gt;</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Index</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;/</span><span class="pln" style="box-sizing: border-box;">title</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;/</span><span class="pln" style="box-sizing: border-box;">head</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">&lt;body&gt;</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">&lt;div&gt;</span><span class="pln" style="box-sizing: border-box;">
     
    </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;/</span><span class="pln" style="box-sizing: border-box;">div</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;/</span><span class="pln" style="box-sizing: border-box;">body</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;/</span><span class="pln" style="box-sizing: border-box;">html</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span></pre> 
 <p> <strong>第5步：</strong>修改以上视图的body内容，使用下面的代码：</p> 
 <pre class="prettyprint prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;body&gt;</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;div&gt;</span><span class="pln" style="box-sizing: border-box;">
     Welcome to My First MVC Application (</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;b&gt;</span><span class="pln" style="box-sizing: border-box;">From Index View</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/b&gt;</span><span class="pln" style="box-sizing: border-box;">)
    </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/div&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/body&gt;</span></pre> 
 <p> <strong>第6步：</strong>现在运行应用程序。在浏览器有下面的输出。这个输出是基于我们的视图文件中的内容呈现。应用程序首先调用该视图，并给出了输出控制器。</p> 
 <img alt="mvc_welcome_message" src="/uploads/allimg/150530/1H1255928-8.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <p> <strong>第7步：</strong>在步骤6，我们收到的输出是基于我们认为的文件内容，并与控制器交互。向前迈进了一步，现在我们将创建一个小例子使用视图和控制器之间的相互作用，显示当前时间和欢迎信息。</p> 
 <p> MVC使用ViewBag对象控制器和视图之间传递数据。打开HomeController.cs和编辑Index函数，下面的代码。</p>   
 <pre class="prettyprint prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">public</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">ViewResult</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Index</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">()</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">{</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">int</span><span class="pln" style="box-sizing: border-box;"> hour </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">DateTime</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Now</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Hour</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span><span class="pln" style="box-sizing: border-box;">
            
    </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">ViewBag</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Greeting</span><span class="pln" style="box-sizing: border-box;"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="pln" style="box-sizing: border-box;"> 
    hour </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&lt;</span><span class="pln" style="box-sizing: border-box;"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">12</span><span class="pln" style="box-sizing: border-box;"> 
    </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">?</span><span class="pln" style="box-sizing: border-box;"> </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"Good Morning. Time is"</span><span class="pln" style="box-sizing: border-box;"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">+</span><span class="pln" style="box-sizing: border-box;">  </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">DateTime</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Now</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">ToShortTimeString</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">()</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box;"> </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"Good Afternoon. Time is "</span><span class="pln" style="box-sizing: border-box;"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">+</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">DateTime</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Now</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">ToShortTimeString</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">();</span><span class="pln" style="box-sizing: border-box;">
            
</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">return</span><span class="pln" style="box-sizing: border-box;"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">View</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">();</span><span class="pln" style="box-sizing: border-box;">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">}</span></pre> 
 <p> 在上面的代码中，我们设置ViewBag对象的问候属性的值。该代码获取当前小时，相应的View() 语句返回Good Morning/Afternoon。需要注意的是这里贺卡只是一个例子属性，我们已经使用ViewBag对象。 可以代替贺卡使用任何其他属性的名称。</p> 
 <p> <strong>第8步：</strong>现在打开Index.cshtml并复制下面的代码主体部分：</p> 
 <pre class="prettyprint prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-radius: 0px; width: 604px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;body&gt;</span><span class="pln" style="box-sizing: border-box;">
    </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;div&gt;</span><span class="pln" style="box-sizing: border-box;">
     @ViewBag.Greeting (</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;b&gt;</span><span class="pln" style="box-sizing: border-box;">From Index View</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/b&gt;</span><span class="pln" style="box-sizing: border-box;">)
    </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/div&gt;</span><span class="pln" style="box-sizing: border-box;">
</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/body&gt;</span></pre> 
 <p> 在上面的代码中，我们访问ViewBag使用对象@（这将是从控制器设置）Greeting&nbsp;属性的值。</p> 
 <p> <strong>第9步：</strong>现在再次运行应用程序。这一次，代码会首先运行控制器，设置ViewBag，然后视图代码渲染。输出看起来象下面这样：</p> 
 <img alt="mvc_example" src="/uploads/allimg/150530/1H1254L8-9.jpg" style="box-sizing: border-box; vertical-align: middle; max-width: 100%; display: block; margin-left: auto; margin-right: auto; padding-bottom: 4px; color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px;"> 
 <div>
   &nbsp;
 </div> 
 <br>      
</div></body></html>