<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">uploadify自定义服务器端上传脚本</h1><div style="width:100%;float:left;" class="article-content">   
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> 当涉及到实际保存上传文件到服务器，在服务器端上传脚本将在后端处理所有的工作。这里是一个比特的信息，应该帮助创建一个自定义的服务器端上传脚本在PHP中。</p> 
 <h2 style="margin: 0px 0px 0.5em; padding: 0px; border: 0px; font-family: 'Upstaged Black', Arial, Helvetica, sans-serif; font-size: 24px; font-weight: normal; line-height: 26px; vertical-align: baseline; color: rgb(70, 70, 70);"> 通过额外的数据到服务器端脚本</h2> 
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> <span style="color: rgb(34, 34, 34); font-family: Arial, Verdana, sans-serif; font-size: 12px;">额外的数据可以传递到脚本无论是作为查询字符串附加到上传选项，或通过参数formdata选项。</span><span style="color: rgb(34, 34, 34); font-family: Arial, Verdana, sans-serif; font-size: 12px;">根据所设定的方法选项('POST'或'GET')，可以检索使用$_POST或$_GET数组中的服务器端脚本发送的参数formdata选项的信息。</span></p> 
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> 当初始化Uploadify：</p> 
 <div class="crayon-line" id="crayon-53959d1a762ef-1" style="margin: 0px; padding: 0px 5px; border: none; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; background-image: none; background-color: rgb(253, 253, 253); height: 15px; color: rgb(70, 70, 70); white-space: pre;"> 
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">$</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">(</span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'#file_upload'</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">)</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">.</span>
  <span class="e" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 78, 208) !important;">uploadify</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">(</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">{</span>
 </div> 
 <div class="crayon-line crayon-striped-line" id="crayon-53959d1a762ef-2" style="margin: 0px; padding: 0px 5px; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; height: 15px; color: rgb(70, 70, 70); white-space: pre; border: 1px rgb(204, 204, 204) !important; background-color: rgb(247, 247, 247) !important;"> 
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
  <span class="c" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(255, 128, 0) !important;">// Some options</span>
 </div> 
 <div class="crayon-line" id="crayon-53959d1a762ef-3" style="margin: 0px; padding: 0px 5px; border: none; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; background-image: none; background-color: rgb(253, 253, 253); height: 15px; color: rgb(70, 70, 70); white-space: pre;"> 
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'method'</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">&nbsp;&nbsp; </span>
  <span class="o" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">:</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'post'</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">,</span>
 </div> 
 <div class="crayon-line crayon-striped-line" id="crayon-53959d1a762ef-4" style="margin: 0px; padding: 0px 5px; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; height: 15px; color: rgb(70, 70, 70); white-space: pre; border: 1px rgb(204, 204, 204) !important; background-color: rgb(247, 247, 247) !important;"> 
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'formData'</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="o" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">:</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">{</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'someKey'</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="o" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">:</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'someValue'</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">}</span>
 </div> 
 <div class="crayon-line" id="crayon-53959d1a762ef-5" style="margin: 0px; padding: 0px 5px; border: none; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; background-image: none; background-color: rgb(253, 253, 253); height: 15px; color: rgb(70, 70, 70); white-space: pre;"> 
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">}</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">)</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">;</span>
 </div> 
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> <br> 在服务器端脚本：</p> 
 <div class="crayon-line" id="crayon-53959d1a77269-1" style="margin: 0px; padding: 0px 5px; border: none; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; background-image: none; background-color: rgb(253, 253, 253); color: rgb(70, 70, 70); white-space: pre; height: 15px !important;"> 
  <span class="c" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(255, 128, 0) !important;">// Set $someVar to 'someValue'</span>
 </div> 
 <div class="crayon-line crayon-striped-line" id="crayon-53959d1a77269-2" style="margin: 0px; padding: 0px 5px; font-family: Monaco, MonacoRegular, 'Courier New', monospace; line-height: 15px; vertical-align: baseline; color: rgb(70, 70, 70); white-space: pre; border: 1px rgb(204, 204, 204) !important; background-color: rgb(247, 247, 247) !important; height: 15px !important;"> 
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">$</span>
  <span class="i" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 0, 0) !important;">someVar</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="o" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;">=</span>
  <span class="h" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 111, 224) !important;"> </span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">$</span>
  <span class="i" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 0, 0) !important;">_POST</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">[</span>
  <span class="s" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(0, 128, 0) !important;">'someKey'</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">]</span>
  <span class="sy" style="margin: 0px; padding: 0px; border: 0px; font-family: inherit; font-size: inherit !important; font-style: inherit; font-variant: inherit; font-weight: inherit !important; line-height: inherit !important; vertical-align: baseline; color: rgb(51, 51, 51) !important;">;</span>
 </div> 
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> <br> 将上面的文件保存为不同名称的文件。&nbsp;如果想传递在页面上设置的上传开始前的信息，那么最好使用&nbsp;<font color="#0072bc">sett</font><font color="#0072bc">ings</font>&nbsp;方法在&nbsp;<font color="#0072bc">on</font><font color="#0072bc">UploadStart</font>&nbsp;事件，这样的参数 formdata 在文件上传前正确设置。<br> &nbsp;</p> 
 <h2 style="margin: 0px 0px 0.5em; padding: 0px; border: 0px; font-family: 'Upstaged Black', Arial, Helvetica, sans-serif; font-size: 24px; font-weight: normal; line-height: 26px; vertical-align: baseline; color: rgb(70, 70, 70);"> 从服务器端脚本返回的数据</h2> 
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> 在uploadify.php脚本返回的数据可通过&nbsp;<font color="#0072bc">onUploadS</font><font color="#0072bc">uccess</font>&nbsp;事件作为第二个参数（数据）进行访问。</p> 
 <p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-family: 'Open Sans', 'Arial Helvetica', sans-serif; font-size: 14px; line-height: 22px; vertical-align: baseline; color: rgb(70, 70, 70);"> 从uploadify.php文件返回文件名：</p>   
 <pre>
$targetFolder = '/uploads'; // Relative to the root

if (!empty($_FILES)) {
    $tempFile = $_FILES['Filedata']['tmp_name'];
    $targetPath = $_SERVER['DOCUMENT_ROOT'] . $targetFolder;
    $targetFile = rtrim($targetPath,'/') . '/' . $_FILES['Filedata']['name'];

    // Validate the file type
    $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
    $fileParts = pathinfo($_FILES['Filedata']['name']);

    if (in_array($fileParts['extension'],$fileTypes)) {
        move_uploaded_file($tempFile,$targetFile);
        echo $targetFolder . '/' . $_FILES['Filedata']['name'];
    } else {
        echo 'Invalid file type.';
    }
}
</pre> 
 <p> 上传返回调用：<br> &nbsp;</p> 
 <pre>
$('#file_upload').uploadify({
    // Some options
    'onUploadSuccess' : function(file, data, response) {
        alert('The file was saved to: ' + data);
    }
});
</pre> 
 <br>      
</div></body></html>