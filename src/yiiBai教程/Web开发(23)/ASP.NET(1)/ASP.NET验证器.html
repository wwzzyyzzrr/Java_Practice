<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ASP.NET验证器</h1><div style="width:100%;float:left;" class="article-content">   
 <p>ASP.NET验证控件主要用来验证用户输入数据，以确保无用的，未经验证的或矛盾的数据不会被存储到服务器中。</p> 
 <p>ASP.NET提供了以下验证控件：</p> 
 <ul> 
  <li><em>RequiredFieldValidator</em></li>
  <li><em>RangeValidator</em></li>
  <li><em>CompareValidator</em></li>
  <li><em>RegularExpressionValidator</em></li>
  <li><em>CustomValidator</em></li>
  <li><em>ValidationSummary</em></li>
 </ul> 
 <h2 id="h2-basevalidator-"><a name="BaseValidator类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>BaseValidator类</h2>
 <p>其它验证控件类是从<code>BaseValidator</code>类继承的，因此它们继承了它的属性和方法。 因此，这将有助于查看此基类的属性和方法，这对于所有验证控件都是常见的：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>ControlToValidate</code></td> 
    <td>指示要验证的输入控件。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Display</code></td> 
    <td>指示如何显示错误消息。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>EnableClientScript</code></td> 
    <td>指示是否需要客户端验证。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Enabled</code></td> 
    <td>启用或禁用验证器。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>ErrorMessage</code></td> 
    <td>指示错误字符串信息。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Text</code></td> 
    <td>如果验证失败，将显示此错误文本。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>IsValid</code></td> 
    <td>指示控件的值是否有效。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>SetFocusOnError</code></td> 
    <td>它表示在无效控制的情况下，焦点应该切换到相关的输入控件。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>ValidationGroup</code></td> 
    <td>该控件所属的多个验证器的逻辑组。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>Validate()</code></td> 
    <td>此方法重新验证控件并更新<code>IsValid</code>属性。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-requiredfieldvalidator-"><a name="RequiredFieldValidator控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>RequiredFieldValidator控件</h2>
 <p><code>RequiredFieldValidator</code>控件确保所需字段不为空。它通常绑定到一个文本框强制输入到文本框中。</p> 
 <p>控件的语法如下：</p> 
 <pre><code class="lang-aspnet">&lt;asp:RequiredFieldValidator ID="rfvcandidate" 
   runat="server" ControlToValidate ="ddlcandidate"
   ErrorMessage="Please choose a candidate" 
   InitialValue="Please choose a candidate"&gt;

&lt;/asp:RequiredFieldValidator&gt;
</code></pre> 
 <h2 id="h2-rangevalidator-"><a name="RangeValidator控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>RangeValidator控件</h2>
 <p><code>RangeValidator</code>控件验证输入值是否在预定的范围内。</p> 
 <p>它有三个特定的属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Type</code></td> 
    <td>它定义了数据的类型。可用值包括：货币，日期，双精度，整数和字符串。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>MinimumValue</code></td> 
    <td>它指定范围的最小值。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>MaximumValue</code></td> 
    <td>它指定范围的最大值。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>控件的语法如下：</p> 
 <pre><code class="lang-aspnet">&lt;asp:RangeValidator ID="rvclass" runat="server" ControlToValidate="txtclass" 
   ErrorMessage="Enter your class (6 - 12)" MaximumValue="12" 
   MinimumValue="6" Type="Integer"&gt;

&lt;/asp:RangeValidator&gt;
</code></pre> 
 <h2 id="h2-comparevalidator-"><a name="CompareValidator控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>CompareValidator控件</h2>
 <p><code>CompareValidator</code>控件将一个控件中的值与另一个控件中的固定值或值进行比较。</p> 
 <p>它具有以下特定属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Type</code></td> 
    <td>它用来指定数据的类型。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>ControlToCompare</code></td> 
    <td>它指定要与之比较的输入控件的值。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>ValueToCompare</code></td> 
    <td>它指定了与之比较的常量值。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Operator</code></td> 
    <td>它指定比较运算符，可用值为：<code>Equal</code>，<code>NotEqual</code>，<code>GreaterThan</code>，<code>GreaterThanEqual</code>，<code>LessThan</code>，<code>LessThanEqual</code>和<code>DataTypeCheck</code>。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>该控件的基本语法如下所示：</p> 
 <pre><code class="lang-aspnet">&lt;asp:CompareValidator ID="CompareValidator1" runat="server" 
   ErrorMessage="CompareValidator"&gt;

&lt;/asp:CompareValidator&gt;
</code></pre> 
 <h2 id="h2-regularexpressionvalidator"><a name="RegularExpressionValidator" class="reference-link"></a><span class="header-link octicon octicon-link"></span>RegularExpressionValidator</h2>
 <p><code>RegularExpressionValidator</code>允许通过匹配正则表达式的模式来验证输入文本。正则表达式在<code>ValidationExpression</code>属性中设置。</p> 
 <p>下表总结了正则表达式的常用语法结构：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>字符转义</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>\b</code></td> 
    <td>匹配一个退格符。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>\t</code></td> 
    <td>匹配一个制表符。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>ValueToCompare</code></td> 
    <td>它指定了与之比较的常量值。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>\r</code></td> 
    <td>匹配回车。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>\v</code></td> 
    <td>匹配垂直制表符。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>\f</code></td> 
    <td>匹配换页</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>\n</code></td> 
    <td>匹配一个新的行。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>\</code></td> 
    <td>转义字符。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>除了单字符匹配之外，还可以指定一组可以匹配的字符，称为元字符。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>元字符</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>.</code></td> 
    <td>匹配除<code>\n</code>之外的任何字符。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>[abcd]</code></td> 
    <td>匹配集合中的任何字符。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>[^abcd]</code></td> 
    <td>匹配不是集合中的任何字符。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>[2-7a-mA-M]</code></td> 
    <td>匹配范围中指定的任何字符。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>\w</code></td> 
    <td>匹配任何字母数字字符和下划线。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>\W</code></td> 
    <td>匹配任何非单词字符。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>\s</code></td> 
    <td>匹配空格字符，如空格，制表符，新行。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>\S</code></td> 
    <td>匹配任何非空白字符。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>\d</code></td> 
    <td>匹配任何十进制字符。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>\D</code></td> 
    <td>匹配任何非十进制字符。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>可以使用量词来指定的字符可能出现次数。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>量词</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>*</code></td> 
    <td>零或多个匹配</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>+</code></td> 
    <td>一个或多个匹配。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>?</code></td> 
    <td>零个或一个匹配。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>{N}</code></td> 
    <td><code>N</code>个匹配</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>{N,}</code></td> 
    <td>至少<code>N</code>次匹配</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>{N,M}</code></td> 
    <td><code>N</code>到<code>M</code>次匹配</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>控件的语法如下：</p> 
 <pre><code class="lang-aspnet">&lt;asp:RegularExpressionValidator ID="string" runat="server" ErrorMessage="string"
   ValidationExpression="string" ValidationGroup="string"&gt;

&lt;/asp:RegularExpressionValidator&gt;
</code></pre> 
 <h2 id="h2-customvalidator"><a name="CustomValidator" class="reference-link"></a><span class="header-link octicon octicon-link"></span>CustomValidator</h2>
 <p><code>CustomValidator</code>控件允许为客户端和服务器端验证编写特定于应用程序的自定义验证例程。</p> 
 <p>客户端验证通过<code>ClientValidationFunction</code>属性完成。 客户端验证例程应该用浏览器可以理解的脚本语言编写，例如JavaScript或VBScript。</p> 
 <p>服务器端验证例程必须从控件的<code>ServerValidate</code>事件处理程序中调用。服务器端验证例程应该用<code>C#</code>或<a target="_blank" href="http://www.yiibai.com/vb.net/" title="VB.Net">VB.Net</a>等<code>.Net</code>语言编写。</p> 
 <p>控件的基本语法如下：</p> 
 <pre><code class="lang-aspnet">&lt;asp:CustomValidator ID="CustomValidator1" runat="server" 
   ClientValidationFunction=.cvf_func. ErrorMessage="CustomValidator"&gt;

&lt;/asp:CustomValidator&gt;
</code></pre> 
 <h2 id="h2-validationsummary"><a name="ValidationSummary" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ValidationSummary</h2>
 <p><code>ValidationSummary</code>控件不执行任何验证，但显示页面中所有错误的摘要。 摘要显示验证失败的所有验证控件的<code>ErrorMessage</code>属性的值。</p> 
 <p>以下两个相互包含的属性列出了错误消息：</p> 
 <ul> 
  <li><em>ShowSummary</em>：以指定的格式显示错误信息。</li>
  <li><em>ShowMessageBox</em>：在单独的窗口中显示错误消息。</li>
 </ul> 
 <p>控件的语法如下：</p> 
 <pre><code class="lang-aspxnet">&lt;asp:ValidationSummary ID="ValidationSummary1" runat="server" 
   DisplayMode = "BulletList" ShowSummary = "true" HeaderText="Errors:" /&gt;
</code></pre> 
 <h2 id="h2-u9A8Cu8BC1u7EC4"><a name="验证组" class="reference-link"></a><span class="header-link octicon octicon-link"></span>验证组</h2>
 <p>复杂的页面在不同的面板中提供不同的信息组。在这种情况下，可能需要为单独的组分别进行验证。这种情况是使用验证组来处理的。</p> 
 <p>要创建验证组，应该通过设置其<code>ValidationGroup</code>属性将输入控件和验证控件放入同一个逻辑组中。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>下面的例子描述了一个由所有投票人来填写的表单信息，分成四个信息段，用来选举总统。 在这里，使用验证控件来验证用户输入。</p> 
 <p>首先打开<em>Visual Studio</em>，创建一个名称为：<em>Validators</em> 的空网站项目，如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/682101210_68734.png" alt=""></p> 
 <p>在这个项目名称上右键选择：<em>添加</em> -&gt; <em>添加新项</em> ，选择：<em>Web窗体</em> ，存储名称为： <em>Default.aspx</em>，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/400101213_57334.png" alt=""></p> 
 <p>这是设计视图中的表单：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/869101232_60854.png" alt=""></p> 
 <p>以下是<em>Defalut.aspx</em> 文件的内容：</p>   
 <pre><code class="lang-aspnet">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %&gt;

&lt;!DOCTYPE html&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;验证器示例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;

   &lt;table style="width: 66%;"&gt;

      &lt;tr&gt;
         &lt;td class="style1" colspan="3" align="center"&gt;
         &lt;asp:Label ID="lblmsg" 
            Text="选择您支持的总统" 
            runat="server" style="font-weight:bold;"/&gt;
         &lt;/td&gt;
      &lt;/tr&gt;

      &lt;tr&gt;
         &lt;td class="style3" style="width:64px;"&gt;
            候选人:
         &lt;/td&gt;

         &lt;td class="style2"&gt;
            &lt;asp:DropDownList ID="ddlcandidate" runat="server"  style="width:239px"&gt;
               &lt;asp:ListItem&gt;请选择一个候选人&lt;/asp:ListItem&gt;
               &lt;asp:ListItem&gt;渣渣辉&lt;/asp:ListItem&gt;
               &lt;asp:ListItem&gt;李布朗&lt;/asp:ListItem&gt;
               &lt;asp:ListItem&gt;小布什&lt;/asp:ListItem&gt;
               &lt;asp:ListItem&gt;特朗扑&lt;/asp:ListItem&gt;
            &lt;/asp:DropDownList&gt;
         &lt;/td&gt;

         &lt;td&gt;
            &lt;asp:RequiredFieldValidator ID="rfvcandidate" 
               runat="server" ControlToValidate ="ddlcandidate"
               ErrorMessage="请选择一个候选人" 
               InitialValue="请选择一个候选人"&gt;
            &lt;/asp:RequiredFieldValidator&gt;
         &lt;/td&gt;
      &lt;/tr&gt;

      &lt;tr&gt;
         &lt;td class="style3"&gt;
            性别:
         &lt;/td&gt;

         &lt;td class="style2"&gt;
            &lt;asp:RadioButtonList ID="rblhouse" runat="server" RepeatLayout="Flow"&gt;
               &lt;asp:ListItem&gt;男&lt;/asp:ListItem&gt;
               &lt;asp:ListItem&gt;女&lt;/asp:ListItem&gt;
               &lt;asp:ListItem&gt;其它&lt;/asp:ListItem&gt;
            &lt;/asp:RadioButtonList&gt;
         &lt;/td&gt;

         &lt;td&gt;
            &lt;asp:RequiredFieldValidator ID="rfvhouse" runat="server" 
               ControlToValidate="rblhouse" ErrorMessage="选择性别" &gt;
            &lt;/asp:RequiredFieldValidator&gt;
            &lt;br /&gt;
         &lt;/td&gt;
      &lt;/tr&gt;

      &lt;tr&gt;
         &lt;td class="style3"&gt;
            年龄:
         &lt;/td&gt;

         &lt;td class="style2"&gt;
            &lt;asp:TextBox ID="txtclass" runat="server"&gt;&lt;/asp:TextBox&gt;
         &lt;/td&gt;

         &lt;td&gt;
            &lt;asp:RangeValidator ID="rvclass" 
               runat="server" ControlToValidate="txtclass" 
               ErrorMessage="请填写年龄 (16 - 70)" MaximumValue="70" 
               MinimumValue="16" Type="Integer"&gt;
            &lt;/asp:RangeValidator&gt;
         &lt;/td&gt;
      &lt;/tr&gt;

      &lt;tr&gt;
         &lt;td class="style3"&gt;
            Email:
         &lt;/td&gt;

         &lt;td class="style2"&gt;
            &lt;asp:TextBox ID="txtemail" runat="server" style="width:250px"&gt;
            &lt;/asp:TextBox&gt;
         &lt;/td&gt;

         &lt;td&gt;
            &lt;asp:RegularExpressionValidator ID="remail" runat="server" 
               ControlToValidate="txtemail" ErrorMessage="请输入电子邮件地址" 
               ValidationExpression="\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*"&gt;
            &lt;/asp:RegularExpressionValidator&gt;
         &lt;/td&gt;
      &lt;/tr&gt;

      &lt;tr&gt;
         &lt;td class="style3" align="center" colspan="3"&gt;
            &lt;asp:Button ID="btnsubmit" runat="server" onclick="btnsubmit_Click" 
               style="text-align: center;width:140px" Text="确认提交"/&gt;
         &lt;/td&gt;
      &lt;/tr&gt;
   &lt;/table&gt;
   &lt;asp:ValidationSummary ID="ValidationSummary1" runat="server" 
      DisplayMode ="BulletList" ShowSummary ="true" HeaderText="错误信息提示:" /&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>以下是<em>Defalut.aspx.cs</em> 文件的内容：</p> 
 <pre><code class="lang-csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        UnobtrusiveValidationMode = UnobtrusiveValidationMode.None;
    }
    protected void btnsubmit_Click(object sender, EventArgs e)
    {
        if (Page.IsValid)
        {
            lblmsg.Text = "感谢支持";
        }
        else
        {
            lblmsg.Text = "填写所有内容";
        }
    }
}
</code></pre> 
 <p>执行上面启动项目，可以看到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/964101231_74102.png" alt=""></p> 
 <p>填写完成表单所有项目，然后提交，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/152101235_51285.png" alt=""></p>
 <br>      
</div></body></html>