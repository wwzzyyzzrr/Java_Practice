<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ASP.NET Ajax控件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>AJAX代表异步的JavaScript和XML。这是一个跨平台的技术，可以加快响应速度。 AJAX服务器控件将脚本添加到由浏览器执行和处理的页面。</p> 
 <p>但是，像其他ASP.NET服务器控件一样，这些AJAX服务器控件也可以拥有与它们关联的方法和事件处理程序，这些处理程序在服务器端处理。</p> 
 <p><em>Visual Studio IDE</em>中的控件工具箱包含一组称为<em>“AJAX扩展”</em> 的控件，</p> 
 <h2 id="h2-scriptmanager-"><a name="ScriptManager控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ScriptManager控件</h2>
 <p><code>ScriptManager</code>控件是最重要的控件，并且必须存在于其他控件才能在页面上工作。</p> 
 <p>它的基本语法，如下：</p> 
 <pre><code class="lang-aspnet">&lt;asp:ScriptManager ID="ScriptManager1" runat="server"&gt;
&lt;/asp:ScriptManager&gt;
</code></pre> 
 <p>如果从<em>“添加项目”</em> 对话框创建<em>“启用Ajax的站点”</em> 或添加<em>“AJAX Web窗体”</em> ，则Web窗体将自动包含脚本管理器控件。 <code>ScriptManager</code>控件负责所有服务器端控件的客户端脚本。</p> 
 <h2 id="h2-updatepanel-"><a name="UpdatePanel控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>UpdatePanel控件</h2>
 <p><code>UpdatePanel</code>控件是一个容器控件，并从<code>Control</code>类派生。 它充当其中的子控件的容器，没有自己的接口。 当它内部的一个控件触发了一个提交(<code>post</code>)后，<code>UpdatePanel</code>会介入以异步启动提交并更新页面的那一部分。</p> 
 <p>例如，如果按钮控件位于更新面板内部并且被点击，则只有更新面板中的控件将受到影响，页面其他部分的控件将不受影响。这被称为部分回传或异步回传。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>在应用程序中添加一个AJAX Web表单。 它包含默认的脚本管理器(<code>ScriptManager</code>)控件，插入更新面板。 在更新面板控件内放置一个按钮控件和一个标签控件。 在面板外面放置另一组按钮和标签。</p> 
 <p>首先打开<em>Visual Studio</em>，创建一个名称为：<em>AjaxControl</em> 的空ASP.NET网站项目，如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0712/250141218_17886.png" alt=""></p> 
 <p>在这个项目名称上点击右键，在弹出的选项中选择：<em>添加</em> -&gt; <em>添加新项</em>，选择<em>Web窗体</em>，创建一个文件：<em>Default.aspx</em>， 如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0712/855141220_10194.png" alt=""></p> 
 <p>设计视图如下所示：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0712/116141226_10715.png" alt=""></p> 
 <p>请注意，执行该页面时，如果点击<em>全部回传</em>按钮，则会更新两个标签中的时间，但如果单击<em>局部回传</em>按钮，则只会更新更新面板中的标签。</p> 
 <p>运行上面项目，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0712/684141237_46571.png" alt=""></p> 
 <p>点击控件后，可以看到以下效果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0712/858141238_36246.png" alt=""></p> 
 <p>一个页面可以包含多个更新面板，每个面板包含其他控件(如网格)并显示不同部分的数据。</p> 
 <p>当<em>全部回传</em> 发生时，更新面板内容默认内容。可以通过更改控件的<code>UpdateMode</code>属性来更改此默认模式。看看更新面板的其他属性。</p> 
 <p><strong>UpdatePanel控件的属性</strong></p> 
 <p>下表显示了<code>UpdatePanel</code>控件的属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>ChildrenAsTriggers</code></td> 
    <td>此属性指示回发是否来自子控件，这会导致更新面板刷新。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>ContentTemplate</code></td> 
    <td>它是内容模板，并定义在更新面板中显示的内容。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>ContentTemplateContainer</code></td> 
    <td>检索动态创建的模板容器对象，并用于以编程方式添加子控件。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>IsInPartialRendering</code></td> 
    <td>指示面板是否作为部分回贴的一部分进行更新。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>RenderMode</code></td> 
    <td>显示渲染模式。可用的模式是<code>Block</code>和<code>Inline</code>。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>UpdateMode</code></td> 
    <td>通过确定一些条件来获取或设置渲染模式。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>Triggers</code></td> 
    <td>定义每个对应于导致面板自动刷新的事件的收集触发器对象。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>UpdatePanel控件的方法</strong></p> 
 <p>下表显示了<code>UpdatePanel</code>控件的方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>CreateContentTemplateContainer</code></td> 
    <td>创建一个<code>Control</code>对象，作为定义<code>UpdatePanel</code>控件内容的子控件的容器。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>CreateControlCollection</code></td> 
    <td>返回<code>UpdatePanel</code>控件中包含的所有控件的集合。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Initialize</code></td> 
    <td>如果启用了部分页面呈现，则初始化<code>UpdatePanel</code>控件触发器集合。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Update</code></td> 
    <td>导致更新<code>UpdatePanel</code>控件的内容。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><code>UpdatePanel</code>控件的行为取决于<code>UpdateMode</code>属性和<code>ChildrenAsTriggers</code>属性的值。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>UpdateMode</th> 
    <th>ChildrenAsTriggers</th> 
    <th>影响</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td><code>Always</code></td> 
    <td><code>False</code></td> 
    <td>非法参数</td> 
   </tr> 
   <tr> 
    <td><code>Always</code></td> 
    <td><code>True</code></td> 
    <td>如果整个页面刷新或其上的子控件回发，<code>UpdatePanel</code>会刷新。</td> 
   </tr> 
   <tr> 
    <td><code>Conditional</code></td> 
    <td><code>False</code></td> 
    <td>如果整个页面刷新或者触发外部控件启动刷新，<code>UpdatePanel</code>将刷新。</td> 
   </tr> 
   <tr> 
    <td><code>Conditional</code></td> 
    <td><code>True</code></td> 
    <td><code>UpdatePanel</code>刷新整个页面刷新，或者其上的子控件回发或触发控件在外部启动刷新。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-updateprogress-"><a name="UpdateProgress控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>UpdateProgress控件</h2>
 <p>当一个或多个更新面板控件正在更新时，<code>UpdateProgress</code>控件在浏览器上提供了一种反馈。 例如，在执行某些面向数据库的作业时，用户登录或等待服务器响应。</p> 
 <p>它提供了一个可视的确认，如<em>“正在载入页面…”</em>，表示正在进行工作。</p> 
 <p><code>UpdateProgress</code>控件的语法是：</p>   
 <pre><code class="lang-aspnet">&lt;asp:UpdateProgress ID="UpdateProgress1" runat="server" DynamicLayout="true" AssociatedUpdatePanelID="UpdatePanel1" &gt;

   &lt;ProgressTemplate&gt;
      Loading...
   &lt;/ProgressTemplate&gt;

&lt;/asp:UpdateProgress&gt;
</code></pre> 
 <p>上面的代码片段显示了<code>ProgressTemplate</code>标签中的简单消息。但是，这可能是一个图像或其他相关的控制。 <code>UpdateProgress</code>控件将显示每个异步回发，除非使用<code>AssociatedUpdatePanelID</code>属性将其分配给单个更新面板。</p> 
 <p><strong>UpdateProgress控件的属性</strong></p> 
 <p>下表显示了<code>UpdateProgress</code>控件的属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>AssociatedUpdatePanelID</code></td> 
    <td>获取并设置与此控件关联的更新面板的ID。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Attributes</code></td> 
    <td>获取或设置<code>UpdateProgress</code>控件的级联样式表(CSS)属性。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DisplayAfter</code></td> 
    <td>获取并设置显示进度模板的时间(以毫秒为单位)。 默认值是<code>500</code>。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>DynamicLayout</code></td> 
    <td>指示是否动态呈现进度模板。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>ProgressTemplate</code></td> 
    <td>指示在异步回发期间显示的模板，其比<code>DisplayAfter</code>时间花费更多的时间。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>UpdateProgress控件的方法</strong></p> 
 <p>下表显示了<code>UpdateProgress</code>控件的方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>GetScriptDescriptors</code></td> 
    <td>返回<code>UpdateProgress</code>控件的客户端功能所需的组件，行为和客户端控件的列表。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>GetScriptReferences</code></td> 
    <td>返回<code>UpdateProgress</code>控件的客户端脚本库依赖项列表。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-timer-"><a name="Timer控制" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Timer控制</h2>
 <p>定时器(<code>Timer</code>)控件用于自动启动回发。 这可以通过两种方式来完成：</p> 
 <p>(1)设置UpdatePanel控件的Triggers属性：</p> 
 <pre><code class="lang-aspnet">&lt;Triggers&gt; 
   &lt;asp:AsyncPostBackTrigger ControlID="btnpanel2" EventName="Click" /&gt;
&lt;/Triggers&gt;
</code></pre> 
 <p>(2)直接在<code>UpdatePanel</code>中放置一个<code>Timer</code>控件，作为一个子控件触发器。 一个计时器可以成为多个<code>UpdatePanel</code>的触发器。</p> 
 <pre><code class="lang-aspnet">&lt;asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Always"&gt;

   &lt;ContentTemplate&gt;
      &lt;asp:Timer ID="Timer1" runat="server" Interval="1000"&gt;
         &lt;/asp:Timer&gt;

      &lt;asp:Label ID="Label1" runat="server" Height="101px" style="width:304px" &gt;
         &lt;/asp:Label&gt;
   &lt;/ContentTemplate&gt;

&lt;/asp:UpdatePanel&gt;
</code></pre>
 <br>      
</div></body></html>