<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ASP.NET数据库访问（Access)</h1><div style="width:100%;float:left;" class="article-content">   
 <p>ASP.NET允许访问和使用以下数据源：</p> 
 <ul> 
  <li>数据库(例如Access，SQL Server，Oracle，MySQL)</li>
  <li>XML文档</li>
  <li>业务对象</li>
  <li>文件</li>
 </ul> 
 <p>ASP.NET隐藏了数据访问的复杂过程，并提供了更高级别的类和对象，通过它可以轻松访问数据。 这些类隐藏了所有复杂的连接编码，数据检索，数据查询和数据操作。</p> 
 <p>ADO.NET是提供各种ASP.NET控件对象和后端数据源之间桥梁的技术。在本教程中，我们将简要介绍数据访问和数据处理。</p> 
 <h2 id="h2-u68C0u7D22u548Cu663Eu793Au6570u636E"><a name="检索和显示数据" class="reference-link"></a><span class="header-link octicon octicon-link"></span>检索和显示数据</h2>
 <p>它需要两种类型的数据控件来检索和显示ASP.NET中的数据：</p> 
 <ul> 
  <li><em>数据源控制</em> - 它管理与数据的连接，数据选择以及其他作业，如数据的分页和缓存等。</li>
  <li><em>数据视图控件</em> - 它绑定并显示数据并允许数据操作。</li>
 </ul> 
 <p>我们将在稍后详细讨论数据绑定和数据源控制。在本节中，将使用<code>SqlDataSource</code>控件访问数据，并使用<code>GridView</code>控件来显示和操作本章中的数据。</p> 
 <p>在这示例中，使用Access数据库，表中包含有关.Net图书的详细信息。数据库的名字是<em>ASPDotNetStepByStep.mdb</em>，并使用数据表：<code>DotNetReferences</code>用来存储图书的信息。</p> 
 <p>该表具有以下列：<code>ID</code>, <code>Title</code>, <code>AuthorName</code>, <code>Topic</code> 和 <code>Publisher</code>。</p> 
 <p>这里是数据表 - <code>book</code> 中的数据的快照：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/911111219_69134.png" alt=""></p> 
 <p>可以参考以下步骤：</p> 
 <p><strong>第1步：</strong> 创建一个网站项目：<em>DatabaseAccess</em>，参考下图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/463111258_48945.png" alt=""></p> 
 <p>在项目名称上右键添加一个<em>Web窗体</em>页面 - <em>Default.aspx</em>，参考下图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/832111259_50810.png" alt=""></p> 
 <p>接下来，在Web窗体(<em>Default.aspx</em>)上添加一个<code>SqlDataSourceControl</code>。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/244121205_39790.png" alt=""></p> 
 <p><strong>第2步：</strong> 点击上图中的<em>配置数据源…</em>选项。如下图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/694121207_65993.png" alt=""></p> 
 <p><strong>第3步：</strong> 点击<em>新建连接</em> 按钮建立与数据库的连接。如下图 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/558121213_55263.png" alt=""></p> 
 <p><strong>第4步：</strong> 连接建立后，可以保存以备后用。 在下一步中，它将要求配置<code>select</code>语句：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/744121215_80286.png" alt=""></p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/991121216_29190.png" alt=""></p> 
 <p><strong>第5步：</strong> 选择列并点击下一步完成步骤。 观察<code>WHERE</code>，<code>ORDER BY</code>和高级按钮。 这些按钮可用来提供<code>where</code>子句，<code>order by</code>子句，并分别指定SQL的插入，更新和删除命令。 这样就可以操纵数据。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/407121217_59476.png" alt=""></p> 
 <p>进入下一步，如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0512/942121219_62485.png" alt=""></p> 
 <p><strong>第6步：</strong> 在窗体上添加一个<code>GridView</code>控件。选择数据源并使用<em>“自动套用格式”</em>选项，选择<em>传统型</em>格式化控件。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0612/216141209_59152.png" alt=""></p> 
 <p><strong>第7步：</strong> 在此之后，格式化的<code>GridView</code>控件显示列标题，并且应用程序已准备好执行。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0612/111141211_28846.png" alt=""></p> 
 <p><strong>第8步：</strong> 最后执行应用程序。</p> 
 <p>文件(<em>Default.aspx</em>)代码如下：</p> 
 <pre><code class="lang-aspnet">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %&gt;

&lt;!DOCTYPE html&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;ASP.Net访问数据库(Access)示例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div&gt;
            &lt;asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="&lt;%$ ConnectionStrings:booksConnectionString %&gt;" ProviderName="&lt;%$ ConnectionStrings:booksConnectionString.ProviderName %&gt;" SelectCommand="SELECT * FROM [book]"&gt;&lt;/asp:SqlDataSource&gt;
            &lt;asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" CellPadding="4" DataKeyNames="ID" DataSourceID="SqlDataSource1" ForeColor="#333333" GridLines="None"&gt;
                &lt;AlternatingRowStyle BackColor="White" /&gt;
                &lt;Columns&gt;
                    &lt;asp:BoundField DataField="ID" HeaderText="编号" InsertVisible="False" ReadOnly="True" SortExpression="ID"/&gt;
                    &lt;asp:BoundField DataField="Title" HeaderText="标题" SortExpression="Title" /&gt;
                    &lt;asp:BoundField DataField="AuthorName" HeaderText="作者" SortExpression="AuthorName" /&gt;
                    &lt;asp:BoundField DataField="Topic" HeaderText="描述" SortExpression="Topic" /&gt;
                    &lt;asp:BoundField DataField="Publisher" HeaderText="发行社" SortExpression="Publisher"/&gt;
                &lt;/Columns&gt;
                &lt;EditRowStyle BackColor="#2461BF" /&gt;
                &lt;FooterStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" /&gt;
                &lt;HeaderStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" /&gt;
                &lt;PagerStyle BackColor="#2461BF" ForeColor="White" HorizontalAlign="Center" /&gt;
                &lt;RowStyle BackColor="#EFF3FB" /&gt;
                &lt;SelectedRowStyle BackColor="#D1DDF1" Font-Bold="True" ForeColor="#333333" /&gt;
                &lt;SortedAscendingCellStyle BackColor="#F5F7FB" /&gt;
                &lt;SortedAscendingHeaderStyle BackColor="#6D95E1" /&gt;
                &lt;SortedDescendingCellStyle BackColor="#E9EBEF" /&gt;
                &lt;SortedDescendingHeaderStyle BackColor="#4870BE" /&gt;
            &lt;/asp:GridView&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0612/998141224_93463.png" alt=""></p>
 <br>      
</div></body></html>