<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ADO.Net SqlDataReader类</h1><div style="width:100%;float:left;" class="article-content">   
 <p>ADO.Net的<code>SqlDataReader</code>类用于从SQL Server数据库读取数据。它从SQL Server数据库读取仅向前行的数据流中的数据。它是封闭的类，所以不能被继承。它继承了<code>DbDataReader</code>类并实现了<code>IDisposable</code>接口。</p> 
 <p><strong>SqlDataReader的签名</strong></p> 
 <pre><code class="lang-csharp">public class SqlDataReader : System.Data.Common.DbDataReader, IDisposable
</code></pre> 
 <p><strong>SqlDataReader类的属性</strong></p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Connection</code></td> 
    <td>它用于获取与<code>SqlDataReader</code>关联的<code>SqlConnection</code>。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Depth</code></td> 
    <td>它被用来获取一个表示当前行的嵌套深度的值。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>FieldCount</code></td> 
    <td>它用于获取当前行中的列数。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>HasRows</code></td> 
    <td>它用于获取一个值，该值指示<code>SqlDataReader</code>是否包含一行或多行。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>IsClosed</code></td> 
    <td>它用于检索布尔值，该值指示指定的<code>SqlDataReader</code>实例是否已关闭。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Item[String]</code></td> 
    <td>它用于以给定列名称的原始格式获取指定列的值。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>Item[Int32]</code></td> 
    <td>它用于以给定列序号的原始格式获取指定列的值。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>RecordsAffected</code></td> 
    <td>它用于通过执行Transact-SQL语句来获取更改，插入或删除的行数。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>VisibleFieldCount</code></td> 
    <td>它用于获取<code>SqlDataReader</code>中未隐藏的字段数。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>SqlDataReader类的属性</strong></p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Close()</code></td> 
    <td>它用于关闭<code>SqlDataReader</code>对象。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>GetBoolean(Int32)</code></td> 
    <td>它用于以布尔值的形式获取指定列的值。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>GetByte(Int32)</code></td> 
    <td>它用于获取指定列的值作为一个字节。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>GetChar(Int32)</code></td> 
    <td>它用于获取指定列的值作为单个字符。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>GetDateTime(Int32)</code></td> 
    <td>它用于获取指定列的值作为<code>DateTime</code>对象。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>GetDecimal(Int32)</code></td> 
    <td>它用于获取指定列的值作为<code>Decimal</code>对象。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>GetDouble(Int32)</code></td> 
    <td>它用于获取指定列的值作为双精度浮点数。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>GetFloat(Int32)</code></td> 
    <td>它用于获取指定列的值作为单精度浮点数。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>GetName(Int32)</code></td> 
    <td>它用于获取指定列的名称。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>GetSchemaTable()</code></td> 
    <td>它用于获取描述<code>SqlDataReader</code>的列元数据的<code>DataTable</code>对象。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>GetValue(Int32)</code></td> 
    <td>它用于以本机格式获取指定列的值。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>GetValues(Object[])</code></td> 
    <td>它用于使用当前行的列值填充对象数组。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>NextResult()</code></td> 
    <td>当读取SQL语句的结果时，它用来获得下一个结果。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>Read()</code></td> 
    <td>它用于从SQL Server数据库中读取记录。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>要创建一个<code>SqlDataReader</code>实例，则必须调用<code>SqlCommand</code>对象的<code>ExecuteReader</code>方法。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>在下面的程序中，使用<code>SqlDataReader</code>从SQL Server获取数据。创建一个C#控制台应用项目：<em>AdoNetSqlDataReader</em>，如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201711/2011/704161146_71640.png" alt=""></p> 
 <p>C#代码实现如下 - </p>   
 <pre><code class="lang-csharp">using System;
using System.Data.SqlClient;

namespace AdoNetSqlDataReader
{
    class Program
    {
        static void Main(string[] args)
        {
            new Program().GetData();
        }
        public void GetData()
        {
            SqlConnection con = null;
            try
            {
                // Creating Connection  
                con = new SqlConnection("data source=.; database=student; integrated security=SSPI");
                // writing sql query  
                SqlCommand cm = new SqlCommand("select * from student_info", con);
                // Opening Connection  
                con.Open();
                Console.WriteLine("当前 student_info 表中存有以下学生信息：" );
                // Executing the SQL query  
                SqlDataReader sdr = cm.ExecuteReader();
                while (sdr.Read())
                {
                    Console.WriteLine("学生编号：" + sdr["id"] +" 学生姓名：" + sdr["name"] + " " + sdr["email"]);
                }
            }
            catch (Exception e)
            {
                Console.WriteLine("OOPs, something went wrong." + e);
            }
            // Closing the connection  
            finally
            {
                con.Close();
            }
        }
    }
}
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/268161150_51984.png" alt=""></p>
 <br>      
</div></body></html>