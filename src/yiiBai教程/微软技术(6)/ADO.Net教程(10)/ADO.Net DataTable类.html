<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ADO.Net DataTable类</h1><div style="width:100%;float:left;" class="article-content">   
 <p><code>DataTable</code>类将关系数据表示为表格形式。ADO.NET提供了一个<code>DataTable</code>类来独立创建和使用数据表。它也可以和<code>DataSet</code>一起使用。 最初，当创建<code>DataTable</code>时，它没有表模式。我们可以通过向表中添加列和约束来创建表模式。在定义表模式之后，可以向表中添加行。</p> 
 <p>在创建<code>DataTable</code>之前，必须包含<code>System.Data</code>名称空间。</p> 
 <h4 id="h4--strong-datatable-strong-"><a name="<strong>DataTable的签名</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span><strong>DataTable的签名</strong></h4>
 <pre><code class="lang-csharp">public class DataTable : System.ComponentModel.MarshalByValueComponent, System.ComponentModel.IListSource,  
System.ComponentModel.ISupportInitializeNotification, System.Runtime.Serialization.ISerializable,  
System.Xml.Serialization.IXmlSerializable
</code></pre> 
 <h4 id="h4--strong-datatable-strong-"><a name="<strong>DataTable构造函数</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span><strong>DataTable构造函数</strong></h4>
 <p>下表列出了<code>DataTable</code>类的构造函数。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>构造函数</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>DataTable()</code></td> 
    <td>它用于初始化没有参数的<code>DataTable</code>类的新实例。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>DataTable(String)</code></td> 
    <td>它用于使用指定的表名初始化<code>DataTable</code>类的新实例。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DataTable(SerializationInfo, StreamingContext)</code></td> 
    <td>它用于使用<code>SerializationInfo</code>和<code>StreamingContext</code>初始化<code>DataTable</code>类的新实例。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>DataTable(String, String)</code></td> 
    <td>它用于使用指定的表名和名称空间初始化<code>DataTable</code>类的新实例。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h4 id="h4--strong-datatable-strong-"><a name="<strong>DataTable属性</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span><strong>DataTable属性</strong></h4>
 <p>下表列出了<code>DataTable</code>类的属性。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Columns</code></td> 
    <td>它用于获取属于此表的列的集合。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Constraints</code></td> 
    <td>它被用来获取由这个表维护的约束的集合。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DataSet</code></td> 
    <td>它用于获取此表所属的<code>DataSet</code>。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>DefaultView</code></td> 
    <td>它用于获取可能包含过滤视图的表的自定义视图。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>HasErrors</code></td> 
    <td>它用于获取指示<code>DataSet</code>表中的任何行中是否存在错误的值。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>MinimumCapacity</code></td> 
    <td>它用于获取或设置此表的初始起始大小。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>PrimaryKey</code></td> 
    <td>它用于获取或设置一个用作数据表主键的列数组。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>Rows</code></td> 
    <td>它用于获取属于此表的行的集合。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>TableName</code></td> 
    <td>它用于获取或设置<code>DataTable</code>的名称。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h4 id="h4--strong-datatable-strong-"><a name="<strong>DataTable方法</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span><strong>DataTable方法</strong></h4>
 <p>下表列出了<code>DataTable</code>类的方法。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>AcceptChanges()</code></td> 
    <td>它用于提交对此表进行的所有更改。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Clear()</code></td> 
    <td>它用来清除所有数据的<code>DataTable</code>。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Clone()</code></td> 
    <td>它被用来克隆<code>DataTable</code>的结构。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Copy()</code></td> 
    <td>它用于复制<code>DataTable</code>的结构和数据。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>CreateDataReader()</code></td> 
    <td>它用于返回与此<code>DataTable</code>中的数据相对应的<code>DataTableReader</code>。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>CreateInstance()</code></td> 
    <td>它用于创建<code>DataTable</code>的新实例。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>GetRowType()</code></td> 
    <td>它用于获取行类型。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>GetSchema()</code></td> 
    <td>它用来获取表的模式。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>ImportRow(DataRow)</code></td> 
    <td>它用于将<code>DataRow</code>复制到<code>DataTable</code>中。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>Load(IDataReader)</code></td> 
    <td>它用于使用提供的<code>IDataReader</code>从数据源填充<code>DataTable</code>。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>Merge(DataTable, Boolean)</code></td> 
    <td>它用于合并指定的<code>DataTable</code>和当前的<code>DataTable</code>。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>NewRow()</code></td> 
    <td>它用于创建一个与表具有相同模式的新<code>DataRow</code>。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>Select()</code></td> 
    <td>它用于获取所有<code>DataRow</code>对象的数组。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>WriteXml(String)</code></td> 
    <td>用于使用指定的文件将<code>DataTable</code>的当前内容写为XML。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-u6570u636Eu8868u793Au4F8B"><a name="数据表示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>数据表示例</h2>
 <p>在下面的例子中，我们创建一个将数据填充到浏览器的数据表。首先创建一个Web项目：<em>AdoNetDataTable</em>，打开Visual Studio创建一个ASP.NET空网站项目，如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/516101150_82018.png" alt=""></p> 
 <p>向这个项目中添加一个新建项，在项目名称上点击右键，在弹出的菜单中选择：<em>添加</em> -&gt;<em>添加新项</em>，文件的名称为：<em>Default.html</em>，如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/491101153_31390.png" alt=""></p> 
 <p>本示例包含以下文件，<em>Default.html</em> - </p>   
 <pre><code class="lang-aspnet">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.html.cs" Inherits="_Default" %&gt;
&lt;!DOCTYPE html&gt;  
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;  
&lt;head runat="server"&gt;  
    &lt;title&gt;DataTable示例&lt;/title&gt;  
&lt;/head&gt;  
&lt;body&gt;  
    &lt;form id="form1" runat="server"&gt;  
        &lt;div&gt;  
        &lt;/div&gt;  
        &lt;asp:GridView ID="GridView1" runat="server"&gt;  
        &lt;/asp:GridView&gt;  
    &lt;/form&gt;  
&lt;/body&gt;  
&lt;/html&gt;
</code></pre> 
 <p>文件：<em>Default.html.cs</em> - </p> 
 <pre><code class="lang-csharp">using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        DataTable table = new DataTable();
        table.Columns.Add("编号");
        table.Columns.Add("姓名");
        table.Columns.Add("电子邮箱");
        table.Rows.Add("101", "Javaer", "javaer@yiibai.com");
        table.Rows.Add("102", "Sam James", "sam.php@yiibai.com");
        table.Rows.Add("103", "Subram Ruby", "ruby@yiibai.com");
        table.Rows.Add("104", "Ankur Python", "ankur.python@yiibai.com");
        GridView1.DataSource = table;
        GridView1.DataBind();
    }
}
</code></pre> 
 <p>执行上面项目，点击菜单：调试 -&gt; 开始执行(不调试) ，Visual Studio自动打开浏览器，看到结果如下所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/386111102_48621.png" alt=""></p>
 <br>      
</div></body></html>