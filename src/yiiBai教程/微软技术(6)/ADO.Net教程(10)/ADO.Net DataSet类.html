<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ADO.Net DataSet类</h1><div style="width:100%;float:left;" class="article-content">   
 <p>ADO.Net的<code>DataSet</code>类包含数据的数据表集合。它用于在不与数据源交互的情况下获取数据，这就是为什么它也被称为断开数据访问方法。这是一个内存数据存储，可以同时容纳多个表。可以使用<code>DataRelation</code>对象来关联这些表。 <code>DataSet</code>也可以用来读写XML文档中的数据。</p> 
 <p>ADO.NET提供了一个可用于创建<code>DataSet</code>对象的<code>DataSet</code>类。它包含执行数据相关操作的构造函数和方法。</p> 
 <p><strong>DataSet类的签名</strong></p> 
 <pre><code class="lang-csharp">public class DataSet : System.ComponentModel.MarshalByValueComponent, System.ComponentModel.IListSource,   
System.ComponentModel.ISupportInitializeNotification, System.Runtime.Serialization.ISerializable,   
System.Xml.Serialization.IXmlSerializable
</code></pre> 
 <p><strong>DataSet类构造函数</strong></p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>构造函数</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>DataSet()</code></td> 
    <td>它用于初始化<code>DataSet</code>类的新实例。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>DataSet(String)</code></td> 
    <td>它用于使用给定名称初始化<code>DataSet</code>类的新实例。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DataSet(SerializationInfo, StreamingContext)</code></td> 
    <td>它用于初始化具有给定序列化信息和上下文的<code>DataSet</code>类的新实例。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>DataSet(SerializationInfo, StreamingContext, Boolean)</code></td> 
    <td>它用于初始化<code>DataSet</code>类的新实例。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>DataSet类的属性</strong></p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>CaseSensitive</code></td> 
    <td>它用于检查<code>DataTable</code>对象是否区分大小写。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>DataSetName</code></td> 
    <td>它用于获取或设置当前<code>DataSet</code>的名称。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DefaultViewManager</code></td> 
    <td>它用于获取<code>DataSet</code>中包含的数据的自定义视图，以允许过滤和搜索。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>HasErrors</code></td> 
    <td>它用于检查此<code>DataSet</code>中的任何<code>DataTable</code>对象中是否有错误。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>IsInitialized</code></td> 
    <td>它用于检查<code>DataSet</code>是否被初始化。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Locale</code></td> 
    <td>它用于获取或设置用于比较表中字符串的语言环境信息。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>Namespace</code></td> 
    <td>它用于获取或设置<code>DataSet</code>的名称空间。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>Site</code></td> 
    <td>它用于获取或设置<code>DataSet</code>的<code>ISite</code>。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>Tables</code></td> 
    <td>它用于获取<code>DataSet</code>中包含的表的集合。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p><strong>DataSet类的方法</strong></p> 
 <p>下表中列出了一些常用的<code>DataSet</code>类中的方法。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>BeginInit()</code></td> 
    <td>它用于在窗体上使用的<code>DataSet</code>的初始化。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Clear()</code></td> 
    <td>它用于通过删除所有表中的所有行来清除任何<code>DataSet</code>中的数据。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Clone()</code></td> 
    <td>它用于复制<code>DataSet</code>的结构。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Copy()</code></td> 
    <td>它用于复制此<code>DataSet</code>的结构和数据。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>CreateDataReader(DataTable[])</code></td> 
    <td>它将为每个<code>DataTable</code>返回一个带有一个结果集的<code>DataTableReader</code>。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>CreateDataReader()</code></td> 
    <td>它将为每个<code>DataTable</code>返回一个带有一个结果集的<code>DataTableReader</code>。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>EndInit()</code></td> 
    <td>它结束在窗体上使用的<code>DataSet</code>的初始化。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>GetXml()</code></td> 
    <td>它返回存储在<code>DataSet</code>中的数据的XML表示形式。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>GetXmlSchema()</code></td> 
    <td>它返回存储在<code>DataSet</code>中的数据的XML表示的XML Schema。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>Load(IDataReader, LoadOption, DataTable[])</code></td> 
    <td>它用于使用提供的<code>IDataReader</code>从数据源填充数据集。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>Merge(DataSet)</code></td> 
    <td>它用于将指定的<code>DataSet</code>及其模式合并到当前的<code>DataSet</code>中。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>Merge(DataTable)</code></td> 
    <td>它用于将指定的<code>DataTable</code>及其模式合并到当前的<code>DataSet</code>中。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>ReadXml(XmlReader, XmlReadMode)</code></td> 
    <td>它用于使用指定的<code>XmlReader</code>和<code>XmlReadMode</code>将XML模式和数据读入<code>DataSet</code>。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>Reset()</code></td> 
    <td>它用于清除所有表，并从<code>DataSet</code>中删除所有关系，外部约束和表。</td> 
   </tr> 
   <tr> 
    <td>15</td> 
    <td><code>WriteXml(XmlWriter, XmlWriteMode)</code></td> 
    <td>它用于使用指定的<code>XmlWriter</code>和<code>XmlWriteMode</code>编写<code>DataSet</code>的当前数据和可选的模式。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>在这个例子中，将演示如何使用<code>DataSet</code>并将数据显示到一个<code>gridview</code>中。 创建一个<em>Web窗体</em>并从工具箱中将<code>GridView</code>拖到窗体上。可以在<em>数据类别</em> 中找到<code>GridView</code>。</p> 
 <p>首先创建一个Web项目：<em>AdoNetDataSet</em>，打开Visual Studio创建一个ASP.NET空网站项目，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/266091109_85747.png" alt=""></p> 
 <p>向这个项目中添加一个新建项，在项目名称上点击右键，在弹出的菜单中选择：<em>添加新项</em>，文件的名称为：<em>Default.aspx</em>，如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/455091113_57384.png" alt=""></p> 
 <p>从工具箱中将<code>GridView</code>拖到窗体上，如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/690091115_48860.png" alt=""></p> 
 <p>下面是<em>Default.aspx</em>的代码实现 - </p>   
 <pre><code class="lang-aspnet">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.html.cs" Inherits="_Default" %&gt;

&lt;!DOCTYPE html&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;AdoNet DataSet示例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div&gt;

        &lt;/div&gt;
        &lt;asp:GridView ID="GridView1" runat="server" CellPadding="4" ForeColor="#333333" GridLines="None"&gt;  
            &lt;AlternatingRowStyle BackColor="White" /&gt;  
            &lt;EditRowStyle BackColor="#2461BF" /&gt;  
            &lt;FooterStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" /&gt;  
            &lt;HeaderStyle BackColor="#507CD1" Font-Bold="True" ForeColor="White" /&gt;  
            &lt;PagerStyle BackColor="#2461BF" ForeColor="White" HorizontalAlign="Center" /&gt;  
            &lt;RowStyle BackColor="#EFF3FB" /&gt;  
            &lt;SelectedRowStyle BackColor="#D1DDF1" Font-Bold="True" ForeColor="#333333" /&gt;  
            &lt;SortedAscendingCellStyle BackColor="#F5F7FB" /&gt;  
            &lt;SortedAscendingHeaderStyle BackColor="#6D95E1" /&gt;  
            &lt;SortedDescendingCellStyle BackColor="#E9EBEF" /&gt;  
            &lt;SortedDescendingHeaderStyle BackColor="#4870BE" /&gt;  
        &lt;/asp:GridView&gt;  
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>下面是<em>Defatult.aspx.cs</em> 代码的实现 - </p> 
 <pre><code class="lang-csharp">using System;
using System.Data.SqlClient;
using System.Data;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {        
        using (SqlConnection con = new SqlConnection("data source=.; database=student; integrated security=SSPI"))
        {
            SqlDataAdapter sde = new SqlDataAdapter("Select * from student_info", con);
            DataSet ds = new DataSet();
            sde.Fill(ds);
            GridView1.DataSource = ds;
            GridView1.DataBind();
        }

    }
}
</code></pre> 
 <p>执行上面项目，点击菜单：<em>调试</em> -&gt; <em>开始执行(不调试)</em> ，Visual Studio自动打开浏览器，看到结果如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/354091128_25219.png" alt=""></p>
 <br>      
</div></body></html>