<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ADO.Net Web表单实例</h1><div style="width:100%;float:left;" class="article-content">   
 <p>可以创建一个具有ADO.NET连接性的Web表单。具有表单控件的简单Web表单可以提交给服务器。 ADO.NET可将提交的值存储到SQL Server数据库中。</p> 
 <p>在这里，我们创建一个连接到SQL Server数据库的Web表单应用程序。</p> 
 <p>首先打开<em>Visual Studio</em>创建一个名称为：<em>AdoNetWebFormApp</em>，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/284111108_19682.png" alt=""></p> 
 <p>在这个项目中，在这个项目中添加一个新建项，在项目名称上点击右键，在弹出的菜单中选择：<em>添加</em>-&gt;<em>添加新项</em>，文件的名称为：<em>Register.aspx</em>，如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/331121153_52898.png" alt=""></p> 
 <p>此Web表单包含以下源代码。文件：<em>Register.aspx</em> - </p> 
 <pre><code class="lang-aspnet">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Register.aspx.cs" Inherits="Register" %&gt;

&lt;!DOCTYPE html&gt;

&lt;!DOCTYPE html&gt;  
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;  
&lt;head runat="server"&gt;  
    &lt;title&gt;WebForm&lt;/title&gt;  
    &lt;style type="text/css"&gt;  
        .auto-style1 {  
            width: 100%;  
        }  
        .auto-style2 {  
            width: 100px;  
        }  
        .auto-style3 {  
            width: 95px;  
        }  
    &lt;/style&gt;  
&lt;/head&gt;  
&lt;body&gt;  
    &lt;form id="form1" runat="server"&gt;  
        &lt;div&gt;  
            &lt;table class="auto-style1"&gt;  
                &lt;tr&gt;  
                    &lt;td class="auto-style2"&gt;  
                       &lt;asp:Label runat="server" Text="用户名" ID="usernamelabelId"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
                    &lt;td&gt;  
                       &lt;asp:TextBox ID="UsernameId" runat="server"&gt;&lt;/asp:TextBox&gt;&lt;/td&gt;  
                &lt;/tr&gt;  
                &lt;tr&gt;  
                    &lt;td class="auto-style2"&gt;  
                        &lt;asp:Label runat="server" Text="Email"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
                    &lt;td&gt;  
                        &lt;asp:TextBox ID="EmailId" runat="server"&gt;&lt;/asp:TextBox&gt;&lt;/td&gt;  
                &lt;/tr&gt;  
                &lt;tr&gt;  
                    &lt;td class="auto-style2"&gt;  
                        &lt;asp:Label runat="server" Text="联系电话"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
                    &lt;td&gt;  
                        &lt;asp:TextBox ID="ContactId" runat="server"&gt;&lt;/asp:TextBox&gt;&lt;/td&gt;  
                &lt;/tr&gt;  
                &lt;tr&gt;  
                    &lt;td class="auto-style2"&gt;&lt;/td&gt;  
                    &lt;td&gt;  
                        &lt;asp:Button ID="ButtonId" runat="server" Text="提交" OnClick="ButtonId_Click" /&gt;&lt;/td&gt;  
                &lt;/tr&gt;  
            &lt;/table&gt;  
        &lt;/div&gt;  
    &lt;div&gt;  
        &lt;asp:Label ID="Label1" runat="server"&gt;&lt;/asp:Label&gt;  
    &lt;/div&gt;  
    &lt;/form&gt;  
    &lt;table class="auto-style1"&gt;  
        &lt;tr&gt;  
            &lt;td class="auto-style3"&gt;  
                &lt;asp:Label ID="Label2" runat="server"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
            &lt;td&gt;  
                &lt;asp:Label ID="Label5" runat="server"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
        &lt;/tr&gt;  
        &lt;tr&gt;  
            &lt;td class="auto-style3"&gt;  
                &lt;asp:Label ID="Label3" runat="server"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
            &lt;td&gt;  
                &lt;asp:Label ID="Label6" runat="server"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
        &lt;/tr&gt;  
        &lt;tr&gt;  
            &lt;td class="auto-style3"&gt;  
                &lt;asp:Label ID="Label4" runat="server"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
            &lt;td&gt;  
                &lt;asp:Label ID="Label7" runat="server"&gt;&lt;/asp:Label&gt;&lt;/td&gt;  
        &lt;/tr&gt;  
    &lt;/table&gt;  
    &lt;/body&gt;  
&lt;/html&gt;
</code></pre> 
 <p>文件：<em>Register.aspx.cs</em> - </p>   
 <pre><code class="lang-csharp">using System;
using System.Data.SqlClient;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Register : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void ButtonId_Click(object sender, EventArgs e)
    {
        SqlConnection con = null;
        try
        {
            // Creating Connection  
            con = new SqlConnection("data source=.; database=student; integrated security=SSPI");
            // Writing insert query  
            string query = "insert into student_info(id,name,email,contact)values(110,'" + UsernameId.Text + "','" + EmailId.Text + "','" + ContactId.Text + "')";
            SqlCommand sc = new SqlCommand(query, con);
            // Opening connection  
            con.Open();
            // Executing query  
            int status = sc.ExecuteNonQuery();
            Label1.Text = "提交的用户信息已经存储到了表中，如下所示 - ";
            // ----------------------- Retrieving Data ------------------ //  
            SqlCommand cm = new SqlCommand("select top 1 * from student_info ORDER BY id DESC", con);
            // Executing the SQL query  
            SqlDataReader sdr = cm.ExecuteReader();
            sdr.Read();
            Label2.Text = "用户名"; Label5.Text = sdr["name"].ToString();
            Label3.Text = "Email"; Label6.Text = sdr["email"].ToString();
            Label4.Text = "联系电话"; Label7.Text = sdr["contact"].ToString();
        }catch (Exception ex)
        {
            Console.WriteLine("OOPs, something went wrong." + ex);
        }
        // Closing the connection  
        finally
        {
            con.Close();
        }
    }
}
</code></pre> 
 <p>运行项目，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/498121151_67457.png" alt=""></p> 
 <p>填写表单信息，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/584121145_30972.png" alt=""></p> 
 <p>提交后，它将存储并检索SQL Server数据库中最后一条插入的数据。如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/967121150_76222.png" alt=""></p> 
 <p>查询数据库<em>student</em>的<em>student_info</em>结果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2011/733121155_38914.png" alt=""></p>
 <br>      
</div></body></html>