<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VBA数组</h1><div style="width:100%;float:left;" class="article-content">   
 <p>我们都知道，一个变量是一个存储值的容器。 有时，开发人员希望一次可以在一个变量中保存多个值。 当一系列值存储在单个变量中时，则称为数组变量。</p> 
 <h2 id="h2-u6570u7EC4u58F0u660E"><a name="数组声明" class="reference-link"></a><span class="header-link octicon octicon-link"></span>数组声明</h2>
 <p>数组声明的方式与声明变量相同，只是数组变量的声明使用括号。 在下面的例子中，括号里提到了数组的大小。参考以下示例 - </p> 
 <pre><code class="lang-vb">'Method 1 : Using Dim
Dim arr1()    'Without Size

'Method 2 : Mentioning the Size
Dim arr2(5)  'Declared with size of 5

'Method 3 : using 'Array' Parameter
Dim arr3
arr3 = Array("apple","Orange","Grapes")
</code></pre> 
 <p>在上面代码中，</p> 
 <ul> 
  <li>虽然数组大小被指定为<code>5</code>，但是当数组索引从零开始时，它可以保持<code>6</code>个值。</li>
  <li>数组索引不能是负数。</li>
  <li>VBScript数组可以在数组中存储任何类型的变量。因此，一个数组可以在一个数组变量中存储一个整数，字符串或字符。</li>
 </ul> 
 <h2 id="h2-u8D4Bu503Cu7ED9u6570u7EC4"><a name="赋值给数组" class="reference-link"></a><span class="header-link octicon octicon-link"></span>赋值给数组</h2>
 <p>通过为每个要分配的值指定一个数组索引值，将这些值分配给数组。它可以是一个字符串。</p> 
 <h4 id="h4--strong-strong-"><a name="<strong>例子</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span><strong>例子</strong></h4>
 <p>添加一个模块并添加以下代码 - </p> 
 <pre><code class="lang-vb">Private Sub Constant_demo_Click()
   Dim arr(5)
   arr(0) = "1"           'Number as String
   arr(1) = "VBScript"    'String
   arr(2) = 100            'Number
   arr(3) = 2.45            'Decimal Number
   arr(4) = #10/07/2013#  'Date
   arr(5) = #12.45 PM#    'Time

   msgbox("Value stored in Array index 0 : " &amp; arr(0))
   msgbox("Value stored in Array index 1 : " &amp; arr(1))
   msgbox("Value stored in Array index 2 : " &amp; arr(2))
   msgbox("Value stored in Array index 3 : " &amp; arr(3))
   msgbox("Value stored in Array index 4 : " &amp; arr(4))
   msgbox("Value stored in Array index 5 : " &amp; arr(5))
End Sub
</code></pre> 
 <p>当执行上面的函数时，它会产生下面的输出。</p> 
 <pre><code class="lang-shell">Value stored in Array index 0 : 1
Value stored in Array index 1 : VBScript
Value stored in Array index 2 : 100
Value stored in Array index 3 : 2.45
Value stored in Array index 4 : 7/10/2013
Value stored in Array index 5 : 12:45:00 PM
</code></pre> 
 <h2 id="h2-u591Au7EF4u6570u7EC4"><a name="多维数组" class="reference-link"></a><span class="header-link octicon octicon-link"></span>多维数组</h2>
 <p>数组不仅限于一个维度，但它们最多可以有<code>60</code>个维度。 二维数组是最常用的数组。</p> 
 <h4 id="h4-u4F8Bu5B50"><a name="例子" class="reference-link"></a><span class="header-link octicon octicon-link"></span>例子</h4>
 <p>在下面的例子中，一个多维数组被声明为<code>3</code>行<code>4</code>列。</p> 
 <pre><code class="lang-vb">Private Sub Constant_demo_Click()
   Dim arr(2,3) as Variant    ' Which has 3 rows and 4 columns
   arr(0,0) = "Apple" 
   arr(0,1) = "Orange"
   arr(0,2) = "Grapes"           
   arr(0,3) = "pineapple" 
   arr(1,0) = "cucumber"           
   arr(1,1) = "beans"           
   arr(1,2) = "carrot"           
   arr(1,3) = "tomato"           
   arr(2,0) = "potato"             
   arr(2,1) = "sandwitch"            
   arr(2,2) = "coffee"             
   arr(2,3) = "nuts"            

   msgbox("Value in Array index 0,1 : " &amp;  arr(0,1))
   msgbox("Value in Array index 2,2 : " &amp;  arr(2,2))
End Sub
</code></pre> 
 <p>当执行上面的函数时，它会产生下面的输出。</p> 
 <pre><code class="lang-shell">Value stored in Array index : 0 , 1 : Orange
Value stored in Array index : 2 , 2 : coffee
</code></pre> 
 <h2 id="h2-redim-"><a name="ReDim语句" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ReDim语句</h2>
 <p><code>ReDim</code>语句用于声明动态数组变量并分配或重新分配存储空间。</p> 
 <pre><code class="lang-vb">ReDim [Preserve] varname(subscripts) [, varname(subscripts)]
</code></pre> 
 <p><strong>参数说明</strong></p> 
 <ul> 
  <li><em>Preserve</em> - 一个可选参数，用于在更改最后一个维度的大小时保留现有数组中的数据。</li>
  <li><em>Varname</em> - 必需的参数，表示变量的名称，应遵循标准变量命名约定。</li>
  <li><em>Subscripts</em> - 必需的参数，表示数组的大小。</li>
 </ul> 
 <h4 id="h4-u4F8Bu5B50"><a name="例子" class="reference-link"></a><span class="header-link octicon octicon-link"></span>例子</h4>
 <p>在下面的例子中，数组已经被重新定义，当数组的现有大小发生改变时，这些值被保存下来。</p> 
 <blockquote> 
  <p>注意 - 调整数组的大小时，删除的元素中的数据将丢失。</p> 
 </blockquote>   
 <pre><code class="lang-vb">Private Sub Constant_demo_Click()
   Dim a() as variant
   i = 0
   redim a(5)
   a(0) = "XYZ"
   a(1) = 41.25
   a(2) = 22

   REDIM PRESERVE a(7)
   For i = 3 to 7
   a(i) = i
   Next

   'to Fetch the output
   For i = 0 to ubound(a)
      Msgbox a(i)
   Next
End Sub
</code></pre> 
 <p>当执行上面的函数时，它会产生下面的输出。</p> 
 <pre><code class="lang-vb">XYZ
41.25
22
3
4
5
6
7
</code></pre> 
 <h2 id="h2-u6570u7EC4u65B9u6CD5"><a name="数组方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>数组方法</h2>
 <p>VBScript中有各种内置函数，可以帮助开发人员有效地处理数组。 下面列出了与数组一起使用的所有方法。请点击方法名称来详细了解它们如何应用。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_lbound_function.html" title="LBound">LBound</a></td> 
    <td>它返回一个整数，对应于给定数组的最小下标。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_ubound_function.html" title="UBound">UBound</a></td> 
    <td>它返回一个整数，对应于给定数组的最大下标。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_split_function.html" title="Split">Split</a></td> 
    <td>它返回一个包含指定数量值的数组。根据分隔符分割。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_join_function.html" title="Join">Join</a></td> 
    <td>它返回一个包含数组中指定数量的子串的字符串。这是<code>Split</code>方法的一个完全相反的功能。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_filter_function.html" title="Filter">Filter</a></td> 
    <td>它返回一个基于零的数组，该数组包含基于特定过滤条件的字符串数组的子集。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_isarray_function.html" title="IsArray">IsArray</a></td> 
    <td>它返回一个布尔值，表示输入变量是否是一个数组。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vba/vba_erase_function.html" title="Erase">Erase</a></td> 
    <td>为数组变量恢复分配的内存。</td> 
   </tr> 
  </tbody> 
 </table>
 <br>      
</div></body></html>