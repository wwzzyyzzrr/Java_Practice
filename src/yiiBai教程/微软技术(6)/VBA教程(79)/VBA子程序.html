<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VBA子程序</h1><div style="width:100%;float:left;" class="article-content">   
 <p>子程序(<em>Sub Procedures</em>，也叫子过程)与函数类似，但有一些差异。</p> 
 <ul> 
  <li>子过程不需要有返回一个值，而函数可能会或可能不会有返回一个值。</li>
  <li>子程序可以不用<code>call</code>关键字来调用。</li>
  <li>子程序总是包含在<code>Sub</code>和<code>End Sub</code>语句中。</li>
 </ul> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-vb">Sub Area(x As Double, y As Double)
   MsgBox x * y
End Sub
</code></pre> 
 <h2 id="h2-u8C03u7528u7A0Bu5E8F"><a name="调用程序" class="reference-link"></a><span class="header-link octicon octicon-link"></span>调用程序</h2>
 <p>要在脚本的某处调用过程，可以使用函数进行调用。无法使用与函数相同的方式来调用子过程，因为子过程不会返回值。</p> 
 <pre><code class="lang-vb">Function findArea(Length As Double, Width As Variant)
   area Length, Width    ' To Calculate Area 'area' sub proc is called
End Function
</code></pre> 
 <p>现在只能调用该函数，而不能调用子程序，如下图所示。<br><img src="http://www.yiibai.com/uploads/images/201711/2411/491111142_55828.png" alt=""></p> 
 <p>该区域的面积仅在消息框中计算和显示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/814111143_24497.png" alt=""></p> 
 <p>结果单元显示为零，因为计算的面积值不是从函数返回的。简而言之，不能直接在Excel工作表中调用子程序。</p>
 <br>      
</div></body></html>