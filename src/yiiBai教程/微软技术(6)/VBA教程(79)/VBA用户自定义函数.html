<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VBA用户自定义函数</h1><div style="width:100%;float:left;" class="article-content">   
 <p>函数是一组可重复使用的代码，可以在程序中的任何地方调用。这消除了一遍又一遍地编写相同的代码的需要。这使程序员能够将一个大程序划分成许多小的可管理的功能模块。</p> 
 <p>除了内置函数外，VBA还允许编写用户定义的函数。 在本章中，我们将学习如何在VBA中编写自己的函数。</p> 
 <h2 id="h2-u51FDu6570u5B9Au4E49"><a name="函数定义" class="reference-link"></a><span class="header-link octicon octicon-link"></span>函数定义</h2>
 <p>一个VBA函数可以有一个可选的<code>return</code>语句。如果要从函数返回值，则可使用<code>return</code>语句。<br>例如，可以在一个函数中传递两个数字，然后从函数中返回它们的乘积。</p> 
 <blockquote> 
  <p>注 - 函数可以返回由逗号分隔的多个值，作为分配给函数名称本身的数组。</p> 
 </blockquote> 
 <p>在使用函数之前，我们需要定义这个特定的函数。 在VBA中定义函数的最常见的方法是使用<code>Function</code>关键字，后跟一个唯一的函数名称，它可能会也可能不会带有一个带有<code>End Function</code>关键字的参数列表和一个语句，这表示函数的结束。以下是定义函数的基本语法。</p> 
 <p><strong>基本语法</strong></p> 
 <pre><code class="lang-vb">Function Functionname(parameter-list)
   statement 1
   statement 2
   statement 3
   .......
   statement n
End Function
</code></pre> 
 <h4 id="h4-u4F8Bu5B50"><a name="例子" class="reference-link"></a><span class="header-link octicon octicon-link"></span>例子</h4>
 <p>添加以下函数计算返回面积。请注意，可以使用函数名称本身返回一个值/值。</p>   
 <pre><code class="lang-vb">Function findArea(Length As Double, Optional Width As Variant)
   If IsMissing(Width) Then
      findArea = Length * Length
   Else
      findArea = Length * Width
   End If
End Function
</code></pre> 
 <h4 id="h4-u8C03u7528u51FDu6570"><a name="调用函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>调用函数</h4>
 <p>要调用函数，请使用函数名称调用函数，如以下屏幕截图所示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/985111105_96991.png" alt=""></p> 
 <p>计算面积的结果输出如下所示将显示给用户。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/744111105_39039.png" alt=""></p>
 <br>      
</div></body></html>