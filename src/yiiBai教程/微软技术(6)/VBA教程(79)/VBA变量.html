<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VBA变量</h1><div style="width:100%;float:left;" class="article-content">   
 <p>变量是一个指定的内存位置，用于保存脚本执行过程中可以更改的值。以下是命名变量的基本规则。</p> 
 <ul> 
  <li>变量名称必须使用一个字母作为第一个字符。</li>
  <li>变量名称不能使用空格，句点(<code>.</code>)，感叹号(<code>!</code>)或字符<code>@</code>，<code>&amp;</code>，<code>$</code>，<code>#</code>。</li>
  <li>变量名称的长度不能超过<code>255</code>个字符。</li>
  <li>不能使用Visual Basic保留关键字作为变量名称。</li>
 </ul> 
 <h4 id="h4--strong-strong-"><a name="<strong>语法</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span><strong>语法</strong></h4>
 <p>在VBA中，变量需要在使用它们之前声明。</p> 
 <pre><code class="lang-vb">Dim &lt;&lt;variable_name&gt;&gt; As &lt;&lt;variable_type&gt;&gt;
</code></pre> 
 <h2 id="h2-u6570u636Eu7C7Bu578B"><a name="数据类型" class="reference-link"></a><span class="header-link octicon octicon-link"></span>数据类型</h2>
 <p>有许多VBA数据类型，可以分为两大类，即数字和非数字数据类型。</p> 
 <h4 id="h4-1-"><a name="1. 数字数据类型" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 数字数据类型</h4>
 <p>下表显示数字数据类型和允许的值范围。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>数字类型</th> 
    <th>范围值</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Byte</code></td> 
    <td>0 ~ 255</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Integer</code></td> 
    <td>-32,768 ~ 32,767</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Long</code></td> 
    <td>-2,147,483,648 ~ 2,147,483,648</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Single</code></td> 
    <td>负值：<code>-3.402823E+38 ~ -1.401298E-45</code>，正值： <code>1.401298E-45 ~ 3.402823E+38</code></td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Double</code></td> 
    <td>负值：<code>-1.79769313486232e+308 ~ -4.94065645841247E-324</code>，正值： <code>4.94065645841247E-324 ~ 1.79769313486232e+308</code></td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Currency</code></td> 
    <td>-922,337,203,685,477.5808 ~ 922,337,203,685,477.5807</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>Decimal</code></td> 
    <td>如果不使用小数，则为<code>+/- 79,228,162,514,264,337,593,543,950,335</code>；如果使用小数，则为：<code>+/- 7.9228162514264337593543950335</code></td> 
   </tr> 
  </tbody> 
 </table> 
 <h4 id="h4-2-"><a name="2. 非数字数据类型" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 非数字数据类型</h4>
 <p>下表显示了非数字数据类型和允许的值范围。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>数字类型</th> 
    <th>范围值</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td>固定长度：<code>String</code></td> 
    <td>1 ~ 65,400个字符</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td>可变长度：<code>String</code></td> 
    <td>0到20亿字符</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Date</code></td> 
    <td>100年1月1日至9999年12月31日</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Boolean</code></td> 
    <td><code>True</code> / <code>False</code></td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Object</code></td> 
    <td>任何嵌入的对象</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Variant (numeric)</code></td> 
    <td>任何大到double的数字值</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>Variant (text)</code></td> 
    <td>与可变长度的<code>string</code>一样。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>在这个示例中，创建一个按钮并命名为<em>“VariablesDemo”</em> 来演示变量的使用。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2111/713111123_24289.png" alt=""></p> 
 <p>参考实现的代码如下 - </p>   
 <pre><code class="lang-vb">Private Sub VariablesDemo()
   Dim password As String

   password = "123456"

   Dim num As Integer
   num = 1234

   Dim BirthDay As Date

   BirthDay = DateValue("1998-10-11")

   MsgBox ("设置的密码是：" &amp; password &amp; Chr(10) &amp; "num的值是：" &amp; num &amp; Chr(10) &amp; "Birthday的值是：" &amp; BirthDay)

End Sub
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2111/800111123_48443.png" alt=""></p>
 <br>      
</div></body></html>