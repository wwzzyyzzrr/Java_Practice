<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VBA事件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在VBA中，要手动更改单元格或单元格值范围时，可以触发事件驱动的编程。 更改事件可能会使事情变得更容易，但您可以非常快速地结束一个完整的格式化页面。VBA中有两种事件 - </p> 
 <ul> 
  <li>工作表事件</li>
  <li>工作簿事件</li>
 </ul> 
 <h2 id="h2-u5DE5u4F5Cu8868u4E8Bu4EF6"><a name="工作表事件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>工作表事件</h2>
 <p>工作表事件在工作表中发生更改时被触发。 它是通过右键单击工作表选项卡并选择<em>“查看代码”</em>，然后粘贴代码来创建的。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/685121107_12999.png" alt=""></p> 
 <p>用户可以选择这些工作表中的每一个，并从下拉列表中选择<em>“工作表”</em>以获取所有支持的工作表事件的列表。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/184121107_56220.png" alt=""></p> 
 <p>以下是可以由用户添加的支持的工作表事件。</p> 
 <pre><code class="lang-vb">Private Sub Worksheet_Activate() 
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)    
Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean) 
Private Sub Worksheet_Calculate() 
Private Sub Worksheet_Change(ByVal Target As Range) 
Private Sub Worksheet_Deactivate() 
Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink) 
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
</code></pre> 
 <h4 id="h4-u4F8Bu5B50"><a name="例子" class="reference-link"></a><span class="header-link octicon octicon-link"></span>例子</h4>
 <p>在这个示例中，只需要双击之前显示一条消息。</p> 
 <pre><code class="lang-vb">Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
   MsgBox ("这是一个双击事件触发提示")
End Sub
</code></pre> 
 <p>双击任何单元格后，消息框将显示给用户，如以下屏幕截图所示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/624121117_78253.png" alt=""></p> 
 <h2 id="h2-u5DE5u4F5Cu7C3Fu4E8Bu4EF6"><a name="工作簿事件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>工作簿事件</h2>
 <p>工作簿事件总是在工作簿发生更改时触发的。可以通过选择“ThisWorkbook”并从下拉列表中选择“workbook”来添加工作簿事件的代码，如下图所示。 </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/956121120_58061.png" alt=""></p> 
 <p>立即将<code>Workbook_open</code>子过程显示给用户，如以下屏幕截图所示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/929121122_30705.png" alt=""></p> 
 <p>以下是可以由用户添加的受支持的工作簿事件。</p>   
 <pre><code class="lang-vb">Private Sub Workbook_AddinUninstall() 
Private Sub Workbook_BeforeClose(Cancel As Boolean) 
Private Sub Workbook_BeforePrint(Cancel As Boolean) 
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) 
Private Sub Workbook_Deactivate() 
Private Sub Workbook_NewSheet(ByVal Sh As Object) 
Private Sub Workbook_Open() 
Private Sub Workbook_SheetActivate(ByVal Sh As Object) 
Private Sub Workbook_SheetBeforeDoubleClick(ByVal Sh As Object, ByVal Target As Range, Cancel As Boolean) 
Private Sub Workbook_SheetBeforeRightClick(ByVal Sh As Object, ByVal Target As Range, Cancel As Boolean) 
Private Sub Workbook_SheetCalculate(ByVal Sh As Object) 
Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range) 
Private Sub Workbook_SheetDeactivate(ByVal Sh As Object) 
Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink) 
Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range) 
Private Sub Workbook_WindowActivate(ByVal Wn As Window) 
Private Sub Workbook_WindowDeactivate(ByVal Wn As Window) 
Private Sub Workbook_WindowResize(ByVal Wn As Window)
</code></pre> 
 <h4 id="h4-u4F8Bu5B50"><a name="例子" class="reference-link"></a><span class="header-link octicon octicon-link"></span>例子</h4>
 <p>只需要向用户显示一条消息，无论何时创建新的工作表，都会成功创建新的工作表。</p> 
 <pre><code class="lang-vb">Private Sub Workbook_NewSheet(ByVal Sh As Object)
   MsgBox "New Sheet Created Successfully"
End Sub
</code></pre> 
 <p>在创建一个新的excel工作表后，会向用户显示一条消息，如以下屏幕截图所示。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/2411/278121127_36924.png" alt=""></p>
 <br>      
</div></body></html>