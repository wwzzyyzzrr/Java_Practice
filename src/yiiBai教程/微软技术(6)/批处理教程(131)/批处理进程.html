<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">批处理进程</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，我们将讨论批处理脚本中涉及的各种进程。</p> 
 <h2 id="h2-1-"><a name="1. 查看正在运行的进程列表" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 查看正在运行的进程列表</h2>
 <p>在批处理脚本中，可以使用<code>TASKLIST</code>命令来获取系统中当前正在运行的进程的列表。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-bat">TASKLIST [/S system [/U username [/P [password]]]] [/M [module] | /SVC | /V] [/FI filter]
[/FO format] [/NH]
</code></pre> 
 <p>以下是<code>TASKLIST</code>命令的选项的说明。</p> 
 <ul> 
  <li><em>/S system</em> - 指定要连接的远程系统。</li>
  <li><em>/U [domain]user</em> - 指定命令应在其下执行的用户上下文。</li>
  <li><em>/P [password]</em> - 指定给定用户上下文的密码。 提示输入，如果省略。</li>
  <li><em>/M [module]</em> - 列出当前使用给定的<code>exe / dll</code>名称的所有任务。 如果未指定模块名称，则显示所有已加载的模块。</li>
  <li><em>/SVC</em> - 显示每个进程中托管的服务。</li>
  <li><em>/V</em> - 显示详细的任务信息。</li>
  <li><em>/FI filter</em> - 显示一组符合过滤器指定条件的任务。</li>
  <li><em>/FO format</em> - 指定输出格式。 有效值:<code>TABLE</code>，<code>LIST</code>，<code>CSV</code>。</li>
  <li><em>/NH</em> - 指定“列标题”不应显示在输出中。 仅适用于<code>TABLE</code>和<code>CSV</code>格式。</li>
 </ul> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-bat">TASKLIST
</code></pre> 
 <p>以上命令将获得本地系统上运行的所有进程的列表。 以下是当上面的命令按原样运行时所呈现的输出的快照。 正如你从下面的输出中看到的，不仅可以获得系统上运行的各种进程，还可以获得每个进程的内存使用情况。</p> 
 <pre><code class="lang-shell">
映像名称                       PID 会话名              会话#       内存使用 
========================= ======== ================ =========== ============
System Idle Process              0 Services                   0          8 K
System                           4 Services                   0        136 K
smss.exe                       396 Services                   0        936 K
csrss.exe                      568 Services                   0      4,524 K
wininit.exe                    656 Services                   0      5,328 K
csrss.exe                      668 Console                    1      4,884 K
winlogon.exe                   764 Console                    1      8,060 K
services.exe                   884 Services                   0      9,320 K
lsass.exe                      892 Services                   0     13,112 K
...... 进程太多了，此处省略部分~
svchost.exe                  12092 Services                   0     20,284 K
svchost.exe                  10536 Services                   0      9,520 K
chrome.exe                   11416 Console                    1    212,284 K
chrome.exe                    4564 Console                    1     10,520 K
chrome.exe                    9824 Console                    1     10,320 K
chrome.exe                   11984 Console                    1     98,216 K
chrome.exe                   12080 Console                    1     23,632 K
svchost.exe                  10920 Services                   0      8,608 K
svchost.exe                   1656 Services                   0      6,948 K
tasklist.exe                  2456 Console                    1      8,044 K
</code></pre> 
 <p><strong>示例2</strong></p> 
 <pre><code class="lang-bat">tasklist &gt; process.txt
</code></pre> 
 <p>以上将<code>tasklist</code>命令的输出显示保存到<code>process.txt</code>文件中。</p> 
 <pre><code class="lang-bat">tasklist /fi "memusage gt 40000"
</code></pre> 
 <p>以上命令只能获取内存大于<code>40MB</code>的进程。 以下是示例的输出。</p> 
 <pre><code class="lang-shell">映像名称                       PID 会话名              会话#       内存使用
========================= ======== ================ =========== ============
svchost.exe                   1936 Services                   0     73,556 K
Memory Compression            2032 Services                   0    149,736 K
java.exe                      8944 Services                   0     62,328 K
explorer.exe                  9544 Console                    1    105,484 K
ShellExperienceHost.exe      10028 Console                    1     57,696 K
SearchUI.exe                 10160 Console                    1     64,624 K
chrome.exe                   11416 Console                    1    203,356 K
chrome.exe                   11984 Console                    1     97,624 K
chrome.exe                   11360 Console                    1    309,812 K
QQ.exe                       11672 Console                    1    182,020 K
WeChat.exe                    4952 Console                    1     58,820 K
chrome.exe                    1240 Console                    1     80,776 K
chrome.exe                   10280 Console                    1    133,196 K
chrome.exe                   10684 Console                    1    108,056 K
chrome.exe                    4644 Console                    1     48,396 K
chrome.exe                    2232 Console                    1     97,652 K
</code></pre> 
 <h2 id="h2-2-"><a name="2. 杀死/终止一个进程" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 杀死/终止一个进程</h2>
 <p>允许运行Microsoft Windows XP Professional，Windows 2003或更高版本的用户通过进程ID(PID)或映像名称从Windows命令行中终止任务。 杀死/终止一个进程的命令是<code>TASKILL</code>命令。</p> 
 <p><strong>语法</strong></p>   
 <pre><code class="lang-bat">TASKKILL [/S system [/U username [/P [password]]]] { [/FI filter] 
[/PID processid | /IM imagename] } [/T] [/F]
</code></pre> 
 <p>以下是<code>TASKKILL</code>命令的选项的描述。</p> 
 <ul> 
  <li><em>/S system</em> - 指定要连接的远程系统</li>
  <li><em>/U [domain]user</em> - 指定命令应在其下执行的用户上下文。</li>
  <li><em>/P [password]</em> - 指定给定用户上下文的密码。 提示输入，如果省略。</li>
  <li><em>/FI FilterName</em> - 应用过滤器来选择一组任务，允许使用<code>*</code>通配符。</li>
  <li><em>/PID processID</em> - 指定要终止的进程的PID。使用<code>TaskList</code>来获取PID。</li>
  <li><em>/IM ImageName</em> - 指定要终止的进程的映像名称。 通配符<code>*</code>可用于指定所有任务或图像名称。</li>
  <li><em>/T</em> - 终止指定的进程以及由其启动的任何子进程。</li>
  <li><em>/F</em> - 指定强制终止进程。</li>
 </ul> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-bat">taskkill /f /im notepad.exe
</code></pre> 
 <p>如果打开记事本，上面的命令杀死(终止)打开的记事本任务。</p> 
 <pre><code class="lang-bat">taskill /pid 9901
</code></pre> 
 <p>上面的命令杀死了一个ID为<code>9901</code>的进程。</p> 
 <h2 id="h2-3-"><a name="3. 启动一个新的过程" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3. 启动一个新的过程</h2>
 <p>DOS脚本也可以完全启动一个新的进程。这是通过使用<code>START</code>命令来实现的。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-bat">START "title" [/D path] [options] "command" [parameters]
</code></pre> 
 <p>其中，</p> 
 <ul> 
  <li><em>title</em> - CMD窗口标题栏的文本(必需)</li>
  <li><em>path</em> - 起始目录。</li>
  <li><em>command</em> - 命令，批处理文件或可执行程序运行。</li>
  <li><em>parameters</em> - 传递给命令的参数。</li>
 </ul> 
 <p>以下是<code>START</code>命令的选项的描述。</p> 
 <ul> 
  <li><em>/MIN</em> - 启动窗口最小化。</li>
  <li><em>/MAX</em> - 启动窗口最大化。</li>
  <li><em>/LOW</em> - 使用<code>IDLE</code>优先级。</li>
  <li><em>/NORMAL</em> - 使用<code>NORMAL</code>优先级。</li>
  <li><em>/ABOVENORMAL</em> - 使用<code>ABOVENORMAL</code>优先级。</li>
  <li><em>/BELOWNORMAL</em> - 使用<code>BELOWNORMAL</code>优先级。</li>
  <li><em>/HIGH</em> - 使用<code>HIGH</code>优先级。</li>
  <li><em>/REALTIME</em> - 使用<code>REALTIME</code>优先级。</li>
 </ul> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-bat">START "Test Batch Script" /Min test.bat
</code></pre> 
 <p>上述命令将在新窗口中运行批处理脚本<code>test.bat</code>。 窗口将以最小化模式启动，并且指定标题为:<em>“Test Batch Script”</em>。</p> 
 <pre><code class="lang-bat">START "" "C:\Program Files\Microsoft Office\Winword.exe" "D:\test\TESTA.txt"
</code></pre> 
 <p>上述命令实际上将在另一个进程中运行<code>Microsoft Word</code>，然后在MS Word中打开文件<code>TESTA.txt</code>。</p>
 <br>      
</div></body></html>