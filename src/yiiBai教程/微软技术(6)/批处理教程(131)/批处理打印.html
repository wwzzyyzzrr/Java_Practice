<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">批处理打印</h1><div style="width:100%;float:left;" class="article-content">   
 <p>也可以通过<code>NET PRINT</code>命令从批处理脚本中控制打印。</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-bat">PRINT [/D:device] [[drive:][path]filename[...]]
</code></pre> 
 <p>其中，<code>/D:device</code> - 指定打印设备。</p> 
 <p><strong>示例</strong></p> 
 <pre><code class="lang-bat">print c:\example.txt /c /d:lpt1
</code></pre> 
 <p>上述命令将打印<code>example.txt</code>文件到并行端口<code>lpt1</code>。</p> 
 <h2 id="h2-u547Du4EE4u884Cu6253u5370u673Au63A7u5236"><a name="命令行打印机控制" class="reference-link"></a><span class="header-link octicon octicon-link"></span>命令行打印机控制</h2>
 <p>从Windows 2000开始，可以使用<code>PRINTUI.DLL</code>和<code>RUNDLL32.EXE</code>从Windows的命令行配置许多但不是全部的打印机设置</p> 
 <p><strong>语法</strong></p> 
 <pre><code class="lang-bat">RUNDLL32.EXE PRINTUI.DLL,PrintUIEntry [ options ] [ @commandfile ]
</code></pre> 
 <p>有一些可用的选项是以下 -</p> 
 <ul> 
  <li><em>/dl</em> - 删除本地打印机。</li>
  <li><em>/dn</em> - 删除网络打印机连接。</li>
  <li><em>/dd</em> - 删除打印机驱动。</li>
  <li><em>/e</em> - 显示打印首选项。</li>
  <li><em>/f[file]</em> - <code>inf</code>文件或输出文件。</li>
  <li><em>/F[file] </em> - INF文件使用<code>/f</code>指定的INF文件的位置。</li>
  <li><em>/ia</em> - 使用<code>inf</code>文件安装打印机驱动程序。</li>
  <li><em>/id</em> - 使用添加打印机驱动程序向导安装打印机。</li>
  <li><em>/if</em> - 使用<code>inf</code>文件安装打印机。</li>
  <li><em>/ii</em> - 使用添加打印机向导与<code>inf</code>文件安装打印机。</li>
  <li><em>/il</em> - 用添加打印机向导安装打印机。</li>
  <li><em>/ip</em> - 使用网络打印机安装向导安装打印机。</li>
  <li><em>/k</em> - 将测试页打印到指定的打印机，安装打印机时不能与命令组合。</li>
  <li><em>/l[path]</em> - 打印机驱动程序源路径。</li>
  <li><em>/m[model]</em> - 打印机驱动程序型号名称。</li>
  <li><em>/n[name]</em> - 打印机名称。</li>
  <li><em>/o</em> - 显示打印机队列视图。</li>
  <li><em>/p</em> - 显示打印机属性。</li>
  <li><em>/Ss</em> - 将打印机设置存储到文件中。</li>
  <li><em>/Sr</em> - 从文件恢复打印机设置。</li>
  <li><em>/y</em> - 将打印机设置为默认值。</li>
  <li><em>/Xg</em> - 获取打印机设置。</li>
  <li><em>/Xs</em> - 设置打印机设置。</li>
 </ul> 
 <h2 id="h2-u6D4Bu8BD5u6253u5370u673Au662Fu5426u5B58u5728"><a name="测试打印机是否存在" class="reference-link"></a><span class="header-link octicon octicon-link"></span>测试打印机是否存在</h2>
 <p>有些情况下，可能会连接到网络打印机而不是本地打印机。 在这种情况下，在打印之前首先检查打印机是否存在是很有必要的。</p> 
 <p>可以使用<code>RUNDLL32.EXE PRINTUI.DLL</code>来评估打印机的存在，该文件用于控制大部分的打印机设置。</p> 
 <p><strong>示例</strong></p>   
 <pre><code class="lang-bat">SET PrinterName=Test Printer
SET file=%TEMP%\Prt.txt
RUNDLL32.EXE PRINTUI.DLL,PrintUIEntry /Xg /n "%PrinterName%" /f "%file%" /q

IF EXIST "%file%" (
   ECHO %PrinterName% printer exists
) ELSE (
   ECHO %PrinterName% printer does NOT exists
)
</code></pre> 
 <p>上面的命令将执行以下操作 -</p> 
 <ul> 
  <li>它将首先设置打印机名称并设置将保存打印机设置的文件名。</li>
  <li><code>RUNDLL32.EXE PRINTUI.DLL</code>命令将用于通过将文件的配置设置发送到文件<code>Prt.txt</code>来检查打印机是否存在。</li>
 </ul>
 <br>      
</div></body></html>