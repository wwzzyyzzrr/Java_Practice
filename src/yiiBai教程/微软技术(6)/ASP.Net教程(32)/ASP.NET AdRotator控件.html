<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ASP.NET AdRotator控件</h1><div style="width:100%;float:left;" class="article-content">   
 <p><code>AdRotator</code>控件从列表中随机选择横幅图形，该列表在外部XML计划文件中指定。 这个外部XML计划文件被称为广告文件。</p> 
 <p><code>AdRotator</code>控件可分别指定广告文件和链接应在广告文件和目标属性中应遵循的窗口类型。</p> 
 <p>添加<code>AdRotator</code>的基本语法如下：</p> 
 <pre><code class="lang-aspnet">&lt;asp:AdRotator  runat = "server" AdvertisementFile = "adfile.xml"  Target =  "_blank" /&gt;
</code></pre> 
 <p>在深入了解<code>AdRotator</code>控件及其属性的细节之前，让我们来看看广告文件的构造。</p> 
 <h2 id="h2-u5E7Fu544Au6587u4EF6"><a name="广告文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>广告文件</h2>
 <p>广告文件是一个XML文件，其中包含有关要显示的广告的信息。</p> 
 <p>可扩展标记语言(XML)是用于文本文档标记的W3C标准。 这是一种基于文本的标记语言，使您可以使用有意义的标记以结构化格式存储数据。术语“可扩展”表示可通过为应用程序定义有意义的标签来扩展描述文档的能力。</p> 
 <p>XML本身不是一种语言，比如HTML，而是一套创建新的标记语言的规则。 这是一种元标记语言。 它允许开发人员为特殊用途创建自定义标签集。它构建，存储和传输信息。</p> 
 <p>以下是XML文件的示例：</p> 
 <pre><code class="lang-aspnet">&lt;BOOK&gt;
   &lt;NAME&gt; 如何深入学习ASP.Net &lt;/NAME&gt;
   &lt;AUTHOR&gt; Max Peter &lt;/AUTHOR&gt;
   &lt;PUBLISHER&gt; 易百教程 &lt;/PUBLISHER&gt;
   &lt;PRICE&gt; ￥139.00&lt;/PRICE&gt;
&lt;/BOOK&gt;
</code></pre> 
 <p>像所有的XML文件一样，广告文件需要是一个结构化的文本文件，其中定义了描述数据的标签。 在广告文件中有以下常用的标准XML元素：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>元素</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Advertisements</code></td> 
    <td>封闭广告文件。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Ad</code></td> 
    <td>分隔广告。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>ImageUrl</code></td> 
    <td>将要显示的图像的路径。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>NavigateUrl</code></td> 
    <td>用户点击广告时将遵循的链接。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>AlternateText</code></td> 
    <td>如果无法显示图片，则使用此文字显示代替。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Keyword</code></td> 
    <td>标识一组广告的关键字，这主要用于过滤。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Impressions</code></td> 
    <td>该数字表示广告将出现的频率。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Height</code></td> 
    <td>要显示的图像的高度。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Width</code></td> 
    <td>要显示的图像的宽度。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>除了这些标签之外，还可以包含具有自定义属性的自定义标签。 以下代码演示了广告文件：<em>ads.xml</em>：</p> 
 <pre><code class="lang-xml">&lt;Advertisements&gt;
   &lt;Ad&gt;
      &lt;ImageUrl&gt;rose1.jpg&lt;/ImageUrl&gt;
      &lt;NavigateUrl&gt;http://www.1800flowers.com&lt;/NavigateUrl&gt;
      &lt;AlternateText&gt;
         Order flowers, roses, gifts and more
      &lt;/AlternateText&gt;
      &lt;Impressions&gt;20&lt;/Impressions&gt;
      &lt;Keyword&gt;flowers&lt;/Keyword&gt;
   &lt;/Ad&gt;

   &lt;Ad&gt;
      &lt;ImageUrl&gt;rose2.jpg&lt;/ImageUrl&gt;
      &lt;NavigateUrl&gt;http://www.babybouquets.com&lt;/NavigateUrl&gt;
      &lt;AlternateText&gt;Order roses and flowers&lt;/AlternateText&gt;
      &lt;Impressions&gt;20&lt;/Impressions&gt;
      &lt;Keyword&gt;gifts&lt;/Keyword&gt;
   &lt;/Ad&gt;

   &lt;Ad&gt;
      &lt;ImageUrl&gt;rose3.jpg&lt;/ImageUrl&gt;
      &lt;NavigateUrl&gt;http://www.flowers2moscow.com&lt;/NavigateUrl&gt;
      &lt;AlternateText&gt;Send flowers to Russia&lt;/AlternateText&gt;
      &lt;Impressions&gt;20&lt;/Impressions&gt;
      &lt;Keyword&gt;russia&lt;/Keyword&gt;
   &lt;/Ad&gt;

   &lt;Ad&gt;
      &lt;ImageUrl&gt;rose4.jpg&lt;/ImageUrl&gt;
      &lt;NavigateUrl&gt;http://www.edibleblooms.com&lt;/NavigateUrl&gt;
      &lt;AlternateText&gt;Edible Blooms&lt;/AlternateText&gt;
      &lt;Impressions&gt;20&lt;/Impressions&gt;
      &lt;Keyword&gt;gifts&lt;/Keyword&gt;
   &lt;/Ad&gt;
&lt;/Advertisements&gt;
</code></pre> 
 <h2 id="h2-adrotator-"><a name="AdRotator类的属性和事件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>AdRotator类的属性和事件</h2>
 <p><code>AdRotator</code>类是从<code>WebControl</code>类派生的，并继承了它的属性。 除此之外，<code>AdRotator</code>类具有以下属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>AdvertisementFile</code></td> 
    <td>广告文件的路径。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>AlternateTextFeild</code></td> 
    <td>提供替代文本的字段的元素名称。默认值是：<code>AlternateText</code>。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DataMember</code></td> 
    <td>不使用广告文件时，要绑定的特定数据列表的名称。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>DataSource</code></td> 
    <td>从哪里检索数据的控件。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>DataSourceID</code></td> 
    <td>从哪里检索数据的控件ID。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Font</code></td> 
    <td>指定与广告横幅控件关联的字体属性。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>ImageUrlField</code></td> 
    <td>提供图像的URL的字段的元素名称。默认值是<code>ImageUrl</code>。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>KeywordFilter</code></td> 
    <td>仅用于显示基于关键字的广告。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>NavigateUrlField</code></td> 
    <td>提供了要导航到的URL的字段的元素名称。 默认值是<code>NavigateUrl</code>。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>Target</code></td> 
    <td>显示链接页面内容的浏览器窗口或框架。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>UniqueID</code></td> 
    <td>获取<code>AdRotator</code>控件的唯一的，分层限定的标识符。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>以下是<code>AdRotator</code>类的重要事件：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>事件</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>AdCreated</code></td> 
    <td>在创建控件之后，每次往返服务器一次，但在页面呈现之前，它会被发生。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>DataBinding</code></td> 
    <td>在服务器控件绑定到数据源时发生。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DataBound</code></td> 
    <td>在服务器控件绑定到数据源之后发生。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Disposed</code></td> 
    <td>在服务器控件从内存中释放时发生，这是请求ASP.NET页面时服务器控件生命周期的最后一个阶段。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Init</code></td> 
    <td>在服务器控件初始化时发生，这是生命周期的第一步。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Load</code></td> 
    <td>在服务器控件加载到<code>Page</code>对象中时发生。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>PreRender</code></td> 
    <td>在加载控件对象之后但在呈现之前发生。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>Unload</code></td> 
    <td>在服务器控件从内存中卸载时发生。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2--adrotator-"><a name="使用AdRotator控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>使用AdRotator控件</h2>
 <p>创建一个新的网页，并在其上放置一个<code>AdRotator</code>控件。</p>   
 <pre><code class="lang-aspnet">&lt;form id="form1" runat="server"&gt;
   &lt;div&gt;
      &lt;asp:AdRotator ID="AdRotator1" runat="server" AdvertisementFile  ="~/ads.xml" onadcreated="AdRotator1_AdCreated" /&gt;
   &lt;/div&gt;
&lt;/form&gt;
</code></pre> 
 <p><code>ads.xml</code>文件和图像文件应位于网站的根目录中。尝试执行上述应用程序，并观察每次页面重新加载时，广告就会改变。</p>
 <br>      
</div></body></html>