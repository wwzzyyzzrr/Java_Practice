<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">ASP.NET日历控件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>日历控件是一个功能丰富的Web控件，它提供了以下功能：</p> 
 <ul> 
  <li>每次显示一个月</li>
  <li>选择一天，一周或一个月</li>
  <li>选择一个天数的范围</li>
  <li>逐月移动</li>
  <li>以编程方式控制日期的显示</li>
 </ul> 
 <p>日历控件的基本语法是：</p> 
 <pre><code class="lang-aspnet">&lt;asp:Calender ID = "Calendar1" runat = "server"&gt;
&lt;/asp:Calender&gt;
</code></pre> 
 <h2 id="h2-u65E5u5386u63A7u4EF6u7684u5C5Eu6027u548Cu4E8Bu4EF6"><a name="日历控件的属性和事件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>日历控件的属性和事件</h2>
 <p>日历控件具有许多属性和事件，使用它们可以自定义控件的操作和显示。 下表提供了<code>Calendar</code>控件的一些重要属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Caption</code></td> 
    <td>获取或设置日历控件的标题。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>CaptionAlign</code></td> 
    <td>获取或设置标题的对齐方式。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>CellPadding</code></td> 
    <td>获取或设置数据与单元格边框之间的空格数。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>CellSpacing</code></td> 
    <td>获取或设置单元格之间的空间。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>DayHeaderStyle</code></td> 
    <td>获取显示星期几的部分的样式属性。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>DayNameFormat</code></td> 
    <td>获取或设置一周中的几天的格式。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>DayStyle</code></td> 
    <td>获取显示的月份中日期的样式属性。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>FirstDayOfWeek</code></td> 
    <td>获取或设置要在第一列中显示的是星期几。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>NextMonthText</code></td> 
    <td>获取或设置下个月导航控件的文本。 默认值是字符：<code>&gt;</code></td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>NextPrevFormat</code></td> 
    <td>获取或设置下个月和上个月的导航控件的格式。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>OtherMonthDayStyle</code></td> 
    <td>获取日历控件上不在显示的月份中的日子的样式属性。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>PrevMonthText</code></td> 
    <td>获取或设置上个月导航控件的文本。默认值是字符：<code>&lt;</code>。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>SelectedDate</code></td> 
    <td>获取或设置选定的日期。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>SelectedDates</code></td> 
    <td>获取表示所选日期的<code>DateTime</code>对象的集合。</td> 
   </tr> 
   <tr> 
    <td>15</td> 
    <td><code>SelectedDayStyle</code></td> 
    <td>获取所选日期的样式属性。</td> 
   </tr> 
   <tr> 
    <td>16</td> 
    <td><code>SelectionMode</code></td> 
    <td>获取或设置选择模式，该模式指定用户是可以选择一天，一周还是整个月份。</td> 
   </tr> 
   <tr> 
    <td>17</td> 
    <td><code>SelectMonthText</code></td> 
    <td>获取或设置选择器列中月份选择元素的文本。</td> 
   </tr> 
   <tr> 
    <td>18</td> 
    <td><code>SelectorStyle</code></td> 
    <td>获取周和月选择器列的样式属性。</td> 
   </tr> 
   <tr> 
    <td>19</td> 
    <td><code>SelectWeekText</code></td> 
    <td>获取或设置在选择器列中为星期选择元素显示的文本。</td> 
   </tr> 
   <tr> 
    <td>20</td> 
    <td><code>ShowDayHeader</code></td> 
    <td>获取或设置指示是否显示星期几的标题的值。</td> 
   </tr> 
   <tr> 
    <td>21</td> 
    <td><code>ShowGridLines</code></td> 
    <td>获取或设置指示是否显示网格线的值。</td> 
   </tr> 
   <tr> 
    <td>22</td> 
    <td><code>ShowNextPrevMonth</code></td> 
    <td>获取或设置一个值，该值指示标题部分中是否显示下个月和上个月的导航元素。</td> 
   </tr> 
   <tr> 
    <td>23</td> 
    <td><code>ShowTitle</code></td> 
    <td>获取或设置一个值，指示是否显示标题部分。</td> 
   </tr> 
   <tr> 
    <td>24</td> 
    <td><code>TitleFormat</code></td> 
    <td>获取或设置标题部分的格式。</td> 
   </tr> 
   <tr> 
    <td>25</td> 
    <td><code>Titlestyle</code></td> 
    <td>获取日历控件标题标题的样式属性。</td> 
   </tr> 
   <tr> 
    <td>26</td> 
    <td><code>TodayDayStyle</code></td> 
    <td>获取日历控件上今天日期的样式属性。</td> 
   </tr> 
   <tr> 
    <td>27</td> 
    <td><code>TodaysDate</code></td> 
    <td>获取或设置今天的日期值。</td> 
   </tr> 
   <tr> 
    <td>28</td> 
    <td><code>UseAccessibleHeader</code></td> 
    <td>获取或设置一个值，该值指示是否为日期标题呈现表格标题<code>&lt;th&gt;</code> HTML元素，而不是表格数据<code>&lt;td&gt;</code> HTML元素。</td> 
   </tr> 
   <tr> 
    <td>29</td> 
    <td><code>VisibleDate</code></td> 
    <td>获取或设置指定要显示的月份的日期。</td> 
   </tr> 
   <tr> 
    <td>30</td> 
    <td><code>WeekendDayStyle</code></td> 
    <td>获取<code>Calendar</code>控件上周末日期的样式属性。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>日历控件具有以下三个最重要的事件，允许开发人员对日历控件进行编程。这些事件分别是：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>事件</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>SelectionChanged</code></td> 
    <td>当选择一天，一周或整个月份时引发。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>DayRender</code></td> 
    <td>在日历控件的每个数据单元被渲染时引发。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>VisibleMonthChanged</code></td> 
    <td>当用户更改一个月时引发。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-u4F7Fu7528u65E5u5386u63A7u4EF6"><a name="使用日历控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>使用日历控件</h2>
 <p>可以把没有任何代码的裸露日历控件放在文件后面，为网站提供了一个可行的日历，该日历显示了一年中的几个月和几天。它还允许导航到下个月和前几个月。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0612/310091258_59507.png" alt=""></p> 
 <p>日历控件允许用户选择一天，一周或整个月份。 这是通过使用SelectionMode属性完成的。 该属性具有以下值：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Day</code></td> 
    <td>选择一天。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>DayWeek</code></td> 
    <td>选择一天或一整周。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>DayWeekMonth</code></td> 
    <td>选择一天，一周或整个月份。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>None</code></td> 
    <td>什么都不能选择。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>选择天数的语法：</p>   
 <pre><code class="lang-aspnet">&lt;asp:Calender ID = "Calendar1" runat = "server" SelectionMode="DayWeekMonth"&gt;
&lt;/asp:Calender&gt;
</code></pre> 
 <p>当选择模式设置为值<code>DayWeekMonth</code>时，会出现一个带有<code>&gt;</code>符号的额外列，用于选择星期，而一个<code>&gt;&gt;</code>符号出现在日期名称左边，用来选择月份。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>首先打开<em>Visual Studio</em>，创建一个名称为：<em>CalendarControl</em> 的空ASP.NET网站项目，如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0612/485091225_39224.png" alt=""></p> 
 <p>在这个项目名称上点击右键，在弹出的选项中选择：<em>添加</em> -&gt; <em>添加新项</em>，选择<em>Web窗体</em>，创建一个文件：<em>Default.aspx</em>， 如下所示 -<br><img src="http://www.yiibai.com/uploads/images/201712/0612/899091227_75411.png" alt=""></p> 
 <p>以下示例演示如何选择日期并在标签中显示日期，参考以下文件(<em>Default.aspx</em>)代码的实现 - </p> 
 <pre><code class="lang-aspnet">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %&gt;

&lt;!DOCTYPE html&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;日期控件示例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
       &lt;div&gt;
            &lt;h3&gt; 你的生日:&lt;/h3&gt;
            &lt;asp:Calendar ID="Calendar1" runat="server"  SelectionMode="DayWeekMonth" onselectionchanged="Calendar1_SelectionChanged"&gt;
            &lt;/asp:Calendar&gt;
         &lt;/div&gt;

         &lt;p&gt;今天是: 
            &lt;asp:Label ID="lblday" runat="server"&gt;&lt;/asp:Label&gt;
         &lt;/p&gt;

         &lt;p&gt;你的生日是: 
            &lt;asp:Label ID="lblbday" runat="server"&gt;&lt;/asp:Label&gt;
         &lt;/p&gt;

    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <p>以下是<em>Default.aspx.cs</em>文件代码的实现 - </p> 
 <pre><code class="lang-csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Calendar1_SelectionChanged(object sender, EventArgs e)
    {
        lblday.Text = Calendar1.TodaysDate.ToShortDateString();
        lblbday.Text = Calendar1.SelectedDate.ToShortDateString();
    }
}
</code></pre> 
 <p>运行上面示例代码，得到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201712/0612/101091251_84245.png" alt=""></p>
 <br>      
</div></body></html>