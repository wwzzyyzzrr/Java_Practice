<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net正则表达式</h1><div style="width:100%;float:left;" class="article-content">   
 <p>正则表达式是可以与输入文本进行匹配的模式。<em>.Net</em> 框架提供了允许这种匹配的正则表达式引擎。模式由一个或多个字符文字，运算符或构造组成。</p> 
 <h2 id="h2-u7528u4E8Eu5B9Au4E49u6B63u5219u8868u8FBEu5F0Fu7684u6784u9020"><a name="用于定义正则表达式的构造" class="reference-link"></a><span class="header-link octicon octicon-link"></span>用于定义正则表达式的构造</h2>
 <p>有各种类型的字符，运算符和结构可以让你定义正则表达式。 点击下面的链接来查看这些结构。</p> 
 <ul> 
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_character_escapes.htm" title="字符转义">字符转义</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_character_classes.htm" title="Character类">Character类</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_anchors.htm" title="锚定">锚定</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_grouping_constructs.htm" title="分组结构">分组结构</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_quantifiers.htm" title="量词">量词</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_backreference_constructs.htm" title="反向引用结构">反向引用结构</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_alternation_constructs.htm" title="交替结构">交替结构</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_substitutions.htm" title="替换结构">替换结构</a></li>
  <li><a target="_blank" href="https://www.yiibai.com/vb.net/vb.net_miscellaneous_constructs.htm" title="杂项结构">杂项结构</a></li>
 </ul> 
 <h2 id="h2-regex-"><a name="Regex类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Regex类</h2>
 <p><code>Regex</code>类用于表示正则表达式，<code>Regex</code>类有以下常用的方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Public Function IsMatch (input As String) As Boolean</code></td> 
    <td>指示在<code>Regex</code>构造函数中指定的正则表达式是否在指定的输入字符串中找到匹配项。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Public Function IsMatch (input As String, startat As Integer ) As Boolean</code></td> 
    <td>指示在<code>Regex</code>构造函数中指定的正则表达式是否在指定的输入字符串中找到匹配项，从字符串中的指定起始位置开始匹配。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Public Shared Function IsMatch (input As String, pattern As String ) As Boolean</code></td> 
    <td>指示指定的正则表达式是否在指定的输入字符串中找到匹配项。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Public Function Matches (input As String) As MatchCollection</code></td> 
    <td>在指定的输入字符串中搜索正则表达式的所有匹配项。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Public Function Replace (input As String, replacement As String) As String</code></td> 
    <td>在指定的输入字符串中，用指定的替换字符串替换与正则表达式模式匹配的所有字符串。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Public Function Split (input As String) As String</code></td> 
    <td>在由<code>Regex</code>构造函数中指定的正则表达式模式定义的位置处将输入字符串拆分为一个子字符串数组。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>有关方法和属性的完整列表，请参阅Microsoft文档。</p> 
 <h4 id="h4-1-1"><a name="1. 示例1" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 示例1</h4>
 <p>以下示例匹配以<code>S</code>开头的单词：</p> 
 <pre><code class="lang-vbnet">Imports System.Text.RegularExpressions
Module regexProg
   Sub showMatch(ByVal text As String, ByVal expr As String)
      Console.WriteLine("The Expression: " + expr)
      Dim mc As MatchCollection = Regex.Matches(text, expr)
      Dim m As Match
      For Each m In mc
          Console.WriteLine(m)
      Next m
   End Sub
   Sub Main()
      Dim str As String = "A Thousand Splendid Suns"
      Console.WriteLine("Matching words that start with 'S': ")
      showMatch(str, "\bS\S*")
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p>   
 <pre><code class="lang-shell">Matching words that start with 'S':
The Expression: \bS\S*
Splendid
Suns
</code></pre> 
 <h4 id="h4-2-2"><a name="2. 示例2" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 示例2</h4>
 <p>以下示例匹配以<code>m</code>开始并以<code>e</code>结尾的单词：</p> 
 <pre><code class="lang-vbnet">Imports System.Text.RegularExpressions
Module regexProg
   Sub showMatch(ByVal text As String, ByVal expr As String)
      Console.WriteLine("The Expression: " + expr)
      Dim mc As MatchCollection = Regex.Matches(text, expr)
      Dim m As Match
      For Each m In mc
          Console.WriteLine(m)
      Next m
   End Sub
   Sub Main()
      Dim str As String = "make a maze and manage to measure it"
      Console.WriteLine("Matching words that start with 'm' and ends with 'e': ")
      showMatch(str, "\bm\S*e\b")
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">Matching words start with 'm' and ends with 'e':
The Expression: \bm\S*e\b
make
maze
manage
measure
</code></pre> 
 <h4 id="h4-3-3"><a name="3. 示例3" class="reference-link"></a><span class="header-link octicon octicon-link"></span>3. 示例3</h4>
 <p>这个例子替换额外(多余)的空格符：</p> 
 <pre><code class="lang-vbnet">Imports System.Text.RegularExpressions
Module regexProg
   Sub Main()
      Dim input As String = "Hello    World   "
      Dim pattern As String = "\\s+"
      Dim replacement As String = " "
      Dim rgx As Regex = New Regex(pattern)
      Dim result As String = rgx.Replace(input, replacement)
      Console.WriteLine("Original String: {0}", input)
      Console.WriteLine("Replacement String: {0}", result)
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">Original String: Hello   World   
Replacement String: Hello World
</code></pre>
 <br>      
</div></body></html>