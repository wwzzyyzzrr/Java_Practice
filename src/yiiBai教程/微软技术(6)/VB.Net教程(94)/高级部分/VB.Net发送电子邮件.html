<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net发送电子邮件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>VB.Net应用程序可发送电子邮件。<code>System.Net.Mail</code>名称空间包含用于向简单邮件传输协议(SMTP)服务器发送电子邮件以供传送的类。</p> 
 <p>下表列出了一些常用的类：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>类</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Attachment</code></td> 
    <td>代表电子邮件的附件。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>AttachmentCollection</code></td> 
    <td>将附件存储为电子邮件的一部分。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>MailAddress</code></td> 
    <td>代表电子邮件发件人或收件人的地址。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>MailAddressCollection</code></td> 
    <td>存储与电子邮件关联的电子邮件地址。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>MailMessage</code></td> 
    <td>表示可以使用<code>SmtpClient</code>类发送的电子邮件。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>SmtpClient</code></td> 
    <td>允许应用程序使用简单邮件传输协议(SMTP)发送电子邮件。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>SmtpException</code></td> 
    <td>表示当<code>SmtpClient</code>无法完成<code>Send</code>或<code>SendAsync</code>操作时引发的异常。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-smtpclient-"><a name="SmtpClient类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>SmtpClient类</h2>
 <p><code>SmtpClient</code>类允许应用程序使用简单邮件传输协议(SMTP)发送电子邮件。</p> 
 <p>以下是<code>SmtpClient</code>类的一些常用属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>ClientCertificates</code></td> 
    <td>指定应使用哪些证书来建立安全套接字层(SSL)连接。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Credentials</code></td> 
    <td>获取或设置用于验证发件人的凭证。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>EnableSsl</code></td> 
    <td>指定<code>SmtpClient</code>是否使用安全套接字层(SSL)来加密连接。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Host</code></td> 
    <td>获取或设置用于SMTP事务的主机的名称或IP地址。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Port</code></td> 
    <td>获取或设置用于SMTP事务的端口。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Timeout</code></td> 
    <td>获取或设置一个值，该值指定同步发送呼叫超时之后的时间量。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>UseDefaultCredentials</code></td> 
    <td>获取或设置一个布尔值，该值控制是否使用请求发送<code>DefaultCredentials</code>。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>以下是<code>SmtpClient</code>类的一些常用方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Dispose</code></td> 
    <td>将QUIT消息发送到SMTP服务器，正常结束TCP连接，并释放当前<code>SmtpClient</code>实例使用的所有资源。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Dispose(Boolean)</code></td> 
    <td>将QUIT消息发送到SMTP服务器，正常结束TCP连接，释放<code>SmtpClient</code>类的当前实例使用的所有资源，并可选地处置受管资源。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>OnSendCompleted</code></td> 
    <td>引发<code>SendCompleted</code>事件。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Send(MailMessage)</code></td> 
    <td>将指定的消息发送到SMTP服务器进行传送。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Send(String, String, String, String)</code></td> 
    <td>将指定的电子邮件发送到SMTP服务器进行传送。 邮件发件人，收件人，主题和邮件正文使用<code>String</code>对象指定。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>SendAsync(MailMessage, Object)</code></td> 
    <td>将指定的电子邮件发送到SMTP服务器进行传送。 此方法不会阻塞调用线程，并允许调用方将对象传递给操作完成时调用的方法。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>SendAsync(String, String, String, String, Object)</code></td> 
    <td>发送电子邮件到SMTP服务器进行传送。 邮件发件人，收件人，主题和邮件正文使用<code>String</code>对象指定。 此方法不会阻塞调用线程，并允许调用方将对象传递给操作完成时调用的方法。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>SendAsyncCancel</code></td> 
    <td>取消异步操作以发送电子邮件。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>SendMailAsync(MailMessage)</code></td> 
    <td>将指定的消息发送到SMTP服务器以作为异步操作进行传送。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>SendMailAsync(String, String, String, String)</code></td> 
    <td>将指定的消息发送到SMTP服务器以作为异步操作进行传送。邮件发件人，收件人，主题和邮件正文使用<code>String</code>对象指定。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>ToString</code></td> 
    <td>返回表示当前对象的字符串。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>以下示例演示如何使用<code>SmtpClient</code>类发送邮件。 以下几点需要注意：</p> 
 <ul> 
  <li>必须指定用于发送电子邮件的SMTP主机服务器。主机和端口属性对于不同的主机服务器是不同的。这个示例中将使用QQ邮件服务器。</li>
  <li>如果SMTP服务器需要，需要为 <code>Credentials</code> 颁发证书。</li>
  <li>分别使用<code>MailMessage.From</code>和<code>MailMessage.To</code>属性提供发件人的电子邮件地址和收件人的电子邮件地址。</li>
  <li>使用<code>MailMessage.Body</code>属性指定邮件内容。</li>
 </ul> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>  
 <p>在这个例子中，创建一个简单的应用程序来发送电子邮件。参考以下步骤：</p> 
 <ul> 
  <li>在窗体中添加三个标签，三个文本框和一个按钮控件。</li>
  <li>将标签的<code>Text</code>属性分别更改为：<em>“发送者：”</em>，<em>“接收者：”</em>和<em>“邮件内容：”</em>。</li>
  <li>将文本的<code>Name</code>属性分别更改为：<code>txtFrom</code>，<code>txtTo</code>和<code>txtMessage</code>。</li>
  <li>将按钮控件的<code>Text</code>属性更改为<em>“发送”</em></li>
 </ul> 
 <p>设计窗体的效果如下所示 - </p> 
 <p>在代码编辑器中添加下面的代码 - </p> 
 <pre><code class="lang-vbnet">Imports System.Net.Mail

Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ' Set the caption bar text of the form.   
        txtFrom.Text = "769728683@qq.com"
        txtTo.Text = "769728683@qq.com"
        Me.Text = "VB.Net发送邮件示例-yiibai.com"
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Try
            'Dim Smtp_Server As New SmtpClient 
            Dim smtp As New System.Net.Mail.SmtpClient("smtp.qq.com", 25)
            Dim mail As New System.Net.Mail.MailMessage()

            smtp.UseDefaultCredentials = False
            smtp.Credentials = New System.Net.NetworkCredential("29888814@qq.com", "zrp29888814encaei")

            mail.Subject = "邮件主题a"
            mail.SubjectEncoding = System.Text.Encoding.UTF8
            mail.BodyEncoding = System.Text.Encoding.UTF8
            mail.From = New System.Net.Mail.MailAddress(txtFrom.Text)
            mail.Priority = System.Net.Mail.MailPriority.Normal
            mail.IsBodyHtml = True
            mail.Body = txtMessage.Text
            mail.To.Add(txtTo.Text)

            smtp.Send(mail)
            MsgBox("邮件已发送~！")

        Catch error_t As Exception
            MsgBox(error_t.ToString)
        End Try

    End Sub
End Class
</code></pre> 
 <blockquote> 
  <p>注意：必须提供您的QQ邮箱账号和真实密码的凭据，才能登录SMTP服务器发送邮件。</p> 
 </blockquote> 
 <p>首先我们要知道用VB.Net代理登录QQ邮箱发邮件，是需要更改自己QQ邮箱设置的。在这里大家需要做两件事情：邮箱开启SMTP功能 、获得授权码。下面来看看如何更改模板代码，实现使用VB.Net登录QQ邮箱发送QQ邮件。</p> 
 <blockquote> 
  <p>注意：也可以使用其他服务商的 SMTP 访问(QQ、网易、Gmail等)。</p> 
 </blockquote> 
 <p>使用QQ邮件发送邮件之前如何设置授权码，参考：</p> 
 <p><a target="_blank" href="http://service.mail.qq.com/cgi-bin/help?subtype=1&amp;&amp;id=28&amp;&amp;no=1001256">http://service.mail.qq.com/cgi-bin/help?subtype=1&amp;&amp;id=28&amp;&amp;no=1001256</a></p> 
 <p>当执行上面的代码并使用Microsoft Visual Studio工具栏上的“开始”按钮运行时，它将显示以下窗口，将使用该窗口发送电子邮件，自己尝试。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/759151103_45123.png" alt=""></p>
 <br>      
</div></body></html>