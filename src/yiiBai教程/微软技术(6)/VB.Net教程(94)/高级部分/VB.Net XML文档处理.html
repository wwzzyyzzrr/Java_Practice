<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net XML文档处理</h1><div style="width:100%;float:left;" class="article-content">   
 <p>可扩展标记语言(XML)是一种非常类似于HTML或SGML的标记语言。这是由万维网联盟推荐的，可作为开放标准提供。</p> 
 <p>.Net Framework中的<code>System.Xml</code>命名空间包含用于处理XML文档的类。以下是<code>System.Xml</code>命名空间中的一些常用类。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>类</th> 
    <th>说明</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>XmlAttribute</code></td> 
    <td>代表一个属性。属性的有效值和默认值是在文档类型定义(DTD)或模式中定义的。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>XmlCDataSection</code></td> 
    <td>代表CDATA部分。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>XmlCharacterData</code></td> 
    <td>提供几个类使用的文本操作方法。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>XmlComment</code></td> 
    <td>表示XML注释的内容。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>XmlConvert</code></td> 
    <td>对XML名称进行编码和解码，并提供用于在公共语言运行时类型和XML模式定义语言(XSD)类型之间进行转换的方法。转换数据类型时，返回的值是与区域无关的。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>XmlDeclaration</code></td> 
    <td>表示XML声明节点：<code>&lt;?xml version='1.0'...?&gt;</code></td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>XmlDictionary</code></td> 
    <td>实现用于优化Windows Communication Foundation(WCF)的XML读取器/写入器实现的字典。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>XmlDictionaryReader</code></td> 
    <td>Windows Communication Foundation(WCF)从<code>XmlReader</code>派生的抽象类，用于执行序列化和反序列化。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>XmlDictionaryWriter</code></td> 
    <td>表示Windows Communication Foundation(WCF)从<code>XmlWriter</code>派生的一个抽象类，用于执行序列化和反序列化。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>XmlDocument</code></td> 
    <td>代表一个XML文档。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>XmlDocumentFragment</code></td> 
    <td>表示一个对树插入操作很有用的轻量级对象。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>XmlDocumentType</code></td> 
    <td>表示文档类型声明。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>XmlElement</code></td> 
    <td>代表一个元素。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>XmlEntity</code></td> 
    <td>表示一个实体声明，如:<code>&lt;!ENTITY ...&gt;</code>。</td> 
   </tr> 
   <tr> 
    <td>15</td> 
    <td><code>XmlEntityReference</code></td> 
    <td>代表一个实体参考节点。</td> 
   </tr> 
   <tr> 
    <td>16</td> 
    <td><code>XmlException</code></td> 
    <td>返回有关最后一个异常的详细信息。</td> 
   </tr> 
   <tr> 
    <td>17</td> 
    <td><code>XmlImplementation</code></td> 
    <td>定义一组<code>XmlDocument</code>对象的上下文。</td> 
   </tr> 
   <tr> 
    <td>18</td> 
    <td><code>XmlLinkedNode</code></td> 
    <td>获取该节点之前或之后的节点。</td> 
   </tr> 
   <tr> 
    <td>19</td> 
    <td><code>XmlNode</code></td> 
    <td>表示XML文档中的单个节点。</td> 
   </tr> 
   <tr> 
    <td>20</td> 
    <td><code>XmlNodeList</code></td> 
    <td>表示有序的节点集合。</td> 
   </tr> 
   <tr> 
    <td>21</td> 
    <td><code>XmlNodeReader</code></td> 
    <td>表示一个读取器，它提供对XmlNode中XML数据的快速，非缓存向前访问。</td> 
   </tr> 
   <tr> 
    <td>22</td> 
    <td><code>XmlNotation</code></td> 
    <td>代表符号声明，例如：<code>&lt;!NOTATION... &gt;</code></td> 
   </tr> 
   <tr> 
    <td>23</td> 
    <td><code>XmlParserContext</code></td> 
    <td>提供<code>XmlReader</code>解析XML片段所需的所有上下文信息。</td> 
   </tr> 
   <tr> 
    <td>24</td> 
    <td><code>XmlProcessingInstruction</code></td> 
    <td>表示处理指令，XML定义该处理指令以将特定于处理器的信息保存在文档的文本中。</td> 
   </tr> 
   <tr> 
    <td>25</td> 
    <td><code>XmlQualifiedName</code></td> 
    <td>表示一个XML限定名称。</td> 
   </tr> 
   <tr> 
    <td>26</td> 
    <td><code>XmlReader</code></td> 
    <td>表示一种对XML数据提供快速，非缓存，只前向访问的读取器。</td> 
   </tr> 
   <tr> 
    <td>27</td> 
    <td><code>XmlReaderSettings</code></td> 
    <td>指定一组要在<code>Create</code>方法创建的<code>XmlReader</code>对象上支持的功能。</td> 
   </tr> 
   <tr> 
    <td>28</td> 
    <td><code>XmlResolver</code></td> 
    <td>解析由统一资源标识符(URI)命名的外部XML资源。</td> 
   </tr> 
   <tr> 
    <td>29</td> 
    <td><code>XmlSecureResolver</code></td> 
    <td>通过包装<code>XmlResolver</code>对象并限制底层<code>XmlResolver</code>可以访问的资源来帮助确保<code>XmlResolver</code>的另一个实现。</td> 
   </tr> 
   <tr> 
    <td>30</td> 
    <td><code>XmlSignificantWhitespace</code></td> 
    <td>表示混合内容节点中的标记或<code>xml:space= 'preserve'</code>范围内的空白之间的空白区域。这也被称为重要的空白。</td> 
   </tr> 
   <tr> 
    <td>31</td> 
    <td><code>XmlText</code></td> 
    <td>表示元素或属性的文本内容。</td> 
   </tr> 
   <tr> 
    <td>32</td> 
    <td><code>XmlTextReader</code></td> 
    <td>表示一种提供对XML数据的快速，非缓存，只进的访问的读取器。</td> 
   </tr> 
   <tr> 
    <td>33</td> 
    <td><code>XmlTextWriter</code></td> 
    <td>表示一个写入器，它提供了一种快速的，非缓存的，只能转发的方式来生成包含符合W3C可扩展标记语言(XML)1.0和XML建议中命名空间的XML数据的流或文件。</td> 
   </tr> 
   <tr> 
    <td>34</td> 
    <td><code>XmlUrlResolver</code></td> 
    <td>解析由统一资源标识符(URI)命名的外部XML资源。</td> 
   </tr> 
   <tr> 
    <td>35</td> 
    <td><code>XmlWhitespace</code></td> 
    <td>表示元素内容中的空格。</td> 
   </tr> 
   <tr> 
    <td>36</td> 
    <td><code>XmlWriter</code></td> 
    <td>代表一个写入器，它提供了一种快速，非缓存，只能生成包含XML数据的流或文件的方法。</td> 
   </tr> 
   <tr> 
    <td>37</td> 
    <td><code>XmlWriterSettings</code></td> 
    <td>指定一组要在<code>XmlWriter.Create</code>方法创建的<code>XmlWriter</code>对象上支持的功能。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-xml-api"><a name="XML解析器API" class="reference-link"></a><span class="header-link octicon octicon-link"></span>XML解析器API</h2>
 <p>XML数据的两个最基本和广泛使用的API是：SAX和DOM接口。</p> 
 <ul> 
  <li><em>简单的XML(SAX)API</em>：在这里，只为感兴趣的事件注册回调，然后让解析器继续处理文档。 当文档很大或者内存有限制时，这是非常有用的，它在从磁盘读取文件时解析文件，整个文件永远不会存储在内存中。</li>
  <li><em>文档对象模型(DOM)API</em>：这是万维网联盟的建议，其中整个文件被读入内存并以分层(基于树)的形式存储以表示XML文档的所有特征。</li>
 </ul> 
 <p>当处理大文件时，SAX显然不能像DOM那样快速地处理信息。另一方面，单独使用DOM要占用大量资源，特别是在很多小文件上使用的时候。</p> 
 <p>SAX是只读的，而DOM允许更改XML文件。 由于这两个不同的API相互补充，所以一般都将它们用于大型项目。</p> 
 <p>对于这里所有的XML代码示例，我们使用一个简单的XML文件<code>movies.xml</code>作为输入：</p> 
 <pre><code class="lang-xml">&lt;?xml version="1.0"?&gt;

&lt;collection shelf="New Arrivals"&gt;
&lt;movie title="Enemy Behind"&gt;
   &lt;type&gt;War, Thriller&lt;/type&gt;
   &lt;format&gt;DVD&lt;/format&gt;
   &lt;year&gt;2003&lt;/year&gt;
   &lt;rating&gt;PG&lt;/rating&gt;
   &lt;stars&gt;10&lt;/stars&gt;
   &lt;description&gt;Talk about a US-Japan war&lt;/description&gt;
&lt;/movie&gt;
&lt;movie title="Transformers"&gt;
   &lt;type&gt;Anime, Science Fiction&lt;/type&gt;
   &lt;format&gt;DVD&lt;/format&gt;
   &lt;year&gt;1989&lt;/year&gt;
   &lt;rating&gt;R&lt;/rating&gt;
   &lt;stars&gt;8&lt;/stars&gt;
   &lt;description&gt;A schientific fiction&lt;/description&gt;
&lt;/movie&gt;
   &lt;movie title="Trigun"&gt;
   &lt;type&gt;Anime, Action&lt;/type&gt;
   &lt;format&gt;DVD&lt;/format&gt;
   &lt;episodes&gt;4&lt;/episodes&gt;
   &lt;rating&gt;PG&lt;/rating&gt;
   &lt;stars&gt;10&lt;/stars&gt;
   &lt;description&gt;Vash the Stampede!&lt;/description&gt;
&lt;/movie&gt;
&lt;movie title="Ishtar"&gt;
   &lt;type&gt;Comedy&lt;/type&gt;
   &lt;format&gt;VHS&lt;/format&gt;
   &lt;rating&gt;PG&lt;/rating&gt;
   &lt;stars&gt;2&lt;/stars&gt;
   &lt;description&gt;Viewable boredom&lt;/description&gt;
&lt;/movie&gt;
&lt;/collection&gt;
</code></pre> 
 <h2 id="h2--sax-api-xml"><a name="用SAX API解析XML" class="reference-link"></a><span class="header-link octicon octicon-link"></span>用SAX API解析XML</h2>
 <p>在SAX模型中，使用<code>XmlReader</code>和<code>XmlWriter</code>类来处理XML数据。<code>XmlReader</code>类用于以快速，只进和非缓存的方式读取XML数据。它读取一个XML文档或一个流。</p> 
 <h4 id="h4--1"><a name="示例1" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例1</h4>
 <p>这个例子演示了从文件<code>movies.xml</code>中读取XML数据。</p> 
 <ul> 
  <li>在应用程序的<code>bin\Debug</code>文件夹中添加<code>movies.xml</code>文件。</li>
  <li>在<code>Form1.vb</code>文件中导入<code>System.Xml</code>名称空间。</li>
  <li>在窗体中添加一个标签，并将其文本更改为<em>“电影列表”</em>。</li>
  <li>添加三个列表框和三个按钮，以显示来自xml文件的电影的标题，类型和描述。</li>
 </ul> 
 <p>设计的效果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/373171117_47488.png" alt=""></p> 
 <p>使用代码编辑器窗口添加下面的代码。参考代码实现如下 - </p> 
 <pre><code class="lang-vbnet">Imports System.Xml
Public Class Form1

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ' Set the caption bar text of the form.   
        Me.Text = "SAX API读取XML示例1 - yiibai.com"
    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        ListBox1().Items.Clear()
        Dim xr As XmlReader = XmlReader.Create("movies.xml")
        Do While xr.Read()
            If xr.NodeType = XmlNodeType.Element AndAlso xr.Name = "movie" Then
                ListBox1.Items.Add(xr.GetAttribute(0))
            End If
        Loop
    End Sub
    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        ListBox2().Items.Clear()
        Dim xr As XmlReader = XmlReader.Create("movies.xml")
        Do While xr.Read()
            If xr.NodeType = XmlNodeType.Element AndAlso xr.Name = "type" Then
                ListBox2.Items.Add(xr.ReadElementString)
            Else
                xr.Read()
            End If
        Loop
    End Sub
    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        ListBox3().Items.Clear()
        Dim xr As XmlReader = XmlReader.Create("movies.xml")
        Do While xr.Read()
            If xr.NodeType = XmlNodeType.Element AndAlso xr.Name = "description" Then
                ListBox3.Items.Add(xr.ReadElementString)
            Else
                xr.Read()
            End If
        Loop
    End Sub
End Class
</code></pre> 
 <p>使用Microsoft Visual Studio工具栏上的“开始”按钮执行并运行上述代码。 点击按钮将显示文件的标题，类型和电影描述。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/939171120_98946.png" alt=""></p> 
 <p>分别点击下面的几个按钮来加载<em>movies.xml</em> 文件中的对应内容 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/135171121_60783.png" alt=""></p> 
 <p><code>XmlWriter</code>类用于将XML数据写入流，文件或<code>TextWriter</code>对象。它也以只向前，非缓存的方式工作。</p> 
 <h4 id="h4--2"><a name="示例2" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例2</h4>
 <p>这个示例中是通过在运行时添加一些数据来创建一个XML文件。参考以下步骤：</p> 
 <ul> 
  <li>在窗体中添加一个<code>WebBrowser</code>控件和一个按钮(<code>Button</code>)控件。</li>
  <li>将该按钮的Text属性更改为显示作者文件。</li>
 </ul> 
 <p>在代码编辑器中添加下面的代码 - </p> 
 <pre><code class="lang-vbnet">Imports System.Xml
Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ' Set the caption bar text of the form.   
        Me.Text = "写入XML文件 - yiibai.com"
    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim xws As XmlWriterSettings = New XmlWriterSettings()
        xws.Indent = True
        xws.NewLineOnAttributes = True
        Dim xw As XmlWriter = XmlWriter.Create("authors.xml", xws)
        xw.WriteStartDocument()
        xw.WriteStartElement("Authors")
        xw.WriteStartElement("author")
        xw.WriteAttributeString("code", "1")
        xw.WriteElementString("fname", "Su")
        xw.WriteElementString("lname", "Max")
        xw.WriteEndElement()
        xw.WriteStartElement("author")
        xw.WriteAttributeString("code", "2")
        xw.WriteElementString("fname", "Paul")
        xw.WriteElementString("lname", "Sharma")
        xw.WriteEndElement()
        xw.WriteStartElement("author")
        xw.WriteAttributeString("code", "3")
        xw.WriteElementString("fname", "Anshuman")
        xw.WriteElementString("lname", "Curry")
        xw.WriteEndElement()
        xw.WriteStartElement("author")
        xw.WriteAttributeString("code", "4")
        xw.WriteElementString("fname", "张")
        xw.WriteElementString("lname", "爱玲")
        xw.WriteEndElement()
        xw.WriteStartElement("author")
        xw.WriteAttributeString("code", "5")
        xw.WriteElementString("fname", "苏")
        xw.WriteElementString("lname", "琴")
        xw.WriteEndElement()
        xw.WriteEndElement()
        xw.WriteEndDocument()
        xw.Flush()
        xw.Close()
        WebBrowser1.Url = New Uri(AppDomain.CurrentDomain.BaseDirectory + "authors.xml")
    End Sub
End Class
</code></pre> 
 <p>使用Microsoft Visual Studio工具栏上的“开始”按钮执行并运行上述代码。 单击显示作者文件将在Web浏览器上显示新创建的<code>authors.xml</code>文件。运行结果如下图所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/196171128_54391.png" alt=""></p> 
 <p>点击<em>显示作者文件内容</em>，看到以下结果 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/417171129_62046.png" alt=""></p> 
 <h2 id="h2--dom-api-xml"><a name="用DOM API解析XML" class="reference-link"></a><span class="header-link octicon octicon-link"></span>用DOM API解析XML</h2>
 <p>根据文档对象模型(DOM)，XML文档由节点的节点和属性组成。<code>XmlDocument</code>类用于实现.Net Framework的XML DOM解析器。 它还允许通过插入，删除或更新文档中的数据来修改现有的XML文档。</p> 
 <p>以下是<code>XmlDocument</code>类的一些常用方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>AppendChild</code></td> 
    <td>将指定的节点添加到此节点的子节点列表的末尾。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>CreateAttribute(String)</code></td> 
    <td>用指定的名称创建一个<code>XmlAttribute</code>。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>CreateComment</code></td> 
    <td>创建一个包含指定数据的<code>XmlComment</code>。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>CreateDefaultAttribute</code></td> 
    <td>使用指定的前缀，本地名称和名称空间URI创建一个默认属性。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>CreateElement(String)</code></td> 
    <td>用指定的名字创建一个元素。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>CreateNode(String, String, String)</code></td> 
    <td>用指定的节点类型,名称和<code>NamespaceURI</code>创建一个XmlNode。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>CreateNode(XmlNodeType, String, String)</code></td> 
    <td>用指定的<code>XmlNodeType</code>，<code>Name</code>和<code>NamespaceURI</code>创建一个<code>XmlNode</code>。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>CreateNode(XmlNodeType, String, String, String)</code></td> 
    <td>用指定的<code>XmlNodeType</code>，<code>Prefix</code>，<code>Name</code>和<code>NamespaceURI</code>创建一个<code>XmlNode</code>。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>CreateProcessingInstruction</code></td> 
    <td>用指定的名称和数据创建一个<code>XmlProcessingInstruction</code>。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>CreateSignificantWhitespace</code></td> 
    <td>创建一个<code>XmlSignificantWhitespace</code>节点。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>CreateTextNode</code></td> 
    <td>用指定的文本创建一个<code>XmlText</code>。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>CreateWhitespace</code></td> 
    <td>创建一个<code>XmlWhitespace</code>节点。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>CreateXmlDeclaration</code></td> 
    <td>用指定的值创建一个<code>XmlDeclaration</code>节点。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>GetElementById</code></td> 
    <td>获取具有指定标识的<code>XmlElement</code>。</td> 
   </tr> 
   <tr> 
    <td>15</td> 
    <td><code>GetElementsByTagName(String)</code></td> 
    <td>返回一个<code>XmlNodeList</code>，其中包含与指定的<code>Name</code>匹配的所有子元素的列表。</td> 
   </tr> 
   <tr> 
    <td>16</td> 
    <td><code>GetElementsByTagName(String, String)</code></td> 
    <td>返回包含与指定的<code>LocalName</code>和<code>NamespaceURI</code>匹配的所有子元素的列表的<code>XmlNodeList</code>。</td> 
   </tr> 
   <tr> 
    <td>17</td> 
    <td><code>InsertAfter</code></td> 
    <td>在指定的参考节点之后立即插入指定的节点。</td> 
   </tr> 
   <tr> 
    <td>18</td> 
    <td><code>InsertBefore</code></td> 
    <td>在指定的参考节点之前立即插入指定的节点。</td> 
   </tr> 
   <tr> 
    <td>19</td> 
    <td><code>Load(Stream)</code></td> 
    <td>从指定的流加载XML文档。</td> 
   </tr> 
   <tr> 
    <td>20</td> 
    <td><code>Load(String)</code></td> 
    <td>从指定的URL加载XML文档。</td> 
   </tr> 
   <tr> 
    <td>21</td> 
    <td><code>Load(TextReader)</code></td> 
    <td>从指定的<code>TextReader</code>加载XML文档。</td> 
   </tr> 
   <tr> 
    <td>22</td> 
    <td><code>Load(XmlReader)</code></td> 
    <td>加载指定的<code>XmlReader</code>中的XML文档。</td> 
   </tr> 
   <tr> 
    <td>23</td> 
    <td><code>LoadXml</code></td> 
    <td>从指定的字符串加载XML文档。</td> 
   </tr> 
   <tr> 
    <td>24</td> 
    <td><code>PrependChild</code></td> 
    <td>将指定的节点添加到此节点的子节点列表的开头。</td> 
   </tr> 
   <tr> 
    <td>25</td> 
    <td><code>ReadNode</code></td> 
    <td>根据<code>XmlReader</code>中的信息创建一个<code>XmlNode</code>对象。读取器必须位于节点或属性上。</td> 
   </tr> 
   <tr> 
    <td>26</td> 
    <td><code>RemoveAll</code></td> 
    <td>删除当前节点的所有子节点和/或属性。</td> 
   </tr> 
   <tr> 
    <td>27</td> 
    <td><code>RemoveChild</code></td> 
    <td>删除特定的子节点。</td> 
   </tr> 
   <tr> 
    <td>28</td> 
    <td><code>ReplaceChild</code></td> 
    <td>用<code>newChild</code>节点替换子节点<code>oldChild</code>。</td> 
   </tr> 
   <tr> 
    <td>29</td> 
    <td><code>Save(Stream)</code></td> 
    <td>将XML文档保存到指定的流。</td> 
   </tr> 
   <tr> 
    <td>30</td> 
    <td><code>Save(String)</code></td> 
    <td>将XML文档保存到指定的文件。</td> 
   </tr> 
   <tr> 
    <td>31</td> 
    <td><code>Save(TextWriter)</code></td> 
    <td>将XML文档保存到指定的<code>TextWriter</code>。</td> 
   </tr> 
   <tr> 
    <td>32</td> 
    <td><code>Save(XmlWriter)</code></td> 
    <td>将XML文档保存到指定的<code>XmlWriter</code>。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h4 id="h4--3"><a name="示例3" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例3</h4>
 <p>在这个例子中，将向xml文档<code>authors.xml</code>中插入一些新节点，然后在列表框中显示所有作者的名字。</p> 
 <p>参考以下步骤：</p> 
 <ul> 
  <li>将<em>authors.xml</em> 文件添加到应用程序的 <em>bin/Debug</em> 文件夹中(如果已经编写上示例2，那么应该在示例2工程中生成了)</li>
  <li>导入System.Xml名称空间</li>
  <li>在窗体中添加一个列表框和按钮控件，并将按钮控件的<code>Text</code>属性设置为<em>显示作者</em>。</li>
 </ul> 
 <p>使用代码编辑器添加以下代码。参考代码实现 - </p>   
 <pre><code class="lang-vbnet">Imports System.Xml
Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ' Set the caption bar text of the form.   
        Me.Text = "插入XML节点 - yiibai.com"
    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        ListBox1.Items.Clear()
        Dim xd As XmlDocument = New XmlDocument()
        xd.Load("authors.xml")
        Dim newAuthor As XmlElement = xd.CreateElement("author")
        newAuthor.SetAttribute("code", "6")
        Dim fn As XmlElement = xd.CreateElement("fname")
        fn.InnerText = "李"
        newAuthor.AppendChild(fn)
        Dim ln As XmlElement = xd.CreateElement("lname")
        ln.InnerText = "安"
        newAuthor.AppendChild(ln)
        xd.DocumentElement.AppendChild(newAuthor)
        Dim tr As XmlTextWriter = New XmlTextWriter("movies.xml", Nothing)
        tr.Formatting = Formatting.Indented
        xd.WriteContentTo(tr)
        tr.Close()
        Dim nl As XmlNodeList = xd.GetElementsByTagName("lname")
        For Each node As XmlNode In nl
            ListBox1.Items.Add(node.InnerText)
        Next node
    End Sub
End Class
</code></pre> 
 <p>使用Microsoft Visual Studio工具栏上的“开始”按钮执行并运行上述代码。点击<em>显示作者</em> 按钮将显示所有作者的名字，包括在运行时添加的名字。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/772171135_28343.png" alt=""></p> 
 <p>点击按钮后的效果如下所示 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1711/866171136_73866.png" alt=""></p>
 <br>      
</div></body></html>