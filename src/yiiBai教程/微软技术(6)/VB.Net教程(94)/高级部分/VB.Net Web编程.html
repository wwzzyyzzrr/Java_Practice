<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net Web编程</h1><div style="width:100%;float:left;" class="article-content">   
 <p>动态Web应用程序由以下两种类型的程序中的一种或两种组成：</p> 
 <ul> 
  <li><em>服务器端脚本</em> - 这些是使用服务器端脚本语言(如ASP(Active Server Pages)或<a target="_blank" href="http://www.yiibai.com/jsp/" title="JSP">JSP</a>(Java Server Pages))编写的Web服务器上执行的程序。</li>
  <li><em>客户端脚本</em> - 这些是在浏览器上执行的程序，使用JavaScript，VBScript等脚本语言编写。</li>
 </ul> 
 <p>ASP.Net是Microsoft推出的.Net版本的ASP，通过使用服务器端脚本来创建动态网页。ASP.Net应用程序是使用.Net框架中存在的可扩展和可重用组件或对象编写的编译代码。这些代码可以在.Net框架中使用整个类的层次结构。</p> 
 <p>ASP.Net应用程序代码可以用以下任何一种语言编写：</p> 
 <ul> 
  <li><em>Visual Basic .Net</em></li>
  <li><em>C#</em></li>
  <li><em>Jscript</em></li>
  <li><em>J#</em></li>
 </ul> 
 <p>在本章中，我们将简要介绍如何使用VB.Net编写ASP.Net应用程序。有关ASP.Net详细的内容，请参阅<a target="_blank" href="http://www.yiibai.com/asp.net/" title="ASP.Net教程">ASP.Net教程</a>。</p> 
 <h2 id="h2-asp-net-"><a name="ASP.Net内置对象" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ASP.Net内置对象</h2>
 <p>ASP.Net有一些在Web服务器上运行的内置对象。这些对象具有可在应用程序开发中使用的方法，属性和集合。</p> 
 <p>下表列出了ASP.Net内置对象的简要说明：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>对象</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Application</code></td> 
    <td>描述存储与整个Web应用程序有关的信息的对象的方法，属性和集合，包括应用程序生命周期中存在的变量和对象。可以使用此对象来存储和检索要在应用程序的所有用户之间共享的信息。 例如，可以使用一个<code>Application</code>对象来创建一个电子商务网页。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Request</code></td> 
    <td>描述存储与HTTP请求有关的信息的对象的方法，属性和集合。 这包括表单，Cookie，服务器变量和证书数据。使用此对象来访问从浏览器发送到服务器的请求中发送的信息。 例如，可以使用<code>Request</code>对象访问HTML表单中用户输入的信息。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Response</code></td> 
    <td>描述存储与服务器响应相关的信息的对象的方法，属性和集合。这包括显示内容，操作标题，设置区域设置和重定向请求。使用这个对象来发送信息给浏览器。例如，使用<code>Response</code>对象将脚本的输出发送到浏览器。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Server</code></td> 
    <td>介绍为各种服务器任务提供方法的对象的方法和属性。 使用这些方法，可以执行代码，获取错误条件，对文本字符串进行编码，创建网页使用的对象以及映射物理路径。可以使用此对象访问服务器上的各种实用程序功能。例如，可以使用<code>Server</code>对象为脚本设置超时。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Session</code></td> 
    <td>描述存储与用户会话相关的信息的对象的方法，属性和集合，包括会话生存期间存在的变量和对象。使用此对象来存储和检索有关特定用户会话的信息。 例如，可以使用<code>Session</code>对象来保存有关用户及其偏好的信息，并跟踪未决操作。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-asp-net-"><a name="ASP.Net编程模型" class="reference-link"></a><span class="header-link octicon octicon-link"></span>ASP.Net编程模型</h2>
 <p>ASP.Net提供了两种类型的编程模型：</p> 
 <ul> 
  <li><em>Web窗体</em> - 可以创建将应用于用户界面各个组件的用户界面和应用程序逻辑。</li>
  <li><em>WCF服务</em> - 可以远程访问一些服务器端功能。</li>
 </ul> 
 <h2 id="h2-web-"><a name="Web窗体" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Web窗体</h2>
 <p>Web表单包括：</p> 
 <ul> 
  <li>用户界面</li>
  <li>应用程序逻辑</li>
 </ul> 
 <p>用户界面由静态HTML或XML元素和ASP.Net服务器控件组成。当创建Web应用程序时，HTML或XML元素和服务器控件将存储在扩展名为<code>.html</code>的文件中。这个文件也被称为页面文件。</p> 
 <p>应用程序逻辑由应用于页面中用户界面元素的代码组成。可以使用.Net语言(如VB.Net或<code>C#</code>)编写此代码。</p> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>使用一个网页的形式来创建一个新的网站，它会显示当前的日期和时间，当用户点击一个按钮。 采取以下步骤：</p> 
 <ul> 
  <li><p>选择<em>文件</em> -&gt;<em>新建</em> -&gt;<em>网站</em> ， 出现<em>新建网站</em>对话框。</p> </li>
  <li><p>选择<em>ASP.Net空白网站</em> 模板。为网站键入一个名称(<em>website</em>)并选择一个保存文件的位置。</p> </li>
 </ul> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1911/784091107_24212.png" alt=""></p> 
 <ul> 
  <li>需要向该网站添加一个默认页面。右键单击解决方案资源管理器中的网站名称，然后从上下文菜单中选择<em>添加新项目</em> 选项。显示添加新项目对话框，并选择<em>Web窗体</em>，如下所示：</li>
 </ul> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1911/573091115_99394.png" alt=""></p> 
 <ul> 
  <li>“源”视图中显示了默认页面。代码如下所示 - </li>
 </ul>   
 <pre><code class="lang-aspnet">&lt;%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.html.vb" Inherits="_Default" %&gt;

&lt;!DOCTYPE html&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;VB.Net默认页面&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div&gt;
            请输入你的名字：&lt;asp:TextBox ID="TextBox1" runat="server"&gt;&lt;/asp:TextBox&gt;
            &lt;asp:Button ID="Button1" runat="server" Text="提交" /&gt;
            &lt;br /&gt;
            &lt;asp:Label ID="Label2" runat="server" Text="Label"&gt;&lt;/asp:Label&gt;
            &lt;br /&gt;
            &lt;asp:Label ID="Label3" runat="server" Text="Label"&gt;&lt;/asp:Label&gt;
            &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
 <ul> 
  <li><p>通过向其添加值来设置默认网页的标题。</p> </li>
  <li><p>要在网页上添加控件，请转到设计视图。 在表单上添加三个标签，一个文本框和一个按钮。</p> </li>
 </ul> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1911/493091121_97960.png" alt=""></p> 
 <p>双击<em>“提交”</em>该按钮并将下面的代码添加到按钮的Click事件中：</p> 
 <pre><code class="lang-vbnet">
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Label2.Visible = True
        Label2.Text = "欢迎你来到易百教程: " + TextBox1.Text
        Label3.Text = "当前系统时间是: " + DateTime.Now.ToString()
    End Sub

End Class
</code></pre> 
 <p>当执行上面的代码并使用Microsoft Visual Studio工具栏上的“开始”按钮运行时，浏览器中将打开以下页面：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1911/992091133_71404.png" alt=""></p> 
 <p>输入用户名：<em>Maxsu</em>，然后提交 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1911/260091132_54628.png" alt=""></p>
 <br>      
</div></body></html>