<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net高级窗体</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在本章中，我们来学习以下概念和功能应用：</p> 
 <ul> 
  <li>在应用程序中添加菜单和子菜单</li>
  <li>在窗体中添加剪切，复制和粘贴功能</li>
  <li>锚定和停靠控件在窗体中</li>
  <li>模态窗体</li>
 </ul> 
 <h2 id="h2-u5728u5E94u7528u7A0Bu5E8Fu4E2Du6DFBu52A0u83DCu5355u548Cu5B50u83DCu5355"><a name="在应用程序中添加菜单和子菜单" class="reference-link"></a><span class="header-link octicon octicon-link"></span>在应用程序中添加菜单和子菜单</h2>
 <p>传统上，<code>Menu</code>，<code>MainMenu</code>，<code>ContextMenu</code>和<code>MenuItem</code>类用于在Windows应用程序中添加菜单，子菜单和上下文菜单。<br>现在，使用<code>MenuStrip</code>，<code>ToolStripMenuItem</code>，<code>ToolStripDropDown</code>和<code>ToolStripDropDownMenu</code>控件替换并添加功能到以前版本的菜单相关的控件。但是，为了向后兼容和将来使用，保留了旧的控制类。</p> 
 <p>先使用旧版本控件创建一个典型的Windows主菜单栏和子菜单，因为这些控件在旧应用程序中仍然有很多用处。</p> 
 <p>下面是一个例子中，显示了如何创建菜单栏菜单项：文件，编辑，视图和项目。文件菜单有子菜单新建，打开和保存。</p> 
 <p>双击窗体并将下面的代码放在打开的窗口中，参考以下代码的实现(项目：<em>MenusSubMenus</em>) - </p> 
 <pre><code class="lang-vbnet">Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        'defining the main menu bar
        Dim mnuBar As New MainMenu()
        'defining the menu items for the main menu bar
        Dim myMenuItemFile As New MenuItem("&amp;文件")
        Dim myMenuItemEdit As New MenuItem("&amp;编辑")
        Dim myMenuItemView As New MenuItem("&amp;查看")
        Dim myMenuItemProject As New MenuItem("&amp;工程")

        'adding the menu items to the main menu bar
        mnuBar.MenuItems.Add(myMenuItemFile)
        mnuBar.MenuItems.Add(myMenuItemEdit)
        mnuBar.MenuItems.Add(myMenuItemView)
        mnuBar.MenuItems.Add(myMenuItemProject)

        ' defining some sub menus
        Dim myMenuItemNew As New MenuItem("&amp;新建")
        Dim myMenuItemOpen As New MenuItem("&amp;打开")
        Dim myMenuItemSave As New MenuItem("&amp;保存")

        'add sub menus to the File menu
        myMenuItemFile.MenuItems.Add(myMenuItemNew)
        myMenuItemFile.MenuItems.Add(myMenuItemOpen)
        myMenuItemFile.MenuItems.Add(myMenuItemSave)

        'add the main menu to the form
        Me.Menu = mnuBar

        ' Set the caption bar text of the form.  
        Me.Text = "Menu&amp;SubMenu示例 - yiibai.com"
    End Sub
End Class
</code></pre> 
 <p>当上面的代码执行并使用Microsoft Visual Studio工具栏上的“开始”按钮运行时，它将显示以下窗口：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/765141137_87495.png" alt=""></p> 
 <p>Windows窗体包含一组丰富的类，用于创建具有现代外观和外观的自定义菜单。 <code>MenuStrip</code>，<code>ToolStripMenuItem</code>，<code>ContextMenuStrip</code>控件用于高效地创建菜单栏和上下文菜单。</p> 
 <p>点击以下链接查看详细信息：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>控件</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vb.net/vb.net_menustrip.html" title="MenuStrip">MenuStrip</a></td> 
    <td>它为窗体提供了一个菜单系统。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vb.net/vb.net_toolstrip_menuitem.html" title="ToolStripMenuItem">ToolStripMenuItem</a></td> 
    <td>它表示在<code>MenuStrip</code>或<code>ContextMenuStrip</code>上显示的可选选项。 <code>ToolStripMenuItem</code>控件替换并添加了以前版本的<code>MenuItem</code>控件的功能。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vb.net/vb.net_context_menustrip.html" title="ContextMenuStrip">ContextMenuStrip</a></td> 
    <td>它代表一个快捷菜单。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2--"><a name="在窗体中添加剪切，复制和粘贴功能" class="reference-link"></a><span class="header-link octicon octicon-link"></span>在窗体中添加剪切，复制和粘贴功能</h2>
 <p><code>ClipBoard</code>类公开的方法用于在应用程序中添加剪切，复制和粘贴功能。 <code>ClipBoard</code>类提供了在系统剪贴板上放置数据和从中检索数据的方法。</p> 
 <p>它有以下常用的方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Clear</code></td> 
    <td>删除剪贴板中的所有数据。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>ContainsData</code></td> 
    <td>指示剪贴板上的数据是否处于指定格式或可以转换为该格式。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>ContainsImage</code></td> 
    <td>指示剪贴板上的数据是位图格式还是可以转换为该格式。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>ContainsText</code></td> 
    <td>指示剪贴板上是否有<code>Text</code>或<code>UnicodeText</code>格式的数据，具体取决于操作系统。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>GetData</code></td> 
    <td>以指定的格式从剪贴板中检索数据。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>GetDataObject</code></td> 
    <td>检索系统剪贴板上当前的数据。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>GetImage</code></td> 
    <td>从剪贴板中检索图像。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>GetText</code></td> 
    <td>根据操作系统，以<code>Text</code>或<code>UnicodeText</code>格式从剪贴板中检索文本数据。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>GetText(TextDataFormat)</code></td> 
    <td>以指定的<code>TextDataFormat</code>值指定的格式从剪贴板中检索文本数据。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>SetData</code></td> 
    <td>清除剪贴板，然后以指定的格式添加数据。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>SetText(String)</code></td> 
    <td>清除剪贴板，然后根据操作系统，以<code>Text</code>或<code>UnicodeText</code>格式添加文本数据。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>以下一个例子，它显示如何使用<code>Clipboard</code>类的方法剪切，复制和粘贴数据。参考以下步骤：</p> 
 <ul> 
  <li>在窗体上添加一个富文本框控件和三个按钮控件。</li>
  <li>将按钮的<code>Text</code>属性分别更改为<em>“剪切”</em>，<em>“复制”</em>和<em>“粘贴”</em>。</li>
 </ul> 
 <p>双击按钮在代码编辑器中添加以下代码(项目：<em>Clipboard</em>)：</p> 
 <pre><code class="lang-vbnet">Imports System.Windows.Forms.Clipboard

Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) _
     Handles MyBase.Load
        ' Set the caption bar text of the form.  
        Me.Text = "剪切-复制-粘贴 - yiibai.com"
    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim ClipboardData As New DataObject()
        ClipboardData.SetData(DataFormats.Rtf, RichTextBox1.Rtf)
        ClipboardData.SetData(DataFormats.Text, RichTextBox1.Text)
        My.Computer.Clipboard.SetDataObject(ClipboardData)
        RichTextBox1.SelectedText = ""
    End Sub
    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim ClipboardData As New DataObject()
        ClipboardData.SetData(DataFormats.Rtf, RichTextBox1.Rtf)
        ClipboardData.SetData(DataFormats.Text, RichTextBox1.Text)
        My.Computer.Clipboard.SetDataObject(ClipboardData)
    End Sub
    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        Dim iData As IDataObject
        iData = My.Computer.Clipboard.GetDataObject()
        If (iData.GetDataPresent(DataFormats.Text)) Then
            RichTextBox1.SelectedText = iData.GetData(DataFormats.Text)
        Else
            RichTextBox1.SelectedText = ""
        End If
    End Sub
End Class
</code></pre> 
 <p>当上面的代码执行并使用Microsoft Visual Studio工具栏上的“开始”按钮运行时，它将显示以下窗口：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/907141152_68958.png" alt=""></p> 
 <p>输入一些文字并检查按钮的工作情况。</p> 
 <h2 id="h2-u5728u7A97u4F53u4E2Du951Au5B9Au548Cu505Cu9760u63A7u4EF6"><a name="在窗体中锚定和停靠控件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>在窗体中锚定和停靠控件</h2>
 <p>锚定可将控件的锚点位置设置为其容器控件的边缘，例如窗体。 <code>Control</code>类的<code>Anchor</code>属性可设置这个属性的值。<code>Anchor</code>属性获取或设置控件绑定到的容器的边，并确定控件的父级调整大小。</p> 
 <p>当将控件锚定到窗体时，控件将在窗体大小调整后保持其与窗体边缘及其锚定位置的距离。</p> 
 <p>可以从“属性”窗口中设置控件的“锚点”属性值：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/204141155_93640.png" alt=""></p> 
 <p>例如，在窗体中添加一个Button控件，并将其<code>Anchor</code>属性设置为<code>Bottom</code>，<code>Right</code>。 运行此窗体来查看<code>Button</code>控件相对于窗体的原始位置。如下图所示 -</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/793141159_85542.png" alt=""></p> 
 <p>现在，当拉伸窗体放大时，<code>Button</code>和窗体右下角之间的距离保持不变。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/705151100_77930.png" alt=""></p> 
 <p>停靠控制装置将其对接到其容器的边缘之一。 在对接中，控制器完全填充容器的某个区域。<br><code>Control</code>类的<code>Dock</code>属性执行此操作。 <code>Dock</code>属性获取或设置哪个控件边框停靠在其父控件上，并确定如何使用其父控件调整大小。</p> 
 <p>可以从“属性”窗口中设置控件的<code>Dock</code>属性值为<code>Bottom</code>：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/570151101_83111.png" alt=""></p> 
 <p>例如，在窗体上添加一个<code>Button</code>控件，并将其<code>Dock</code>属性设置为<code>Bottom</code>。运行此窗体来查看此<code>Button</code>控件相对于窗体的原始位置。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/244151102_30554.png" alt=""></p> 
 <p>现在，当拉伸窗体的时候，按钮就会随着窗体的大小自动调整。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/553151103_45459.png" alt=""></p> 
 <h2 id="h2-u6A21u6001u7A97u4F53"><a name="模态窗体" class="reference-link"></a><span class="header-link octicon octicon-link"></span>模态窗体</h2>
 <p>模态窗体是在继续使用其他应用程序之前需要关闭或隐藏的窗体。所有对话框都是模态形式。<code>MessageBox</code>控件也是一个模态窗体。</p> 
 <p>可以通过两种方式调用模态窗体：</p> 
 <ul> 
  <li>调用<code>ShowDialog</code>方法</li>
  <li>调用<code>Show</code>方法</li>
 </ul> 
 <p>举一个例子，下面创建一个模式窗体：一个对话框。参考以下步骤：</p> 
 <ul> 
  <li>将<em>Form1</em>添加到应用程序，并将两个标签和一个按钮控件添加到<em>Form1</em>中。</li>
  <li>将第一个标签和按钮的<code>Text</code>属性分别更改为<em>“欢迎使用易百教程”</em>和<em>“输入你的名字”</em>。保持第二个标签的<code>Text</code>属性为空。设计视图效果如下 -<br><img src="http://www.yiibai.com/uploads/images/201711/1511/214151113_61909.png" alt=""></li>
  <li>在“解决方案资源管理器”中，找到项目名称，然后右键点击，在弹出的菜单中选择：<em>添加</em>-&gt;<em>Windows窗体</em>，添加一个新的Windows窗体:<em>Form2</em>，并将两个按钮，一个标签和一个文本框添加到<em>Form2</em>中。</li>
  <li>将按钮的<code>Text</code>属性分别更改为<em>“确定”</em>和<em>“取消”</em>。 将标签的<code>Text</code>属性更改为<em>“输入您的姓名：”</em>。</li>
  <li>将<em>Form2</em>的<code>FormBorderStyle</code>属性设置为<code>FixedDialog</code>，给它一个对话框边框。</li>
  <li>将<em>Form2</em>的<code>ControlBox</code>属性设置为<code>False</code>。</li>
  <li>将<em>Form2</em>的<code>ShowInTaskbar</code>属性设置为<code>False</code>。</li>
  <li>将<em>“确定”</em>按钮的<code>DialogResult</code>属性设置为<code>OK</code>，并将<em>“取消”</em>按钮设置为<code>Cancel</code>。</li>
 </ul> 
 <p>最终设计的视图效果如下 - </p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/194151118_16896.png" alt=""></p> 
 <p>在<em>Form2.vb</em>添加下面的代码：</p>   
 <pre><code class="lang-vbnet">Public Class Form2
    Private Sub Form2_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        AcceptButton = Button1
        CancelButton = Button2
    End Sub
End Class
</code></pre> 
 <p>在<em>Form1.vb</em>添加下面的代码：</p> 
 <pre><code class="lang-vbnet">Public Class Form1
    Private Sub Button1_Click(sender As Object, e As EventArgs) _
   Handles Button1.Click
        Dim frmSecond As Form2 = New Form2()
        If frmSecond.ShowDialog() = DialogResult.OK Then
            Label2.Text = frmSecond.TextBox1.Text
        End If
    End Sub
End Class
</code></pre> 
 <p>当上面的代码执行并使用Microsoft Visual Studio工具栏上的“开始”按钮运行时，它将显示以下窗口：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/129151122_86527.png" alt=""></p> 
 <p>点击“输入你的名字”按钮显示第二个窗体：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/432151123_79388.png" alt=""></p> 
 <p>点击“确定”按钮，将控制和信息从模态窗体恢复到第一个窗体，结果如下：</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201711/1511/695151123_55481.png" alt=""></p>
 <br>      
</div></body></html>