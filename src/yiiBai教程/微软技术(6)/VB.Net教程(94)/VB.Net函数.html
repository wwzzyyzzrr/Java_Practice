<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net函数</h1><div style="width:100%;float:left;" class="article-content">   
 <p>一个过程是一组语句，在调用时一起执行任务。过程执行后，控制权返回到调用过程的语句。 VB.Net有两种类型的程序：</p> 
 <ul> 
  <li>函数</li>
  <li>子程序或Subs</li>
 </ul> 
 <p><strong>重要区别：</strong> 函数返回一个值，而Subs不返回任何一个值。</p> 
 <h2 id="h2-u5B9Au4E49u51FDu6570"><a name="定义函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>定义函数</h2>
 <p><code>Function</code>语句用于声明函数的名称，参数和函数体。<code>Function</code>语句的语法是：</p> 
 <pre><code class="lang-vbnet">[Modifiers] Function FunctionName [(ParameterList)] As ReturnType
    [Statements]
End Function
</code></pre> 
 <p>其中，</p> 
 <ul> 
  <li><em>Modifiers</em> - 指定函数的访问级别; 可能的值有：<code>Public</code>, <code>Private</code>, <code>Protected</code>, <code>Friend</code>, <code>Protected Friend</code>以及有关重载，覆盖，共享和投影的信息。</li>
  <li><em>FunctionName</em> - 表示函数的名称。</li>
  <li><em>ParameterList</em>: 指定参数的列表。</li>
  <li><em>ReturnType</em>: 指定函数返回的变量的数据类型。</li>
 </ul> 
 <h3 id="h3-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h3>
 <p>下面的代码片段显示了一个函数：<code>FindMax</code>，它取两个整数值作为参数并返回两个中较大的那一个。</p> 
 <pre><code class="lang-vb">Function FindMax(ByVal num1 As Integer, ByVal num2 As Integer) As Integer
   ' local variable declaration '
   Dim result As Integer
   If (num1 &gt; num2) Then
       result = num1
   Else
       result = num2
   End If
   FindMax = result
End Function
</code></pre> 
 <h2 id="h2-u51FDu6570u8FD4u56DEu503C"><a name="函数返回值" class="reference-link"></a><span class="header-link octicon octicon-link"></span>函数返回值</h2>
 <p>在VB.Net中，函数可以通过两种方式将值返回给调用代码：</p> 
 <ul> 
  <li>通过使用<code>return</code>语句</li>
  <li>通过赋值给函数名称</li>
 </ul> 
 <p>以下示例演示如何使用<code>FindMax</code>函数：</p> 
 <pre><code class="lang-vbnet">Module FunctionReturnValue
   Function FindMax(ByVal num1 As Integer, ByVal num2 As Integer) As Integer
      ' local variable declaration '
      Dim result As Integer
      If (num1 &gt; num2) Then
          result = num1
      Else
          result = num2
      End If
      FindMax = result
   End Function
   Sub Main()
      Dim a As Integer = 100
      Dim b As Integer = 200
      Dim res As Integer
      res = FindMax(a, b)
      Console.WriteLine("Max value is : {0}", res)
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\function&gt;vbc FunctionReturningValue.vb
F:\worksp\vb.net\function&gt;FunctionReturningValue.exe
Max value is : 200
</code></pre> 
 <h2 id="h2-u9012u5F52u51FDu6570"><a name="递归函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>递归函数</h2>
 <p>一个函数可以调用它自己(自身)，这被称为递归函数。以下是一个使用递归函数计算给定数字的阶乘的示例：</p> 
 <pre><code class="lang-vbnet">
Module Recursive
   Function factorial(ByVal num As Integer) As Integer
      ' local variable declaration '
      Dim result As Integer
      If (num = 1) Then
          Return 1
      Else
          result = factorial(num - 1) * num
          Return result
      End If
   End Function
   Sub Main()
      'calling the factorial method '
      Console.WriteLine("Factorial of 6 is : {0}", factorial(6))
      Console.WriteLine("Factorial of 7 is : {0}", factorial(7))
      Console.WriteLine("Factorial of 8 is : {0}", factorial(8))
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\function&gt;vbc Recursive.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
....
F:\worksp\vb.net\function&gt;Recursive.exe
Factorial of 6 is : 720
Factorial of 7 is : 5040
Factorial of 8 is : 40320
</code></pre> 
 <h2 id="h2-u53C2u6570u6570u7EC4"><a name="参数数组" class="reference-link"></a><span class="header-link octicon octicon-link"></span>参数数组</h2>
 <p>有时，在声明一个函数或子过程的时候，有时不确定传递的参数的数量。 VB.Net参数数组(或参数数组)可以解决这个问题。</p> 
 <p>以下示例演示了这一点：</p>   
 <pre><code class="lang-vbnet">Module ParamArrays
   Function AddElements(ParamArray arr As Integer()) As Integer
      Dim sum As Integer = 0
      Dim i As Integer = 0
      For Each i In arr
          sum += i
      Next i
      Return sum
   End Function
   Sub Main()
      Dim sum As Integer
      sum = AddElements(111, 720, 222, 567, 999)
      Console.WriteLine("The sum is: {0}", sum)
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\function&gt;vbc ParamArrays.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
......
F:\worksp\vb.net\function&gt;ParamArrays.exe
The sum is: 2619
</code></pre> 
 <h2 id="h2-u5C06u6570u7EC4u4F5Cu4E3Au51FDu6570u53C2u6570u4F20u9012"><a name="将数组作为函数参数传递" class="reference-link"></a><span class="header-link octicon octicon-link"></span>将数组作为函数参数传递</h2>
 <p>可以在VB.Net中传递一个数组作为函数的参数。以下示例演示了这一点：</p> 
 <pre><code class="lang-vbnet">Module PassingArrays
   Function getAverage(ByVal arr As Integer(), ByVal size As Integer) As Double
      'local variables'
       Dim i As Integer
       Dim avg As Double
       Dim sum As Integer = 0
       For i = 0 To size - 1
           sum += arr(i)
       Next i
       avg = sum / size
       Return avg
    End Function
    Sub Main()
        ' an int array with 5 elements '
        Dim balance As Integer() = {1110, 210, 320, 179, 509}
        Dim avg As Double
        'pass pointer to the array as an argument 
        avg = getAverage(balance, 5)
        ' output the returned value '
        Console.WriteLine("Average value is: {0} ", avg)
        Console.ReadLine()
    End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\function&gt;vbc PassingArrays.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
... ...
F:\worksp\vb.net\function&gt;PassingArrays.exe
Average value is: 465.6
</code></pre>
 <br>      
</div></body></html>