<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net指令</h1><div style="width:100%;float:left;" class="article-content">   
 <p>VB.Net编译器指令给编译器提供指令，在实际编译开始之前对信息进行预处理。</p> 
 <p>所有这些指令都以<code>#</code>字符开始，只有空格字符可能出现在一行上的指令之前。这些指令不是语句。</p> 
 <p>VB.Net编译器没有单独的预处理器; 然而，指令被处理好像有一个。在VB.Net中，编译器指令用于帮助进行条件编译。与C和C++指令不同，它们不用于创建宏。</p> 
 <h2 id="h2-vb-net-"><a name="VB.Net编译指令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>VB.Net编译指令</h2>
 <p>VB.Net提供了以下一组编译器指令：</p> 
 <ul> 
  <li><code>#Const</code>指令</li>
  <li><code>#ExternalSource</code>指令</li>
  <li><code>#If...Then...#Else</code>指令</li>
  <li><code>#Region</code>指令</li>
 </ul> 
 <h4 id="h4--const-"><a name="#Const指令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>#Const指令</h4>
 <p>这个指令定义了条件编译器常量。这个指令的语法是：</p> 
 <pre><code class="lang-vb">#Const constname = expression
</code></pre> 
 <p>其中，</p> 
 <ul> 
  <li><em>constname</em>：指定常量的名称，必需。</li>
  <li><em>expression</em>：它可以是文字或其他条件编译器常量，也可以是包含除了<code>Is</code>以外的任何或所有算术或逻辑运算符的组合。</li>
 </ul> 
 <p>例如，</p> 
 <pre><code class="lang-vb">#Const state = "WEST BENGAL"
</code></pre> 
 <p><strong>示例</strong></p> 
 <p>下面的代码演示了这个指令的用法：</p> 
 <pre><code class="lang-vb">Module mydirectives
#Const age = True
Sub Main()
   #If age Then
      Console.WriteLine("You are welcome to the Robotics Club")
   #End If
   Console.ReadKey()
End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">You are welcome to the Robotics Club
</code></pre> 
 <h4 id="h4--externalsource-"><a name="#ExternalSource指令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>#ExternalSource指令</h4>
 <p>该指令用于指示特定的源代码行和源代码外部的文本之间的映射。它只用于编译器，调试器对代码编译没有影响。</p> 
 <p>该指令允许将来自外部代码文件的外部代码包含到源代码文件中。</p> 
 <p>这个指令的语法是：</p> 
 <pre><code class="lang-shell">#ExternalSource( StringLiteral , IntLiteral )
    [ LogicalLine ]
#End ExternalSource
</code></pre> 
 <p><code>#ExternalSource</code>指令的参数是外部文件的路径，第一行的行号和发生错误的行。</p> 
 <p><strong>示例</strong></p> 
 <p>下面的代码演示了这个指令的假设用法：</p> 
 <pre><code class="lang-vb">Module mydirectives
    Public Class ExternalSourceTester

        Sub TestExternalSource()

        #ExternalSource("F:\worksp\vb.net\helloworld.vb", 0)
            Console.WriteLine("This is External Code. ")
        #End ExternalSource

        End Sub
    End Class

    Sub Main()
        Dim t As New ExternalSourceTester()
        t.TestExternalSource()
        Console.WriteLine("In Main.")
        Console.ReadKey()

    End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">F:\worksp\vb.net&gt;vbc mydirectives.vbc
F:\worksp\vb.net&gt;mydirectives.exe
This is External Code.
In Main.
</code></pre> 
 <h4 id="h4--if-then-else-"><a name="#If … Then …＃Else指令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>#If … Then …＃Else指令</h4>
 <p>该指令有条件地编译选定的Visual Basic代码块。</p> 
 <p>这个指令的语法是：</p>   
 <pre><code class="lang-vb">#If expression Then
   statements
[ #ElseIf expression Then
   [ statements ]
...
#ElseIf expression Then
   [ statements ] ]
[ #Else
   [ statements ] ]
#End If
</code></pre> 
 <p>例如，</p> 
 <pre><code class="lang-vb">#Const TargetOS = "Linux"
#If TargetOS = "Windows 7" Then
   ' Windows 7 specific code
#ElseIf TargetOS = "WinXP" Then
   ' Windows XP specific code
#Else
   ' Code for other OS
#End if
</code></pre> 
 <p><strong>示例</strong></p> 
 <p>下面的代码演示了这个指令的用法，代码文件：<em>ifthenelse_directives.vb</em> - </p> 
 <pre><code class="lang-vb">Module ifthenelse_directives
#Const classCode = 8

   Sub Main()
   #If classCode = 7 Then
        Console.WriteLine("Exam Questions for Class VII")
   #ElseIf classCode = 8 Then
        Console.WriteLine("Exam Questions for Class VIII")
   #Else
        Console.WriteLine("Exam Questions for Higher Classes")
   #End If
        Console.ReadKey()

    End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net&gt;vbc ifthenelse_directives.vb
......
F:\worksp\vb.net&gt;ifthenelse_directives.exe
Exam Questions for Class VIII
</code></pre> 
 <h4 id="h4--region-"><a name="#Region指令" class="reference-link"></a><span class="header-link octicon octicon-link"></span>#Region指令</h4>
 <p>该指令有助于在Visual Basic文件中折叠和隐藏代码段。</p> 
 <p>这个指令的语法是：</p> 
 <pre><code class="lang-vb">#Region "identifier_string" 
#End Region
</code></pre> 
 <p>示例 -</p> 
 <pre><code class="lang-vb">#Region "StatsFunctions" 
' Insert code for the Statistical functions here. '
#End Region
</code></pre>
 <br>      
</div></body></html>