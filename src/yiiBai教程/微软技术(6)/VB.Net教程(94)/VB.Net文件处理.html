<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net文件处理</h1><div style="width:100%;float:left;" class="article-content">   
 <p>文件是存储在具有特定名称和目录路径的磁盘中的数据的集合。当一个文件被打开进行读或写时，它就成为一个流。</p> 
 <p>流基本上是通过通信路径的字节序列。 有两个主流：输入流和输出流。 输入流用于从文件读取数据(读取操作)，输出流用于写入文件(写入操作)。</p> 
 <h2 id="h2-vb-net-i-o-"><a name="VB.Net I/O类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>VB.Net I/O类</h2>
 <p><code>System.IO</code>名称空间具有各种类，用于执行文件的各种操作，如创建和删除文件，读取或写入文件，关闭文件等。</p> 
 <p>下表显示了<code>System.IO</code>名称空间中的一些常用的非抽象类：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>I/O类</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>BinaryReader</code></td> 
    <td>从二进制流读取原始数据。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>BinaryWriter</code></td> 
    <td>以二进制格式写入原始数据。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>BufferedStream</code></td> 
    <td>临时存储一个字节流。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Directory</code></td> 
    <td>帮助操作目录结构。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>DirectoryInfo</code></td> 
    <td>用于在目录上执行操作。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>DriveInfo</code></td> 
    <td>提供驱动器的信息。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>File</code></td> 
    <td>用于操纵文件。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>FileInfo</code></td> 
    <td>用于对文件执行操作。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>FileStream</code></td> 
    <td>用于读取和写入文件中的任何位置。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>MemoryStream</code></td> 
    <td>用于随机访问存储在内存中的流式数据。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>Path</code></td> 
    <td>对路径信息进行操作。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>StreamReader</code></td> 
    <td>用于从字节流中读取字符。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>StreamWriter</code></td> 
    <td>用于将字符写入流中。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>StringReader</code></td> 
    <td>用于从字符串缓冲区读取。</td> 
   </tr> 
   <tr> 
    <td>15</td> 
    <td><code>StringWriter</code></td> 
    <td>用于写入字符串缓冲区。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-filestream-"><a name="FileStream类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>FileStream类</h2>
 <p><code>System.IO</code>命名空间中的<code>FileStream</code>类有助于读取，写入和关闭文件。这个类派生自抽象类<code>Stream</code>。</p> 
 <p>需要创建一个<code>FileStream</code>对象来创建一个新文件或打开一个现有的文件。创建<code>FileStream</code>对象的语法如下所示：</p> 
 <pre><code class="lang-vbnet">Dim &lt;object_name&gt; As FileStream = New FileStream(&lt;file_name&gt;, &lt;FileMode Enumerator&gt;, &lt;FileAccess Enumerator&gt;, &lt;FileShare Enumerator&gt;)
</code></pre> 
 <p>例如，为了创建一个<code>FileStream</code>对象F来读取名为<code>sample.txt</code>的文件：</p> 
 <pre><code class="lang-vbnet">Dim f1 As FileStream = New FileStream("sample.txt", FileMode.OpenOrCreate, FileAccess.ReadWrite)
</code></pre> 
 <p>以下是参数和描述 -</p> 
 <ul> 
  <li><p><em>FileMode</em> - <em>FileMode</em> 枚举器定义了打开文件的各种方法。<code>FileMode</code>枚举器的成员是：</p> 
   <ul> 
    <li><em>Append</em>：它打开一个现有的文件，并将光标放在文件的末尾，或创建文件，如果文件不存在。</li>
    <li><em>Create</em>：它创建一个新的文件。</li>
    <li><em>CreateNew</em>：它指定操作系统应该创建一个新文件。</li>
    <li><em>Open</em>：它打开一个现有的文件。</li>
    <li><em>OpenOrCreate</em>： 它指定操作系统应该打开一个文件，否则它应该创建一个新的文件。</li>
    <li><em>Truncate</em>：它打开一个现有的文件，并截断其大小为零字节。</li>
   </ul> </li>
  <li><p><em>FileAccess</em> - <code>FileAccess</code>枚举员具有成员：<code>Read</code>，<code>ReadWrite</code>和<code>Write</code>。</p> 
   <ul> 
    <li><em>Inheritable</em> - 它允许文件句柄将继承传递给子进程。</li>
    <li><em>None</em> - 它拒绝共享当前文件。</li>
    <li><em>Read</em> - 它允许打开文件进行读读。</li>
    <li><em>ReadWrite</em>： 它允许打开文件进行读写。</li>
    <li><em>Write</em> - 它允许打开文件进行写入。</li>
   </ul> </li>
 </ul> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>以下程序演示了<code>FileStream</code>类的使用：</p>   
 <pre><code class="lang-vbnet">Imports System.IO
Module fileProg
   Sub Main()
      Dim f1 As FileStream = New FileStream("sample.txt",FileMode.OpenOrCreate, FileAccess.ReadWrite)
      Dim i As Integer
      For i = 0 To 20
          f1.WriteByte(CByte(i))
      Next i
      f1.Position = 0
      For i = 0 To 20
          Console.Write("{0} ", f1.ReadByte())
      Next i
      f1.Close()
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 -1
</code></pre> 
 <h2 id="h2-vb-net-"><a name="VB.Net高级文件操作" class="reference-link"></a><span class="header-link octicon octicon-link"></span>VB.Net高级文件操作</h2>
 <p>前面的例子提供了VB.Net中的简单文件操作。但是，要利用<code>System.IO</code>类的强大功能，需要了解这些类的常用属性和方法。</p> 
 <p>我们将在下面的章节中讨论这些类和它们所执行的操作。请点击提供的链接以访问各个部分：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vb.net/vb.net_text_files.html" title="读取和写入文本文件">读取和写入文本文件</a></td> 
    <td>它涉及到读取和写入文本文件。<code>StreamReader</code>和<code>StreamWriter</code>类有助于实现它。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vb.net/vb.net_binary_files.html" title="读取和写入二进制文件">读取和写入二进制文件</a></td> 
    <td>它涉及到读取和写入二进制文件。<code>BinaryReader</code>和<code>BinaryWriter</code>类有助于实现这一点。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><a target="_blank" href="http://www.yiibai.com/vb.net/vb.net_windows_file_system.html" title="操作Windows文件系统">操作Windows文件系统</a></td> 
    <td>它使VB.Net程序员能够浏览和查找Windows文件和目录。</td> 
   </tr> 
  </tbody> 
 </table>
 <br>      
</div></body></html>