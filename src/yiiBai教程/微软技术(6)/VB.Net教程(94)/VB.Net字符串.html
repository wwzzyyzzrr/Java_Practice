<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net字符串</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在VB.Net中，可以使用字符串作为字符数组，但更常见的做法是使用<code>String</code>关键字来声明一个字符串变量。<code>String</code>关键字是<code>System.String</code>类的别名。</p> 
 <h2 id="h2-u521Bu5EFAu4E00u4E2Au5B57u7B26u4E32u5BF9u8C61"><a name="创建一个字符串对象" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建一个字符串对象</h2>
 <p>可以使用以下方法之一创建字符串对象：</p> 
 <ul> 
  <li>通过将一个字符串文字分配给一个<code>String</code>变量</li>
  <li>通过使用一个<code>String</code>类的构造函数</li>
  <li>通过使用字符串连接运算符(+)</li>
  <li>通过检索一个属性或调用返回一个字符串的方法</li>
  <li>通过调用格式化方法将值或对象转换为其字符串表示形式</li>
 </ul> 
 <p>以下示例演示了如何创建对象：</p> 
 <pre><code class="lang-vb">Module strings
   Sub Main()
      Dim fname, lname, fullname, greetings As String
      fname = "Bryant"
      lname = "Kobe"
      fullname = fname + " " + lname
      Console.WriteLine("Full Name: {0}", fullname)

     'by using string constructor'
      Dim letters As Char() = {"H", "e", "l", "l", "o"}
      greetings = New String(letters)
      Console.WriteLine("Greetings: {0}", greetings)

      'methods returning String'
      Dim sarray() As String = {"Hello", "From", "Yiibai", "Yiibai"}
      Dim message As String = String.Join(" ", sarray)
      Console.WriteLine("Message: {0}", message)

      'formatting method to convert a value '
      Dim waiting As DateTime = New DateTime(2018, 12, 12, 17, 58, 1)
      Dim chat As String = String.Format("Message sent at {0:t} on {0:D}", waiting)
      Console.WriteLine("Message: {0}", chat)
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\string&gt;vbc strings.vb
F:\worksp\vb.net\string&gt;strings.exe
Full Name: Bryant Kobe
Greetings: Hello
Message: Hello From Yiibai Yiibai
Message: Message sent at 17:58 on 2018年12月12日
</code></pre> 
 <h2 id="h2-string-"><a name="String类的属性" class="reference-link"></a><span class="header-link octicon octicon-link"></span>String类的属性</h2>
 <p><code>String</code>类具有以下两个属性：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>属性名称</th> 
    <th>说明</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Chars</code></td> 
    <td>获取当前<code>String</code>对象中指定位置的<code>Char</code>对象。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Length</code></td> 
    <td>获取当前<code>String</code>对象中的字符数量。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-string-"><a name="String类的方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>String类的方法</h2>
 <p><code>String</code>类有许多方法可以用来处理<code>String</code>对象。下表提供了一些最常用的方法：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>编号</th> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>1</td> 
    <td><code>Public Shared Function Compare ( strA As String, strB As String ) As Integer</code></td> 
    <td>比较两个指定的字符串对象，并返回一个整数，以整理顺序指示它们的相对位置。</td> 
   </tr> 
   <tr> 
    <td>2</td> 
    <td><code>Public Shared Function Compare ( strA As String, strB As String, ignoreCase As Boolean ) As Integer</code></td> 
    <td>比较两个指定的字符串对象，并返回一个整数，以整理顺序指示它们的相对位置。但是，如果布尔参数为<code>true</code>，则会忽略大小写。</td> 
   </tr> 
   <tr> 
    <td>3</td> 
    <td><code>Public Shared Function Concat ( str0 As String, str1 As String ) As String</code></td> 
    <td>连接两个字符串对象。</td> 
   </tr> 
   <tr> 
    <td>4</td> 
    <td><code>Public Shared Function Concat ( str0 As String, str1 As String, str2 As String ) As String</code></td> 
    <td>连接三个字符串对象。</td> 
   </tr> 
   <tr> 
    <td>5</td> 
    <td><code>Public Shared Function Concat ( str0 As String, str1 As String, str2 As String, str3 As String ) As String</code></td> 
    <td>连接四个字符串对象。</td> 
   </tr> 
   <tr> 
    <td>6</td> 
    <td><code>Public Function Contains ( value As String ) As Boolean</code></td> 
    <td>返回一个值，指示指定的字符串对象是否在此字符串中出现。</td> 
   </tr> 
   <tr> 
    <td>7</td> 
    <td><code>Public Shared Function Copy ( str As String ) As String</code></td> 
    <td>用与指定字符串相同的值创建一个新的<code>String</code>对象。</td> 
   </tr> 
   <tr> 
    <td>8</td> 
    <td><code>Public Sub CopyTo ( sourceIndex As Integer, destination As Char(), destinationIndex As Integer, count As Integer )</code></td> 
    <td>从字符串对象的指定位置复制指定数量的字符到Unicode字符数组中指定的位置。</td> 
   </tr> 
   <tr> 
    <td>9</td> 
    <td><code>Public Function EndsWith ( value As String ) As Boolean</code></td> 
    <td>确定字符串对象的末尾是否与指定的字符串匹配。</td> 
   </tr> 
   <tr> 
    <td>10</td> 
    <td><code>Public Function Equals ( value As String ) As Boolean</code></td> 
    <td>确定当前的字符串对象和指定的字符串对象是否具有相同的值。</td> 
   </tr> 
   <tr> 
    <td>11</td> 
    <td><code>Public Shared Function Equals ( a As String, b As String ) As Boolean</code></td> 
    <td>确定两个指定的字符串对象是否具有相同的值。</td> 
   </tr> 
   <tr> 
    <td>12</td> 
    <td><code>Public Shared Function Format ( format As String, arg0 As Object ) As String</code></td> 
    <td>用指定对象的字符串表示形式替换指定字符串中的一个或多个格式项目。</td> 
   </tr> 
   <tr> 
    <td>13</td> 
    <td><code>Public Function IndexOf ( value As Char ) As Integer</code></td> 
    <td>返回当前字符串中第一个出现的指定Unicode字符的从零开始的索引。</td> 
   </tr> 
   <tr> 
    <td>14</td> 
    <td><code>Public Function IndexOf ( value As String ) As Integer</code></td> 
    <td>返回此实例中第一次出现指定字符串的从零开始的索引。</td> 
   </tr> 
   <tr> 
    <td>15</td> 
    <td><code>Public Function IndexOf ( value As Char, startIndex As Integer ) As Integer</code></td> 
    <td>返回此字符串中第一个出现的指定Unicode字符的从零开始的索引，从指定的字符位置开始搜索。</td> 
   </tr> 
   <tr> 
    <td>16</td> 
    <td><code>Public Function IndexOf ( value As String, startIndex As Integer ) As Integer</code></td> 
    <td>返回此实例中指定字符串的第一个匹配项的从零开始的索引，从指定的字符位置开始搜索。</td> 
   </tr> 
   <tr> 
    <td>17</td> 
    <td><code>Public Function IndexOfAny ( anyOf As Char() ) As Integer</code></td> 
    <td>返回指定的Unicode字符数组中任何字符的第一次出现的从零开始的索引。</td> 
   </tr> 
   <tr> 
    <td>18</td> 
    <td><code>Public Function IndexOfAny ( anyOf As Char(), startIndex As Integer ) As Integer</code></td> 
    <td>返回指定Unicode字符数组中任何字符的此实例中第一次出现的从零开始的索引，从指定的字符位置开始搜索。</td> 
   </tr> 
   <tr> 
    <td>19</td> 
    <td><code>Public Function Insert ( startIndex As Integer, value As String ) As String</code></td> 
    <td>返回一个新字符串，其中指定的字符串被插入到当前字符串对象中的指定索引位置。</td> 
   </tr> 
   <tr> 
    <td>20</td> 
    <td><code>Public Shared Function IsNullOrEmpty ( value As String ) As Boolean</code></td> 
    <td>指示指定的字符串是否为空或空字符串。</td> 
   </tr> 
   <tr> 
    <td>21</td> 
    <td><code>Public Shared Function Join ( separator As String, ParamArray value As String() ) As String</code></td> 
    <td>使用每个元素之间指定的分隔符连接字符串数组的所有元素。</td> 
   </tr> 
   <tr> 
    <td>22</td> 
    <td><code>Public Shared Function Join ( separator As String, value As String(), startIndex As Integer, count As Integer ) As String</code></td> 
    <td>使用每个元素之间指定的分隔符连接字符串数组的指定元素。</td> 
   </tr> 
   <tr> 
    <td>23</td> 
    <td><code>Public Function LastIndexOf ( value As Char ) As Integer</code></td> 
    <td>返回当前字符串对象中最后一次出现的指定Unicode字符的从零开始的索引位置。</td> 
   </tr> 
   <tr> 
    <td>24</td> 
    <td><code>Public Function LastIndexOf ( value As String ) As Integer</code></td> 
    <td>返回当前字符串对象中最后一次出现的指定字符串的从零开始的索引位置。</td> 
   </tr> 
   <tr> 
    <td>25</td> 
    <td><code>Public Function Remove ( startIndex As Integer ) As String</code></td> 
    <td>删除当前实例中的所有字符，从指定位置开始，继续到最后一个位置，然后返回字符串。</td> 
   </tr> 
   <tr> 
    <td>26</td> 
    <td><code>Public Function Remove ( startIndex As Integer, count As Integer ) As String</code></td> 
    <td>从指定位置开始删除当前字符串中指定数量的字符并返回字符串。</td> 
   </tr> 
   <tr> 
    <td>27</td> 
    <td><code>Public Function Replace ( oldChar As Char, newChar As Char ) As String</code></td> 
    <td>用指定的Unicode字符替换当前字符串对象中指定的Unicode字符的所有匹配项并返回新的字符串。</td> 
   </tr> 
   <tr> 
    <td>28</td> 
    <td><code>Public Function Replace ( oldValue As String, newValue As String ) As String</code></td> 
    <td>用指定的字符串替换当前字符串对象中指定字符串的所有匹配项并返回新的字符串。</td> 
   </tr> 
   <tr> 
    <td>29</td> 
    <td><code>Public Function Split ( ParamArray separator As Char() ) As String()</code></td> 
    <td>返回一个字符串数组，它包含当前字符串对象中的子字符串，由指定的Unicode字符数组的元素分隔。</td> 
   </tr> 
   <tr> 
    <td>30</td> 
    <td><code>Public Function Split ( separator As Char(), count As Integer ) As String()</code></td> 
    <td>返回一个字符串数组，它包含当前字符串对象中的子字符串，由指定的Unicode字符数组的元素分隔。<code>int</code>参数指定要返回的最大子字符串数量。</td> 
   </tr> 
   <tr> 
    <td>31</td> 
    <td><code>Public Function StartsWith ( value As String ) As Boolean</code></td> 
    <td>确定此字符串实例的开始是否与指定的字符串匹配。</td> 
   </tr> 
   <tr> 
    <td>32</td> 
    <td><code>Public Function ToCharArray As Char()</code></td> 
    <td>返回一个Unicode字符数组，其中包含当前字符串<code>object</code>中的所有字符</td> 
   </tr> 
   <tr> 
    <td>33</td> 
    <td><code>Public Function ToCharArray ( startIndex As Integer, length As Integer ) As Char()</code></td> 
    <td>返回一个Unicode字符数组，其中包含当前字符串对象中的所有字符，从指定的索引开始，直到指定的长度。</td> 
   </tr> 
   <tr> 
    <td>34</td> 
    <td><code>Public Function ToLower As String</code></td> 
    <td>返回转换为小写字符串的副本。</td> 
   </tr> 
   <tr> 
    <td>35</td> 
    <td><code>Public Function ToUpper As String</code></td> 
    <td>返回转换为大写字符串的副本。</td> 
   </tr> 
   <tr> 
    <td>37</td> 
    <td><code>Public Function Trim As String</code></td> 
    <td>从当前<code>String</code>对象中删除所有前导和尾随空格字符。</td> 
   </tr> 
  </tbody> 
 </table> 
 <p>上面的方法列表并不详尽，请访问MSDN库以获取完整的方法列表和String类的构造方法。</p> 
 <h2 id="h2-u4F8Bu5B50"><a name="例子" class="reference-link"></a><span class="header-link octicon octicon-link"></span>例子</h2>
 <p>以下示例演示了上面提到的一些方法：</p> 
 <p><strong>比较字符串：</strong></p>   
 <pre><code class="lang-vb">Module strings
   Sub Main()
      Dim str1, str2 As String
      str1 = "This is test"
      str2 = "This is text"
      If (String.Compare(str1, str2) = 0) Then
          Console.WriteLine(str1 + " and " + str2 +
                            " are equal.")
      Else
          Console.WriteLine(str1 + " and " + str2 +
                            " are not equal.")
      End If
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">This is test and This is text are not equal.
</code></pre> 
 <p><strong>字符串包含字符串：</strong></p> 
 <pre><code class="lang-vb">Module strings
   Sub Main()
      Dim str1 As String
      str1 = "This is test"
      If (str1.Contains("test")) Then
          Console.WriteLine("The sequence 'test' was found.")
      End If
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">The sequence 'test' was found.
</code></pre> 
 <p><strong>获取子字符串：</strong></p> 
 <pre><code class="lang-vb">Module strings
   Sub Main()
      Dim str As String
      str = "Last night I dreamt of San Pedro"
      Console.WriteLine(str)
      Dim substr As String = str.Substring(23)
      Console.WriteLine(substr)
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">Last night I dreamt of San Pedro San Pedro.
</code></pre> 
 <p><strong>连接字符串：</strong></p> 
 <pre><code class="lang-vb">Module strings
   Sub Main()
      Dim strarray As String() = {"Down the way where the nights are gay",
                          "And the sun shines daily on the mountain top",
                           "I took a trip on a sailing ship",
                          "And when I reached Jamaica",
                          "I made a stop"}
      Dim str As String = String.Join(vbCrLf, strarray)
      Console.WriteLine(str)
      Console.ReadLine()
   End Sub
End Module
</code></pre> 
 <p>当上面的代码被编译并执行时，会产生以下结果：</p> 
 <pre><code class="lang-shell">Down the way where the nights are gay
And the sun shines daily on the mountain top
I took a trip on a sailing ship
And when I reached Jamaica
I made a stop
</code></pre>
 <br>      
</div></body></html>