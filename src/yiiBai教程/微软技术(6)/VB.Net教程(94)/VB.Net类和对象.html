<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">VB.Net类和对象</h1><div style="width:100%;float:left;" class="article-content">   
 <p>当定义一个类时，就定义了一个数据类型的蓝图(或模板)。这实际上并没有定义任何数据，但它确实定义了类名和含义，即该类的一个对象将包含哪些内容以及可以在这样的对象上执行哪些操作。</p> 
 <p>对象是一个类的实例。构成类的方法和变量被称为类的成员。</p> 
 <h2 id="h2-u7C7Bu5B9Au4E49"><a name="类定义" class="reference-link"></a><span class="header-link octicon octicon-link"></span>类定义</h2>
 <p>类定义以关键字<code>Class</code>开头，后面跟着类名和类体，并以<code>End Class</code>语句结束。 以下是类定义的一般形式：</p> 
 <pre><code class="lang-vbnet">[ &lt;attributelist&gt; ] [ accessmodifier ] [ Shadows ] [ MustInherit | NotInheritable ] [ Partial ] _
Class name [ ( Of typelist ) ]
    [ Inherits classname ]
    [ Implements interfacenames ]
    [ statements ]
End Class
</code></pre> 
 <p>其中，</p> 
 <ul> 
  <li><em>attributelist</em> 是适用于该类的属性列表，这是一个可选项。</li>
  <li><em>accessmodifier</em> 定义了该类的访问级别，它的值有 - <code>Public</code>, <code>Protected</code>, <code>Friend</code>, <code>Protected Friend</code> 和 <code>Private</code>，这是一个可选项。</li>
  <li><em>Shadows</em> 指示该变量在基类中重新声明并隐藏了一个相同名称的元素或一组重载元素，这是一个可选项。</li>
  <li><em>MustInherit</em> 指定该类只能用作基类，并且不能直接从它创建对象，即抽象类，这是一个可选项。</li>
  <li><em>NotInheritable</em> 指定该类不能用作基类。</li>
  <li><em>Partial</em> 表示该类的定义部分。</li>
  <li><em>Inherits</em> 指定它所继承的基类。</li>
  <li><em>Implements</em> 指定类继承的接口。</li>
 </ul> 
 <p>下面的例子演示了一个<code>Box</code>类，它有三个数据成员，分别是：<code>length</code>, <code>breadth</code> 和 <code>height</code>：</p> 
 <pre><code class="lang-vbnet">Module mybox
   Class Box
      Public length As Double   ' Length of a box '
      Public breadth As Double   ' Breadth of a box '
      Public height As Double    ' Height of a box '
   End Class
   Sub Main()
      Dim Box1 As Box = New Box()        ' Declare Box1 of type Box '
      Dim Box2 As Box = New Box()        ' Declare Box2 of type Box '
      Dim volume As Double = 0.0     ' Store the volume of a box here '
      ' box 1 specification '
      Box1.height = 5.0
      Box1.length = 6.0
      Box1.breadth = 7.0
       ' box 2 specification '
      Box2.height = 10.0
      Box2.length = 12.0
      Box2.breadth = 13.0
      'volume of box 1 '
      volume = Box1.height * Box1.length * Box1.breadth
      Console.WriteLine("Volume of Box1 : {0}", volume)
      'volume of box 2 '
      volume = Box2.height * Box2.length * Box2.breadth
      Console.WriteLine("Volume of Box2 : {0}", volume)
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc mybox.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
......
F:\worksp\vb.net\classes_objects&gt;mybox.exe
Volume of Box1 : 210
Volume of Box2 : 1560
</code></pre> 
 <h2 id="h2-u6210u5458u51FDu6570u548Cu5C01u88C5"><a name="成员函数和封装" class="reference-link"></a><span class="header-link octicon octicon-link"></span>成员函数和封装</h2>
 <p>一个类的成员函数是一个函数，它在类定义中具有其定义或原型，就像任何其他变量一样。 它在它所属的类的任何对象上运行，并且可以访问该对象的类的所有成员。</p> 
 <p>成员变量是一个对象的属性(从设计的角度来看)，它们是保密的，以实现封装。 这些变量只能使用公共成员函数来访问。</p> 
 <p>让我们来看看上面的概念设置和获得不同类成员的值：</p> 
 <pre><code class="lang-vbnet">Module MemberFunctions
   Class Box
      Public length As Double   ' Length of a box '
      Public breadth As Double   ' Breadth of a box'
      Public height As Double    ' Height of a box'
      Public Sub setLength(ByVal len As Double)
          length = len
      End Sub
      Public Sub setBreadth(ByVal bre As Double)
          breadth = bre
      End Sub
      Public Sub setHeight(ByVal hei As Double)
          height = hei
      End Sub
      Public Function getVolume() As Double
          Return length * breadth * height
      End Function
   End Class
   Sub Main()
      Dim Box1 As Box = New Box()        ' Declare Box1 of type Box'
      Dim Box2 As Box = New Box()        ' Declare Box2 of type Box'
      Dim volume As Double = 0.0     ' Store the volume of a box here'

     ' box 1 specification'
      Box1.setLength(6.0)
      Box1.setBreadth(7.0)
      Box1.setHeight(5.0)

      'box 2 specification'
      Box2.setLength(12.0)
      Box2.setBreadth(13.0)
      Box2.setHeight(10.0)

      ' volume of box 1'
      volume = Box1.getVolume()
      Console.WriteLine("Volume of Box1 : {0}", volume)

      'volume of box 2'
      volume = Box2.getVolume()
      Console.WriteLine("Volume of Box2 : {0}", volume)
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc MemberFunctions.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
F:\worksp\vb.net\classes_objects&gt;MemberFunctions.exe
Volume of Box1 : 210
Volume of Box2 : 1560
</code></pre> 
 <h2 id="h2-u6784u9020u51FDu6570u548Cu6790u6784u51FDu6570"><a name="构造函数和析构函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>构造函数和析构函数</h2>
 <p>一个类的构造函数是一个类的特殊成员子程序，每当创建这个类的新对象的时候构造函数就会被执行。一个构造函数名称为：<code>New</code>，它没有任何返回类型。</p> 
 <p>以下程序演示了构造函数的概念和使用：</p> 
 <pre><code class="lang-vbnet">Module MemberFunctions
   Class Box
      Public length As Double   ' Length of a box '
      Public breadth As Double   ' Breadth of a box'
      Public height As Double    ' Height of a box'
      Public Sub setLength(ByVal len As Double)
          length = len
      End Sub
      Public Sub setBreadth(ByVal bre As Double)
          breadth = bre
      End Sub
      Public Sub setHeight(ByVal hei As Double)
          height = hei
      End Sub
      Public Function getVolume() As Double
          Return length * breadth * height
      End Function
   End Class
   Sub Main()
      Dim Box1 As Box = New Box()        ' Declare Box1 of type Box'
      Dim Box2 As Box = New Box()        ' Declare Box2 of type Box'
      Dim volume As Double = 0.0     ' Store the volume of a box here'

     ' box 1 specification'
      Box1.setLength(6.0)
      Box1.setBreadth(7.0)
      Box1.setHeight(5.0)

      'box 2 specification'
      Box2.setLength(12.0)
      Box2.setBreadth(13.0)
      Box2.setHeight(10.0)

      ' volume of box 1'
      volume = Box1.getVolume()
      Console.WriteLine("Volume of Box1 : {0}", volume)

      'volume of box 2'
      volume = Box2.getVolume()
      Console.WriteLine("Volume of Box2 : {0}", volume)
      Console.ReadKey()
   End Sub
End Module
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-vbnet">F:\worksp\vb.net\classes_objects&gt;vbc Line.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
......
F:\worksp\vb.net\classes_objects&gt;Line.exe
Object is being created
Length of line : 6
</code></pre> 
 <p>默认的构造函数没有任何参数，但是如果需要的话，构造函数可以有参数。这样的构造函数被称为参数化的构造函数。这种技术可以在创建对象时将初始值赋值，如以下示例所示：</p> 
 <pre><code class="lang-vbnet">Class Line2
   Private length As Double    ' Length of a line '
   Public Sub New(ByVal len As Double)   'parameterised constructor '
      Console.WriteLine("Object is being created, length = {0}", len)
      length = len
   End Sub
   Public Sub setLength(ByVal len As Double)
      length = len
   End Sub

   Public Function getLength() As Double
      Return length
   End Function
   Shared Sub Main()
      Dim line As Line2 = New Line2(199.0)
      Console.WriteLine("Length of line set by constructor : {0}", line.getLength())
      'set line length '
      line.setLength(68.0)
      Console.WriteLine("Length of line set by setLength : {0}", line.getLength())
      Console.ReadKey()
   End Sub
End Class
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc Line2.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
......
F:\worksp\vb.net\classes_objects&gt;Line2.exe
Object is being created, length = 199
Length of line set by constructor : 199
Length of line set by setLength : 68
</code></pre> 
 <p>析构函数是一个类的特殊成员子程序(Sub)，只要它的类的一个对象超出了作用域就会被执行。</p> 
 <p>析构函数名称为<code>Finalize</code>，它既不能返回值也不能带任何参数。在关闭文件，释放内存等程序出来之前，析构函数可以非常有用地释放资源。</p> 
 <p>析构函数不能被继承或重载。</p> 
 <p>下面的例子演示了如何使用析构函数：</p> 
 <pre><code class="lang-vbnet">Class Line3
   Private length As Double    ' Length of a line'
   Public Sub New()   'parameterised constructor'
      Console.WriteLine("Object is being created")
   End Sub
   Protected Overrides Sub Finalize()  ' destructor'
      Console.WriteLine("Object is being deleted")
   End Sub
   Public Sub setLength(ByVal len As Double)
      length = len
   End Sub
   Public Function getLength() As Double
      Return length
   End Function
   Shared Sub Main()
      Dim line As Line3 = New Line3()
      'set line length '
      line.setLength(699.0)
      Console.WriteLine("Length of line : {0}", line.getLength())
      Console.ReadKey()
   End Sub
End Class
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p>   
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc Line3.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.

......

F:\worksp\vb.net\classes_objects&gt;Line3.exe
Object is being created
Length of line : 699
</code></pre> 
 <h2 id="h2-vb-net-"><a name="VB.Net类的共享成员" class="reference-link"></a><span class="header-link octicon octicon-link"></span>VB.Net类的共享成员</h2>
 <p>可以使用<code>Shared</code>关键字将类成员定义为静态的。当将一个类的成员声明为<code>Shared</code>时，这意味着无论该类创建了多少个对象，该成员只有一个副本。</p> 
 <p><code>Shared</code>关键字表示一个类只存在一个成员实例。共享变量用于定义常量，因为它们的值可以通过调用该类而不创建实例来调用获取。</p> 
 <p>共享变量可以在成员函数或类定义之外初始化。也可以在类定义中初始化共享变量。</p> 
 <p>可以声明一个成员函数为<code>Shared</code>。这样的函数只能访问共享变量。<code>Shared</code>函数甚至在创建对象之前就存在。</p> 
 <p>以下示例演示了共享(<code>Shared</code>)成员的使用：</p> 
 <pre><code class="lang-vbnet">Class StaticVar
   Public Shared num As Integer
   Public Sub count()
      num = num + 100
   End Sub
   Public Shared Function getNum() As Integer
      Return num
   End Function
   Shared Sub Main()
      Dim s As StaticVar = New StaticVar()
      s.count()
      s.count()
      s.count()
      Console.WriteLine("Value of variable num: {0}", StaticVar.getNum())
      Console.ReadKey()
   End Sub
End Class
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc StaticVar.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.

.....

F:\worksp\vb.net\classes_objects&gt;StaticVar.exe
Value of variable num: 300
</code></pre> 
 <h2 id="h2-u7EE7u627F"><a name="继承" class="reference-link"></a><span class="header-link octicon octicon-link"></span>继承</h2>
 <p>面向对象编程中最重要的概念之一就是继承。继承允许使用另一个类来定义一个类，这使得创建和维护应用程序变得更容易。这也提供了重用代码功能和快速实施时间的机会。</p> 
 <p>当创建一个类时，程序员可以指定新的类继承现有类的成员，而不是编写全新的数据成员和成员函数。这个现有的类被称为基类，新的类被称为派生类。</p> 
 <h4 id="h4-u57FAu7840u6D3Eu751Fu7C7B"><a name="基础派生类" class="reference-link"></a><span class="header-link octicon octicon-link"></span>基础派生类</h4>
 <p>一个类可以从多个类或接口派生，这意味着它可以从多个基类或接口继承数据和函数。<br>VB.Net中用于创建派生类的语法如下所示：</p> 
 <pre><code class="lang-vb">&lt;access-specifier&gt; Class &lt;base_class&gt;
...
End Class
Class &lt;derived_class&gt;: Inherits &lt;base_class&gt;
...
End Class
</code></pre> 
 <p>考虑一个基类<code>Shape</code>及其派生类<code>Rectangle</code>：</p> 
 <pre><code class="lang-vbnet">' 定义基类 '
Class Shape
   Protected width As Integer
   Protected height As Integer
   Public Sub setWidth(ByVal w As Integer)
      width = w
   End Sub
   Public Sub setHeight(ByVal h As Integer)
      height = h
   End Sub
End Class
' 子类或派生类 '
Class Rectangle : Inherits Shape
   Public Function getArea() As Integer
      Return (width * height)
   End Function
End Class
Class RectangleTester
   Shared Sub Main()
      Dim rect As Rectangle = New Rectangle()
      rect.setWidth(15)
      rect.setHeight(25)
      ' Print the area of the object. '
      Console.WriteLine("Total area: {0}", rect.getArea())
      Console.ReadKey()
   End Sub    
End Class
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc BaseDerived.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
.....
F:\worksp\vb.net\classes_objects&gt;BaseDerived.exe
Total area: 375
</code></pre> 
 <h4 id="h4-u57FAu7C7Bu521Du59CBu5316"><a name="基类初始化" class="reference-link"></a><span class="header-link octicon octicon-link"></span>基类初始化</h4>
 <p>派生类继承基类成员变量和成员方法。 因此，应该在创建子类之前创建超类对象。 在VB.Net中，超类或基类隐式地被称为:<em>MyBase</em>。</p> 
 <p>以下程序演示了这一点：</p> 
 <pre><code class="lang-vbnet">
' 定义基类 '
Class Shape
   Protected width As Integer
   Protected height As Integer
   Public Sub setWidth(ByVal w As Integer)
      width = w
   End Sub
   Public Sub setHeight(ByVal h As Integer)
      height = h
   End Sub
End Class
' 子类或派生类 '
Class Rectangle : Inherits Shape
   Public Function getArea() As Integer
      Return (width * height)
   End Function
End Class
Class RectangleTester
   Shared Sub Main()
      Dim rect As Rectangle = New Rectangle()
      rect.setWidth(15)
      rect.setHeight(25)
      ' Print the area of the object. '
      Console.WriteLine("Total area: {0}", rect.getArea())
      Console.ReadKey()
   End Sub    
End Class
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">F:\worksp\vb.net\classes_objects&gt;vbc BaseClassInitialization.vb
Microsoft (R) Visual Basic Compiler version 14.0.1038
for Visual Basic 2012
Copyright (c) Microsoft Corporation.  All rights reserved.
......
F:\worksp\vb.net\classes_objects&gt;BaseClassInitialization.exe
Length: 4.5
Width: 7.5
Area: 33.75
Cost: 2362.5
</code></pre>
 <br>      
</div></body></html>