<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Meteor方法</h1><div style="width:100%;float:left;" class="article-content">   
 <div> 
  <div>
    Meteor方法是写入在服务器侧的函数，但可以在客户端调用这些函数。 
  </div> 
 </div> 
 <div> 
  <p style="text-align:justify;"> 在服务器端，我们将创建两个简单的方法。第一个参数将加5，而第二个参数将加10。 </p> 
  <h2> 使用方法<br> </h2> 
  <p> <strong>meteorApp/server/main.js</strong> </p> 
  <div style="background-color:inherit;"> 
   <pre>if(Meteor.isServer) {
   Meteor.methods({
	
      method1: function (arg) {
         var result = arg + 5;
         return result;
      },

      method2: function (arg) {
         var result = arg + 10;
         return result;
      }
   });
}</pre> 
  </div> 
  <p style="font-family:Verdana, Geneva, Tahoma,  Helvetica, font-size:1.3em;font-weight:normal;background-color:inherit;"> <strong><span style="font-size:14px;">meteorApp/client/app.js</span></strong> </p> 
  <pre>	
if(Meteor.isClient) {
   var aaa = 'aaa'
   Meteor.call('method1', aaa, function (error, result) {
	
      if (error) {
         console.log(error);
         else {
            console.log('Method 1 result is: ' + result);
         }
      }
   );

   Meteor.call('method2', 5, function (error, result) {
      if (error) {
         console.log(error);
      } else {
         console.log('Method 2 result is: ' + result);
      }
   });
}</pre> 
  <div>
    当我们启动应用程序，我们将看到在控制台输出的计算值。
   <br> 
   <img src="/uploads/tutorial/20160426/1-160426213441D5.png" alt="">
   <br> 
  </div> 
  <img src="file://E:/data/youdao/qq24B39E2329F08D9F4C3146A571A415EF/ad972c0953ad4ef9b0e6b403684b60bb/clipboard.png">
  <br> 
  <h2> 
   <div>
     处理错误 
   </div> </h2> 
  <p> 如需处理错误，可以使用 Meteor.Error 方法。下面的例子说明如何为未登录用户处理错误。 </p> meteorApp/server/main.js
  <br> 
  <pre class="prettyprint lang-js">import { Meteor } from 'meteor/meteor';
Meteor.startup(() =&gt; {
  // code to run on server at startup
});
if(Meteor.isServer) {
   Meteor.methods({
      method1: function (param) {
         if (! this.userId) {
            throw new Meteor.Error("logged-out",
               "The user must be logged in to post a comment.");
         }
         return result;
      }
   });
}</pre> 
  <p style="font-family:Verdana, Geneva, Tahoma,  Helvetica, text-align:justify;font-size:15px !important;background-color:inherit;"> <span style="background-color:inherit;font-family:微软雅黑;font-size:14px;line-height:1.5;"></span> </p> 
  <h3> meteorApp/client/app.js </h3>   
  <pre>if(Meteor.isClient) {  Meteor.call('method1', 1, function (error, result) {
   if (error &amp;&amp; error.error === "logged-out") {
      console.log("errorMessage:", "Please log in to post a comment.");
   } else {
      console.log('Method 1 result is: ' + result);
   }});
}</pre> 
  <div>
    控制台将显示我们的自定义错误消息。
   <br> 
   <img src="/uploads/tutorial/20160426/1-160426213512A9.png" alt="">
   <br> 
  </div> 
  <img src="file://E:/data/youdao/qq24B39E2329F08D9F4C3146A571A415EF/2d90ba2ceafb495eabfdf96c890ec29c/clipboard.png">
  <br> 
 </div>
 <br>      
</div></body></html>