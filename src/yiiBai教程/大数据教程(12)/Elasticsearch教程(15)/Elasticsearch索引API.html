<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Elasticsearch索引API</h1><div style="width:100%;float:left;" class="article-content">   
 <p>这些API负责管理索引的所有方面，如设置，别名，映射，索引模板。</p> 
 <h2 id="h2-u521Bu5EFAu7D22u5F15"><a name="创建索引" class="reference-link"></a><span class="header-link octicon octicon-link"></span>创建索引</h2>
 <p>此API可用于创建索引。 当用户将<code>JSON</code>对象传递到任何索引时，可以自动创建索引，也可以在此之前创建索引。 要创建索引，只需要发送包含设置，映射和别名的发布请求，或者只发送一个没有正文的简单请求。 例如，</p> 
 <pre><code>POST http://localhost:9200/colleges
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"acknowledged":true}
</code></pre> 
 <p>或者，加上一些设置 -</p> 
 <pre><code>POST http://localhost:9200/colleges
</code></pre>
 <p><strong>请求正文</strong></p> 
 <pre><code class="lang-json">{
   "settings" : {
      "index" : {
         "number_of_shards" : 5, "number_of_replicas" : 3
      }
   }
}
</code></pre> 
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"acknowledged":true}
</code></pre> 
 <p>或使用映射 -</p> 
 <pre><code>POST http://localhost:9200/colleges
</code></pre>
 <p><strong>请求正文</strong></p> 
 <pre><code class="lang-json">{
   "settings" : {
      "number_of_shards" : 3
   },

   "mappings" : {
      "type1" : {
         "_source" : { "enabled" : false }, "properties" : {
            "college_name" : { "type" : "string" }, "college type" : {"type":"string"}
         }
      }
   }
}
</code></pre> 
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"acknowledged":true}
</code></pre> 
 <p>或者，用别名 -</p> 
 <pre><code>POST http://localhost:9200/colleges
</code></pre>
 <p><strong>请求正文</strong></p> 
 <pre><code class="lang-json">{
   "aliases" : {
      "alias_1" : {}, "alias_2" : {
         "filter" : {
            "term" : {"user" : "manu" }
         },
         "routing" : "manu"
      }
   }
}
</code></pre> 
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"acknowledged":true}
</code></pre> 
 <h2 id="h2-u5220u9664u7D22u5F15"><a name="删除索引" class="reference-link"></a><span class="header-link octicon octicon-link"></span>删除索引</h2>
 <p>此API可用来删除任何索引。只需要传递一个删除请求以及指定索引的URL。 例如，</p> 
 <pre><code>DELETE http://localhost:9200/colleges
</code></pre>
 <p>可以通过使用<code>_all，*</code>删除所有索引。</p> 
 <h2 id="h2-u83B7u53D6u7D22u5F15"><a name="获取索引" class="reference-link"></a><span class="header-link octicon octicon-link"></span>获取索引</h2>
 <p>这个API可以通过发送<code>get</code>请求到一个或多个索引来调用。这将返回有关索引的信息。</p> 
 <pre><code>GET http://localhost:9200/schools
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{
   "schools":{
      "aliases":{}, "mappings":{
         "school":{
            "properties":{
               "city":{"type":"string"}, "description":{"type":"string"},
               "fees":{"type":"long"}, "location":{"type":"double"},
               "name":{"type":"string"}, "rating":{"type":"string"},
               "state":{"type":"string"}, "street":{"type":"string"},
               "tags":{"type":"string"}, "zip":{"type":"string"}
            }
         }
      },

      "settings":{
         "index":{
            "creation_date":"1454409831535", "number_of_shards":"5",
            "number_of_replicas":"1", "uuid":"iKdjTtXQSMCW4xZMhpsOVA",
            "version":{"created":"2010199"}
         }
      },
      "warmers":{}
   }
}
</code></pre> 
 <p>可以使用<code>_all</code>或<code>*</code>来获取所有索引的信息。</p> 
 <h2 id="h2-u6D4Bu8BD5u7D22u5F15u5B58u5728"><a name="测试索引存在" class="reference-link"></a><span class="header-link octicon octicon-link"></span>测试索引存在</h2>
 <p>可以通过向该索引发送获取请求来确定索引的存在。如果HTTP响应为<code>200</code>，则存在; 如果是<code>404</code>，它不存在。</p> 
 <h2 id="h2--api"><a name="打开/关闭索引API" class="reference-link"></a><span class="header-link octicon octicon-link"></span>打开/关闭索引API</h2>
 <p>通过在<code>post</code>中添加<code>_close</code>或<code>_open</code>来请求索引，可以很容易地关闭或打开一个或多个索引。 例如，<br>关闭索引-</p> 
 <pre><code>POST http://localhost:9200/schools/_close
</code></pre>
 <p>或打开索引-</p> 
 <pre><code>POST http://localhost:9200/schools/_open
</code></pre>
 <h2 id="h2-u7D22u5F15u522Bu540D"><a name="索引别名" class="reference-link"></a><span class="header-link octicon octicon-link"></span>索引别名</h2>
 <p>此API有助于使用<code>_aliases</code>关键字向任何索引提供别名。 单个别名可以映射到多个别名，且别名不能与索引具有相同的名称。 例如，</p> 
 <pre><code>POST http://localhost:9200/_aliases
</code></pre>
 <p><strong>请求正文</strong></p> 
 <pre><code class="lang-json">{
   "actions" : [
      { "add" : { "index" : "schools", "alias" : "schools_pri" } }
   ]
}
</code></pre> 
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"acknowledged":true}
</code></pre> 
 <p>然后，</p> 
 <pre><code>GET http://localhost:9200/schools_pri
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"schools":{"aliases":{"schools_pri":{}},"}}
</code></pre> 
 <h2 id="h2-u7D22u5F15u8BBEu7F6E"><a name="索引设置" class="reference-link"></a><span class="header-link octicon octicon-link"></span>索引设置</h2>
 <p>可以通过在URL结尾处附加<code>_settings</code>关键字来获取索引设置。 例如，</p> 
 <pre><code>GET http://localhost:9200/schools/_settings
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{
   "schools":{
      "settings":{
         "index":{
            "creation_date":"1454409831535", "number_of_shards":"5", 
            "number_of_replicas":"1", "uuid":"iKdjTtXQSMCW4xZMhpsOVA", 
            "version":{"created":"2010199"}
        }
      }
   }
}
</code></pre> 
 <h2 id="h2-u5206u6790"><a name="分析" class="reference-link"></a><span class="header-link octicon octicon-link"></span>分析</h2>
 <p>此API有助于分析文本并使用偏移值和数据类型发送令牌。 例如，</p>   
 <pre><code>POST http://localhost:9200/_analyze
</code></pre>
 <p><strong>请求正文</strong></p> 
 <pre><code class="lang-json">{
   "analyzer" : "standard",
   "text" : "you are reading this at YIIBAI point"
}
</code></pre> 
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{
   "tokens":[
      {"token":"you", "start_offset":0, "end_offset":3, "type":"&lt;ALPHANUM&gt;", "position":0},
      {"token":"are", "start_offset":4, "end_offset":7, "type":"&lt;ALPHANUM&gt;", "position":1},
      {"token":"reading", "start_offset":8, "end_offset":15, "type":"&lt;ALPHANUM&gt;", "position":2},
      {"token":"this", "start_offset":16, "end_offset":20, "type":"&lt;ALPHANUM&gt;", "position":3},
      {"token":"at", "start_offset":21, "end_offset":23, "type":"&lt;ALPHANUM&gt;", "position":4},
      {"token":"tutorials", "start_offset":24, "end_offset":33, "type":"&lt;ALPHANUM&gt;", "position":5},
      {"token":"point", "start_offset":34, "end_offset":39, "type":"&lt;ALPHANUM&gt;", "position":6}
   ]
}
</code></pre> 
 <p>还可以使用任何索引分析文本，然后根据与该索引关联的分析器来分析文本。</p> 
 <h2 id="h2-u7D22u5F15u6A21u677F"><a name="索引模板" class="reference-link"></a><span class="header-link octicon octicon-link"></span>索引模板</h2>
 <p>还可以创建具有映射的索引模板，这可以应用于新的索引。 例如，</p> 
 <pre><code>POST http://localhost:9200/_template/template_a
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{
   "template" : "tu*", 
      "settings" : {
         "number_of_shards" : 3
   },

   "mappings" : {
      "chapter" : {
         "_source" : { "enabled" : false }
      }
   }
}
</code></pre> 
 <p>以“<code>tu</code>”开头的任何索引都将具有与模板相同的设置。</p> 
 <h2 id="h2-u7D22u5F15u7EDFu8BA1"><a name="索引统计" class="reference-link"></a><span class="header-link octicon octicon-link"></span>索引统计</h2>
 <p>此API可用于提取有关特定索引的统计信息。只需要发送一个带有索引<code>URL</code>和<code>_stats</code>关键字的<code>get</code>请求。</p> 
 <pre><code>GET http://localhost:9200/schools/_stats
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">………………………………………………
{"_shards":{"total":10, "successful":5, "failed":0}, "_all":{"primaries":{"docs":{
   "count":3, "deleted":0}}}, "store":{"size_in_bytes":16653, "throttle_time_in_millis":0},
………………………………………………
</code></pre> 
 <h2 id="h2-u5237u65B0u6E05u9664u6570u636E"><a name="刷新清除数据" class="reference-link"></a><span class="header-link octicon octicon-link"></span>刷新清除数据</h2>
 <p>此API用于从索引内存中清除数据，并将其迁移到索引存储，并清除内部事务日志。 例如，</p> 
 <pre><code>GET http://localhost:9200/schools/_flush
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"_shards":{"total":10, "successful":5, "failed":0}}
</code></pre> 
 <h2 id="h2-u5237u65B0u7D22u5F15"><a name="刷新索引" class="reference-link"></a><span class="header-link octicon octicon-link"></span>　刷新索引</h2>
 <p>默认情况下，刷新在<strong>Elasticsearch</strong>中一般按计划来执行，但可以使用<code>_refresh</code>显式刷新一个或多个索引。 例如，</p> 
 <pre><code>GET http://localhost:9200/schools/_refresh
</code></pre>
 <p><strong>响应</strong></p> 
 <pre><code class="lang-json">{"_shards":{"total":10, "successful":5, "failed":0}}
</code></pre>
 <br>      
</div></body></html>