<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Hadoop程序入门实践</h1><div style="width:100%;float:left;" class="article-content">   
 <p> <strong>问题陈述：</strong></p> 
 <p> 找出销往各个国家商品数量。</p> 
 <p> 输入:&nbsp;我们的畋输入数据集合是一个 CSV 文件,&nbsp;Sales2014.csv</p> 
 <p> <strong>前提条件：</strong></p> 
 <ul> 
  <li> 本教程是在Linux上开发 - Ubuntu操作系统</li> 
  <li> 已经安装了Hadoop(本教程使用版本2.7.1)</li> 
  <li> 系统上已安装了Java(本教程使用 JDK1.8.0)。</li> 
 </ul> 
 <p> 在实际操作过程中，使用的用户是'hduser_“(此用户使用 Hadoop)。</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
yiibai@ubuntu:~$ su hduser_</pre> 
 <p> 步骤:</p> 
 <p> 1.创建一个新的目录名称是：MapReduceTutorial</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ sudo mkdir MapReduceTuorial</pre> 
 <p style="margin: 5px 0px; widows: auto; color: rgb(52, 52, 52); 'Droid Sans'; font-size: 17px;"> <strong style="background-color: inherit;">授予权限</strong></p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ sudo chmod -R 777 MapReduceTutorial</pre> 
 <p style="margin: 5px 0px; widows: auto; color: rgb(52, 52, 52); 'Droid Sans'; font-size: 17px;"> <a target="_blank" href="http://cdn.guru99.com/images/Big_Data/061114_0954_CreateYourF3.png" style="background-color: inherit; cursor: pointer; color: rgb(112, 189, 205);"><img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/5ae0ddc4a8154784991f9e5d0fcbecac/createyourf3.png" data-attr-org-src-id="EE85BF13DCEF4BA0872706A924EC61A6" data-media-type="image" src="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/5ae0ddc4a8154784991f9e5d0fcbecac/createyourf3.png" style="display: inline-block; margin-top: 8px; max-width: 800px; background-color: inherit;"></a></p> 
 <p> 下载相关文件：<a target="_blank" href="http://pan.baidu.com/s/1o6EbAUQ">下载 Java 程序文件</a>，拷贝以下文件：SalesMapper.java, SalesCountryReducer.java&nbsp;和&nbsp;SalesCountryDriver.java&nbsp;到 MapReduceTutorial 目录中，</p> 
 <p> 检查所有这些文件的文件权限是否正确：<br> <img alt="" src="/uploads/allimg/201509/1-150913111500Y7.png" style="width: 643px; height: 165px;"><img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/480161075aab4dbeb69a190e7fd5145d/clipboard.png" data-attr-org-src-id="F5248A95CB914A9B98652930196B6C32" data-media-type="image" src="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/480161075aab4dbeb69a190e7fd5145d/clipboard.png"></p> 
 <p> 如果“读取”权限缺少可重新再授予权限，执行以下命令：</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
yiibai@ubuntu:/home/hduser_/MapReduceTutorial$ sudo chmod +r *</pre> 
 <p> 2.导出类路径</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~/MapReduceTutorial$ export CLASSPATH="$HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-client-core-2.7.1.jar:$HADOOP_HOME/share/hadoop/mapreduce/hadoop-mapreduce-client-common-2.7.1.jar:$HADOOP_HOME/share/hadoop/common/hadoop-common-2.7.1.jar:~/MapReduceTutorial/SalesCountry/*:$HADOOP_HOME/lib/*"
hduser_@ubuntu:~/MapReduceTutorial$</pre> 
 <p> 3.&nbsp;编译Java文件(这些文件存在于目录：Final-MapReduceHandsOn). 它的类文件将被放在包目录：</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~/MapReduceTutorial$ javac -d . SalesMapper.java SalesCountryReducer.java SalesCountryDriver.java</pre> 
 <p style="margin: 5px 0px; widows: auto; color: rgb(52, 52, 52); 'Droid Sans'; font-size: 17px;"> <img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/7377a9dee8dd4d80b0c05d06020e9a94/clipboard.png" data-attr-org-src-id="C3BC88BDD199413AB95AEE9427BE242A" data-media-type="image" src="/uploads/allimg/201509/1-150913111543203.png" style="display: inline-block; margin-top: 8px; width: 800px; background-color: inherit;"></p> 
 <p> <strong>安全地忽略此警告：</strong></p> 
 <p> 此编译将创建一个名称与Java源文件(在我们的例子即，SalesCountry)指定包名称的目录，并把所有编译的类文件在里面，因此这个目录要在编译文件前创建。<br> <img alt="" src="/uploads/allimg/201509/1-150913111624M8.png" style="width: 472px; height: 136px;"><a target="_blank" href="http://cdn.guru99.com/images/Big_Data/061114_0954_CreateYourF9.png"><img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/eceae0a100a942ff9d48b5bfc04f7661/createyourf9.png" data-attr-org-src-id="1F2B7DAAA69B45F2B1D92A33B06332C8" data-media-type="image" src="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/eceae0a100a942ff9d48b5bfc04f7661/createyourf9.png"></a></p> 
 <p> 接下来：</p> 
 <p> 创建一个新的文件：<em><strong>Manifest.txt</strong></em></p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~/MapReduceTutorial$ vi Manifest.txt</pre> 
 <p> 添加以下内容到文件中：</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
Main-Class: SalesCountry.SalesCountryDriver</pre> 
 <p> <strong>SalesCountry.SalesCountryDriver</strong>&nbsp;是主类的名称。请注意，必须键入回车键，在该行的末尾。</p> 
 <p> 下一步：创建一个 jar 文件</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~/MapReduceTutorial$ $JAVA_HOME/bin/jar cfm ProductSalePerCountry.jar Manifest.txt SalesCountry/*.class</pre> 
 <p> 检查所创建的 jar 文件，结果如下：</p> 
 <p style="margin: 5px 0px; widows: auto; color: rgb(52, 52, 52); 'Droid Sans'; font-size: 17px;"> <img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/4491ec862a3648a294922a350e9648f0/clipboard.png" data-attr-org-src-id="1F69077A4EF844619D3E73A620A6861C" data-media-type="image" src="/uploads/allimg/201509/1-150913111H3210.png" style="display: inline-block; margin-top: 8px; width: 800px; background-color: inherit;"></p> 
 <p> 6.&nbsp;启动 Hadoop</p>   
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ $HADOOP_HOME/sbin/start-dfs.sh
hduser_@ubuntu:~$ $HADOOP_HOME/sbin/start-yarn.sh</pre> 
 <p> <img alt="" src="/uploads/allimg/201509/1-150913111Q45C.png" style="width: 755px; height: 167px;"><br> <br> 7.&nbsp;拷贝文件&nbsp;<em><strong>Sales2014.csv</strong></em>&nbsp;到<strong><em>&nbsp;~/inputMapReduce</em></strong></p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ mkdir inputMapReduce
hduser_@ubuntu:~$ cp MapReduceTutorial/Sales2014.csv ./inputMapReduce/Sales2014.csv</pre> 
 <p> 现在使用以下命令来拷贝&nbsp;~/inputMapReduce&nbsp;到&nbsp;HDFS.</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ $HADOOP_HOME/bin/hdfs dfs -copyFromLocal ~/inputMapReduce /</pre> 
 <p> 我们可以放心地忽略此警告。验证文件是否真正复制没有？</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ $HADOOP_HOME/bin/hdfs dfs -ls /inputMapReduce</pre> 
 <p> 8.&nbsp;运行MapReduce 作业</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ $HADOOP_HOME/bin/hadoop jar ProductSalePerCountry.jar /inputMapReduce /mapreduce_output_sales</pre> 
 <p> 这将在 HDFS 上创建一个输出目录，名为mapreduce_output_sales。此目录的文件内容将包含每个国家的产品销售。</p> 
 <p> 9.&nbsp;结果可以通过命令界面中可以看到</p> 
 <pre style="'Courier New', Courier, monospace; widows: auto; color: rgb(51, 51, 51); font-size: 14px; background-color: rgb(245, 245, 245);">
hduser_@ubuntu:~$ $HADOOP_HOME/bin/hdfs dfs -cat /mapreduce_output_sales/part-00000</pre> 
 <p> 结果也可以通过 Web 界面看到，打开 Web 浏览器，输入网址：http://localhost:50070/dfshealth.jsp ，结果如下：<br> <img alt="" src="/uploads/allimg/201509/1-150913111Z1210.png" style="width: 735px; height: 344px;"></p> 
 <p> <img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/9864ddcff0174965afc4141e889d4aaa/clipboard.png" data-attr-org-src-id="EEE5132028354F8EB351E91CFA93E90E" data-media-type="image" src="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/9864ddcff0174965afc4141e889d4aaa/clipboard.png">现在选择&nbsp;'Browse the filesystem'&nbsp;并导航到&nbsp;/mapreduce_output_sales&nbsp;如下：</p> 
 <p style="margin: 5px 0px; widows: auto; color: rgb(52, 52, 52); 'Droid Sans'; font-size: 17px;"> <img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/41c5244b87bf4c87bed71691fae737c1/clipboard.png" data-attr-org-src-id="209253BB95184A06B848DA89B020C867" data-media-type="image" src="/uploads/allimg/201509/1-150913111950538.png" style="display: inline-block; margin-top: 8px; width: 844px; height: 417px; background-color: inherit;"></p> 
 <p> 打开&nbsp;part-r-00000 ，如下图所示：<br> <img alt="" src="/uploads/allimg/201509/1-15091311200b00.png" style="width: 586px; height: 538px;"><br> <img data-attr-org-img-file="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/2d9829d9b48e475a9cae3ad6d57c2d56/clipboard.png" data-attr-org-src-id="DFFD2FE4BBC943C28E2315BB2737D08B" data-media-type="image" src="file:///D:/Program%20Files/qq24B39E2329F08D9F4C3146A571A415EF/2d9829d9b48e475a9cae3ad6d57c2d56/clipboard.png"></p> 
 <p> 下载后，查看结果内容。</p> 
 <br>      
</div></body></html>