<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Hadoop多节点集群</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 本章介绍了在分布式环境中Hadoop多节点集群的设置。</p> 
 <p> 由于整个集群不能表现出来，这里作为示例，我们使用三个系统(一个主机和两个从机)的Hadoop集群环境;下面给出的是其IP地址。</p> 
 <ul> 
  <li> Hadoop 主机: 192.168.1.15 (hadoop-master)</li> 
  <li> Hadoop 从机: 192.168.1.16 (hadoop-slave-1)</li> 
  <li> Hadoop 从机: 192.168.1.17 (hadoop-slave-2)</li> 
 </ul> 
 <p> 按照下面给出Hadoop的多节点集群设置的步骤。</p> 
 <h2> 安装Java</h2> 
 <p> Java是Hadoop的主要先决条件。首先，应该使用 “java -version”在系统上检查 java 是否已经安装。Java version 命令的语法如下。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ java </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">version</span></pre> 
 <p> 如果一切正常，它会给出下面的输出。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">java version </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">"1.7.0_71"</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Java</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">TM</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> SE </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Runtime</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Environment</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">build </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.7</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">0_71</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">b13</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Java</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">HotSpot</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">TM</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Client</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> VM </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">build </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">25.0</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">b02</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">,</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> mixed mode</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span></pre> 
 <p> 如果Java尚未安装系统中，那么可以按照下面给定的步骤来安装Java。</p> 
 <h3> 第1步</h3> 
 <p> 
  <latest version="">
   下载Java（JDK - X64.tar.gz）通过访问以下链接&nbsp;
   <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html" rel="nofollow">http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html</a>
  </latest></p> 
 <p> 那么jdk-7u71-linux-x64.tar.gz下载到系统。</p> 
 <h3> 第2步</h3> 
 <p> 一般来说，在下载文件夹中找到下载的Java文件。使用下面的命令提取 jdk-7u71-linux-x64.gz 文件。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ cd </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Downloads</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
$ ls
jdk</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7u71</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Linux</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">x64</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">gz
$ tar zxf jdk</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7u71</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Linux</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">x64</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">gz
$ ls
jdk1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7.0</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">_71 jdk</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7u71</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Linux</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">x64</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">gz</span></pre> 
 <h3> 第3步</h3> 
 <p> 为了使Java能提供给所有用户，必须将它移动到 “/usr/local/” 的位置。使用root用户打开然后键入以下命令。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ su
password</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># mv jdk1.7.0_71 /usr/local/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># exit</span></pre> 
 <h3> 第4步</h3> 
 <p> 有关设置 PATH 和 JAVA_HOME 变量，添加以下命令到&nbsp;~/.bashrc&nbsp;文件。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">export</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> JAVA_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/usr/</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">local</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">jdk1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7.0</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">_71
</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">export</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> PATH</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">PATH</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$JAVA_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">bin</span></pre> 
 <p> 现在使用java -version命令从终端验证上述说明。按照上面的过程，并在所有群集节点安装java。</p> 
 <h2> 创建用户帐户</h2> 
 <p> 在主机和从机系统上创建一个系统用户帐户来安装Hadoop。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># useradd hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># passwd hadoop</span></pre> 
 <h2> 映射节点</h2> 
 <p> 编辑hosts文件在所有节点的/etc/目录，指定每个系统后面的主机名和IP地址。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># vi /etc/hosts</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
enter the following lines </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> the </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">etc</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hosts file</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">192.168</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.109</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">master 
</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">192.168</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.145</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">192.168</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">56.1</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2</span></pre> 
 <h2> 配置基于密钥登录</h2> 
 <p> 在每一个节点，设置的ssh使得它们可在没有任何提示密码彼此通信。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># su hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
$ ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">keygen </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">t rsa 
$ ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">copy</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">i </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">~</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/.ssh/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id_rsa</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pub yiibai@hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">master 
$ ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">copy</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">i </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">~</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/.ssh/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id_rsa</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pub hadoop_tp1@hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
$ ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">copy</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">i </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">~</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/.ssh/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id_rsa</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pub hadoop_tp2@hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
$ chmod </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">0600</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">~</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/.ssh/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">authorized_keys 
$ </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">exit</span></pre> 
 <h2> 安装Hadoop</h2> 
 <p> 在主服务器上，下载并使用以下命令安装Hadoop。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># mkdir /opt/hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># cd /opt/hadoop/ </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># wget http://apache.mesi.com.ar/hadoop/common/hadoop-1.2.1/hadoop-1.2.0.tar.gz </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># tar -xzf hadoop-1.2.0.tar.gz </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># mv hadoop-1.2.0 hadoop</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># chown -R hadoop /opt/hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># cd /opt/hadoop/hadoop/</span></pre> 
 <h2> 配置Hadoop</h2> 
 <p> 必须做以下修改，如下所示配置Hadoop的服务器。</p> 
 <h3> core-site.xml</h3> 
 <p> 打开 core-site.xml文件并对其进行编辑，如下图所示。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;configuration&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">fs.default.name</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hdfs://hadoop-master:9000/</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs.permissions</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">false</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/configuration&gt;</span></pre> 
 <h3> hdfs-site.xml</h3> 
 <p> 打开hdfs-site.xml文件并对其进行编辑，如下图所示。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;configuration&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs.data.dir</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">/opt/hadoop/hadoop/dfs/name/data</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;final&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">true</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/final&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 

   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs.name.dir</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">/opt/hadoop/hadoop/dfs/name</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;final&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">true</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/final&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 

   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs.replication</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">1</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/configuration&gt;</span></pre> 
 <h3> mapred-site.xml</h3> 
 <p> 打开mapred-site.xml文件并对其进行编辑，如下图所示。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;configuration&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">mapred.job.tracker</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
      </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop-master:9001</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/configuration&gt;</span></pre> 
 <h3> hadoop-env.sh</h3> 
 <p> 打开hadoop-env.sh文件并编辑JAVA_HOME，HADOOP_CONF_DIR和HADOOP_OPTS，如下图所示。</p> 
 <p> 注意：根据系统配置设置JAVA_HOME 。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">export</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> JAVA_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/opt/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">jdk1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7.0</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">_17 </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">export</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> HADOOP_OPTS</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=-</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Djava</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">net</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">preferIPv4Stack</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">true</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">export</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> HADOOP_CONF_DIR</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/opt/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">conf</span></pre> 
 <h2> 在从服务器上安装Hadoop</h2> 
 <p> 对所有从服务器按照给定的命令安装Hadoop。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># su hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
$ cd </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">opt</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop 
$ scp </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">r hadoop hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/opt/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop 
$ scp </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">r hadoop hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/opt/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span></pre> 
 <h2> 主服务器上配置Hadoop</h2> 
 <p> 打开主服务器，并按照给定的命令进行配置。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># su hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
$ cd </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">opt</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span></pre> 
 <h3> 配置主节点</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ vi etc</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">masters
hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">master</span></pre> 
 <h3> 配置从节点</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ vi etc</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slaves
hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2</span></pre> 
 <h3> Hadoop主服务器上格式名称节点</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);"># su hadoop </span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
$ cd </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">opt</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop 
$ bin</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop namenode </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">–</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">format</span></pre> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">11</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">14</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">58</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">07</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> INFO namenode</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">NameNode</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> STARTUP_MSG</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);">/************************************************************ 
STARTUP_MSG: Starting NameNode 
STARTUP_MSG: host = hadoop-master/192.168.1.109 
STARTUP_MSG: args = [-format] 
STARTUP_MSG: version = 1.2.0 
STARTUP_MSG: build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-1.2 -r 1479473; compiled by 'hortonfo' on Mon May 6 06:59:37 UTC 2013 
STARTUP_MSG: java = 1.7.0_71 ************************************************************/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">11</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">14</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">58</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">08</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> INFO util</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">GSet</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Computing</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> capacity </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">for</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> map </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">BlocksMap</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> editlog</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/opt/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">name</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">current</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">edits
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">………………………………………………….</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">………………………………………………….</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">………………………………………………….</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">11</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">14</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">58</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">08</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> INFO common</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Storage</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Storage</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> directory </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">opt</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">name has been successfully formatted</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">11</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">14</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">58</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">08</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> INFO namenode</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">NameNode</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
SHUTDOWN_MSG</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="com" style="box-sizing: border-box; color: rgb(136, 0, 0);">/************************************************************ SHUTDOWN_MSG: Shutting down NameNode at hadoop-master/192.168.1.15 ************************************************************/</span></pre> 
 <h2> 启动Hadoop服务</h2> 
 <p> 下面的命令是启动主Hadoop的所有Hadoop服务。</p>   
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ cd $HADOOP_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">sbin
$ start</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">all</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">sh</span></pre> 
 <h2> 在Hadoop集群的添加新DataNode</h2> 
 <p> 下面给出遵循增加新节点Hadoop集群的步骤。</p> 
 <h3> 网络</h3> 
 <p> 添加新节点用一些适当的网络配置Hadoop集群。假设下面的网络配置。</p> 
 <p> 对于新的节点配置：</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">IP address </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">192.168</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.103</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
netmask </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">255.255</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">255.0</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
hostname </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> slave3</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span></pre> 
 <h2> 添加用户和SSH访问</h2> 
 <h3> 添加用户</h3> 
 <p> 在一个新的节点，使用以下命令添加“hadoopuser”用户并设置密码为“hadoop123”。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">useradd hadoop
passwd hadoop</span></pre> 
 <p> 从主机连接到新的从属机设置密码。</p> 
 <h3> 在主机执行以下</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">mkdir </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">p $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh 
chmod </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">700</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh 
ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">keygen </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">t rsa </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">P </span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">''</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">f $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id_rsa 
cat $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id_rsa</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pub </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">authorized_keys 
chmod </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">644</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">authorized_keys
</span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Copy</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> the </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">public</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> key to </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">new</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> slave node </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> hadoop user $HOME directory
scp $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">id_rsa</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pub hadoop@192</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">168.1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">103</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">:</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/home/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span></pre> 
 <h3> 在从机以下执行</h3> 
 <p> 登录到Hadoop。如果不是则登录到 Hadoop 用户。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">su hadoop ssh </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">X hadoop@192</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">168.1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">103</span></pre> 
 <p> 复制公钥进入文件的内容&nbsp;<strong><em>"$HOME/.ssh/authorized_keys"</em></strong>&nbsp;并通过执行以下命令改变为相同的权限。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">cd $HOME
mkdir </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">p $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh 
chmod </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">700</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh
cat id_rsa</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">pub </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">authorized_keys 
chmod </span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">644</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> $HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">authorized_keys</span></pre> 
 <p> 检查SSH登录从主计算机。现在检查是否可以ssh到新的节点，从主机登陆不需要密码。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ssh hadoop@192</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">168.1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">103</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">or</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> hadoop@slave3</span></pre> 
 <h2> 新节点的主机名设置</h2> 
 <p> 设置主机名的文件<strong>&nbsp;/etc/sysconfig/network</strong></p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">On</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">new</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> slave3 machine
NETWORKING</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">yes 
HOSTNAME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">=</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave3</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span></pre> 
 <p> 为了使更改生效，请重新启动计算机或运行hostname命令，以新机与相应的主机名（重启是一个不错的选择）。</p> 
 <p> 在slave3节点机：</p> 
 <p> 主机名 slave3.&nbsp;在更新 /etc/ 集群具有以下行的所有机器从机：</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">192.168</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">1.102</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> slave3</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> slave3</span></pre> 
 <p> 现在尝试 <strong>ping </strong>计算机主机名来检查它是否解析为IP。</p> 
 <p> 在新的节点机：</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">ping master</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span></pre> 
 <h2> 启动新节点的DataNode</h2> 
 <p> 启动数据节点守护进程手动使用$HADOOP_HOME/bin/hadoop-daemon.sh脚本。它会自动联系主（NameNode），并加入集群。我们还应该将新节点添加到主服务器在conf/从机文件。基于脚本的命令将识别新节点。</p> 
 <h3> 登录新节点</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">su hadoop </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">or</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> ssh </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">X hadoop@192</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">168.1</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">103</span></pre> 
 <h3> 启动HDFS新添加从节点，通过使用以下命令</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="str" style="box-sizing: border-box; color: rgb(0, 136, 0);">/bin/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">daemon</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">sh start datanode</span></pre> 
 <h3> 检查输出一个新的节点上使用jps 命令。它看起来如下。</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ jps
</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">7141</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">DataNode</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">
</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">10312</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="typ" style="box-sizing: border-box; color: rgb(127, 0, 85);">Jps</span></pre> 
 <h2> 从Hadoop集群中删除DataNode</h2> 
 <p> 我们可以从正在运行一个集群中删除一个节点，在运行时，不会丢失任何数据。 HDFS提供了一个退役的功能，它可以确保删除节点安全地执行。要使用它，按照下列步骤，如下所示：</p> 
 <h3> 第1步：登录到主机</h3> 
 <p> 登录主机用户安装了Hadoop。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ su hadoop</span></pre> 
 <h3> 第2步：修改集群配置</h3> 
 <p> 排除文件必须在启动群集之前进行配置。添加一个名为键 dfs.hosts.exclude到$HADOOP_HOME/etc/hadoop/hdfs-site.xml文件。与此键关联的值提供了完整路径的NameNode是本地文件系统上的文件，其中包含未允许连接到HDFS的机器列表。</p> 
 <p> 例如，添加这些行到etc/hadoop/hdfs-site.xml文件。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;property&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">dfs.hosts.exclude</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/name&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">/home/hadoop/hadoop-1.2.1/hdfs_exclude.txt</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/value&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
   </span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;description&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">DFS exclude</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/description&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> 
</span><span class="tag" style="box-sizing: border-box; color: rgb(0, 0, 136);">&lt;/property&gt;</span></pre> 
 <h3> 第3步：确定主机可淘汰</h3> 
 <p> 每台机器要停止使用应该使用每一行标识添加到在一个域名的文件：hdfs_exclude.txt。这将阻止它们连接到NameNode。在“/home/hadoop/hadoop-1.2.1/hdfs_exclude.txt”文件的内容如下图所示，如果想删除DataNode2。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">slave2</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">in</span></pre> 
 <h3> 第4步：强制配置重装</h3> 
 <p> 运行命令“$ HADOOP_HOME/ bin中/ Hadoop的dfsadmin-refreshNodes”不带引号。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ $HADOOP_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">bin</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop dfsadmin </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">refreshNodes</span></pre> 
 <p> 这将迫使NameNode会重新读取它的配置，其中包括最近更新的“排除”的文件。它将停止使用该节点在一段时间，让时间为每个节点的块被复制到被安排要保持活跃的机器。</p> 
 <p> 在slave2.in，检查JPS命令的输出。一段时间后会看到DataNode过程是自动关机。</p> 
 <h3> 第5步：关闭节点</h3> 
 <p> 停止使用处理结束之后，停止使用硬件可以安全地关闭，进行维修。运行报告命令dfsadmin检查退役的状态。以下命令将描述退役节点的状态和所连接的节点集群。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ $HADOOP_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">bin</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop dfsadmin </span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">report</span></pre> 
 <h3> 第6步：编辑文件再次排除</h3> 
 <p> 一旦机已经停止使用，他们可以从'不包括'文件被删除。运行“$HADOOP_HOME/bin/hadoop dfsadmin -refreshNodes”再次将读取文件排除放回NameNode;允许DataNodes重新加入群集，维护工作已经完成，或额外的容量，需要集群中再次等后</p> 
 <p> 特别注意：如果上述过程向TaskTracker处理节点上之后仍在运行，它需要关闭。一种方式是在上述步骤确实断开的机器。主机将自动识别过程声明为无效。没有必要遵循相同的过程用于删除TaskTracker，因为它相比于DataNode不是关键。DataNode包含要安全地删除没有任何数据丢失。</p> 
 <p> TaskTracker可以在任何时间点运行以下命令关机。</p> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 604px; line-height: 16px; font-size: 14px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">$ $HADOOP_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">bin</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">daemon</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">sh stop tasktracker $HADOOP_HOME</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">bin</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">/</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hadoop</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">-</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">daemon</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">.</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">sh start tasktracker</span></pre> 
 <br>      
</div></body></html>