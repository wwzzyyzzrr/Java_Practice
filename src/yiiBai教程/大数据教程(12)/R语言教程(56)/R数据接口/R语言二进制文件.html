<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">R语言二进制文件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>二进制文件是一个文件，其中包含仅以位和字节形式存储的信息(<code>0</code>和<code>1</code>)。它们不可读，因为其中的字节转换为包含许多其他不可打印字符的字符和符号。尝试使用任何文本编辑器读取二进制文件将显示为类似<code>Ø</code>和<code>ð</code>这样的字符。</p> 
 <p>二进制文件必须由特定程序读取才能使用。例如，<em>Microsoft Word</em>程序的二进制文件只能通过Word程序读取到人类可读的形式。这表明，除了人类可读的文本之外，还有更多的信息，如格式化的字符和页码等，它们也与字母数字字符一起存储。最后二进制文件是一个连续的字节序列。 我们在文本文件中看到的换行符是将第一行连接到下一个的字符。</p> 
 <p>有时，由其他程序生成的数据需要由R作为二进制文件处理。 另外R需要创建可以与其他程序共享的二进制文件。</p> 
 <p>R有两个函数用来创建和读取二进制文件，它们分别是：<code>WriteBin()</code>和<code>readBin()</code>函数。</p> 
 <h2 id="h2-u8BEDu6CD5"><a name="语法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>语法</h2>
 <pre><code class="lang-r">writeBin(object, con)
readBin(con, what, n )
</code></pre> 
 <p>以下是使用的参数的描述 - </p> 
 <ul> 
  <li><em>con</em> - 是要读取或写入二进制文件的连接对象。</li>
  <li><em>object</em> - 是要写入的二进制文件。</li>
  <li><em>what</em> - 是像字符，整数等的模式，代表要读取的字节。</li>
  <li><em>n</em> - 是从二进制文件读取的字节数。</li>
 </ul> 
 <h2 id="h2-u5B9Eu4F8B"><a name="实例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实例</h2>
 <p>这里考虑使用R内置数据<code>“mtcars”</code>。 首先，我们从它创建一个csv文件并将其转换为二进制文件并将其存储为操作系统文件。接下来将这个二进制文件读入R中。</p> 
 <h3 id="h3-1-"><a name="1. 写入二进制文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>1. 写入二进制文件</h3>
 <p>我们将数据帧<code>“mtcars”</code>读为csv文件，然后将其作为二进制文件写入操作系统。参考以下代码实现 - </p> 
 <pre><code class="lang-r"># Read the "mtcars" data frame as a csv file and store only the columns 
   "cyl", "am" and "gear".
write.table(mtcars, file = "mtcars.csv",row.names = FALSE, na = "", 
   col.names = TRUE, sep = ",")

# Store 5 records from the csv file as a new data frame.
new.mtcars &lt;- read.table("mtcars.csv",sep = ",",header = TRUE,nrows = 5)

# Create a connection object to write the binary file using mode "wb".
write.filename = file("/web/com/binmtcars.dat", "wb")

# Write the column names of the data frame to the connection object.
writeBin(colnames(new.mtcars), write.filename)

# Write the records in each of the column to the file.
writeBin(c(new.mtcars$cyl,new.mtcars$am,new.mtcars$gear), write.filename)

# Close the file for writing so that it can be read by other program.
close(write.filename)
</code></pre> 
 <h3 id="h3-2-"><a name="2. 读取二进制文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>2. 读取二进制文件</h3>
 <p>上面创建的二进制文件将所有数据作为连续字节存储。 因此，我们将通过选择列名称和列值的适当值来读取它。</p>   
 <pre><code class="lang-r"># Create a connection object to read the file in binary mode using "rb".
read.filename &lt;- file("/web/com/binmtcars.dat", "rb")

# First read the column names. n = 3 as we have 3 columns.
column.names &lt;- readBin(read.filename, character(),  n = 3)

# Next read the column values. n = 18 as we have 3 column names and 15 values.
read.filename &lt;- file("/web/com/binmtcars.dat", "rb")
bindata &lt;- readBin(read.filename, integer(),  n = 18)

# Print the data.
print(bindata)

# Read the values from 4th byte to 8th byte which represents "cyl".
cyldata = bindata[4:8]
print(cyldata)

# Read the values form 9th byte to 13th byte which represents "am".
amdata = bindata[9:13]
print(amdata)

# Read the values form 9th byte to 13th byte which represents "gear".
geardata = bindata[14:18]
print(geardata)

# Combine all the read values to a dat frame.
finaldata = cbind(cyldata, amdata, geardata)
colnames(finaldata) = column.names
print(finaldata)
</code></pre> 
 <p>当我们执行上面的代码，它产生以下结果和图表 -</p> 
 <pre><code class="lang-shell"> [1]    7108963 1728081249    7496037          6          6          4
 [7]          6          8          1          1          1          0
[13]          0          4          4          4          3          3

[1] 6 6 4 6 8

[1] 1 1 1 0 0

[1] 4 4 4 3 3

     cyl am gear
[1,]   6  1    4
[2,]   6  1    4
[3,]   4  1    4
[4,]   6  0    3
[5,]   8  0    3
</code></pre> 
 <p>我们可以看到，通过读取R中的二进制文件，得到了原始数据。</p>
 <br>      
</div></body></html>