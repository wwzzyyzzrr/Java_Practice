<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">R语言CSV文件</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在R中，我们可以从存储在R环境外部的文件读取数据。还可以将数据写入由操作系统存储和访问的文件。 R可以读取和写入各种文件格式，如：<em>csv</em>，<em>excel</em>，<em>xml</em>等。</p> 
 <p>在本章中，我们将学习如何从<code>csv</code>文件中读取数据，然后将数据写入<code>csv</code>文件。 该文件应该存在于当前工作目录中，以方便<em>R</em>可以读取它。 当然，也可以设置自己的目录，并从那里读取文件。</p> 
 <h2 id="h2-u83B7u53D6u548Cu8BBEu7F6Eu5DE5u4F5Cu76EEu5F55"><a name="获取和设置工作目录" class="reference-link"></a><span class="header-link octicon octicon-link"></span>获取和设置工作目录</h2>
 <p>可以使用<code>getwd()</code>函数来检查R工作区指向哪个目录，使用<code>setwd()</code>函数设置新的工作目录。</p> 
 <pre><code class="lang-r"># Get and print current working directory.
print(getwd())

# Set current working directory.
# setwd("/web/com")
setwd("F:/worksp/R")

# Get and print current working directory.
print(getwd())
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">[1] "C:/Users/Administrator/Documents"
[1] "F:/worksp/R"
</code></pre> 
 <blockquote> 
  <p>注意： 此结果取决于您的操作系统和您当前正在工作的目录。</p> 
 </blockquote> 
 <h2 id="h2--csv-"><a name="作为CSV文件输入" class="reference-link"></a><span class="header-link octicon octicon-link"></span>作为CSV文件输入</h2>
 <p>csv文件是一个文本文件，其中列中的值用逗号分隔。假设下面的数据存在于名为<em>input.csv</em> 的文件中。</p> 
 <p>您可以使用Windows记事本通过复制和粘贴此数据来创建此文件。使用记事本中的另存为所有文件(<code>*.*</code>)选项将文件另存为：<em>input.csv</em>(在目录：<em>F:/worksp/R</em> 下载)。</p> 
 <pre><code class="lang-csv">id,name,salary,start_date,dept
1,Rick,623.3,2012-01-01,IT
2,Dan,515.2,2013-09-23,Operations
3,Michelle,611,2014-11-15,IT
4,Ryan,729,2014-05-11,HR
 ,Gary,843.25,2015-03-27,Finance
6,Nina,578,2013-05-21,IT
7,Simon,632.8,2013-07-30,Operations
8,Guru,722.5,2014-06-17,Finance
</code></pre> 
 <h2 id="h2--csv-"><a name="读取CSV文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>读取CSV文件</h2>
 <p>以下是<em>read.csv()</em>函数的一个简单示例，用于读取当前工作目录中可用的CSV文件 -</p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
data &lt;- read.csv("input.csv")
print(data)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">&gt; data &lt;- read.csv("input.csv")
&gt; print(data)
  id     name salary start_date       dept
1  1     Rick 623.30 2012-01-01         IT
2  2      Dan 515.20 2013-09-23 Operations
3  3 Michelle 611.00 2014-11-15         IT
4  4     Ryan 729.00 2014-05-11         HR
5 NA     Gary 843.25 2015-03-27    Finance
6  6     Nina 578.00 2013-05-21         IT
7  7    Simon 632.80 2013-07-30 Operations
8  8     Guru 722.50 2014-06-17    Finance
</code></pre> 
 <h2 id="h2--csv-"><a name="分析CSV文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>分析CSV文件</h2>
 <p>默认情况下，<code>read.csv()</code>函数将输出作为数据帧。这可以很容易地查看到，此外，我们可以检查列和行的数量。</p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
data &lt;- read.csv("input.csv")

print(is.data.frame(data))
print(ncol(data))
print(nrow(data))
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">[1] TRUE
[1] 5
[1] 8
</code></pre> 
 <p>当我们在数据帧中读取数据，可以应用所有适用于数据帧的函数，如下一节所述。</p> 
 <p><strong>获得最高工资</strong></p> 
 <pre><code class="lang-r"># Create a data frame.
data &lt;- read.csv("input.csv")

# Get the max salary from data frame.
sal &lt;- max(data$salary)
print(sal)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">[1] 843.25
</code></pre> 
 <p><strong>获得最高工资的人员的详细信息</strong></p> 
 <p>可以使用过滤条件获取符合特定的行，类似于SQL的<code>where</code>子句。</p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Create a data frame.
data &lt;- read.csv("input.csv")

# Get the max salary from data frame.
sal &lt;- max(data$salary)

# Get the person detail having max salary.
retval &lt;- subset(data, salary == max(salary))
print(retval)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">      id    name  salary  start_date    dept
5     NA    Gary  843.25  2015-03-27    Finance
</code></pre> 
 <p><strong>获取IT部门的所有人员</strong></p> 
 <pre><code class="lang-r"># Create a data frame.
data &lt;- read.csv("input.csv")

retval &lt;- subset( data, dept == "IT")
print(retval)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p>   
 <pre><code class="lang-shell">       id   name      salary   start_date   dept
1      1    Rick      623.3    2012-01-01   IT
3      3    Michelle  611.0    2014-11-15   IT
6      6    Nina      578.0    2013-05-21   IT
</code></pre> 
 <p><strong>获取IT部门薪水在600以上的人员</strong></p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Create a data frame.
data &lt;- read.csv("input.csv")

info &lt;- subset(data, salary &gt; 600 &amp; dept == "IT")
print(info)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">       id   name      salary   start_date   dept
1      1    Rick      623.3    2012-01-01   IT
3      3    Michelle  611.0    2014-11-15   IT
</code></pre> 
 <p><strong>获得在2014年或以后入职的人员</strong></p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Create a data frame.
data &lt;- read.csv("input.csv")

retval &lt;- subset(data, as.Date(start_date) &gt; as.Date("2014-01-01"))
print(retval)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">       id   name     salary   start_date    dept
3      3    Michelle 611.00   2014-11-15    IT
4      4    Ryan     729.00   2014-05-11    HR
5     NA    Gary     843.25   2015-03-27    Finance
8      8    Guru     722.50   2014-06-17    Finance
</code></pre> 
 <h2 id="h2--csv-"><a name="写入CSV文件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>写入CSV文件</h2>
 <p>R可以从现有数据帧中来创建csv文件。<code>write.csv()</code>函数用于创建<code>csv</code>文件。 该文件在工作目录中创建。参考以下示例代码 - </p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Create a data frame.
data &lt;- read.csv("input.csv")
retval &lt;- subset(data, as.Date(start_date) &gt; as.Date("2014-01-01"))
# print(retval)
# Write filtered data into a new file.
write.csv(retval,"output.csv")
newdata &lt;- read.csv("output.csv")
print(newdata)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">  X      id   name      salary   start_date    dept
1 3      3    Michelle  611.00   2014-11-15    IT
2 4      4    Ryan      729.00   2014-05-11    HR
3 5     NA    Gary      843.25   2015-03-27    Finance
4 8      8    Guru      722.50   2014-06-17    Finance
</code></pre> 
 <p>这里列<em>X</em>来自数据集更新器。在编写文件时可以使用其他参数来删除它。</p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Create a data frame.
data &lt;- read.csv("input.csv")
retval &lt;- subset(data, as.Date(start_date) &gt; as.Date("2014-01-01"))

# Write filtered data into a new file.
write.csv(retval,"output.csv", row.names = FALSE)
newdata &lt;- read.csv("output.csv")
print(newdata)
</code></pre> 
 <p>当我们执行上述代码时，会产生以下结果 -</p> 
 <pre><code class="lang-shell">      id    name      salary   start_date    dept
1      3    Michelle  611.00   2014-11-15    IT
2      4    Ryan      729.00   2014-05-11    HR
3     NA    Gary      843.25   2015-03-27    Finance
4      8    Guru      722.50   2014-06-17    Finance
</code></pre>
 <br>      
</div></body></html>