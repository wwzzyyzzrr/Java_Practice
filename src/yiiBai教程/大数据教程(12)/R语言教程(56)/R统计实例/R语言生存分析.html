<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">R语言生存分析</h1><div style="width:100%;float:left;" class="article-content">   
 <p>生存分析涉及预测特定事件发生的时间。 它也被称为失败时间分析或分析死亡时间。 例如预测癌症患者的生存天数或预测机械系统出现故障的时间。</p> 
 <p>R中的软件包：<code>survival</code>用于进行生存分析。该包中含有<code>Surv()</code>函数，它将输入数据作为R公式，并在所选变量中创建一个生存对象进行分析。然后使用<code>survfit()</code>函数来创建分析图。</p> 
 <h2 id="h2-u5B89u88C5u5305"><a name="安装包" class="reference-link"></a><span class="header-link octicon octicon-link"></span>安装包</h2>
 <pre><code class="lang-r">install.packages("survival")
</code></pre> 
 <p><strong>语法</strong></p> 
 <p>在R中创建生存分析的基本语法是 -</p> 
 <pre><code class="lang-r">Surv(time,event)
survfit(formula)
</code></pre> 
 <p>以下是使用的参数的描述 - </p> 
 <ul> 
  <li><em>time</em> - 是直到事件发生的后续时间。</li>
  <li><em>event</em> - 表示预期事件发生的状态。</li>
  <li><em>formula</em> - 是预测变量之间的关系。</li>
 </ul> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>考虑上面安装的<code>survival</code>包中存在的名为<code>“pbc”</code>的数据集。 它描述了肝脏原发性胆汁性肝硬化(PBC)患者的生存数据。在数据集中存在的许多列中，我们主要关注<code>"time"</code>和<code>"status"</code>字段。时间(<code>time</code>)表示在患者接受肝脏移植或患者死亡的患者之间登记患者和事件之前的天数。</p> 
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Load the library.
library("survival")

# Print first few rows.
print(head(pbc))
</code></pre> 
 <p>当我们执行上面的代码，它产生以下结果 -</p> 
 <pre><code class="lang-shell">  id time status trt      age sex ascites hepato spiders edema bili chol
1  1  400      2   1 58.76523   f       1      1       1   1.0 14.5  261
2  2 4500      0   1 56.44627   f       0      1       1   0.0  1.1  302
3  3 1012      2   1 70.07255   m       0      0       0   0.5  1.4  176
4  4 1925      2   1 54.74059   f       0      1       1   0.5  1.8  244
5  5 1504      1   2 38.10541   f       0      1       1   0.0  3.4  279
6  6 2503      2   2 66.25873   f       0      1       0   0.0  0.8  248
  albumin copper alk.phos    ast trig platelet protime stage
1    2.60    156   1718.0 137.95  172      190    12.2     4
2    4.14     54   7394.8 113.52   88      221    10.6     3
3    3.48    210    516.0  96.10   55      151    12.0     4
4    2.54     64   6121.8  60.63   92      183    10.3     4
5    3.53    143    671.0 113.15   72      136    10.9     3
6    3.98     50    944.0  93.00   63       NA    11.0     3
</code></pre> 
 <p>从上述数据，我们正在考虑时间和状态进行分析。</p> 
 <h2 id="h2--surv-survfit-"><a name="应用Surv()和survfit()函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>应用Surv()和survfit()函数</h2>
 <p>现在继续将<code>Surv()</code>函数应用于上述数据集，并创建一个将显示趋势图。参考以下示例代码 - </p>   
 <pre><code class="lang-r">setwd("F:/worksp/R")
# Load the library.
library("survival")

# Create the survival object. 
survfit(Surv(pbc$time,pbc$status == 2)~1)

# Give the chart file a name.
png(file = "survival.png")

# Plot the graph. 
plot(survfit(Surv(pbc$time,pbc$status == 2)~1))

# Save the file.
dev.off()
</code></pre> 
 <p>当我们执行上面的代码，它产生以下结果和图表 -</p> 
 <pre><code class="lang-r">Call: survfit(formula = Surv(pbc$time, pbc$status == 2) ~ 1)

      n  events  median 0.95LCL 0.95UCL 
    418     161    3395    3090    3853
</code></pre> 
 <p>上图中的趋势有助于我们预测在一定天数结束时的生存概率。</p> 
 <p><img src="http://www.yiibai.com/uploads/images/201708/2508/499070828_71560.png" alt=""></p>
 <br>      
</div></body></html>