<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Pandas与SQL比较</h1><div style="width:100%;float:left;" class="article-content">   
 <p>由于许多潜在的Pandas用户对SQL有一定的了解，因此本文章旨在提供一些如何使用<em>Pandas</em>执行各种SQL操作的示例。</p> 
 <pre><code class="lang-python">import pandas as pd
url = 'tips.csv'
tips=pd.read_csv(url)
print (tips.head())
</code></pre> 
 <p>文件：<em>tips.csv</em> - </p> 
 <pre><code class="lang-csv">total_bill,tip,sex,smoker,day,time,size
0,16.99,1.01,Female,No,Sun,Dinner,2
1,10.34,1.66,Male,No,Sun,Dinner,3
2,21.01,3.50,Male,No,Sun,Dinner,3
3,23.68,3.31,Male,No,Sun,Dinner,2
4,24.59,3.61,Female,No,Sun,Dinner,4
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">   total_bill   tip     sex smoker  day    time  size
0       16.99  1.01  Female     No  Sun  Dinner     2
1       10.34  1.66    Male     No  Sun  Dinner     3
2       21.01  3.50    Male     No  Sun  Dinner     3
3       23.68  3.31    Male     No  Sun  Dinner     2
4       24.59  3.61  Female     No  Sun  Dinner     4
</code></pre> 
 <h2 id="h2--select-"><a name="选择(Select)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>选择(Select)</h2>
 <p>在SQL中，选择是使用逗号分隔的列列表(或选择所有列)来完成的，例如 -</p> 
 <pre><code class="lang-sql">SELECT total_bill, tip, smoker, time
FROM tips
LIMIT 5;
</code></pre> 
 <p>在<em>Pandas</em>中，列的选择是通过传递列名到DataFrame -</p> 
 <pre><code class="lang-python">tips[['total_bill', 'tip', 'smoker', 'time']].head(5)
</code></pre> 
 <p>下面来看看完整的程序 -</p> 
 <pre><code class="lang-python">import pandas as pd

url = 'tips.csv'

tips=pd.read_csv(url)
rs = tips[['total_bill', 'tip', 'smoker', 'time']].head(5)
print(rs)
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">   total_bill   tip smoker    time
0       16.99  1.01     No  Dinner
1       10.34  1.66     No  Dinner
2       21.01  3.50     No  Dinner
3       23.68  3.31     No  Dinner
4       24.59  3.61     No  Dinner
</code></pre> 
 <p>调用没有列名称列表的DataFrame将显示所有列(类似于SQL的<code>*</code>)。</p> 
 <h2 id="h2-where-"><a name="WHERE条件" class="reference-link"></a><span class="header-link octicon octicon-link"></span>WHERE条件</h2>
 <pre><code class="lang-sql">SELECT * FROM tips WHERE time = 'Dinner' LIMIT 5;
</code></pre> 
 <p>数据帧可以通过多种方式进行过滤; 最直观的是使用布尔索引。</p> 
 <pre><code class="lang-python">tips[tips['time'] == 'Dinner'].head(5)
</code></pre> 
 <p>下面来看看完整的程序 -</p> 
 <pre><code class="lang-python">import pandas as pd

url = 'tips.csv'

tips=pd.read_csv(url)
rs = tips[tips['time'] == 'Dinner'].head(5)
print(rs)
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">   total_bill   tip     sex smoker  day    time  size
0       16.99  1.01  Female     No  Sun  Dinner     2
1       10.34  1.66    Male     No  Sun  Dinner     3
2       21.01  3.50    Male     No  Sun  Dinner     3
3       23.68  3.31    Male     No  Sun  Dinner     2
4       24.59  3.61  Female     No  Sun  Dinner     4
</code></pre> 
 <p>上述语句将一系列<code>True/False</code>对象传递给DataFrame，并将所有行返回<code>True</code>。</p> 
 <h2 id="h2--groupby-"><a name="通过GroupBy分组" class="reference-link"></a><span class="header-link octicon octicon-link"></span>通过GroupBy分组</h2>
 <p>此操作将获取整个数据集中每个组的记录数。 例如，一个查询提取性别的数量(即，按性别分组) -</p>   
 <pre><code class="lang-sql">SELECT sex, count(*)
FROM tips
GROUP BY sex;
</code></pre> 
 <p>在<em>Pandas</em>中的等值语句将是 -</p> 
 <pre><code class="lang-python">tips.groupby('sex').size()
</code></pre> 
 <p>下面来看看完整的程序 -</p> 
 <pre><code class="lang-python">import pandas as pd

url = 'tips.csv'

tips=pd.read_csv(url)
rs = tips.groupby('sex').size()
print(rs)
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">sex
Female    2
Male      3
dtype: int64
</code></pre> 
 <h2 id="h2--n-"><a name="前N行" class="reference-link"></a><span class="header-link octicon octicon-link"></span>前N行</h2>
 <p>SQL(MySQL数据库)使用<code>LIMIT</code>返回前<code>n</code>行 -</p> 
 <pre><code class="lang-python">SELECT * FROM tips
LIMIT 5 ;
</code></pre> 
 <p>在<em>Pandas</em>中的等值语句将是 -</p> 
 <pre><code class="lang-python">tips.head(5)
</code></pre> 
 <p>下面来看看完整的程序 -</p> 
 <pre><code class="lang-python">import pandas as pd

url = 'tips.csv'

tips=pd.read_csv(url)
rs = tips[['smoker', 'day', 'time']].head(5)
print(rs)
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">  smoker  day    time
0     No  Sun  Dinner
1     No  Sun  Dinner
2     No  Sun  Dinner
3     No  Sun  Dinner
4     No  Sun  Dinner
</code></pre> 
 <p>这些是比较的几个基本操作，在前几章的<em>Pandas</em>库中学到的。</p>
 <br>      
</div></body></html>