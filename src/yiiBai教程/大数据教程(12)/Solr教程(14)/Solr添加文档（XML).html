<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Solr添加文档（XML)</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在上一章中，我们学习解释了如何向<strong>Solr</strong>中添加<code>JSON</code>和<code>.CSV</code>文件格式的数据。在本章中，将演示如何使用<code>XML</code>文档格式在<strong>Apache Solr</strong>索引中添加数据。</p> 
 <h2 id="h2-u793Au4F8Bu6570u636E"><a name="示例数据" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例数据</h2>
 <p>假设我们需要使用<code>XML</code>文件格式将以下数据添加到<strong>Solr</strong>索引。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>Student ID</th> 
    <th>First Name</th> 
    <th>Last Name</th> 
    <th>Phone</th> 
    <th>City</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>001</td> 
    <td>Rajiv</td> 
    <td>Reddy</td> 
    <td>9848022337</td> 
    <td>Hyderabad</td> 
   </tr> 
   <tr> 
    <td>002</td> 
    <td>Siddharth</td> 
    <td>Bhattacharya</td> 
    <td>9848022338</td> 
    <td>Kolkata</td> 
   </tr> 
   <tr> 
    <td>003</td> 
    <td>Rajesh</td> 
    <td>Khanna</td> 
    <td>9848022339</td> 
    <td>Delhi</td> 
   </tr> 
   <tr> 
    <td>004</td> 
    <td>Preethi</td> 
    <td>Agarwal</td> 
    <td>9848022330</td> 
    <td>Pune</td> 
   </tr> 
   <tr> 
    <td>005</td> 
    <td>Trupthi</td> 
    <td>Mohanty</td> 
    <td>9848022336</td> 
    <td>Bhubaneshwar</td> 
   </tr> 
   <tr> 
    <td>006</td> 
    <td>Archana</td> 
    <td>Mishra</td> 
    <td>9848022335</td> 
    <td>Chennai</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2--xml-"><a name="使用XML添加文档" class="reference-link"></a><span class="header-link octicon octicon-link"></span>使用XML添加文档</h2>
 <p>要将上述数据添加到<strong>Solr</strong>索引中，我们需要准备一个XML文档，如下所示。 将此文档保存在名称为<code>sample.xml</code>的文件中。</p> 
 <pre><code class="lang-xml">&lt;add&gt; 
   &lt;doc&gt; 
      &lt;field name = "id"&gt;001&lt;/field&gt; 
      &lt;field name = "first name"&gt;Rajiv&lt;/field&gt; 
      &lt;field name = "last name"&gt;Reddy&lt;/field&gt; 
      &lt;field name = "phone"&gt;9848022337&lt;/field&gt; 
      &lt;field name = "city"&gt;Hyderabad&lt;/field&gt; 
   &lt;/doc&gt;  
   &lt;doc&gt; 
      &lt;field name = "id"&gt;002&lt;/field&gt; 
      &lt;field name = "first name"&gt;Siddarth&lt;/field&gt; 
      &lt;field name = "last name"&gt;Battacharya&lt;/field&gt; 
      &lt;field name = "phone"&gt;9848022338&lt;/field&gt; 
      &lt;field name = "city"&gt;Kolkata&lt;/field&gt; 
   &lt;/doc&gt;  
   &lt;doc&gt; 
      &lt;field name = "id"&gt;003&lt;/field&gt; 
      &lt;field name = "first name"&gt;Rajesh&lt;/field&gt; 
      &lt;field name = "last name"&gt;Khanna&lt;/field&gt; 
      &lt;field name = "phone"&gt;9848022339&lt;/field&gt; 
      &lt;field name = "city"&gt;Delhi&lt;/field&gt; 
   &lt;/doc&gt;  
   &lt;doc&gt; 
      &lt;field name = "id"&gt;004&lt;/field&gt; 
      &lt;field name = "first name"&gt;Preethi&lt;/field&gt; 
      &lt;field name = "last name"&gt;Agarwal&lt;/field&gt; 
      &lt;field name = "phone"&gt;9848022330&lt;/field&gt; 
      &lt;field name = "city"&gt;Pune&lt;/field&gt; 
   &lt;/doc&gt;  
   &lt;doc&gt; 
      &lt;field name = "id"&gt;005&lt;/field&gt; 
      &lt;field name = "first name"&gt;Trupthi&lt;/field&gt; 
      &lt;field name = "last name"&gt;Mohanthy&lt;/field&gt; 
      &lt;field name = "phone"&gt;9848022336&lt;/field&gt; 
      &lt;field name = "city"&gt;Bhuwaeshwar&lt;/field&gt; 
   &lt;/doc&gt; 
   &lt;doc&gt; 
      &lt;field name = "id"&gt;006&lt;/field&gt; 
      &lt;field name = "first name"&gt;Archana&lt;/field&gt; 
      &lt;field name = "last name"&gt;Mishra&lt;/field&gt; 
      &lt;field name = "phone"&gt;9848022335&lt;/field&gt; 
      &lt;field name = "city"&gt;Chennai&lt;/field&gt; 
   &lt;/doc&gt; 
&lt;/add&gt;
</code></pre> 
 <p>正如所看到的，写入添加数据到索引的<code>XML</code>文件包含三个重要的标签，<code>&lt;add&gt; &lt;/add&gt;</code>, <code>&lt;doc&gt;&lt;/doc&gt;</code>, 以及 <code>&lt; field &gt;&lt; /field &gt;</code>。</p> 
 <ul> 
  <li><strong>add</strong> − 这是用于将文档添加到索引的根标记。它包含一个或多个要添加的文档。</li>
  <li><strong>doc</strong> − 添加的文档应该包含在<code>&lt;doc&gt; &lt;/ doc&gt;</code>标记中。文档包含字段形式的数据。</li>
  <li><strong>field</strong> − 字段标记包含文档的字段的名称和值。</li>
 </ul> 
 <p>准备好文档后，可以使用上一章中讨论的任何方法将此文档添加到索引。</p> 
 <p>假设<code>XML</code>文件(<code>sample.xml</code>)存在于<strong>Solr</strong>的<code>bin</code>目录中，并且它将在名称为<code>my_core</code>的核心中进行索引，那么可以使用<code>post</code>工具将其添加到<strong>Solr</strong>索引中，如下所示 -</p>   
 <pre><code class="lang-shell">[yiibai@ubuntu:/usr/local/solr-6.4.0/bin]$ ./post -c my_core sample.xml
</code></pre> 
 <p>执行上述命令后，将得到以下输出 -</p> 
 <pre><code class="lang-shell">yiibai@ubuntu:/usr/local/solr-6.4.0/bin$ ./post -c my_core sample.xml
/usr/local/jdk1.8.0_65/bin/java -classpath /usr/local/solr-6.4.0/dist/solr-core-6.4.0.jar -Dauto=yes -Dc=my_core -Ddata=files org.apache.solr.util.SimplePostTool sample.xml
SimplePostTool version 5.0.0
Posting files to [base] url http://localhost:8983/solr/my_core/update...
Entering auto mode. File endings considered are xml,json,jsonl,csv,pdf,doc,docx,ppt,pptx,xls,xlsx,odt,odp,ods,ott,otp,ots,rtf,htm,html,txt,log
POSTing file sample.xml (application/xml) to [base]
1 files indexed.
COMMITting Solr index changes to http://localhost:8983/solr/my_core/update...
Time spent: 0:00:00.756
</code></pre> 
 <h3 id="h3-u9A8Cu8BC1u4E0Au9762u7684u64CDu4F5C"><a name="验证上面的操作" class="reference-link"></a><span class="header-link octicon octicon-link"></span>验证上面的操作</h3>
 <p>访问Apache Solr Web界面的主页并选择核心<code>my_core</code>。尝试通过在文本区域<code>q</code>中传递查询“：”来检索所有文档，并执行查询。执行时应该可以观察到所需的数据被添加到<strong>Solr</strong>索引。<br><img src="http://www.yiibai.com/uploads/images/201702/0402/927100238_56212.png" alt=""></p>
 <br>      
</div></body></html>