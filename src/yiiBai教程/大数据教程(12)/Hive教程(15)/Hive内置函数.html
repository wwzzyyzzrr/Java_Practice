<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">Hive内置函数</h1><div style="width:100%;float:left;" class="article-content">   
 <p> 本章介绍了在Hive中可用的内置函数。这些函数看起来非常类似于SQL的函数，除了他们的使用有点不一样。</p> 
 <h2> 内置函数</h2> 
 <p> Hive支持以下内置函数：</p> 
 <table class="table table-bordered" style="box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; width: 496px; max-width: 100%; margin-bottom: 20px;  border-color: rgb(221, 221, 221); color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px; background-color: transparent;"> 
  <tbody style="box-sizing: border-box;"> 
   <tr style="box-sizing: border-box;"> 
    <th style="box-sizing: border-box; padding: 8px; line-height: 1.42857143; vertical-align: top;  border-color: rgb(221, 221, 221); width: 99px; background: rgb(238, 238, 238);"> 返回类型</th> 
    <th style="box-sizing: border-box; padding: 8px; line-height: 1.42857143; vertical-align: top;  border-color: rgb(221, 221, 221); background: rgb(238, 238, 238);"> 签名</th> 
    <th style="box-sizing: border-box; padding: 8px; line-height: 1.42857143; vertical-align: top;  border-color: rgb(221, 221, 221); background: rgb(238, 238, 238);"> 描述</th> 
   </tr> 
   <tr> 
    <td> BIGINT</td> 
    <td> round(double a)</td> 
    <td> 返回BIGINT最近的double值。</td> 
   </tr> 
   <tr> 
    <td> BIGINT</td> 
    <td> floor(double a)</td> 
    <td> 返回最大BIGINT值等于或小于double。</td> 
   </tr> 
   <tr> 
    <td> BIGINT</td> 
    <td> ceil(double a)</td> 
    <td> 它返回最小BIGINT值等于或大于double。</td> 
   </tr> 
   <tr> 
    <td> double</td> 
    <td> rand(), rand(int seed)</td> 
    <td> 它返回一个随机数，从行改变到行。</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> concat(string A, string B,...)</td> 
    <td> 它返回从A后串联B产生的字符串</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> substr(string A, int start)</td> 
    <td> 它返回一个起始，从起始位置的子字符串，直到A.结束</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> substr(string A, int start, int length)</td> 
    <td> 返回从给定长度的起始start位置开始的字符串。</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> upper(string A)</td> 
    <td> 它返回从转换的所有字符为大写产生的字符串。</td> 
   </tr> 
   <tr> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> ucase(string A)</td> 
    <td> 和上面的一样</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> lower(string A)</td> 
    <td> 它返回转换B的所有字符为小写产生的字符串。</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> lcase(string A)</td> 
    <td> 和上面的一样</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> trim(string A)</td> 
    <td> 它返回字符串从A.两端修剪空格的结果</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> ltrim(string A)</td> 
    <td> 它返回A从一开始修整空格产生的字符串(左手侧)</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> rtrim(string A)</td> 
    <td> rtrim(string A)，它返回A从结束修整空格产生的字符串(右侧)</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> regexp_replace(string A, string B, string C)</td> 
    <td> 它返回从替换所有子在B结果配合C.在Java正则表达式语法的字符串</td> 
   </tr> 
   <tr> 
    <td> int</td> 
    <td> size(Map&lt;K.V&gt;)</td> 
    <td> 它返回在映射类型的元素的数量。</td> 
   </tr> 
   <tr> 
    <td> int</td> 
    <td> size(Array&lt;T&gt;)</td> 
    <td> 它返回在数组类型元素的数量。</td> 
   </tr> 
   <tr> 
    <td> value of &lt;type&gt;</td> 
    <td> cast(&lt;expr&gt; as &lt;type&gt;)</td> 
    <td> 它把表达式的结果expr&lt;类型&gt;如cast('1'作为BIGINT)代表整体转换为字符串'1'。如果转换不成功，返回的是NULL。</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> from_unixtime(int unixtime)</td> 
    <td> 转换的秒数从Unix纪元(1970-01-0100:00:00 UTC)代表那一刻，在当前系统时区的时间戳字符的串格式："1970-01-01 00:00:00"</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> to_date(string timestamp)</td> 
    <td> 返回一个字符串时间戳的日期部分：to_date("1970-01-01 00:00:00") = "1970-01-01"</td> 
   </tr> 
   <tr> 
    <td> int</td> 
    <td> year(string date)</td> 
    <td> 返回年份部分的日期或时间戳字符串：year("1970-01-01 00:00:00") = 1970, year("1970-01-01") = 1970</td> 
   </tr> 
   <tr> 
    <td> int</td> 
    <td> month(string date)</td> 
    <td> 返回日期或时间戳记字符串月份部分：month("1970-11-01 00:00:00") = 11, month("1970-11-01") = 11</td> 
   </tr> 
   <tr> 
    <td> int</td> 
    <td> day(string date)</td> 
    <td> 返回日期或时间戳记字符串当天部分：day("1970-11-01 00:00:00") = 1, day("1970-11-01") = 1</td> 
   </tr> 
   <tr> 
    <td> string</td> 
    <td> get_json_object(string json_string, string path)</td> 
    <td> 提取从基于指定的JSON路径的JSON字符串JSON对象，并返回提取的JSON字符串的JSON对象。如果输入的JSON字符串无效，返回NULL。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h3> 示例</h3> 
 <p> 以下查询演示了一些内置函数：</p> 
 <h3> round() 函数</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 496.1875px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hive</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> SELECT round</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2.6</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">from</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> temp</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span></pre> 
 <p> 成功执行的查询，能看到以下回应：</p> 
 <pre class="result notranslate" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; margin-bottom: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 496.1875px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); line-height: 22px; background-color: rgb(241, 241, 241);">
2.0</pre> 
 <h3> floor()&nbsp;函数</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 496.1875px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hive</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> SELECT floor</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2.6</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">from</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> temp</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span></pre> 
 <p> 成功执行的查询，能看到以下回应：</p>   
 <pre class="result notranslate" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; margin-bottom: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 496.1875px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); line-height: 22px; background-color: rgb(241, 241, 241);">
2.0</pre> 
 <h3> floor()&nbsp;函数</h3> 
 <pre class="prettyprint notranslate prettyprinted" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 496.1875px; line-height: 16px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49);">
<span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);">hive</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">&gt;</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> SELECT ceil</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">(</span><span class="lit" style="box-sizing: border-box; color: rgb(0, 102, 102);">2.6</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">)</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> </span><span class="kwd" style="box-sizing: border-box; color: rgb(0, 0, 136);">from</span><span class="pln" style="box-sizing: border-box; color: rgb(0, 0, 0);"> temp</span><span class="pun" style="box-sizing: border-box; color: rgb(102, 102, 0);">;</span></pre> 
 <p> 成功执行的查询，能看到以下回应：</p> 
 <pre class="result notranslate" style="box-sizing: border-box; Menlo, Monaco, Consolas, 'Courier New', monospace; margin-bottom: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: 496.1875px; font-size: 12px; overflow: auto; color: rgb(49, 49, 49); line-height: 22px; background-color: rgb(241, 241, 241);">
3.0</pre> 
 <h2> 聚合函数</h2> 
 <p> Hive支持以下内置聚合函数。这些函数的用法类似于SQL聚合函数。</p> 
 <table class="table table-bordered" style="box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; width: 496px; max-width: 100%; margin-bottom: 20px;  border-color: rgb(221, 221, 221); color: rgb(49, 49, 49);  font-size: 14px; line-height: 22px; background-color: transparent;"> 
  <tbody style="box-sizing: border-box;"> 
   <tr style="box-sizing: border-box;"> 
    <th style="box-sizing: border-box; padding: 8px; line-height: 1.42857143; vertical-align: top;  border-color: rgb(221, 221, 221); width: 99px; background: rgb(238, 238, 238);"> 返回类型</th> 
    <th style="box-sizing: border-box; padding: 8px; line-height: 1.42857143; vertical-align: top;  border-color: rgb(221, 221, 221); background: rgb(238, 238, 238);"> 签名</th> 
    <th style="box-sizing: border-box; padding: 8px; line-height: 1.42857143; vertical-align: top;  border-color: rgb(221, 221, 221); background: rgb(238, 238, 238);"> 描述</th> 
   </tr> 
   <tr> 
    <td> BIGINT</td> 
    <td> count(*), count(expr),</td> 
    <td> count(*) - 返回检索行的总数。</td> 
   </tr> 
   <tr> 
    <td> DOUBLE</td> 
    <td> sum(col), sum(DISTINCT col)</td> 
    <td> 返回该组或该组中的列的不同值的分组和所有元素的总和。</td> 
   </tr> 
   <tr> 
    <td> DOUBLE</td> 
    <td> avg(col), avg(DISTINCT col)</td> 
    <td> 返回上述组或该组中的列的不同值的元素的平均值。</td> 
   </tr> 
   <tr> 
    <td> DOUBLE</td> 
    <td> min(col)</td> 
    <td> 返回该组中的列的最小值。</td> 
   </tr> 
   <tr> 
    <td> DOUBLE</td> 
    <td> max(col)</td> 
    <td> 返回该组中的列的最大值。</td> 
   </tr> 
  </tbody> 
 </table> 
 <br> 
 <br>      
</div></body></html>