<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">C# DirectoryInfo类</h1><div style="width:100%;float:left;" class="article-content">   
 <p><code>DirectoryInfo</code>类是<code>System.IO</code>命名空间的一部分。它用于创建，删除和移动目录。它提供了执行与目录和子目录相关的操作的方法。这是一个密封的类，所以不能继承它。</p> 
 <p><code>DirectoryInfo</code>类提供了下面列出的构造函数，方法和属性。</p> 
 <h2 id="h2-c-directoryinfo-"><a name="C#  DirectoryInfo语法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>C# DirectoryInfo语法</h2>
 <pre><code class="lang-csharp">[SerializableAttribute]  
[ComVisibleAttribute(true)]  
public sealed class DirectoryInfo : FileSystemInfo
</code></pre> 
 <h2 id="h2-c-directoryinfo-"><a name="C#  DirectoryInfo构造函数" class="reference-link"></a><span class="header-link octicon octicon-link"></span>C# DirectoryInfo构造函数</h2>
 <p>下表列出了<code>DirectoryInfo</code>类的构造函数。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>构造函数</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>DirectoryInfo(String)</td> 
    <td>它用于在指定的路径上初始化<code>DirectoryInfo</code>类的新实例。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-c-directoryinfo-"><a name="C# DirectoryInfo属性" class="reference-link"></a><span class="header-link octicon octicon-link"></span>C# DirectoryInfo属性</h2>
 <p>下表中列出了<code>DirectoryInfo</code>类的属性。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>属性</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>Attributes</td> 
    <td>它用于获取或设置当前文件或目录的属性。</td> 
   </tr> 
   <tr> 
    <td>CreationTime</td> 
    <td>它用于获取或设置当前文件或目录的创建时间。</td> 
   </tr> 
   <tr> 
    <td>CreationTimeUtc</td> 
    <td>它用于在协调的世界时间(UTC)中获取或设置创建时间。</td> 
   </tr> 
   <tr> 
    <td>Exists</td> 
    <td>它用于获取一个值，指示目录是否存在。</td> 
   </tr> 
   <tr> 
    <td>Extension</td> 
    <td>它用于获取表示文件扩展部分的字符串。</td> 
   </tr> 
   <tr> 
    <td>FullName</td> 
    <td>它用于获取目录的完整路径。</td> 
   </tr> 
   <tr> 
    <td>LastAccessTime</td> 
    <td>它用于获取或设置上次访问当前文件或目录的时间。</td> 
   </tr> 
   <tr> 
    <td>LastAccessTimeUtc</td> 
    <td>用于在当前文件或目录被上次访问的协调世界时间(UTC)中获取或设置时间。</td> 
   </tr> 
   <tr> 
    <td>LastWriteTime</td> 
    <td>它用于获取或设置当前文件或目录最后写入的时间。</td> 
   </tr> 
   <tr> 
    <td>LastWriteTimeUtc</td> 
    <td>当最后一次写入当前文件或目录时，它用于在协调世界时(UTC)中获取或设置时间。</td> 
   </tr> 
   <tr> 
    <td>Name</td> 
    <td>它用于获取此<code>DirectoryInfo</code>实例的名称。</td> 
   </tr> 
   <tr> 
    <td>Parent</td> 
    <td>它用于获取指定子目录的父目录。</td> 
   </tr> 
   <tr> 
    <td>Root</td> 
    <td>它用于获取目录的根部分。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-c-directoryinfo-"><a name="C#  DirectoryInfo方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>C# DirectoryInfo方法</h2>
 <p>下表列出了<code>DirectoryInfo</code>类中定义的方法。</p> 
 <table> 
  <thead> 
   <tr> 
    <th>方法</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td>Create()</td> 
    <td>它用于创建一个目录。</td> 
   </tr> 
   <tr> 
    <td>Create(DirectorySecurity)</td> 
    <td>它用于使用<code>DirectorySecurity</code>对象创建目录。</td> 
   </tr> 
   <tr> 
    <td>CreateObjRef(Type)</td> 
    <td>它用于创建一个对象，其中包含生成用于与远程对象通信的代理所需的所有相关信息。</td> 
   </tr> 
   <tr> 
    <td>CreateSubdirectory(String)</td> 
    <td>它用于在指定的路径上创建一个子目录或子目录。</td> 
   </tr> 
   <tr> 
    <td>CreateSubdirectory(String,DirectorySecurity)</td> 
    <td>它用于在具有指定安全性的指定路径上创建子目录或子目录。</td> 
   </tr> 
   <tr> 
    <td>Delete()</td> 
    <td>如果<code>DirectoryInfo</code>为空，则用于删除<code>DirectoryInfo</code>。</td> 
   </tr> 
   <tr> 
    <td>Delete(Boolean)</td> 
    <td>它用于删除<code>DirectoryInfo</code>的实例，指定是否删除子目录和文件。</td> 
   </tr> 
   <tr> 
    <td>EnumerateDirectories()</td> 
    <td>它返回当前目录中可用的目录信息集合。</td> 
   </tr> 
   <tr> 
    <td>EnumerateFiles()</td> 
    <td>它在当前目录中返回无数的文件信息集合。</td> 
   </tr> 
   <tr> 
    <td>GetAccessControl()</td> 
    <td>它用于获取一个<code>DirectorySecurity</code>对象，该对象封装了目录的访问控制列表(ACL)条目。</td> 
   </tr> 
   <tr> 
    <td>GetDirectories()</td> 
    <td>它返回当前目录的子目录。</td> 
   </tr> 
   <tr> 
    <td>GetFiles()</td> 
    <td>它从当前目录返回文件列表。</td> 
   </tr> 
   <tr> 
    <td>GetType()</td> 
    <td>它用于获取当前实例的类型。</td> 
   </tr> 
   <tr> 
    <td>MoveTo(String)</td> 
    <td>它用于将<code>DirectoryInfo</code>实例及其内容移动到新路径。</td> 
   </tr> 
   <tr> 
    <td>Refresh()</td> 
    <td>它用于刷新对象的状态。</td> 
   </tr> 
   <tr> 
    <td>SetAccessControl(DirectorySecurity)</td> 
    <td>它用于设置<code>DirectorySecurity</code>对象描述的访问控制列表(ACL)条目。</td> 
   </tr> 
   <tr> 
    <td>ToString()</td> 
    <td>它返回用户传递的原始路径。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-c-directoryinfo-"><a name="C#  DirectoryInfo示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>C# DirectoryInfo示例</h2>
 <p>在下面的例子中，通过指定目录路径来创建一个名称为：<em>yiibai_dir</em>的目录。参考以下示例代码的实现 - </p>   
 <pre><code class="lang-csharp">using System;
using System.IO;
namespace CSharpProgram
{
    class Program
    {
        static void Main(string[] args)
        {
            // Provide directory name with complete location.  
            DirectoryInfo directory = new DirectoryInfo(@"F:\worksp\csharp\yiibai_dir");
            try
            {
                // Check, directory exist or not.  
                if (directory.Exists)
                {
                    Console.WriteLine("Directory already exist.");
                    return;
                }
                // Creating a new directory.  
                directory.Create();
                Console.WriteLine("The directory is created successfully.");
            }
            catch (Exception e)
            {
                Console.WriteLine("Directory not created: {0}", e.ToString());
            }
        }
    }
}
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">The directory is created successfully.
</code></pre> 
 <p>打开目录：<em>F:\worksp\csharp</em> 应该能看到有一个名称为：<em>yiibai_dir</em>的目录。</p> 
 <p><code>DirectoryInfo</code>类还提供删除创建的目录的删除方法。</p> 
 <h2 id="h2-c-directoryinfo-"><a name="C#  DirectoryInfo示例：删除目录" class="reference-link"></a><span class="header-link octicon octicon-link"></span>C# DirectoryInfo示例：删除目录</h2>
 <p>在以下程序中，我们将删除在上面示例程序中创建的<em>yiibai_dir</em>目录。</p> 
 <pre><code class="lang-csharp">using System;
using System.IO;
namespace CSharpProgram
{
    class Program
    {
        static void Main(string[] args)
        {
            // Providing directory name with complete location.  
            DirectoryInfo directory = new DirectoryInfo(@"F:\worksp\csharp\yiibai_dir");
            try
            {
                // Deleting directory  
                directory.Delete();
                Console.WriteLine("The directory is deleted successfully.");
            }
            catch (Exception e)
            {
                Console.WriteLine("Something went wrong: {0}", e.ToString());
            }
        }
    }
}
</code></pre> 
 <p>执行上面示例代码，得到以下结果 - </p> 
 <pre><code class="lang-shell">The directory is deleted successfully.
</code></pre> 
 <p>打开目录：<em>F:\worksp\csharp</em> 应该能看到<em>yiibai_dir</em>目录已经被删除了。</p> 
 <p>如果指定位置不存在目录，它将抛出一个<code>System.IO.DirectoryNotFoundException</code>异常。您可以自己修改上面代码测试一下。</p>
 <br>      
</div></body></html>