<html><head><meta charset="utf-8"></meta></head><body><h1 class="article-title" style="text-align:center;">C#运算符重载</h1><div style="width:100%;float:left;" class="article-content">   
 <p>在C#中，可以重新定义或重载大多数内置运算符。 因此，程序员也可以使用具有用户定义类型的运算符。重载运算符是具有特殊名称的功能，关键字<code>operator</code>后跟定义运算符的符号。 类似于任何其他函数定义，重载运算符具有返回类型和参数列表。</p> 
 <p>例如，通过以下示例函数：</p> 
 <pre><code class="lang-csharp">public static Box operator+ (Box b, Box c)
{
   Box box = new Box();
   box.length = b.length + c.length;
   box.breadth = b.breadth + c.breadth;
   box.height = b.height + c.height;
   return box;
}
</code></pre> 
 <p>上述函数为用户自定义<code>Box</code>类实现加法运算符(<code>+</code>)。它实现相加两个<code>Box</code>对象的属性，并返回生成的<code>Box</code>对象。</p> 
 <h2 id="h2-u5B9Eu73B0u64CDu4F5Cu7B26u91CDu8F7D"><a name="实现操作符重载" class="reference-link"></a><span class="header-link octicon octicon-link"></span>实现操作符重载</h2>
 <p>以下程序显示了完整的实现：</p> 
 <pre><code class="lang-csharp">using System;
namespace OperatorOvlApplication
{
    class Box
    {
        private double length;   // Length of a box
        private double breadth;  // Breadth of a box
        private double height;   // Height of a box

        public double getVolume()
        {
            return length * breadth * height;
        }

        public void setLength(double len)
        {
            length = len;
        }

        public void setBreadth(double bre)
        {
            breadth = bre;
        }

        public void setHeight(double hei)
        {
            height = hei;
        }

        // Overload + operator to add two Box objects.
        public static Box operator +(Box b, Box c)
        {
            Box box = new Box();
            box.length = b.length + c.length;
            box.breadth = b.breadth + c.breadth;
            box.height = b.height + c.height;
            return box;
        }

    }

    class Tester
    {
        static void Main(string[] args)
        {
            Box Box1 = new Box();   // Declare Box1 of type Box
            Box Box2 = new Box();   // Declare Box2 of type Box
            Box Box3 = new Box();   // Declare Box3 of type Box
            double volume = 0.0;    // Store the volume of a box here

            // box 1 specification
            Box1.setLength(60.0);
            Box1.setBreadth(70.0);
            Box1.setHeight(50.0);

            // box 2 specification
            Box2.setLength(121.0);
            Box2.setBreadth(133.0);
            Box2.setHeight(110.0);

            // volume of box 1
            volume = Box1.getVolume();
            Console.WriteLine("Volume of Box1 : {0}", volume);

            // volume of box 2
            volume = Box2.getVolume();
            Console.WriteLine("Volume of Box2 : {0}", volume);

            // Add two object as follows:
            Box3 = Box1 + Box2;

            // volume of box 3
            volume = Box3.getVolume();
            Console.WriteLine("Volume of Box3 : {0}", volume);
            Console.ReadKey();
        }
    }
}
</code></pre> 
 <p>当编译和执行上述代码时，会产生以下结果：</p> 
 <pre><code class="lang-shell">Volume of Box1 : 210000
Volume of Box2 : 1770230
Volume of Box3 : 5878880
</code></pre> 
 <h2 id="h2-u53EFu91CDu8F7Du548Cu4E0Du53EFu91CDu8F7Du7684u8FD0u7B97u7B26"><a name="可重载和不可重载的运算符" class="reference-link"></a><span class="header-link octicon octicon-link"></span>可重载和不可重载的运算符</h2>
 <p>下表描述了 C# 中重载的运算符：</p> 
 <table> 
  <thead> 
   <tr> 
    <th>操作符</th> 
    <th>描述</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr> 
    <td><code>+</code>, <code>-</code>, <code>!</code>, <code>~</code>, <code>++</code>, <code>--</code></td> 
    <td>这些一元运算符需要一个操作数，并且可以重载。</td> 
   </tr> 
   <tr> 
    <td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></td> 
    <td>这些二进制运算符取一个操作数并且可以重载。</td> 
   </tr> 
   <tr> 
    <td><code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></td> 
    <td>这些比较运算符都可以重载</td> 
   </tr> 
   <tr> 
    <td><code>&amp;&amp;</code>, <code>//</code></td> 
    <td>条件逻辑运算符不能直接重载。</td> 
   </tr> 
   <tr> 
    <td><code>+=</code>， <code>-=</code>,<code>*=</code>，<code>/=</code>，<code>％=</code></td> 
    <td>赋值运算符不能被重载。</td> 
   </tr> 
   <tr> 
    <td><code>=</code>, <code>.</code>, <code>?:</code>, <code>-&gt;</code>, <code>new</code>, <code>is</code>, <code>sizeof</code>, <code>typeof</code></td> 
    <td>这些运算符不能重载。</td> 
   </tr> 
  </tbody> 
 </table> 
 <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2>
 <p>根据上述讨论，我们来扩展上面的例子，并且重载更多的运算符：</p> 
 <pre><code class="lang-csharp">using System;
namespace OperatorOvlApplication
{
   class Box
   {
      private double length;    // Length of a box
      private double breadth;   // Breadth of a box
      private double height;    // Height of a box

      public double getVolume()
      {
         return length * breadth * height;
      }

      public void setLength( double len )
      {
         length = len;
      }

      public void setBreadth( double bre )
      {
         breadth = bre;
      }


      public void setHeight( double hei )
      {
         height = hei;
      }

      // Overload + operator to add two Box objects.
      public static Box operator+ (Box b, Box c)
      {
         Box box = new Box();
         box.length = b.length + c.length;
         box.breadth = b.breadth + c.breadth;
         box.height = b.height + c.height;
         return box;
      }

      public static bool operator == (Box lhs, Box rhs)
      {
         bool status = false;
         if (lhs.length == rhs.length &amp;&amp; lhs.height == rhs.height &amp;&amp; lhs.breadth == rhs.breadth)
         {
            status = true;
         }
         return status;
      }

      public static bool operator !=(Box lhs, Box rhs)
      {
         bool status = false;
         if (lhs.length != rhs.length || lhs.height != rhs.height || lhs.breadth != rhs.breadth)
         {
            status = true;
         }
         return status;
      }

      public static bool operator &lt;(Box lhs, Box rhs)
      {
         bool status = false;
         if (lhs.length &lt; rhs.length &amp;&amp; lhs.height &lt; rhs.height &amp;&amp; lhs.breadth &lt; rhs.breadth)
         {
            status = true;
         }
         return status;
      }

      public static bool operator &gt;(Box lhs, Box rhs)
      {
         bool status = false;
         if (lhs.length &gt; rhs.length &amp;&amp; lhs.height &gt; rhs.height &amp;&amp; lhs.breadth &gt; rhs.breadth)
         {
            status = true;
         }
         return status;
      }

      public static bool operator &lt;=(Box lhs, Box rhs)
      {
         bool status = false;
         if (lhs.length &lt;= rhs.length &amp;&amp; lhs.height &lt;= rhs.height &amp;&amp; lhs.breadth &lt;= rhs.breadth)
         {
            status = true;
         }
         return status;
      }

      public static bool operator &gt;=(Box lhs, Box rhs)
      {
         bool status = false;
         if (lhs.length &gt;= rhs.length &amp;&amp; lhs.height &gt;= rhs.height &amp;&amp; lhs.breadth &gt;= rhs.breadth)
         {
            status = true;
         }
         return status;
      }
      public override string ToString()
      {
         return String.Format("({0}, {1}, {2})", length, breadth, height);
      }
   }

   class Tester
   {
      static void Main(string[] args)
      {
         Box Box1 = new Box();   // Declare Box1 of type Box
         Box Box2 = new Box();   // Declare Box2 of type Box
         Box Box3 = new Box();   // Declare Box3 of type Box
         Box Box4 = new Box();
         double volume = 0.0;    // Store the volume of a box here

         // box 1 specification
         Box1.setLength(6.0);
         Box1.setBreadth(7.0);
         Box1.setHeight(5.0);

         // box 2 specification
         Box2.setLength(12.0);
         Box2.setBreadth(13.0);
         Box2.setHeight(10.0);

         //displaying the Boxes using the overloaded ToString():
         Console.WriteLine("Box 1: {0}", Box1.ToString());
         Console.WriteLine("Box 2: {0}", Box2.ToString());

         // volume of box 1
         volume = Box1.getVolume();
         Console.WriteLine("Volume of Box1 : {0}", volume);

         // volume of box 2
         volume = Box2.getVolume();
         Console.WriteLine("Volume of Box2 : {0}", volume);

         // Add two object as follows:
         Box3 = Box1 + Box2;
         Console.WriteLine("Box 3: {0}", Box3.ToString());

         // volume of box 3
         volume = Box3.getVolume();
         Console.WriteLine("Volume of Box3 : {0}", volume);

         //comparing the boxes
         if (Box1 &gt; Box2)
            Console.WriteLine("Box1 is greater than Box2");
         else
            Console.WriteLine("Box1 is  greater than Box2");

         if (Box1 &lt; Box2)
            Console.WriteLine("Box1 is less than Box2");
         else
            Console.WriteLine("Box1 is not less than Box2");

         if (Box1 &gt;= Box2)
            Console.WriteLine("Box1 is greater or equal to Box2");
         else
            Console.WriteLine("Box1 is not greater or equal to Box2");

         if (Box1 &lt;= Box2)
            Console.WriteLine("Box1 is less or equal to Box2");
         else
            Console.WriteLine("Box1 is not less or equal to Box2");

         if (Box1 != Box2)
            Console.WriteLine("Box1 is not equal to Box2");
         else
            Console.WriteLine("Box1 is not greater or equal to Box2");
         Box4 = Box3;

         if (Box3 == Box4)
            Console.WriteLine("Box3 is equal to Box4");
         else
            Console.WriteLine("Box3 is not equal to Box4");

         Console.ReadKey();
      }
   }
}
</code></pre> 
 <p>当编译和执行上述代码时，会产生以下结果：</p>   
 <pre><code class="lang-csharp">Box 1: (6, 7, 5)
Box 2: (12, 13, 10)
Volume of Box1 : 210
Volume of Box2 : 1560
Box 3: (18, 20, 15)
Volume of Box3 : 5400
Box1 is not greater than Box2
Box1 is less than Box2
Box1 is not greater or equal to Box2
Box1 is less or equal to Box2
Box1 is not equal to Box2
Box3 is equal to Box4
</code></pre>
 <br>      
</div></body></html>